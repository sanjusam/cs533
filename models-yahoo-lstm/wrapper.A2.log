DATA_FOLDER : ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_100.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Sun 29 Nov 2020 11:15:01 PM MST
2020-11-29 23:15:12.833230: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-29 23:15:12.883274: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-29 23:15:12.884794: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x556a5b945740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-29 23:15:12.884847: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-29 23:15:12.891726: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_100.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00364/7 [================>.............] - ETA: 0s - loss: 0.00197/7 [==============================] - ETA: 0s - loss: 0.00167/7 [==============================] - 0s 15ms/step - loss: 0.0016
1/7 [===>..........................] - ETA: 0s - loss: 1.5582e-045/7 [====================>.........] - ETA: 0s - loss: 2.9929e-047/7 [==============================] - 0s 13ms/step - loss: 2.9316e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.2895e-045/7 [====================>.........] - ETA: 0s - loss: 0.0046    7/7 [==============================] - 0s 11ms/step - loss: 0.0037
1/7 [===>..........................] - ETA: 0s - loss: 2.4330e-044/7 [================>.............] - ETA: 0s - loss: 1.6311e-047/7 [==============================] - ETA: 0s - loss: 0.0034    7/7 [==============================] - 0s 18ms/step - loss: 0.0034
1/7 [===>..........................] - ETA: 0s - loss: 1.4809e-044/7 [================>.............] - ETA: 0s - loss: 0.0011    6/7 [========================>.....] - ETA: 0s - loss: 0.00117/7 [==============================] - 0s 18ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 0.00393/7 [===========>..................] - ETA: 0s - loss: 0.00225/7 [====================>.........] - ETA: 0s - loss: 0.00167/7 [==============================] - ETA: 0s - loss: 0.00157/7 [==============================] - 0s 24ms/step - loss: 0.0015
1/7 [===>..........................] - ETA: 0s - loss: 7.0033e-053/7 [===========>..................] - ETA: 0s - loss: 2.1723e-045/7 [====================>.........] - ETA: 0s - loss: 1.8035e-047/7 [==============================] - ETA: 0s - loss: 1.7011e-047/7 [==============================] - 0s 25ms/step - loss: 1.7011e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.3845e-044/7 [================>.............] - ETA: 0s - loss: 0.0055    6/7 [========================>.....] - ETA: 0s - loss: 0.00387/7 [==============================] - 0s 24ms/step - loss: 0.0037
1/7 [===>..........................] - ETA: 0s - loss: 0.00113/7 [===========>..................] - ETA: 0s - loss: 7.7231e-045/7 [====================>.........] - ETA: 0s - loss: 0.0048    7/7 [==============================] - 0s 23ms/step - loss: 0.0040
1/7 [===>..........................] - ETA: 0s - loss: 3.0570e-042/7 [=======>......................] - ETA: 0s - loss: 2.1926e-045/7 [====================>.........] - ETA: 0s - loss: 1.5722e-047/7 [==============================] - ETA: 0s - loss: 1.4942e-047/7 [==============================] - 0s 30ms/step - loss: 1.4942e-04
1/7 [===>..........................] - ETA: 0s - loss: 6.7302e-043/7 [===========>..................] - ETA: 0s - loss: 3.1472e-045/7 [====================>.........] - ETA: 0s - loss: 2.3048e-047/7 [==============================] - ETA: 0s - loss: 1.9940e-047/7 [==============================] - 0s 35ms/step - loss: 1.9940e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.5262e-043/7 [===========>..................] - ETA: 0s - loss: 4.8142e-045/7 [====================>.........] - ETA: 0s - loss: 3.7593e-047/7 [==============================] - 0s 24ms/step - loss: 3.5237e-04
1/7 [===>..........................] - ETA: 0s - loss: 6.1648e-053/7 [===========>..................] - ETA: 0s - loss: 8.6317e-055/7 [====================>.........] - ETA: 0s - loss: 0.0046    7/7 [==============================] - ETA: 0s - loss: 0.00377/7 [==============================] - 0s 27ms/step - loss: 0.0037
1/7 [===>..........................] - ETA: 0s - loss: 0.00113/7 [===========>..................] - ETA: 0s - loss: 6.9805e-045/7 [====================>.........] - ETA: 0s - loss: 0.0047    7/7 [==============================] - ETA: 0s - loss: 0.00397/7 [==============================] - 0s 24ms/step - loss: 0.0039
1/7 [===>..........................] - ETA: 0s - loss: 4.5948e-043/7 [===========>..................] - ETA: 0s - loss: 2.5376e-045/7 [====================>.........] - ETA: 0s - loss: 1.8918e-047/7 [==============================] - 0s 27ms/step - loss: 1.9952e-04
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.0016823017853312195:
Train Score: 0.00147 MSE 0.03828 RMSE
Test Score: 0.00054 MSE 0.02315 RMSE
Deviation Min [2.6079426e-05], Max [0.58549905]
Deviation 99.5th pctile [0.06707244]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,    4]))
Confusion matrix 
[[1390    3]
 [   0    4]]
precision 0.57143, recall 1.00000, f1 0.72727
Time to train: 394289 ms
Saving model models/A2Benchmark/synthetic_100.csv.h5
Total Time to proces all the selected files : 398348 ms
A2Benchmark : Avg precision 0.57143 recall 1.00000 f1 0.72727 time to train 394289.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_100.csv  --epochs 20 --n_iter 3 --patience 3 :: took 410 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_10.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Sun 29 Nov 2020 11:21:56 PM MST
2020-11-29 23:22:02.265142: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-29 23:22:02.284283: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-29 23:22:02.285346: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5651e16cc740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-29 23:22:02.285382: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-29 23:22:02.285527: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_10.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00594/7 [================>.............] - ETA: 0s - loss: 0.00297/7 [==============================] - ETA: 0s - loss: 0.00337/7 [==============================] - 0s 19ms/step - loss: 0.0033
1/7 [===>..........................] - ETA: 0s - loss: 4.1077e-044/7 [================>.............] - ETA: 0s - loss: 0.0012    7/7 [==============================] - ETA: 0s - loss: 0.00117/7 [==============================] - 0s 18ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 7.1259e-044/7 [================>.............] - ETA: 0s - loss: 0.0032    7/7 [==============================] - ETA: 0s - loss: 0.00237/7 [==============================] - 0s 18ms/step - loss: 0.0023
1/7 [===>..........................] - ETA: 0s - loss: 6.9377e-044/7 [================>.............] - ETA: 0s - loss: 0.0014    7/7 [==============================] - ETA: 0s - loss: 0.00197/7 [==============================] - 0s 17ms/step - loss: 0.0019
1/7 [===>..........................] - ETA: 0s - loss: 9.9128e-045/7 [====================>.........] - ETA: 0s - loss: 9.4009e-047/7 [==============================] - 0s 16ms/step - loss: 8.7127e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00203/7 [===========>..................] - ETA: 0s - loss: 0.00145/7 [====================>.........] - ETA: 0s - loss: 0.00147/7 [==============================] - ETA: 0s - loss: 0.00157/7 [==============================] - 0s 30ms/step - loss: 0.0015
1/7 [===>..........................] - ETA: 0s - loss: 4.3895e-043/7 [===========>..................] - ETA: 0s - loss: 0.0012    5/7 [====================>.........] - ETA: 0s - loss: 0.00127/7 [==============================] - ETA: 0s - loss: 0.00127/7 [==============================] - 0s 26ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 9.3235e-043/7 [===========>..................] - ETA: 0s - loss: 9.1823e-045/7 [====================>.........] - ETA: 0s - loss: 0.0024    7/7 [==============================] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 26ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 5.4976e-043/7 [===========>..................] - ETA: 0s - loss: 8.9555e-045/7 [====================>.........] - ETA: 0s - loss: 0.0017    7/7 [==============================] - ETA: 0s - loss: 0.00177/7 [==============================] - 0s 36ms/step - loss: 0.0017
1/7 [===>..........................] - ETA: 0s - loss: 0.00153/7 [===========>..................] - ETA: 0s - loss: 0.00195/7 [====================>.........] - ETA: 0s - loss: 0.00157/7 [==============================] - ETA: 0s - loss: 0.00147/7 [==============================] - 0s 27ms/step - loss: 0.0014
1/7 [===>..........................] - ETA: 0s - loss: 0.00143/7 [===========>..................] - ETA: 0s - loss: 0.00105/7 [====================>.........] - ETA: 0s - loss: 0.00117/7 [==============================] - ETA: 0s - loss: 0.00117/7 [==============================] - 0s 31ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 4.1235e-043/7 [===========>..................] - ETA: 0s - loss: 9.8971e-045/7 [====================>.........] - ETA: 0s - loss: 0.0010    7/7 [==============================] - ETA: 0s - loss: 9.9654e-047/7 [==============================] - 0s 37ms/step - loss: 9.9654e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00113/7 [===========>..................] - ETA: 0s - loss: 0.00115/7 [====================>.........] - ETA: 0s - loss: 0.00227/7 [==============================] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 25ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 5.1014e-043/7 [===========>..................] - ETA: 0s - loss: 9.7036e-045/7 [====================>.........] - ETA: 0s - loss: 0.0018    7/7 [==============================] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 24ms/step - loss: 0.0018
1/7 [===>..........................] - ETA: 0s - loss: 0.00133/7 [===========>..................] - ETA: 0s - loss: 0.00115/7 [====================>.........] - ETA: 0s - loss: 0.00117/7 [==============================] - ETA: 0s - loss: 0.00107/7 [==============================] - 0s 36ms/step - loss: 0.0010
Best parameters {'n_units': 72, 'n_hidden': 2} best score 0.0013669270556420088:
Train Score: 0.00166 MSE 0.04074 RMSE
Test Score: 0.00132 MSE 0.03632 RMSE
Deviation Min [1.1902062e-07], Max [0.28940988]
Deviation 99.5th pctile [0.11006398]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,    4]))
Confusion matrix 
[[1390    3]
 [   0    4]]
precision 0.57143, recall 1.00000, f1 0.72727
Time to train: 381370 ms
Saving model models/A2Benchmark/synthetic_10.csv.h5
Total Time to proces all the selected files : 385299 ms
A2Benchmark : Avg precision 0.57143 recall 1.00000 f1 0.72727 time to train 381370.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_10.csv  --epochs 20 --n_iter 3 --patience 3 :: took 392 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_11.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Sun 29 Nov 2020 11:28:33 PM MST
2020-11-29 23:28:38.727742: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-29 23:28:38.746215: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-29 23:28:38.747112: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x562bf8db6960 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-29 23:28:38.747139: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-29 23:28:38.747246: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_11.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00253/7 [===========>..................] - ETA: 0s - loss: 0.00265/7 [====================>.........] - ETA: 0s - loss: 0.00257/7 [==============================] - ETA: 0s - loss: 0.00227/7 [==============================] - 0s 25ms/step - loss: 0.0022
1/7 [===>..........................] - ETA: 0s - loss: 0.00133/7 [===========>..................] - ETA: 0s - loss: 0.00115/7 [====================>.........] - ETA: 0s - loss: 9.8694e-047/7 [==============================] - ETA: 0s - loss: 8.9157e-047/7 [==============================] - 0s 27ms/step - loss: 8.9157e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00153/7 [===========>..................] - ETA: 0s - loss: 0.01835/7 [====================>.........] - ETA: 0s - loss: 0.02237/7 [==============================] - ETA: 0s - loss: 0.01787/7 [==============================] - 0s 35ms/step - loss: 0.0178
1/7 [===>..........................] - ETA: 0s - loss: 9.4153e-043/7 [===========>..................] - ETA: 0s - loss: 0.0010    5/7 [====================>.........] - ETA: 0s - loss: 0.00967/7 [==============================] - ETA: 0s - loss: 0.00847/7 [==============================] - 0s 25ms/step - loss: 0.0084
1/7 [===>..........................] - ETA: 0s - loss: 0.01633/7 [===========>..................] - ETA: 0s - loss: 0.00875/7 [====================>.........] - ETA: 0s - loss: 0.00867/7 [==============================] - ETA: 0s - loss: 0.00937/7 [==============================] - 0s 38ms/step - loss: 0.0093
1/7 [===>..........................] - ETA: 0s - loss: 0.00203/7 [===========>..................] - ETA: 0s - loss: 0.00205/7 [====================>.........] - ETA: 0s - loss: 0.00197/7 [==============================] - ETA: 0s - loss: 0.00177/7 [==============================] - 0s 30ms/step - loss: 0.0017
1/7 [===>..........................] - ETA: 0s - loss: 0.00383/7 [===========>..................] - ETA: 0s - loss: 0.00224/7 [================>.............] - ETA: 0s - loss: 0.00196/7 [========================>.....] - ETA: 0s - loss: 0.00197/7 [==============================] - 0s 33ms/step - loss: 0.0019
1/7 [===>..........................] - ETA: 0s - loss: 0.00123/7 [===========>..................] - ETA: 0s - loss: 0.01835/7 [====================>.........] - ETA: 0s - loss: 0.02267/7 [==============================] - ETA: 0s - loss: 0.01827/7 [==============================] - 0s 41ms/step - loss: 0.0182
1/7 [===>..........................] - ETA: 0s - loss: 9.3001e-043/7 [===========>..................] - ETA: 0s - loss: 0.0017    5/7 [====================>.........] - ETA: 0s - loss: 0.01017/7 [==============================] - ETA: 0s - loss: 0.00897/7 [==============================] - 0s 26ms/step - loss: 0.0089
1/7 [===>..........................] - ETA: 0s - loss: 0.00393/7 [===========>..................] - ETA: 0s - loss: 0.00245/7 [====================>.........] - ETA: 0s - loss: 0.00237/7 [==============================] - ETA: 0s - loss: 0.00267/7 [==============================] - 0s 34ms/step - loss: 0.0026
1/7 [===>..........................] - ETA: 0s - loss: 5.8434e-044/7 [================>.............] - ETA: 0s - loss: 8.1097e-047/7 [==============================] - ETA: 0s - loss: 7.0932e-047/7 [==============================] - 0s 19ms/step - loss: 7.0932e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00135/7 [====================>.........] - ETA: 0s - loss: 9.7661e-047/7 [==============================] - 0s 13ms/step - loss: 8.9233e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00215/7 [====================>.........] - ETA: 0s - loss: 0.02077/7 [==============================] - 0s 14ms/step - loss: 0.0166
1/7 [===>..........................] - ETA: 0s - loss: 7.1645e-044/7 [================>.............] - ETA: 0s - loss: 0.0013    7/7 [==============================] - ETA: 0s - loss: 0.00827/7 [==============================] - 0s 17ms/step - loss: 0.0082
1/7 [===>..........................] - ETA: 0s - loss: 0.00764/7 [================>.............] - ETA: 0s - loss: 0.00367/7 [==============================] - ETA: 0s - loss: 0.00467/7 [==============================] - 0s 18ms/step - loss: 0.0046
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.006192245846614241:
Train Score: 0.00491 MSE 0.07007 RMSE
Test Score: 0.00164 MSE 0.04047 RMSE
Deviation Min [4.88932033e-05], Max [0.74578256]
Deviation 99.5th pctile [0.58288615]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1388,    9]))
Confusion matrix 
[[1388    0]
 [   2    7]]
precision 1.00000, recall 0.77778, f1 0.87500
Time to train: 422252 ms
Saving model models/A2Benchmark/synthetic_11.csv.h5
Total Time to proces all the selected files : 424418 ms
A2Benchmark : Avg precision 1.00000 recall 0.77778 f1 0.87500 time to train 422252.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_11.csv  --epochs 20 --n_iter 3 --patience 3 :: took 430 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_12.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Sun 29 Nov 2020 11:35:48 PM MST
2020-11-29 23:35:54.298103: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-29 23:35:54.317316: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-29 23:35:54.318221: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559261edd740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-29 23:35:54.318249: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-29 23:35:54.318358: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_12.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00184/7 [================>.............] - ETA: 0s - loss: 0.00177/7 [==============================] - ETA: 0s - loss: 0.00167/7 [==============================] - 0s 16ms/step - loss: 0.0016
1/7 [===>..........................] - ETA: 0s - loss: 0.00205/7 [====================>.........] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 13ms/step - loss: 0.0019
1/7 [===>..........................] - ETA: 0s - loss: 0.00175/7 [====================>.........] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 11ms/step - loss: 0.0018
1/7 [===>..........................] - ETA: 0s - loss: 0.00245/7 [====================>.........] - ETA: 0s - loss: 0.00277/7 [==============================] - 0s 13ms/step - loss: 0.0025
1/7 [===>..........................] - ETA: 0s - loss: 0.00394/7 [================>.............] - ETA: 0s - loss: 0.00257/7 [==============================] - ETA: 0s - loss: 0.00257/7 [==============================] - 0s 17ms/step - loss: 0.0025
1/7 [===>..........................] - ETA: 0s - loss: 0.00174/7 [================>.............] - ETA: 0s - loss: 0.00177/7 [==============================] - ETA: 0s - loss: 0.00177/7 [==============================] - 0s 19ms/step - loss: 0.0017
1/7 [===>..........................] - ETA: 0s - loss: 0.00255/7 [====================>.........] - ETA: 0s - loss: 0.00237/7 [==============================] - 0s 13ms/step - loss: 0.0022
1/7 [===>..........................] - ETA: 0s - loss: 0.00225/7 [====================>.........] - ETA: 0s - loss: 0.00227/7 [==============================] - 0s 13ms/step - loss: 0.0023
1/7 [===>..........................] - ETA: 0s - loss: 0.00234/7 [================>.............] - ETA: 0s - loss: 0.00217/7 [==============================] - ETA: 0s - loss: 0.00257/7 [==============================] - 0s 17ms/step - loss: 0.0025
1/7 [===>..........................] - ETA: 0s - loss: 0.00185/7 [====================>.........] - ETA: 0s - loss: 0.00167/7 [==============================] - 0s 14ms/step - loss: 0.0016
1/7 [===>..........................] - ETA: 0s - loss: 0.00173/7 [===========>..................] - ETA: 0s - loss: 0.00175/7 [====================>.........] - ETA: 0s - loss: 0.00197/7 [==============================] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 33ms/step - loss: 0.0018
1/7 [===>..........................] - ETA: 0s - loss: 0.00193/7 [===========>..................] - ETA: 0s - loss: 0.00185/7 [====================>.........] - ETA: 0s - loss: 0.00207/7 [==============================] - ETA: 0s - loss: 0.00197/7 [==============================] - 0s 24ms/step - loss: 0.0019
1/7 [===>..........................] - ETA: 0s - loss: 0.00113/7 [===========>..................] - ETA: 0s - loss: 0.00155/7 [====================>.........] - ETA: 0s - loss: 0.00167/7 [==============================] - ETA: 0s - loss: 0.00177/7 [==============================] - 0s 24ms/step - loss: 0.0017
1/7 [===>..........................] - ETA: 0s - loss: 0.00223/7 [===========>..................] - ETA: 0s - loss: 0.00195/7 [====================>.........] - ETA: 0s - loss: 0.00247/7 [==============================] - ETA: 0s - loss: 0.00227/7 [==============================] - 0s 29ms/step - loss: 0.0022
1/7 [===>..........................] - ETA: 0s - loss: 0.00303/7 [===========>..................] - ETA: 0s - loss: 0.00185/7 [====================>.........] - ETA: 0s - loss: 0.00187/7 [==============================] - ETA: 0s - loss: 0.00177/7 [==============================] - 0s 23ms/step - loss: 0.0017
Best parameters {'n_units': 48, 'n_hidden': 2} best score 0.001878030365332961:
Train Score: 0.00172 MSE 0.04141 RMSE
Test Score: 0.00151 MSE 0.03886 RMSE
Deviation Min [6.40605744e-06], Max [0.27412534]
Deviation 99.5th pctile [0.11549558]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,    1]))
Confusion matrix 
[[1390    6]
 [   0    1]]
precision 0.14286, recall 1.00000, f1 0.25000
Time to train: 408207 ms
Saving model models/A2Benchmark/synthetic_12.csv.h5
Total Time to proces all the selected files : 411814 ms
A2Benchmark : Avg precision 0.14286 recall 1.00000 f1 0.25000 time to train 408207.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_12.csv  --epochs 20 --n_iter 3 --patience 3 :: took 418 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_13.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Sun 29 Nov 2020 11:42:51 PM MST
2020-11-29 23:42:57.280882: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-29 23:42:57.299321: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-29 23:42:57.300797: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x557713f81740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-29 23:42:57.300863: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-29 23:42:57.301086: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_13.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 6.1306e-042/7 [=======>......................] - ETA: 0s - loss: 0.0010    4/7 [================>.............] - ETA: 0s - loss: 7.4792e-046/7 [========================>.....] - ETA: 0s - loss: 7.8603e-047/7 [==============================] - 0s 34ms/step - loss: 7.6078e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.5920e-043/7 [===========>..................] - ETA: 0s - loss: 6.0856e-045/7 [====================>.........] - ETA: 0s - loss: 6.0691e-047/7 [==============================] - ETA: 0s - loss: 6.8281e-047/7 [==============================] - 0s 31ms/step - loss: 6.8281e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.7869e-043/7 [===========>..................] - ETA: 0s - loss: 5.2390e-045/7 [====================>.........] - ETA: 0s - loss: 0.0055    7/7 [==============================] - ETA: 0s - loss: 0.00457/7 [==============================] - 0s 28ms/step - loss: 0.0045
1/7 [===>..........................] - ETA: 0s - loss: 6.9110e-043/7 [===========>..................] - ETA: 0s - loss: 6.1719e-045/7 [====================>.........] - ETA: 0s - loss: 0.0049    7/7 [==============================] - ETA: 0s - loss: 0.00447/7 [==============================] - 0s 31ms/step - loss: 0.0044
1/7 [===>..........................] - ETA: 0s - loss: 9.1275e-043/7 [===========>..................] - ETA: 0s - loss: 5.4406e-045/7 [====================>.........] - ETA: 0s - loss: 5.8729e-047/7 [==============================] - ETA: 0s - loss: 5.4421e-047/7 [==============================] - 0s 27ms/step - loss: 5.4421e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.4271e-044/7 [================>.............] - ETA: 0s - loss: 3.6984e-047/7 [==============================] - ETA: 0s - loss: 3.9427e-047/7 [==============================] - 0s 18ms/step - loss: 3.9427e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.8861e-045/7 [====================>.........] - ETA: 0s - loss: 8.0157e-047/7 [==============================] - 0s 15ms/step - loss: 8.6720e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.1579e-044/7 [================>.............] - ETA: 0s - loss: 0.0056    7/7 [==============================] - ETA: 0s - loss: 0.00387/7 [==============================] - 0s 16ms/step - loss: 0.0038
1/7 [===>..........................] - ETA: 0s - loss: 4.1281e-045/7 [====================>.........] - ETA: 0s - loss: 0.0044    7/7 [==============================] - 0s 13ms/step - loss: 0.0038
1/7 [===>..........................] - ETA: 0s - loss: 0.00104/7 [================>.............] - ETA: 0s - loss: 6.8434e-047/7 [==============================] - ETA: 0s - loss: 5.4957e-047/7 [==============================] - 0s 15ms/step - loss: 5.4957e-04
1/7 [===>..........................] - ETA: 0s - loss: 8.5663e-043/7 [===========>..................] - ETA: 0s - loss: 0.0012    5/7 [====================>.........] - ETA: 0s - loss: 0.00127/7 [==============================] - ETA: 0s - loss: 0.00117/7 [==============================] - 0s 32ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 3.0341e-043/7 [===========>..................] - ETA: 0s - loss: 5.4139e-045/7 [====================>.........] - ETA: 0s - loss: 5.7429e-047/7 [==============================] - ETA: 0s - loss: 6.3672e-047/7 [==============================] - 0s 26ms/step - loss: 6.3672e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.2014e-043/7 [===========>..................] - ETA: 0s - loss: 2.9404e-045/7 [====================>.........] - ETA: 0s - loss: 0.0047    7/7 [==============================] - ETA: 0s - loss: 0.00397/7 [==============================] - 0s 35ms/step - loss: 0.0039
1/7 [===>..........................] - ETA: 0s - loss: 6.2955e-043/7 [===========>..................] - ETA: 0s - loss: 7.1014e-045/7 [====================>.........] - ETA: 0s - loss: 0.0050    7/7 [==============================] - ETA: 0s - loss: 0.00457/7 [==============================] - 0s 27ms/step - loss: 0.0045
1/7 [===>..........................] - ETA: 0s - loss: 0.00173/7 [===========>..................] - ETA: 0s - loss: 0.00125/7 [====================>.........] - ETA: 0s - loss: 0.00137/7 [==============================] - ETA: 0s - loss: 0.00137/7 [==============================] - 0s 26ms/step - loss: 0.0013
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0018734465877059848:
Train Score: 0.00152 MSE 0.03903 RMSE
Test Score: 0.00037 MSE 0.01923 RMSE
Deviation Min [2.37808972e-06], Max [0.56542635]
Deviation 99.5th pctile [0.15421655]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,    4]))
Confusion matrix 
[[1390    3]
 [   0    4]]
precision 0.57143, recall 1.00000, f1 0.72727
Time to train: 422862 ms
Saving model models/A2Benchmark/synthetic_13.csv.h5
Total Time to proces all the selected files : 425384 ms
A2Benchmark : Avg precision 0.57143 recall 1.00000 f1 0.72727 time to train 422862.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_13.csv  --epochs 20 --n_iter 3 --patience 3 :: took 432 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_14.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Sun 29 Nov 2020 11:50:08 PM MST
2020-11-29 23:50:13.941917: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-29 23:50:13.960286: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-29 23:50:13.961894: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56390cd0d960 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-29 23:50:13.961951: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-29 23:50:13.962174: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_14.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00333/7 [===========>..................] - ETA: 0s - loss: 0.00565/7 [====================>.........] - ETA: 0s - loss: 0.00517/7 [==============================] - ETA: 0s - loss: 0.00417/7 [==============================] - 0s 28ms/step - loss: 0.0041
1/7 [===>..........................] - ETA: 0s - loss: 3.5992e-043/7 [===========>..................] - ETA: 0s - loss: 3.5080e-045/7 [====================>.........] - ETA: 0s - loss: 3.3427e-047/7 [==============================] - ETA: 0s - loss: 3.7734e-047/7 [==============================] - 0s 43ms/step - loss: 3.7734e-04
1/7 [===>..........................] - ETA: 0s - loss: 9.5701e-053/7 [===========>..................] - ETA: 0s - loss: 0.0122    5/7 [====================>.........] - ETA: 0s - loss: 0.01487/7 [==============================] - ETA: 0s - loss: 0.01187/7 [==============================] - 0s 28ms/step - loss: 0.0118
1/7 [===>..........................] - ETA: 0s - loss: 6.7231e-043/7 [===========>..................] - ETA: 0s - loss: 8.7231e-045/7 [====================>.........] - ETA: 0s - loss: 0.0067    7/7 [==============================] - ETA: 0s - loss: 0.00587/7 [==============================] - 0s 31ms/step - loss: 0.0058
1/7 [===>..........................] - ETA: 0s - loss: 0.01923/7 [===========>..................] - ETA: 0s - loss: 0.02514/7 [================>.............] - ETA: 0s - loss: 0.02585/7 [====================>.........] - ETA: 0s - loss: 0.02526/7 [========================>.....] - ETA: 0s - loss: 0.02387/7 [==============================] - 0s 39ms/step - loss: 0.0235
1/7 [===>..........................] - ETA: 0s - loss: 0.00224/7 [================>.............] - ETA: 0s - loss: 0.00367/7 [==============================] - ETA: 0s - loss: 0.00267/7 [==============================] - 0s 16ms/step - loss: 0.0026
1/7 [===>..........................] - ETA: 0s - loss: 3.0515e-044/7 [================>.............] - ETA: 0s - loss: 2.6835e-047/7 [==============================] - ETA: 0s - loss: 2.7496e-047/7 [==============================] - 0s 18ms/step - loss: 2.7496e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.4556e-044/7 [================>.............] - ETA: 0s - loss: 0.0173    7/7 [==============================] - 0s 14ms/step - loss: 0.0113
1/7 [===>..........................] - ETA: 0s - loss: 1.1749e-045/7 [====================>.........] - ETA: 0s - loss: 0.0063    7/7 [==============================] - 0s 13ms/step - loss: 0.0053
1/7 [===>..........................] - ETA: 0s - loss: 0.00124/7 [================>.............] - ETA: 0s - loss: 6.9804e-047/7 [==============================] - 0s 14ms/step - loss: 4.9310e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00254/7 [================>.............] - ETA: 0s - loss: 0.00377/7 [==============================] - ETA: 0s - loss: 0.00267/7 [==============================] - 0s 19ms/step - loss: 0.0026
1/7 [===>..........................] - ETA: 0s - loss: 2.9548e-044/7 [================>.............] - ETA: 0s - loss: 2.5804e-047/7 [==============================] - ETA: 0s - loss: 2.6166e-047/7 [==============================] - 0s 17ms/step - loss: 2.6166e-04
1/7 [===>..........................] - ETA: 0s - loss: 9.1561e-054/7 [================>.............] - ETA: 0s - loss: 0.0168    7/7 [==============================] - ETA: 0s - loss: 0.01107/7 [==============================] - 0s 19ms/step - loss: 0.0110
1/7 [===>..........................] - ETA: 0s - loss: 3.0832e-044/7 [================>.............] - ETA: 0s - loss: 2.7274e-047/7 [==============================] - ETA: 0s - loss: 0.0056    7/7 [==============================] - 0s 17ms/step - loss: 0.0056
1/7 [===>..........................] - ETA: 0s - loss: 1.7136e-045/7 [====================>.........] - ETA: 0s - loss: 0.0018    7/7 [==============================] - 0s 13ms/step - loss: 0.0018
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.0039807894849218425:
Train Score: 0.00298 MSE 0.05455 RMSE
Test Score: 0.00172 MSE 0.04147 RMSE
Deviation Min [9.48142631e-06], Max [0.61860934]
Deviation 99.5th pctile [0.45801317]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1388,    9]))
Confusion matrix 
[[1388    0]
 [   2    7]]
precision 1.00000, recall 0.77778, f1 0.87500
Time to train: 255727 ms
Saving model models/A2Benchmark/synthetic_14.csv.h5
Total Time to proces all the selected files : 257798 ms
A2Benchmark : Avg precision 1.00000 recall 0.77778 f1 0.87500 time to train 255727.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_14.csv  --epochs 20 --n_iter 3 --patience 3 :: took 264 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_15.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Sun 29 Nov 2020 11:54:37 PM MST
2020-11-29 23:54:42.849045: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-29 23:54:42.868243: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-29 23:54:42.869500: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55fbb0679440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-29 23:54:42.869544: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-29 23:54:42.869717: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_15.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00274/7 [================>.............] - ETA: 0s - loss: 0.00307/7 [==============================] - ETA: 0s - loss: 0.00277/7 [==============================] - 0s 17ms/step - loss: 0.0027
1/7 [===>..........................] - ETA: 0s - loss: 0.00255/7 [====================>.........] - ETA: 0s - loss: 0.00297/7 [==============================] - 0s 13ms/step - loss: 0.0027
1/7 [===>..........................] - ETA: 0s - loss: 0.00165/7 [====================>.........] - ETA: 0s - loss: 0.00277/7 [==============================] - 0s 13ms/step - loss: 0.0029
1/7 [===>..........................] - ETA: 0s - loss: 0.00325/7 [====================>.........] - ETA: 0s - loss: 0.00507/7 [==============================] - 0s 13ms/step - loss: 0.0045
1/7 [===>..........................] - ETA: 0s - loss: 0.00545/7 [====================>.........] - ETA: 0s - loss: 0.00287/7 [==============================] - 0s 13ms/step - loss: 0.0027
1/7 [===>..........................] - ETA: 0s - loss: 0.00393/7 [===========>..................] - ETA: 0s - loss: 0.00375/7 [====================>.........] - ETA: 0s - loss: 0.00597/7 [==============================] - ETA: 0s - loss: 0.00507/7 [==============================] - 0s 32ms/step - loss: 0.0050
1/7 [===>..........................] - ETA: 0s - loss: 0.00553/7 [===========>..................] - ETA: 0s - loss: 0.00465/7 [====================>.........] - ETA: 0s - loss: 0.00727/7 [==============================] - ETA: 0s - loss: 0.00717/7 [==============================] - 0s 31ms/step - loss: 0.0071
1/7 [===>..........................] - ETA: 0s - loss: 0.00143/7 [===========>..................] - ETA: 0s - loss: 0.00235/7 [====================>.........] - ETA: 0s - loss: 0.00247/7 [==============================] - ETA: 0s - loss: 0.00267/7 [==============================] - 0s 33ms/step - loss: 0.0026
1/7 [===>..........................] - ETA: 0s - loss: 0.00273/7 [===========>..................] - ETA: 0s - loss: 0.00245/7 [====================>.........] - ETA: 0s - loss: 0.00457/7 [==============================] - ETA: 0s - loss: 0.00437/7 [==============================] - 0s 28ms/step - loss: 0.0043
1/7 [===>..........................] - ETA: 0s - loss: 0.00373/7 [===========>..................] - ETA: 0s - loss: 0.00285/7 [====================>.........] - ETA: 0s - loss: 0.00317/7 [==============================] - ETA: 0s - loss: 0.00297/7 [==============================] - 0s 26ms/step - loss: 0.0029
1/7 [===>..........................] - ETA: 0s - loss: 0.00325/7 [====================>.........] - ETA: 0s - loss: 0.00287/7 [==============================] - 0s 12ms/step - loss: 0.0026
1/7 [===>..........................] - ETA: 0s - loss: 0.00235/7 [====================>.........] - ETA: 0s - loss: 0.00337/7 [==============================] - 0s 13ms/step - loss: 0.0031
1/7 [===>..........................] - ETA: 0s - loss: 0.00155/7 [====================>.........] - ETA: 0s - loss: 0.00257/7 [==============================] - 0s 14ms/step - loss: 0.0030
1/7 [===>..........................] - ETA: 0s - loss: 0.00294/7 [================>.............] - ETA: 0s - loss: 0.00267/7 [==============================] - ETA: 0s - loss: 0.00427/7 [==============================] - 0s 16ms/step - loss: 0.0042
1/7 [===>..........................] - ETA: 0s - loss: 0.00715/7 [====================>.........] - ETA: 0s - loss: 0.00347/7 [==============================] - 0s 12ms/step - loss: 0.0032
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0030897434800863264:
Train Score: 0.00294 MSE 0.05418 RMSE
Test Score: 0.00261 MSE 0.05105 RMSE
Deviation Min [4.37083987e-05], Max [0.54832259]
Deviation 99.5th pctile [0.14436872]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,    1]))
Confusion matrix 
[[1390    6]
 [   0    1]]
precision 0.14286, recall 1.00000, f1 0.25000
Time to train: 318939 ms
Saving model models/A2Benchmark/synthetic_15.csv.h5
Total Time to proces all the selected files : 321031 ms
A2Benchmark : Avg precision 0.14286 recall 1.00000 f1 0.25000 time to train 318939.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_15.csv  --epochs 20 --n_iter 3 --patience 3 :: took 327 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_16.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 12:00:09 AM MST
2020-11-30 00:00:15.158470: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 00:00:15.177238: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 00:00:15.178591: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d65ab39440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 00:00:15.178630: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 00:00:15.178790: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_16.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00773/7 [===========>..................] - ETA: 0s - loss: 0.00345/7 [====================>.........] - ETA: 0s - loss: 0.00267/7 [==============================] - ETA: 0s - loss: 0.00307/7 [==============================] - 0s 31ms/step - loss: 0.0030
1/7 [===>..........................] - ETA: 0s - loss: 4.6946e-043/7 [===========>..................] - ETA: 0s - loss: 0.0012    5/7 [====================>.........] - ETA: 0s - loss: 0.00127/7 [==============================] - ETA: 0s - loss: 0.00117/7 [==============================] - 0s 26ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 0.00343/7 [===========>..................] - ETA: 0s - loss: 0.00325/7 [====================>.........] - ETA: 0s - loss: 0.00647/7 [==============================] - ETA: 0s - loss: 0.00537/7 [==============================] - 0s 30ms/step - loss: 0.0053
1/7 [===>..........................] - ETA: 0s - loss: 0.00323/7 [===========>..................] - ETA: 0s - loss: 0.00195/7 [====================>.........] - ETA: 0s - loss: 0.00517/7 [==============================] - ETA: 0s - loss: 0.00457/7 [==============================] - 0s 24ms/step - loss: 0.0045
1/7 [===>..........................] - ETA: 0s - loss: 0.00373/7 [===========>..................] - ETA: 0s - loss: 0.00185/7 [====================>.........] - ETA: 0s - loss: 0.00137/7 [==============================] - ETA: 0s - loss: 0.00167/7 [==============================] - 0s 32ms/step - loss: 0.0016
1/7 [===>..........................] - ETA: 0s - loss: 0.00265/7 [====================>.........] - ETA: 0s - loss: 0.00117/7 [==============================] - 0s 13ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 4.7772e-045/7 [====================>.........] - ETA: 0s - loss: 8.5124e-047/7 [==============================] - 0s 13ms/step - loss: 7.6014e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00175/7 [====================>.........] - ETA: 0s - loss: 0.00507/7 [==============================] - 0s 11ms/step - loss: 0.0041
1/7 [===>..........................] - ETA: 0s - loss: 0.00294/7 [================>.............] - ETA: 0s - loss: 0.00177/7 [==============================] - ETA: 0s - loss: 0.00447/7 [==============================] - 0s 18ms/step - loss: 0.0044
1/7 [===>..........................] - ETA: 0s - loss: 0.00165/7 [====================>.........] - ETA: 0s - loss: 7.9888e-047/7 [==============================] - 0s 13ms/step - loss: 8.8111e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.01253/7 [===========>..................] - ETA: 0s - loss: 0.00545/7 [====================>.........] - ETA: 0s - loss: 0.00397/7 [==============================] - ETA: 0s - loss: 0.00447/7 [==============================] - 0s 33ms/step - loss: 0.0044
1/7 [===>..........................] - ETA: 0s - loss: 5.2219e-043/7 [===========>..................] - ETA: 0s - loss: 0.0010    4/7 [================>.............] - ETA: 0s - loss: 0.00116/7 [========================>.....] - ETA: 0s - loss: 0.00127/7 [==============================] - 0s 32ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 0.00193/7 [===========>..................] - ETA: 0s - loss: 0.00195/7 [====================>.........] - ETA: 0s - loss: 0.00557/7 [==============================] - ETA: 0s - loss: 0.00457/7 [==============================] - 0s 37ms/step - loss: 0.0045
1/7 [===>..........................] - ETA: 0s - loss: 0.00183/7 [===========>..................] - ETA: 0s - loss: 0.00135/7 [====================>.........] - ETA: 0s - loss: 0.00487/7 [==============================] - ETA: 0s - loss: 0.00437/7 [==============================] - 0s 36ms/step - loss: 0.0043
1/7 [===>..........................] - ETA: 0s - loss: 0.00613/7 [===========>..................] - ETA: 0s - loss: 0.00405/7 [====================>.........] - ETA: 0s - loss: 0.00267/7 [==============================] - ETA: 0s - loss: 0.00307/7 [==============================] - 0s 26ms/step - loss: 0.0030
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.002262218948453665:
Train Score: 0.00193 MSE 0.04391 RMSE
Test Score: 0.00130 MSE 0.03603 RMSE
Deviation Min [2.55014713e-06], Max [0.54530218]
Deviation 99.5th pctile [0.11482602]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,    4]))
Confusion matrix 
[[1390    3]
 [   0    4]]
precision 0.57143, recall 1.00000, f1 0.72727
Time to train: 371860 ms
Saving model models/A2Benchmark/synthetic_16.csv.h5
Total Time to proces all the selected files : 374175 ms
A2Benchmark : Avg precision 0.57143 recall 1.00000 f1 0.72727 time to train 371860.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_16.csv  --epochs 20 --n_iter 3 --patience 3 :: took 380 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_17.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 12:06:34 AM MST
2020-11-30 00:06:40.962282: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 00:06:40.981233: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 00:06:40.982562: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x563355203640 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 00:06:40.982609: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 00:06:40.982788: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_17.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00134/7 [================>.............] - ETA: 0s - loss: 0.00127/7 [==============================] - ETA: 0s - loss: 0.00137/7 [==============================] - 0s 17ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 6.9487e-046/7 [========================>.....] - ETA: 0s - loss: 0.0014    7/7 [==============================] - 0s 11ms/step - loss: 0.0015
1/7 [===>..........................] - ETA: 0s - loss: 9.3801e-044/7 [================>.............] - ETA: 0s - loss: 0.0119    7/7 [==============================] - ETA: 0s - loss: 0.00827/7 [==============================] - 0s 17ms/step - loss: 0.0082
1/7 [===>..........................] - ETA: 0s - loss: 7.2075e-045/7 [====================>.........] - ETA: 0s - loss: 0.0046    7/7 [==============================] - 0s 12ms/step - loss: 0.0043
1/7 [===>..........................] - ETA: 0s - loss: 0.00215/7 [====================>.........] - ETA: 0s - loss: 0.00167/7 [==============================] - 0s 12ms/step - loss: 0.0016
1/7 [===>..........................] - ETA: 0s - loss: 0.00253/7 [===========>..................] - ETA: 0s - loss: 0.00185/7 [====================>.........] - ETA: 0s - loss: 0.00157/7 [==============================] - ETA: 0s - loss: 0.00177/7 [==============================] - 0s 31ms/step - loss: 0.0017
1/7 [===>..........................] - ETA: 0s - loss: 6.7410e-043/7 [===========>..................] - ETA: 0s - loss: 0.0014    5/7 [====================>.........] - ETA: 0s - loss: 0.00157/7 [==============================] - ETA: 0s - loss: 0.00147/7 [==============================] - 0s 31ms/step - loss: 0.0014
1/7 [===>..........................] - ETA: 0s - loss: 0.00113/7 [===========>..................] - ETA: 0s - loss: 0.00785/7 [====================>.........] - ETA: 0s - loss: 0.01037/7 [==============================] - ETA: 0s - loss: 0.00847/7 [==============================] - 0s 35ms/step - loss: 0.0084
1/7 [===>..........................] - ETA: 0s - loss: 7.8744e-043/7 [===========>..................] - ETA: 0s - loss: 0.0016    5/7 [====================>.........] - ETA: 0s - loss: 0.00467/7 [==============================] - ETA: 0s - loss: 0.00437/7 [==============================] - 0s 25ms/step - loss: 0.0043
1/7 [===>..........................] - ETA: 0s - loss: 0.00413/7 [===========>..................] - ETA: 0s - loss: 0.00275/7 [====================>.........] - ETA: 0s - loss: 0.00227/7 [==============================] - ETA: 0s - loss: 0.00257/7 [==============================] - 0s 35ms/step - loss: 0.0025
1/7 [===>..........................] - ETA: 0s - loss: 0.00272/7 [=======>......................] - ETA: 0s - loss: 0.00264/7 [================>.............] - ETA: 0s - loss: 0.00206/7 [========================>.....] - ETA: 0s - loss: 0.00217/7 [==============================] - 0s 28ms/step - loss: 0.0021
1/7 [===>..........................] - ETA: 0s - loss: 0.00153/7 [===========>..................] - ETA: 0s - loss: 0.00235/7 [====================>.........] - ETA: 0s - loss: 0.00257/7 [==============================] - ETA: 0s - loss: 0.00247/7 [==============================] - 0s 26ms/step - loss: 0.0024
1/7 [===>..........................] - ETA: 0s - loss: 0.00103/7 [===========>..................] - ETA: 0s - loss: 0.00815/7 [====================>.........] - ETA: 0s - loss: 0.01047/7 [==============================] - ETA: 0s - loss: 0.00857/7 [==============================] - 0s 26ms/step - loss: 0.0085
1/7 [===>..........................] - ETA: 0s - loss: 6.5528e-043/7 [===========>..................] - ETA: 0s - loss: 0.0017    5/7 [====================>.........] - ETA: 0s - loss: 0.00497/7 [==============================] - ETA: 0s - loss: 0.00457/7 [==============================] - 0s 32ms/step - loss: 0.0045
1/7 [===>..........................] - ETA: 0s - loss: 0.00153/7 [===========>..................] - ETA: 0s - loss: 0.00145/7 [====================>.........] - ETA: 0s - loss: 0.00137/7 [==============================] - ETA: 0s - loss: 0.00127/7 [==============================] - 0s 31ms/step - loss: 0.0012
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0033537052804604173:
Train Score: 0.00340 MSE 0.05834 RMSE
Test Score: 0.00157 MSE 0.03962 RMSE
Deviation Min [0.000144], Max [0.49895626]
Deviation 99.5th pctile [0.36903478]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1388,    9]))
Confusion matrix 
[[1388    0]
 [   2    7]]
precision 1.00000, recall 0.77778, f1 0.87500
Time to train: 408471 ms
Saving model models/A2Benchmark/synthetic_17.csv.h5
Total Time to proces all the selected files : 410768 ms
A2Benchmark : Avg precision 1.00000 recall 0.77778 f1 0.87500 time to train 408471.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_17.csv  --epochs 20 --n_iter 3 --patience 3 :: took 418 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_18.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 12:13:37 AM MST
2020-11-30 00:13:43.838598: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 00:13:43.857174: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 00:13:43.858675: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55c749584740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 00:13:43.858720: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 00:13:43.858928: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_18.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 7.8467e-044/7 [================>.............] - ETA: 0s - loss: 0.0015    7/7 [==============================] - ETA: 0s - loss: 0.00127/7 [==============================] - 0s 16ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 0.00115/7 [====================>.........] - ETA: 0s - loss: 0.00117/7 [==============================] - 0s 16ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 8.1897e-044/7 [================>.............] - ETA: 0s - loss: 8.3178e-047/7 [==============================] - ETA: 0s - loss: 9.1965e-047/7 [==============================] - 0s 16ms/step - loss: 9.1965e-04
1/7 [===>..........................] - ETA: 0s - loss: 8.9517e-044/7 [================>.............] - ETA: 0s - loss: 9.0345e-047/7 [==============================] - 0s 14ms/step - loss: 0.0025
1/7 [===>..........................] - ETA: 0s - loss: 0.00214/7 [================>.............] - ETA: 0s - loss: 0.00157/7 [==============================] - 0s 16ms/step - loss: 0.0016
1/7 [===>..........................] - ETA: 0s - loss: 0.00314/7 [================>.............] - ETA: 0s - loss: 0.00337/7 [==============================] - ETA: 0s - loss: 0.00337/7 [==============================] - 0s 17ms/step - loss: 0.0033
1/7 [===>..........................] - ETA: 0s - loss: 0.00154/7 [================>.............] - ETA: 0s - loss: 0.00137/7 [==============================] - 0s 14ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 5.4007e-044/7 [================>.............] - ETA: 0s - loss: 7.4921e-047/7 [==============================] - 0s 14ms/step - loss: 7.9490e-04
1/7 [===>..........................] - ETA: 0s - loss: 9.5679e-045/7 [====================>.........] - ETA: 0s - loss: 0.0029    7/7 [==============================] - 0s 14ms/step - loss: 0.0025
1/7 [===>..........................] - ETA: 0s - loss: 0.00244/7 [================>.............] - ETA: 0s - loss: 0.00127/7 [==============================] - ETA: 0s - loss: 0.00147/7 [==============================] - 0s 18ms/step - loss: 0.0014
1/7 [===>..........................] - ETA: 0s - loss: 0.00103/7 [===========>..................] - ETA: 0s - loss: 0.00125/7 [====================>.........] - ETA: 0s - loss: 0.00127/7 [==============================] - ETA: 0s - loss: 0.00117/7 [==============================] - 0s 38ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 0.00113/7 [===========>..................] - ETA: 0s - loss: 0.00165/7 [====================>.........] - ETA: 0s - loss: 0.00167/7 [==============================] - ETA: 0s - loss: 0.00177/7 [==============================] - 0s 31ms/step - loss: 0.0017
1/7 [===>..........................] - ETA: 0s - loss: 8.5092e-043/7 [===========>..................] - ETA: 0s - loss: 7.5845e-045/7 [====================>.........] - ETA: 0s - loss: 9.7170e-047/7 [==============================] - ETA: 0s - loss: 9.4577e-047/7 [==============================] - 0s 31ms/step - loss: 9.4577e-04
1/7 [===>..........................] - ETA: 0s - loss: 8.0169e-043/7 [===========>..................] - ETA: 0s - loss: 0.0020    4/7 [================>.............] - ETA: 0s - loss: 0.00186/7 [========================>.....] - ETA: 0s - loss: 0.00327/7 [==============================] - 0s 34ms/step - loss: 0.0032
1/7 [===>..........................] - ETA: 0s - loss: 0.00183/7 [===========>..................] - ETA: 0s - loss: 0.00135/7 [====================>.........] - ETA: 0s - loss: 0.00147/7 [==============================] - ETA: 0s - loss: 0.00147/7 [==============================] - 0s 30ms/step - loss: 0.0014
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0014621385489590466:
Train Score: 0.00137 MSE 0.03705 RMSE
Test Score: 0.00295 MSE 0.05430 RMSE
Deviation Min [5.22074011e-05], Max [0.54820487]
Deviation 99.5th pctile [0.11246337]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,    1]))
Confusion matrix 
[[1390    6]
 [   0    1]]
precision 0.14286, recall 1.00000, f1 0.25000
Time to train: 427143 ms
Saving model models/A2Benchmark/synthetic_18.csv.h5
Total Time to proces all the selected files : 429489 ms
A2Benchmark : Avg precision 0.14286 recall 1.00000 f1 0.25000 time to train 427143.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_18.csv  --epochs 20 --n_iter 3 --patience 3 :: took 436 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_19.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 12:20:58 AM MST
2020-11-30 00:21:04.567106: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 00:21:04.585279: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 00:21:04.586965: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x561899a65740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 00:21:04.587020: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 00:21:04.587247: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_19.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00233/7 [===========>..................] - ETA: 0s - loss: 0.00255/7 [====================>.........] - ETA: 0s - loss: 0.00287/7 [==============================] - ETA: 0s - loss: 0.00277/7 [==============================] - 0s 30ms/step - loss: 0.0027
1/7 [===>..........................] - ETA: 0s - loss: 0.00293/7 [===========>..................] - ETA: 0s - loss: 0.00365/7 [====================>.........] - ETA: 0s - loss: 0.00387/7 [==============================] - ETA: 0s - loss: 0.00377/7 [==============================] - 0s 24ms/step - loss: 0.0037
1/7 [===>..........................] - ETA: 0s - loss: 0.00204/7 [================>.............] - ETA: 0s - loss: 0.01136/7 [========================>.....] - ETA: 0s - loss: 0.00847/7 [==============================] - 0s 21ms/step - loss: 0.0082
1/7 [===>..........................] - ETA: 0s - loss: 0.00263/7 [===========>..................] - ETA: 0s - loss: 0.00335/7 [====================>.........] - ETA: 0s - loss: 0.00867/7 [==============================] - 0s 28ms/step - loss: 0.0078
1/7 [===>..........................] - ETA: 0s - loss: 0.00533/7 [===========>..................] - ETA: 0s - loss: 0.00525/7 [====================>.........] - ETA: 0s - loss: 0.00487/7 [==============================] - ETA: 0s - loss: 0.00497/7 [==============================] - 0s 23ms/step - loss: 0.0049
1/7 [===>..........................] - ETA: 0s - loss: 0.00223/7 [===========>..................] - ETA: 0s - loss: 0.00285/7 [====================>.........] - ETA: 0s - loss: 0.00297/7 [==============================] - ETA: 0s - loss: 0.00297/7 [==============================] - 0s 27ms/step - loss: 0.0029
1/7 [===>..........................] - ETA: 0s - loss: 0.00143/7 [===========>..................] - ETA: 0s - loss: 0.00285/7 [====================>.........] - ETA: 0s - loss: 0.00307/7 [==============================] - ETA: 0s - loss: 0.00307/7 [==============================] - 0s 27ms/step - loss: 0.0030
1/7 [===>..........................] - ETA: 0s - loss: 0.00163/7 [===========>..................] - ETA: 0s - loss: 0.00225/7 [====================>.........] - ETA: 0s - loss: 0.00867/7 [==============================] - ETA: 0s - loss: 0.00727/7 [==============================] - 0s 26ms/step - loss: 0.0072
1/7 [===>..........................] - ETA: 0s - loss: 0.00183/7 [===========>..................] - ETA: 0s - loss: 0.00275/7 [====================>.........] - ETA: 0s - loss: 0.00767/7 [==============================] - ETA: 0s - loss: 0.00717/7 [==============================] - 0s 27ms/step - loss: 0.0071
1/7 [===>..........................] - ETA: 0s - loss: 0.00433/7 [===========>..................] - ETA: 0s - loss: 0.00385/7 [====================>.........] - ETA: 0s - loss: 0.00357/7 [==============================] - ETA: 0s - loss: 0.00347/7 [==============================] - 0s 38ms/step - loss: 0.0034
1/7 [===>..........................] - ETA: 0s - loss: 0.00224/7 [================>.............] - ETA: 0s - loss: 0.00287/7 [==============================] - ETA: 0s - loss: 0.00297/7 [==============================] - 0s 17ms/step - loss: 0.0029
1/7 [===>..........................] - ETA: 0s - loss: 0.00235/7 [====================>.........] - ETA: 0s - loss: 0.00347/7 [==============================] - 0s 13ms/step - loss: 0.0033
1/7 [===>..........................] - ETA: 0s - loss: 0.00194/7 [================>.............] - ETA: 0s - loss: 0.01087/7 [==============================] - ETA: 0s - loss: 0.00797/7 [==============================] - 0s 17ms/step - loss: 0.0079
1/7 [===>..........................] - ETA: 0s - loss: 0.00184/7 [================>.............] - ETA: 0s - loss: 0.00317/7 [==============================] - ETA: 0s - loss: 0.00697/7 [==============================] - 0s 16ms/step - loss: 0.0069
1/7 [===>..........................] - ETA: 0s - loss: 0.00394/7 [================>.............] - ETA: 0s - loss: 0.00347/7 [==============================] - ETA: 0s - loss: 0.00307/7 [==============================] - 0s 15ms/step - loss: 0.0030
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.00470998752862215:
Train Score: 0.00455 MSE 0.06743 RMSE
Test Score: 0.00254 MSE 0.05035 RMSE
Deviation Min [0.00017751], Max [0.65783125]
Deviation 99.5th pctile [0.20804111]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,    4]))
Confusion matrix 
[[1390    3]
 [   0    4]]
precision 0.57143, recall 1.00000, f1 0.72727
Time to train: 440487 ms
Saving model models/A2Benchmark/synthetic_19.csv.h5
Total Time to proces all the selected files : 444779 ms
A2Benchmark : Avg precision 0.57143 recall 1.00000 f1 0.72727 time to train 440487.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_19.csv  --epochs 20 --n_iter 3 --patience 3 :: took 451 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_1.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 12:28:34 AM MST
2020-11-30 00:28:40.507688: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 00:28:40.526281: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 00:28:40.527211: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55bab8edc740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 00:28:40.527238: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 00:28:40.527361: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_1.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 7.6494e-043/7 [===========>..................] - ETA: 0s - loss: 0.0012    5/7 [====================>.........] - ETA: 0s - loss: 0.00117/7 [==============================] - ETA: 0s - loss: 9.5096e-047/7 [==============================] - 0s 30ms/step - loss: 9.5096e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.6021e-043/7 [===========>..................] - ETA: 0s - loss: 4.9736e-045/7 [====================>.........] - ETA: 0s - loss: 5.2738e-047/7 [==============================] - ETA: 0s - loss: 4.5456e-047/7 [==============================] - 0s 34ms/step - loss: 4.5456e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.6602e-043/7 [===========>..................] - ETA: 0s - loss: 2.2852e-045/7 [====================>.........] - ETA: 0s - loss: 0.0068    7/7 [==============================] - ETA: 0s - loss: 0.00557/7 [==============================] - 0s 33ms/step - loss: 0.0055
1/7 [===>..........................] - ETA: 0s - loss: 9.4224e-043/7 [===========>..................] - ETA: 0s - loss: 5.6109e-045/7 [====================>.........] - ETA: 0s - loss: 0.0066    7/7 [==============================] - ETA: 0s - loss: 0.00617/7 [==============================] - 0s 30ms/step - loss: 0.0061
1/7 [===>..........................] - ETA: 0s - loss: 0.00333/7 [===========>..................] - ETA: 0s - loss: 0.00125/7 [====================>.........] - ETA: 0s - loss: 7.5042e-047/7 [==============================] - ETA: 0s - loss: 6.3461e-047/7 [==============================] - 0s 23ms/step - loss: 6.3461e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.9939e-053/7 [===========>..................] - ETA: 0s - loss: 4.7521e-045/7 [====================>.........] - ETA: 0s - loss: 4.8840e-047/7 [==============================] - ETA: 0s - loss: 4.7910e-047/7 [==============================] - 0s 33ms/step - loss: 4.7910e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.4252e-043/7 [===========>..................] - ETA: 0s - loss: 6.5629e-045/7 [====================>.........] - ETA: 0s - loss: 5.5902e-046/7 [========================>.....] - ETA: 0s - loss: 4.8124e-047/7 [==============================] - 0s 36ms/step - loss: 4.6243e-04
1/7 [===>..........................] - ETA: 0s - loss: 8.3522e-053/7 [===========>..................] - ETA: 0s - loss: 3.4353e-045/7 [====================>.........] - ETA: 0s - loss: 0.0069    7/7 [==============================] - ETA: 0s - loss: 0.00567/7 [==============================] - 0s 32ms/step - loss: 0.0056
1/7 [===>..........................] - ETA: 0s - loss: 3.0074e-053/7 [===========>..................] - ETA: 0s - loss: 2.8714e-045/7 [====================>.........] - ETA: 0s - loss: 0.0061    7/7 [==============================] - ETA: 0s - loss: 0.00537/7 [==============================] - 0s 23ms/step - loss: 0.0053
1/7 [===>..........................] - ETA: 0s - loss: 7.8179e-043/7 [===========>..................] - ETA: 0s - loss: 3.2142e-045/7 [====================>.........] - ETA: 0s - loss: 2.5929e-047/7 [==============================] - ETA: 0s - loss: 2.6850e-047/7 [==============================] - 0s 27ms/step - loss: 2.6850e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00285/7 [====================>.........] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 12ms/step - loss: 0.0016
1/7 [===>..........................] - ETA: 0s - loss: 1.6059e-045/7 [====================>.........] - ETA: 0s - loss: 7.6077e-047/7 [==============================] - 0s 11ms/step - loss: 6.8141e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.1940e-045/7 [====================>.........] - ETA: 0s - loss: 0.0068    7/7 [==============================] - 0s 12ms/step - loss: 0.0064
1/7 [===>..........................] - ETA: 0s - loss: 2.1294e-046/7 [========================>.....] - ETA: 0s - loss: 0.0054    7/7 [==============================] - 0s 10ms/step - loss: 0.0053
1/7 [===>..........................] - ETA: 0s - loss: 0.00304/7 [================>.............] - ETA: 0s - loss: 0.00127/7 [==============================] - ETA: 0s - loss: 0.00127/7 [==============================] - 0s 15ms/step - loss: 0.0012
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.002406561461975798:
Train Score: 0.00220 MSE 0.04686 RMSE
Test Score: 0.00045 MSE 0.02131 RMSE
Deviation Min [5.83256336e-05], Max [0.66517191]
Deviation 99.5th pctile [0.12854991]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,    4]))
Confusion matrix 
[[1390    3]
 [   0    4]]
precision 0.57143, recall 1.00000, f1 0.72727
Time to train: 396177 ms
Saving model models/A2Benchmark/synthetic_1.csv.h5
Total Time to proces all the selected files : 399968 ms
A2Benchmark : Avg precision 0.57143 recall 1.00000 f1 0.72727 time to train 396177.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_1.csv  --epochs 20 --n_iter 3 --patience 3 :: took 406 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_20.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 12:35:25 AM MST
2020-11-30 00:35:31.577942: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 00:35:31.596286: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 00:35:31.597827: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55c78415e740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 00:35:31.597915: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 00:35:31.598119: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_20.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 9.5907e-043/7 [===========>..................] - ETA: 0s - loss: 0.0013    5/7 [====================>.........] - ETA: 0s - loss: 0.00127/7 [==============================] - ETA: 0s - loss: 0.00127/7 [==============================] - 0s 32ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 5.1793e-043/7 [===========>..................] - ETA: 0s - loss: 9.9208e-045/7 [====================>.........] - ETA: 0s - loss: 0.0011    7/7 [==============================] - ETA: 0s - loss: 0.00127/7 [==============================] - 0s 26ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 0.00133/7 [===========>..................] - ETA: 0s - loss: 0.00745/7 [====================>.........] - ETA: 0s - loss: 0.00947/7 [==============================] - ETA: 0s - loss: 0.00787/7 [==============================] - 0s 24ms/step - loss: 0.0078
1/7 [===>..........................] - ETA: 0s - loss: 0.00203/7 [===========>..................] - ETA: 0s - loss: 0.00185/7 [====================>.........] - ETA: 0s - loss: 0.00557/7 [==============================] - ETA: 0s - loss: 0.00537/7 [==============================] - 0s 35ms/step - loss: 0.0053
1/7 [===>..........................] - ETA: 0s - loss: 0.00373/7 [===========>..................] - ETA: 0s - loss: 0.00295/7 [====================>.........] - ETA: 0s - loss: 0.00327/7 [==============================] - ETA: 0s - loss: 0.00317/7 [==============================] - 0s 33ms/step - loss: 0.0031
1/7 [===>..........................] - ETA: 0s - loss: 0.00153/7 [===========>..................] - ETA: 0s - loss: 0.00175/7 [====================>.........] - ETA: 0s - loss: 0.00167/7 [==============================] - ETA: 0s - loss: 0.00157/7 [==============================] - 0s 26ms/step - loss: 0.0015
1/7 [===>..........................] - ETA: 0s - loss: 7.2699e-043/7 [===========>..................] - ETA: 0s - loss: 0.0012    5/7 [====================>.........] - ETA: 0s - loss: 0.00137/7 [==============================] - ETA: 0s - loss: 0.00137/7 [==============================] - 0s 30ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 7.8460e-043/7 [===========>..................] - ETA: 0s - loss: 0.0070    5/7 [====================>.........] - ETA: 0s - loss: 0.00867/7 [==============================] - ETA: 0s - loss: 0.00717/7 [==============================] - 0s 33ms/step - loss: 0.0071
1/7 [===>..........................] - ETA: 0s - loss: 7.4905e-043/7 [===========>..................] - ETA: 0s - loss: 9.3538e-045/7 [====================>.........] - ETA: 0s - loss: 0.0041    7/7 [==============================] - ETA: 0s - loss: 0.00387/7 [==============================] - 0s 28ms/step - loss: 0.0038
1/7 [===>..........................] - ETA: 0s - loss: 0.00463/7 [===========>..................] - ETA: 0s - loss: 0.00315/7 [====================>.........] - ETA: 0s - loss: 0.00387/7 [==============================] - ETA: 0s - loss: 0.00347/7 [==============================] - 0s 23ms/step - loss: 0.0034
1/7 [===>..........................] - ETA: 0s - loss: 0.00104/7 [================>.............] - ETA: 0s - loss: 0.00127/7 [==============================] - 0s 14ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 0.00105/7 [====================>.........] - ETA: 0s - loss: 0.00137/7 [==============================] - 0s 13ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 6.6846e-044/7 [================>.............] - ETA: 0s - loss: 0.0102    7/7 [==============================] - ETA: 0s - loss: 0.00747/7 [==============================] - 0s 15ms/step - loss: 0.0074
1/7 [===>..........................] - ETA: 0s - loss: 8.7016e-045/7 [====================>.........] - ETA: 0s - loss: 0.0039    7/7 [==============================] - 0s 12ms/step - loss: 0.0037
1/7 [===>..........................] - ETA: 0s - loss: 0.00465/7 [====================>.........] - ETA: 0s - loss: 0.00257/7 [==============================] - 0s 12ms/step - loss: 0.0022
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.0031366275623440744:
Train Score: 0.00248 MSE 0.04979 RMSE
Test Score: 0.00103 MSE 0.03208 RMSE
Deviation Min [6.75489345e-05], Max [0.45647386]
Deviation 99.5th pctile [0.28718313]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1388,    9]))
Confusion matrix 
[[1388    0]
 [   2    7]]
precision 1.00000, recall 0.77778, f1 0.87500
Time to train: 481890 ms
Saving model models/A2Benchmark/synthetic_20.csv.h5
Total Time to proces all the selected files : 483985 ms
A2Benchmark : Avg precision 1.00000 recall 0.77778 f1 0.87500 time to train 481890.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_20.csv  --epochs 20 --n_iter 3 --patience 3 :: took 491 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_21.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 12:43:41 AM MST
2020-11-30 00:43:46.932655: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 00:43:46.951278: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 00:43:46.952199: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x555e4a482740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 00:43:46.952227: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 00:43:46.952354: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_21.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 5.0401e-045/7 [====================>.........] - ETA: 0s - loss: 5.7442e-047/7 [==============================] - 0s 14ms/step - loss: 4.6560e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.2297e-044/7 [================>.............] - ETA: 0s - loss: 1.3044e-047/7 [==============================] - 0s 14ms/step - loss: 1.0731e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.1146e-045/7 [====================>.........] - ETA: 0s - loss: 2.7675e-047/7 [==============================] - 0s 14ms/step - loss: 2.4800e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.4713e-044/7 [================>.............] - ETA: 0s - loss: 1.6542e-047/7 [==============================] - ETA: 0s - loss: 0.0032    7/7 [==============================] - 0s 17ms/step - loss: 0.0032
1/7 [===>..........................] - ETA: 0s - loss: 5.2178e-044/7 [================>.............] - ETA: 0s - loss: 3.3686e-047/7 [==============================] - ETA: 0s - loss: 2.5392e-047/7 [==============================] - 0s 16ms/step - loss: 2.5392e-04
1/7 [===>..........................] - ETA: 0s - loss: 7.9808e-044/7 [================>.............] - ETA: 0s - loss: 0.0010    7/7 [==============================] - ETA: 0s - loss: 7.2198e-047/7 [==============================] - 0s 16ms/step - loss: 7.2198e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.7964e-045/7 [====================>.........] - ETA: 0s - loss: 2.8087e-047/7 [==============================] - 0s 13ms/step - loss: 2.4818e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.4100e-045/7 [====================>.........] - ETA: 0s - loss: 6.0557e-047/7 [==============================] - 0s 16ms/step - loss: 6.0094e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.0096e-044/7 [================>.............] - ETA: 0s - loss: 8.5938e-057/7 [==============================] - ETA: 0s - loss: 0.0030    7/7 [==============================] - 0s 16ms/step - loss: 0.0030
1/7 [===>..........................] - ETA: 0s - loss: 8.6873e-055/7 [====================>.........] - ETA: 0s - loss: 4.3433e-047/7 [==============================] - 0s 12ms/step - loss: 4.7747e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00153/7 [===========>..................] - ETA: 0s - loss: 0.00185/7 [====================>.........] - ETA: 0s - loss: 0.00167/7 [==============================] - ETA: 0s - loss: 0.00137/7 [==============================] - 0s 24ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 3.2837e-043/7 [===========>..................] - ETA: 0s - loss: 3.0712e-045/7 [====================>.........] - ETA: 0s - loss: 2.4827e-047/7 [==============================] - ETA: 0s - loss: 2.1339e-047/7 [==============================] - 0s 30ms/step - loss: 2.1339e-04
1/7 [===>..........................] - ETA: 0s - loss: 9.3066e-053/7 [===========>..................] - ETA: 0s - loss: 2.3696e-045/7 [====================>.........] - ETA: 0s - loss: 3.0963e-047/7 [==============================] - ETA: 0s - loss: 2.9442e-047/7 [==============================] - 0s 24ms/step - loss: 2.9442e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.8238e-043/7 [===========>..................] - ETA: 0s - loss: 1.6846e-045/7 [====================>.........] - ETA: 0s - loss: 0.0036    7/7 [==============================] - ETA: 0s - loss: 0.00297/7 [==============================] - 0s 25ms/step - loss: 0.0029
1/7 [===>..........................] - ETA: 0s - loss: 1.3624e-043/7 [===========>..................] - ETA: 0s - loss: 2.1180e-045/7 [====================>.........] - ETA: 0s - loss: 3.7198e-047/7 [==============================] - ETA: 0s - loss: 4.4779e-047/7 [==============================] - 0s 29ms/step - loss: 4.4779e-04
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0008461492572678253:
Train Score: 0.00075 MSE 0.02735 RMSE
Test Score: 0.00206 MSE 0.04538 RMSE
Deviation Min [2.06323308e-05], Max [0.74157068]
Deviation 99.5th pctile [0.07659911]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,    1]))
Confusion matrix 
[[1390    6]
 [   0    1]]
precision 0.14286, recall 1.00000, f1 0.25000
Time to train: 231753 ms
Saving model models/A2Benchmark/synthetic_21.csv.h5
Total Time to proces all the selected files : 234088 ms
A2Benchmark : Avg precision 0.14286 recall 1.00000 f1 0.25000 time to train 231753.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_21.csv  --epochs 20 --n_iter 3 --patience 3 :: took 240 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_22.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 12:47:46 AM MST
2020-11-30 00:47:52.450877: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 00:47:52.472212: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 00:47:52.473060: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55bb104c6740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 00:47:52.473108: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 00:47:52.473296: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_22.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00623/7 [===========>..................] - ETA: 0s - loss: 0.00525/7 [====================>.........] - ETA: 0s - loss: 0.00677/7 [==============================] - ETA: 0s - loss: 0.00587/7 [==============================] - 0s 27ms/step - loss: 0.0058
1/7 [===>..........................] - ETA: 0s - loss: 0.00393/7 [===========>..................] - ETA: 0s - loss: 0.00455/7 [====================>.........] - ETA: 0s - loss: 0.00627/7 [==============================] - ETA: 0s - loss: 0.00657/7 [==============================] - 0s 34ms/step - loss: 0.0065
1/7 [===>..........................] - ETA: 0s - loss: 0.00253/7 [===========>..................] - ETA: 0s - loss: 0.00285/7 [====================>.........] - ETA: 0s - loss: 0.00497/7 [==============================] - ETA: 0s - loss: 0.00457/7 [==============================] - 0s 31ms/step - loss: 0.0045
1/7 [===>..........................] - ETA: 0s - loss: 0.00273/7 [===========>..................] - ETA: 0s - loss: 0.00375/7 [====================>.........] - ETA: 0s - loss: 0.00507/7 [==============================] - ETA: 0s - loss: 0.00487/7 [==============================] - 0s 29ms/step - loss: 0.0048
1/7 [===>..........................] - ETA: 0s - loss: 0.00843/7 [===========>..................] - ETA: 0s - loss: 0.00575/7 [====================>.........] - ETA: 0s - loss: 0.00517/7 [==============================] - ETA: 0s - loss: 0.00477/7 [==============================] - 0s 30ms/step - loss: 0.0047
1/7 [===>..........................] - ETA: 0s - loss: 0.01164/7 [================>.............] - ETA: 0s - loss: 0.00887/7 [==============================] - 0s 15ms/step - loss: 0.0074
1/7 [===>..........................] - ETA: 0s - loss: 0.00216/7 [========================>.....] - ETA: 0s - loss: 0.00437/7 [==============================] - 0s 12ms/step - loss: 0.0044
1/7 [===>..........................] - ETA: 0s - loss: 0.00254/7 [================>.............] - ETA: 0s - loss: 0.00517/7 [==============================] - 0s 14ms/step - loss: 0.0046
1/7 [===>..........................] - ETA: 0s - loss: 0.00395/7 [====================>.........] - ETA: 0s - loss: 0.00537/7 [==============================] - 0s 12ms/step - loss: 0.0051
1/7 [===>..........................] - ETA: 0s - loss: 0.00555/7 [====================>.........] - ETA: 0s - loss: 0.00427/7 [==============================] - 0s 13ms/step - loss: 0.0040
1/7 [===>..........................] - ETA: 0s - loss: 0.00545/7 [====================>.........] - ETA: 0s - loss: 0.00567/7 [==============================] - 0s 14ms/step - loss: 0.0050
1/7 [===>..........................] - ETA: 0s - loss: 0.00235/7 [====================>.........] - ETA: 0s - loss: 0.00407/7 [==============================] - 0s 13ms/step - loss: 0.0040
1/7 [===>..........................] - ETA: 0s - loss: 0.00276/7 [========================>.....] - ETA: 0s - loss: 0.00497/7 [==============================] - 0s 11ms/step - loss: 0.0049
1/7 [===>..........................] - ETA: 0s - loss: 0.00375/7 [====================>.........] - ETA: 0s - loss: 0.00547/7 [==============================] - 0s 13ms/step - loss: 0.0052
1/7 [===>..........................] - ETA: 0s - loss: 0.00705/7 [====================>.........] - ETA: 0s - loss: 0.00447/7 [==============================] - 0s 13ms/step - loss: 0.0041
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.004631720297038555:
Train Score: 0.00402 MSE 0.06343 RMSE
Test Score: 0.00341 MSE 0.05841 RMSE
Deviation Min [2.91517826e-05], Max [0.37943453]
Deviation 99.5th pctile [0.16084521]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,    4]))
Confusion matrix 
[[1390    3]
 [   0    4]]
precision 0.57143, recall 1.00000, f1 0.72727
Time to train: 341362 ms
Saving model models/A2Benchmark/synthetic_22.csv.h5
Total Time to proces all the selected files : 343644 ms
A2Benchmark : Avg precision 0.57143 recall 1.00000 f1 0.72727 time to train 341362.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_22.csv  --epochs 20 --n_iter 3 --patience 3 :: took 350 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_23.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 12:53:41 AM MST
2020-11-30 00:53:47.378301: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 00:53:47.397230: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 00:53:47.398447: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55a5a0b26740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 00:53:47.398498: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 00:53:47.398698: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_23.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 7.5961e-046/7 [========================>.....] - ETA: 0s - loss: 3.5268e-047/7 [==============================] - 0s 9ms/step - loss: 3.4920e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.1205e-045/7 [====================>.........] - ETA: 0s - loss: 2.9805e-047/7 [==============================] - 0s 14ms/step - loss: 2.9697e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.4411e-045/7 [====================>.........] - ETA: 0s - loss: 0.0186    7/7 [==============================] - 0s 12ms/step - loss: 0.0148
1/7 [===>..........................] - ETA: 0s - loss: 8.1510e-044/7 [================>.............] - ETA: 0s - loss: 4.5216e-047/7 [==============================] - ETA: 0s - loss: 0.0072    7/7 [==============================] - 0s 17ms/step - loss: 0.0072
1/7 [===>..........................] - ETA: 0s - loss: 6.4256e-046/7 [========================>.....] - ETA: 0s - loss: 3.1115e-047/7 [==============================] - 0s 12ms/step - loss: 3.3565e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00183/7 [===========>..................] - ETA: 0s - loss: 8.2993e-045/7 [====================>.........] - ETA: 0s - loss: 6.4018e-047/7 [==============================] - ETA: 0s - loss: 6.5579e-047/7 [==============================] - 0s 32ms/step - loss: 6.5579e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.6613e-043/7 [===========>..................] - ETA: 0s - loss: 6.6783e-045/7 [====================>.........] - ETA: 0s - loss: 4.9346e-047/7 [==============================] - ETA: 0s - loss: 4.2795e-047/7 [==============================] - 0s 27ms/step - loss: 4.2795e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.1357e-043/7 [===========>..................] - ETA: 0s - loss: 0.0162    5/7 [====================>.........] - ETA: 0s - loss: 0.01986/7 [========================>.....] - ETA: 0s - loss: 0.01667/7 [==============================] - 0s 35ms/step - loss: 0.0158
1/7 [===>..........................] - ETA: 0s - loss: 1.5145e-043/7 [===========>..................] - ETA: 0s - loss: 6.7044e-045/7 [====================>.........] - ETA: 0s - loss: 0.0092    7/7 [==============================] - ETA: 0s - loss: 0.00817/7 [==============================] - 0s 31ms/step - loss: 0.0081
1/7 [===>..........................] - ETA: 0s - loss: 7.9684e-043/7 [===========>..................] - ETA: 0s - loss: 5.5517e-045/7 [====================>.........] - ETA: 0s - loss: 4.1941e-047/7 [==============================] - ETA: 0s - loss: 4.6651e-047/7 [==============================] - 0s 25ms/step - loss: 4.6651e-04
1/7 [===>..........................] - ETA: 0s - loss: 8.8078e-045/7 [====================>.........] - ETA: 0s - loss: 4.0791e-047/7 [==============================] - 0s 12ms/step - loss: 4.5339e-04
1/7 [===>..........................] - ETA: 0s - loss: 9.7056e-056/7 [========================>.....] - ETA: 0s - loss: 2.8732e-047/7 [==============================] - 0s 10ms/step - loss: 2.8718e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.2879e-044/7 [================>.............] - ETA: 0s - loss: 0.0227    7/7 [==============================] - ETA: 0s - loss: 0.01477/7 [==============================] - 0s 15ms/step - loss: 0.0147
1/7 [===>..........................] - ETA: 0s - loss: 0.00165/7 [====================>.........] - ETA: 0s - loss: 0.00917/7 [==============================] - 0s 12ms/step - loss: 0.0076
1/7 [===>..........................] - ETA: 0s - loss: 0.00184/7 [================>.............] - ETA: 0s - loss: 0.00127/7 [==============================] - ETA: 0s - loss: 0.00127/7 [==============================] - 0s 16ms/step - loss: 0.0012
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.00460129373241216:
Train Score: 0.00387 MSE 0.06224 RMSE
Test Score: 0.00114 MSE 0.03376 RMSE
Deviation Min [1.50891748e-06], Max [0.70777699]
Deviation 99.5th pctile [0.56721515]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1388,    9]))
Confusion matrix 
[[1388    0]
 [   2    7]]
precision 1.00000, recall 0.77778, f1 0.87500
Time to train: 288980 ms
Saving model models/A2Benchmark/synthetic_23.csv.h5
Total Time to proces all the selected files : 291155 ms
A2Benchmark : Avg precision 1.00000 recall 0.77778 f1 0.87500 time to train 288980.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_23.csv  --epochs 20 --n_iter 3 --patience 3 :: took 297 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_24.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 12:58:43 AM MST
2020-11-30 00:58:49.497100: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 00:58:49.516252: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 00:58:49.517816: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55ead6f40740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 00:58:49.517874: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 00:58:49.518095: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_24.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00473/7 [===========>..................] - ETA: 0s - loss: 0.00385/7 [====================>.........] - ETA: 0s - loss: 0.00367/7 [==============================] - ETA: 0s - loss: 0.00357/7 [==============================] - 0s 33ms/step - loss: 0.0035
1/7 [===>..........................] - ETA: 0s - loss: 0.00533/7 [===========>..................] - ETA: 0s - loss: 0.00415/7 [====================>.........] - ETA: 0s - loss: 0.00477/7 [==============================] - ETA: 0s - loss: 0.00447/7 [==============================] - 0s 32ms/step - loss: 0.0044
1/7 [===>..........................] - ETA: 0s - loss: 0.00223/7 [===========>..................] - ETA: 0s - loss: 0.00355/7 [====================>.........] - ETA: 0s - loss: 0.00377/7 [==============================] - ETA: 0s - loss: 0.00387/7 [==============================] - 0s 32ms/step - loss: 0.0038
1/7 [===>..........................] - ETA: 0s - loss: 0.00463/7 [===========>..................] - ETA: 0s - loss: 0.00405/7 [====================>.........] - ETA: 0s - loss: 0.00437/7 [==============================] - ETA: 0s - loss: 0.00427/7 [==============================] - 0s 30ms/step - loss: 0.0042
1/7 [===>..........................] - ETA: 0s - loss: 0.00513/7 [===========>..................] - ETA: 0s - loss: 0.00395/7 [====================>.........] - ETA: 0s - loss: 0.00377/7 [==============================] - ETA: 0s - loss: 0.00367/7 [==============================] - 0s 26ms/step - loss: 0.0036
1/7 [===>..........................] - ETA: 0s - loss: 0.00514/7 [================>.............] - ETA: 0s - loss: 0.00397/7 [==============================] - ETA: 0s - loss: 0.00387/7 [==============================] - 0s 16ms/step - loss: 0.0038
1/7 [===>..........................] - ETA: 0s - loss: 0.00425/7 [====================>.........] - ETA: 0s - loss: 0.00467/7 [==============================] - 0s 15ms/step - loss: 0.0043
1/7 [===>..........................] - ETA: 0s - loss: 0.00244/7 [================>.............] - ETA: 0s - loss: 0.00377/7 [==============================] - ETA: 0s - loss: 0.00387/7 [==============================] - 0s 16ms/step - loss: 0.0038
1/7 [===>..........................] - ETA: 0s - loss: 0.00485/7 [====================>.........] - ETA: 0s - loss: 0.00507/7 [==============================] - 0s 11ms/step - loss: 0.0047
1/7 [===>..........................] - ETA: 0s - loss: 0.00705/7 [====================>.........] - ETA: 0s - loss: 0.00457/7 [==============================] - 0s 13ms/step - loss: 0.0045
1/7 [===>..........................] - ETA: 0s - loss: 0.00523/7 [===========>..................] - ETA: 0s - loss: 0.00395/7 [====================>.........] - ETA: 0s - loss: 0.00417/7 [==============================] - ETA: 0s - loss: 0.00397/7 [==============================] - 0s 30ms/step - loss: 0.0039
1/7 [===>..........................] - ETA: 0s - loss: 0.00563/7 [===========>..................] - ETA: 0s - loss: 0.00445/7 [====================>.........] - ETA: 0s - loss: 0.00507/7 [==============================] - ETA: 0s - loss: 0.00487/7 [==============================] - 0s 25ms/step - loss: 0.0048
1/7 [===>..........................] - ETA: 0s - loss: 0.00223/7 [===========>..................] - ETA: 0s - loss: 0.00355/7 [====================>.........] - ETA: 0s - loss: 0.00387/7 [==============================] - ETA: 0s - loss: 0.00387/7 [==============================] - 0s 25ms/step - loss: 0.0038
1/7 [===>..........................] - ETA: 0s - loss: 0.00463/7 [===========>..................] - ETA: 0s - loss: 0.00415/7 [====================>.........] - ETA: 0s - loss: 0.00437/7 [==============================] - ETA: 0s - loss: 0.00427/7 [==============================] - 0s 25ms/step - loss: 0.0042
1/7 [===>..........................] - ETA: 0s - loss: 0.00643/7 [===========>..................] - ETA: 0s - loss: 0.00505/7 [====================>.........] - ETA: 0s - loss: 0.00457/7 [==============================] - ETA: 0s - loss: 0.00447/7 [==============================] - 0s 26ms/step - loss: 0.0044
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.0038799814879894256:
Train Score: 0.00374 MSE 0.06116 RMSE
Test Score: 0.00339 MSE 0.05824 RMSE
Deviation Min [0.00031473], Max [0.21851674]
Deviation 99.5th pctile [0.16611042]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,    1]))
Confusion matrix 
[[1390    6]
 [   0    1]]
precision 0.14286, recall 1.00000, f1 0.25000
Time to train: 468494 ms
Saving model models/A2Benchmark/synthetic_24.csv.h5
Total Time to proces all the selected files : 472697 ms
A2Benchmark : Avg precision 0.14286 recall 1.00000 f1 0.25000 time to train 468494.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_24.csv  --epochs 20 --n_iter 3 --patience 3 :: took 479 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_25.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 01:06:47 AM MST
2020-11-30 01:06:54.372819: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 01:06:54.391249: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 01:06:54.392686: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x558b1c1bd440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 01:06:54.392741: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 01:06:54.392948: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_25.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00103/7 [===========>..................] - ETA: 0s - loss: 9.2398e-045/7 [====================>.........] - ETA: 0s - loss: 9.3697e-047/7 [==============================] - ETA: 0s - loss: 8.4288e-047/7 [==============================] - 0s 27ms/step - loss: 8.4288e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.8115e-043/7 [===========>..................] - ETA: 0s - loss: 0.0015    5/7 [====================>.........] - ETA: 0s - loss: 0.00137/7 [==============================] - ETA: 0s - loss: 0.00127/7 [==============================] - 0s 33ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 0.00123/7 [===========>..................] - ETA: 0s - loss: 0.00125/7 [====================>.........] - ETA: 0s - loss: 0.00797/7 [==============================] - ETA: 0s - loss: 0.00657/7 [==============================] - 0s 30ms/step - loss: 0.0065
1/7 [===>..........................] - ETA: 0s - loss: 4.9906e-042/7 [=======>......................] - ETA: 0s - loss: 5.3583e-043/7 [===========>..................] - ETA: 0s - loss: 8.5952e-045/7 [====================>.........] - ETA: 0s - loss: 0.0068    7/7 [==============================] - ETA: 0s - loss: 0.00587/7 [==============================] - 0s 40ms/step - loss: 0.0058
1/7 [===>..........................] - ETA: 0s - loss: 0.00442/7 [=======>......................] - ETA: 0s - loss: 0.00304/7 [================>.............] - ETA: 0s - loss: 0.00196/7 [========================>.....] - ETA: 0s - loss: 0.00237/7 [==============================] - 0s 34ms/step - loss: 0.0022
1/7 [===>..........................] - ETA: 0s - loss: 8.6619e-045/7 [====================>.........] - ETA: 0s - loss: 7.7631e-047/7 [==============================] - 0s 14ms/step - loss: 7.0094e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00115/7 [====================>.........] - ETA: 0s - loss: 8.0047e-047/7 [==============================] - 0s 16ms/step - loss: 7.3561e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00294/7 [================>.............] - ETA: 0s - loss: 0.00987/7 [==============================] - ETA: 0s - loss: 0.00707/7 [==============================] - 0s 18ms/step - loss: 0.0070
1/7 [===>..........................] - ETA: 0s - loss: 6.0370e-044/7 [================>.............] - ETA: 0s - loss: 7.1394e-047/7 [==============================] - ETA: 0s - loss: 0.0056    7/7 [==============================] - 0s 18ms/step - loss: 0.0056
1/7 [===>..........................] - ETA: 0s - loss: 0.00335/7 [====================>.........] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 14ms/step - loss: 0.0018
1/7 [===>..........................] - ETA: 0s - loss: 4.8963e-044/7 [================>.............] - ETA: 0s - loss: 0.0011    7/7 [==============================] - 0s 15ms/step - loss: 8.9662e-04
1/7 [===>..........................] - ETA: 0s - loss: 9.9082e-045/7 [====================>.........] - ETA: 0s - loss: 7.3831e-047/7 [==============================] - 0s 12ms/step - loss: 6.8232e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00236/7 [========================>.....] - ETA: 0s - loss: 0.00677/7 [==============================] - 0s 10ms/step - loss: 0.0064
1/7 [===>..........................] - ETA: 0s - loss: 4.3519e-044/7 [================>.............] - ETA: 0s - loss: 9.0046e-047/7 [==============================] - ETA: 0s - loss: 0.0058    7/7 [==============================] - 0s 15ms/step - loss: 0.0058
1/7 [===>..........................] - ETA: 0s - loss: 0.00174/7 [================>.............] - ETA: 0s - loss: 8.5987e-047/7 [==============================] - ETA: 0s - loss: 9.1198e-047/7 [==============================] - 0s 16ms/step - loss: 9.1198e-04
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.002928359049838036:
Train Score: 0.00241 MSE 0.04911 RMSE
Test Score: 0.00075 MSE 0.02748 RMSE
Deviation Min [2.1413929e-05], Max [0.74472149]
Deviation 99.5th pctile [0.10681816]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,    4]))
Confusion matrix 
[[1390    3]
 [   0    4]]
precision 0.57143, recall 1.00000, f1 0.72727
Time to train: 299432 ms
Saving model models/A2Benchmark/synthetic_25.csv.h5
Total Time to proces all the selected files : 301504 ms
A2Benchmark : Avg precision 0.57143 recall 1.00000 f1 0.72727 time to train 299432.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_25.csv  --epochs 20 --n_iter 3 --patience 3 :: took 309 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_26.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 01:12:01 AM MST
2020-11-30 01:12:07.101317: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 01:12:07.120074: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 01:12:07.121148: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55a9586f1740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 01:12:07.121176: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 01:12:07.121307: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_26.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00263/7 [===========>..................] - ETA: 0s - loss: 0.00315/7 [====================>.........] - ETA: 0s - loss: 0.00327/7 [==============================] - ETA: 0s - loss: 0.00317/7 [==============================] - 0s 25ms/step - loss: 0.0031
1/7 [===>..........................] - ETA: 0s - loss: 0.00203/7 [===========>..................] - ETA: 0s - loss: 0.00355/7 [====================>.........] - ETA: 0s - loss: 0.00387/7 [==============================] - ETA: 0s - loss: 0.00377/7 [==============================] - 0s 32ms/step - loss: 0.0037
1/7 [===>..........................] - ETA: 0s - loss: 0.00203/7 [===========>..................] - ETA: 0s - loss: 0.00785/7 [====================>.........] - ETA: 0s - loss: 0.00907/7 [==============================] - ETA: 0s - loss: 0.00797/7 [==============================] - 0s 33ms/step - loss: 0.0079
1/7 [===>..........................] - ETA: 0s - loss: 0.00213/7 [===========>..................] - ETA: 0s - loss: 0.00325/7 [====================>.........] - ETA: 0s - loss: 0.00497/7 [==============================] - ETA: 0s - loss: 0.00497/7 [==============================] - 0s 27ms/step - loss: 0.0049
1/7 [===>..........................] - ETA: 0s - loss: 0.00653/7 [===========>..................] - ETA: 0s - loss: 0.00515/7 [====================>.........] - ETA: 0s - loss: 0.00507/7 [==============================] - ETA: 0s - loss: 0.00487/7 [==============================] - 0s 27ms/step - loss: 0.0048
1/7 [===>..........................] - ETA: 0s - loss: 0.00273/7 [===========>..................] - ETA: 0s - loss: 0.00315/7 [====================>.........] - ETA: 0s - loss: 0.00337/7 [==============================] - ETA: 0s - loss: 0.00327/7 [==============================] - 0s 23ms/step - loss: 0.0032
1/7 [===>..........................] - ETA: 0s - loss: 0.00273/7 [===========>..................] - ETA: 0s - loss: 0.00385/7 [====================>.........] - ETA: 0s - loss: 0.00417/7 [==============================] - ETA: 0s - loss: 0.00407/7 [==============================] - 0s 23ms/step - loss: 0.0040
1/7 [===>..........................] - ETA: 0s - loss: 0.00192/7 [=======>......................] - ETA: 0s - loss: 0.00254/7 [================>.............] - ETA: 0s - loss: 0.01056/7 [========================>.....] - ETA: 0s - loss: 0.00817/7 [==============================] - 0s 40ms/step - loss: 0.0078
1/7 [===>..........................] - ETA: 0s - loss: 0.00243/7 [===========>..................] - ETA: 0s - loss: 0.00355/7 [====================>.........] - ETA: 0s - loss: 0.00546/7 [========================>.....] - ETA: 0s - loss: 0.00547/7 [==============================] - 0s 37ms/step - loss: 0.0052
1/7 [===>..........................] - ETA: 0s - loss: 0.00583/7 [===========>..................] - ETA: 0s - loss: 0.00525/7 [====================>.........] - ETA: 0s - loss: 0.00497/7 [==============================] - ETA: 0s - loss: 0.00497/7 [==============================] - 0s 29ms/step - loss: 0.0049
1/7 [===>..........................] - ETA: 0s - loss: 0.00454/7 [================>.............] - ETA: 0s - loss: 0.00447/7 [==============================] - 0s 15ms/step - loss: 0.0041
1/7 [===>..........................] - ETA: 0s - loss: 0.00234/7 [================>.............] - ETA: 0s - loss: 0.00397/7 [==============================] - 0s 14ms/step - loss: 0.0037
1/7 [===>..........................] - ETA: 0s - loss: 0.00184/7 [================>.............] - ETA: 0s - loss: 0.01027/7 [==============================] - 0s 14ms/step - loss: 0.0076
1/7 [===>..........................] - ETA: 0s - loss: 0.00364/7 [================>.............] - ETA: 0s - loss: 0.00447/7 [==============================] - ETA: 0s - loss: 0.00567/7 [==============================] - 0s 18ms/step - loss: 0.0056
1/7 [===>..........................] - ETA: 0s - loss: 0.00594/7 [================>.............] - ETA: 0s - loss: 0.00507/7 [==============================] - ETA: 0s - loss: 0.00477/7 [==============================] - 0s 17ms/step - loss: 0.0047
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.004879754688590765:
Train Score: 0.00464 MSE 0.06810 RMSE
Test Score: 0.00437 MSE 0.06612 RMSE
Deviation Min [9.44333764e-05], Max [0.37856317]
Deviation 99.5th pctile [0.30229637]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1388,    9]))
Confusion matrix 
[[1388    0]
 [   2    7]]
precision 1.00000, recall 0.77778, f1 0.87500
Time to train: 447285 ms
Saving model models/A2Benchmark/synthetic_26.csv.h5
Total Time to proces all the selected files : 451520 ms
A2Benchmark : Avg precision 1.00000 recall 0.77778 f1 0.87500 time to train 447285.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_26.csv  --epochs 20 --n_iter 3 --patience 3 :: took 457 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_27.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 01:19:44 AM MST
2020-11-30 01:19:49.617003: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 01:19:49.636210: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 01:19:49.637537: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55da895e5740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 01:19:49.637581: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 01:19:49.637761: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_27.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00103/7 [===========>..................] - ETA: 0s - loss: 0.00135/7 [====================>.........] - ETA: 0s - loss: 0.00137/7 [==============================] - ETA: 0s - loss: 0.00127/7 [==============================] - 0s 27ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 7.1404e-043/7 [===========>..................] - ETA: 0s - loss: 8.4788e-045/7 [====================>.........] - ETA: 0s - loss: 9.2816e-047/7 [==============================] - ETA: 0s - loss: 0.0010    7/7 [==============================] - 0s 30ms/step - loss: 0.0010
1/7 [===>..........................] - ETA: 0s - loss: 5.1990e-043/7 [===========>..................] - ETA: 0s - loss: 6.7530e-045/7 [====================>.........] - ETA: 0s - loss: 7.3503e-047/7 [==============================] - ETA: 0s - loss: 7.9546e-047/7 [==============================] - 0s 39ms/step - loss: 7.9546e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00183/7 [===========>..................] - ETA: 0s - loss: 0.00115/7 [====================>.........] - ETA: 0s - loss: 0.00397/7 [==============================] - ETA: 0s - loss: 0.00347/7 [==============================] - 0s 27ms/step - loss: 0.0034
1/7 [===>..........................] - ETA: 0s - loss: 0.00233/7 [===========>..................] - ETA: 0s - loss: 0.00165/7 [====================>.........] - ETA: 0s - loss: 0.00177/7 [==============================] - ETA: 0s - loss: 0.00177/7 [==============================] - 0s 36ms/step - loss: 0.0017
1/7 [===>..........................] - ETA: 0s - loss: 0.00143/7 [===========>..................] - ETA: 0s - loss: 0.00195/7 [====================>.........] - ETA: 0s - loss: 0.00197/7 [==============================] - 0s 23ms/step - loss: 0.0017
1/7 [===>..........................] - ETA: 0s - loss: 7.6016e-043/7 [===========>..................] - ETA: 0s - loss: 0.0010    5/7 [====================>.........] - ETA: 0s - loss: 0.00117/7 [==============================] - 0s 23ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 8.4122e-043/7 [===========>..................] - ETA: 0s - loss: 0.0013    5/7 [====================>.........] - ETA: 0s - loss: 0.00147/7 [==============================] - 0s 26ms/step - loss: 0.0014
1/7 [===>..........................] - ETA: 0s - loss: 7.0653e-043/7 [===========>..................] - ETA: 0s - loss: 6.5842e-045/7 [====================>.........] - ETA: 0s - loss: 0.0034    7/7 [==============================] - ETA: 0s - loss: 0.00307/7 [==============================] - 0s 32ms/step - loss: 0.0030
1/7 [===>..........................] - ETA: 0s - loss: 0.00273/7 [===========>..................] - ETA: 0s - loss: 0.00135/7 [====================>.........] - ETA: 0s - loss: 0.00157/7 [==============================] - ETA: 0s - loss: 0.00137/7 [==============================] - 0s 25ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 7.6828e-045/7 [====================>.........] - ETA: 0s - loss: 6.8793e-047/7 [==============================] - 0s 14ms/step - loss: 6.3084e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.9567e-045/7 [====================>.........] - ETA: 0s - loss: 6.8349e-047/7 [==============================] - 0s 11ms/step - loss: 6.8952e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.1635e-045/7 [====================>.........] - ETA: 0s - loss: 8.4435e-047/7 [==============================] - 0s 12ms/step - loss: 8.5443e-04
1/7 [===>..........................] - ETA: 0s - loss: 9.7060e-045/7 [====================>.........] - ETA: 0s - loss: 0.0035    7/7 [==============================] - 0s 14ms/step - loss: 0.0030
1/7 [===>..........................] - ETA: 0s - loss: 0.00214/7 [================>.............] - ETA: 0s - loss: 0.00127/7 [==============================] - 0s 20ms/step - loss: 0.0010
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.001243300677742809:
Train Score: 0.00133 MSE 0.03651 RMSE
Test Score: 0.00109 MSE 0.03309 RMSE
Deviation Min [1.02038507e-05], Max [0.61536106]
Deviation 99.5th pctile [0.08332844]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,    1]))
Confusion matrix 
[[1390    6]
 [   0    1]]
precision 0.14286, recall 1.00000, f1 0.25000
Time to train: 444527 ms
Saving model models/A2Benchmark/synthetic_27.csv.h5
Total Time to proces all the selected files : 446735 ms
A2Benchmark : Avg precision 0.14286 recall 1.00000 f1 0.25000 time to train 444527.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_27.csv  --epochs 20 --n_iter 3 --patience 3 :: took 452 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_28.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 01:27:21 AM MST
2020-11-30 01:27:27.755644: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 01:27:27.774214: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 01:27:27.775760: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55bbc6f53740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 01:27:27.775807: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 01:27:27.776034: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_28.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00263/7 [===========>..................] - ETA: 0s - loss: 0.00325/7 [====================>.........] - ETA: 0s - loss: 0.00267/7 [==============================] - ETA: 0s - loss: 0.00217/7 [==============================] - 0s 26ms/step - loss: 0.0021
1/7 [===>..........................] - ETA: 0s - loss: 4.1801e-043/7 [===========>..................] - ETA: 0s - loss: 4.1733e-045/7 [====================>.........] - ETA: 0s - loss: 3.3963e-047/7 [==============================] - ETA: 0s - loss: 3.0783e-047/7 [==============================] - 0s 33ms/step - loss: 3.0783e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.6701e-043/7 [===========>..................] - ETA: 0s - loss: 0.0010    5/7 [====================>.........] - ETA: 0s - loss: 0.00627/7 [==============================] - ETA: 0s - loss: 0.00517/7 [==============================] - 0s 28ms/step - loss: 0.0051
1/7 [===>..........................] - ETA: 0s - loss: 1.1817e-042/7 [=======>......................] - ETA: 0s - loss: 1.6275e-044/7 [================>.............] - ETA: 0s - loss: 1.7441e-046/7 [========================>.....] - ETA: 0s - loss: 0.0040    7/7 [==============================] - 0s 33ms/step - loss: 0.0038
1/7 [===>..........................] - ETA: 0s - loss: 7.3213e-043/7 [===========>..................] - ETA: 0s - loss: 0.0020    5/7 [====================>.........] - ETA: 0s - loss: 0.00347/7 [==============================] - ETA: 0s - loss: 0.00377/7 [==============================] - 0s 27ms/step - loss: 0.0037
1/7 [===>..........................] - ETA: 0s - loss: 0.00223/7 [===========>..................] - ETA: 0s - loss: 0.00285/7 [====================>.........] - ETA: 0s - loss: 0.00237/7 [==============================] - ETA: 0s - loss: 0.00197/7 [==============================] - 0s 25ms/step - loss: 0.0019
1/7 [===>..........................] - ETA: 0s - loss: 4.7401e-043/7 [===========>..................] - ETA: 0s - loss: 3.7946e-045/7 [====================>.........] - ETA: 0s - loss: 3.0342e-047/7 [==============================] - ETA: 0s - loss: 2.7564e-047/7 [==============================] - 0s 28ms/step - loss: 2.7564e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.3047e-043/7 [===========>..................] - ETA: 0s - loss: 3.1539e-045/7 [====================>.........] - ETA: 0s - loss: 0.0052    7/7 [==============================] - ETA: 0s - loss: 0.00427/7 [==============================] - 0s 25ms/step - loss: 0.0042
1/7 [===>..........................] - ETA: 0s - loss: 1.3694e-043/7 [===========>..................] - ETA: 0s - loss: 1.6069e-045/7 [====================>.........] - ETA: 0s - loss: 0.0046    7/7 [==============================] - ETA: 0s - loss: 0.00387/7 [==============================] - 0s 29ms/step - loss: 0.0038
1/7 [===>..........................] - ETA: 0s - loss: 6.7014e-043/7 [===========>..................] - ETA: 0s - loss: 4.1394e-045/7 [====================>.........] - ETA: 0s - loss: 3.2240e-047/7 [==============================] - ETA: 0s - loss: 2.8990e-047/7 [==============================] - 0s 25ms/step - loss: 2.8990e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00235/7 [====================>.........] - ETA: 0s - loss: 0.00247/7 [==============================] - 0s 13ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 2.6555e-045/7 [====================>.........] - ETA: 0s - loss: 2.5915e-047/7 [==============================] - 0s 13ms/step - loss: 2.4303e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.3482e-045/7 [====================>.........] - ETA: 0s - loss: 0.0053    7/7 [==============================] - 0s 13ms/step - loss: 0.0043
1/7 [===>..........................] - ETA: 0s - loss: 1.1209e-045/7 [====================>.........] - ETA: 0s - loss: 0.0043    7/7 [==============================] - 0s 13ms/step - loss: 0.0036
1/7 [===>..........................] - ETA: 0s - loss: 4.2832e-045/7 [====================>.........] - ETA: 0s - loss: 3.9721e-047/7 [==============================] - 0s 13ms/step - loss: 3.9755e-04
Best parameters {'n_units': 72, 'n_hidden': 2} best score 0.002084374736296013:
Train Score: 0.00168 MSE 0.04105 RMSE
Test Score: 0.00287 MSE 0.05356 RMSE
Deviation Min [0.00010438], Max [0.62085364]
Deviation 99.5th pctile [0.10718824]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,    4]))
Confusion matrix 
[[1390    3]
 [   0    4]]
precision 0.57143, recall 1.00000, f1 0.72727
Time to train: 346244 ms
Saving model models/A2Benchmark/synthetic_28.csv.h5
Total Time to proces all the selected files : 350103 ms
A2Benchmark : Avg precision 0.57143 recall 1.00000 f1 0.72727 time to train 346244.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_28.csv  --epochs 20 --n_iter 3 --patience 3 :: took 357 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_29.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 01:33:23 AM MST
2020-11-30 01:33:29.202771: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 01:33:29.221258: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 01:33:29.222776: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5595541c1740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 01:33:29.222827: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 01:33:29.223050: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_29.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00615/7 [====================>.........] - ETA: 0s - loss: 0.00547/7 [==============================] - 0s 12ms/step - loss: 0.0049
1/7 [===>..........................] - ETA: 0s - loss: 0.00445/7 [====================>.........] - ETA: 0s - loss: 0.00597/7 [==============================] - 0s 12ms/step - loss: 0.0059
1/7 [===>..........................] - ETA: 0s - loss: 0.00286/7 [========================>.....] - ETA: 0s - loss: 0.02097/7 [==============================] - 0s 10ms/step - loss: 0.0202
1/7 [===>..........................] - ETA: 0s - loss: 0.00395/7 [====================>.........] - ETA: 0s - loss: 0.01187/7 [==============================] - 0s 12ms/step - loss: 0.0106
1/7 [===>..........................] - ETA: 0s - loss: 0.00764/7 [================>.............] - ETA: 0s - loss: 0.00587/7 [==============================] - 0s 14ms/step - loss: 0.0051
1/7 [===>..........................] - ETA: 0s - loss: 0.00754/7 [================>.............] - ETA: 0s - loss: 0.00607/7 [==============================] - ETA: 0s - loss: 0.00537/7 [==============================] - 0s 17ms/step - loss: 0.0053
1/7 [===>..........................] - ETA: 0s - loss: 0.00404/7 [================>.............] - ETA: 0s - loss: 0.00547/7 [==============================] - 0s 15ms/step - loss: 0.0055
1/7 [===>..........................] - ETA: 0s - loss: 0.00264/7 [================>.............] - ETA: 0s - loss: 0.02897/7 [==============================] - 0s 14ms/step - loss: 0.0202
1/7 [===>..........................] - ETA: 0s - loss: 0.00384/7 [================>.............] - ETA: 0s - loss: 0.00457/7 [==============================] - 0s 14ms/step - loss: 0.0107
1/7 [===>..........................] - ETA: 0s - loss: 0.00694/7 [================>.............] - ETA: 0s - loss: 0.00577/7 [==============================] - ETA: 0s - loss: 0.00517/7 [==============================] - 0s 17ms/step - loss: 0.0051
1/7 [===>..........................] - ETA: 0s - loss: 0.00663/7 [===========>..................] - ETA: 0s - loss: 0.00535/7 [====================>.........] - ETA: 0s - loss: 0.00547/7 [==============================] - ETA: 0s - loss: 0.00487/7 [==============================] - 0s 33ms/step - loss: 0.0048
1/7 [===>..........................] - ETA: 0s - loss: 0.00403/7 [===========>..................] - ETA: 0s - loss: 0.00545/7 [====================>.........] - ETA: 0s - loss: 0.00657/7 [==============================] - ETA: 0s - loss: 0.00687/7 [==============================] - 0s 26ms/step - loss: 0.0068
1/7 [===>..........................] - ETA: 0s - loss: 0.00273/7 [===========>..................] - ETA: 0s - loss: 0.02125/7 [====================>.........] - ETA: 0s - loss: 0.02567/7 [==============================] - ETA: 0s - loss: 0.02167/7 [==============================] - 0s 26ms/step - loss: 0.0216
1/7 [===>..........................] - ETA: 0s - loss: 0.00343/7 [===========>..................] - ETA: 0s - loss: 0.00415/7 [====================>.........] - ETA: 0s - loss: 0.01267/7 [==============================] - ETA: 0s - loss: 0.01137/7 [==============================] - 0s 26ms/step - loss: 0.0113
1/7 [===>..........................] - ETA: 0s - loss: 0.00673/7 [===========>..................] - ETA: 0s - loss: 0.00535/7 [====================>.........] - ETA: 0s - loss: 0.00527/7 [==============================] - ETA: 0s - loss: 0.00497/7 [==============================] - 0s 26ms/step - loss: 0.0049
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.009337210189551115:
Train Score: 0.00838 MSE 0.09153 RMSE
Test Score: 0.00441 MSE 0.06643 RMSE
Deviation Min [0.00015471], Max [0.75693215]
Deviation 99.5th pctile [0.5874574]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1388,    9]))
Confusion matrix 
[[1388    0]
 [   2    7]]
precision 1.00000, recall 0.77778, f1 0.87500
Time to train: 328491 ms
Saving model models/A2Benchmark/synthetic_29.csv.h5
Total Time to proces all the selected files : 330356 ms
A2Benchmark : Avg precision 1.00000 recall 0.77778 f1 0.87500 time to train 328491.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_29.csv  --epochs 20 --n_iter 3 --patience 3 :: took 337 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_2.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 01:39:05 AM MST
2020-11-30 01:39:10.905582: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 01:39:10.924272: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 01:39:10.925759: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5590b0a8b740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 01:39:10.925814: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 01:39:10.926051: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_2.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 3.6160e-046/7 [========================>.....] - ETA: 0s - loss: 2.6197e-047/7 [==============================] - 0s 11ms/step - loss: 2.7239e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.1126e-045/7 [====================>.........] - ETA: 0s - loss: 3.7788e-047/7 [==============================] - 0s 12ms/step - loss: 3.4492e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.2895e-044/7 [================>.............] - ETA: 0s - loss: 0.0062    7/7 [==============================] - ETA: 0s - loss: 0.00417/7 [==============================] - 0s 16ms/step - loss: 0.0041
1/7 [===>..........................] - ETA: 0s - loss: 5.1355e-045/7 [====================>.........] - ETA: 0s - loss: 0.0021    7/7 [==============================] - 0s 12ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 0.00335/7 [====================>.........] - ETA: 0s - loss: 8.3012e-047/7 [==============================] - 0s 12ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 2.6761e-043/7 [===========>..................] - ETA: 0s - loss: 3.9371e-045/7 [====================>.........] - ETA: 0s - loss: 2.6929e-047/7 [==============================] - ETA: 0s - loss: 2.6699e-047/7 [==============================] - 0s 33ms/step - loss: 2.6699e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.6694e-043/7 [===========>..................] - ETA: 0s - loss: 7.8376e-045/7 [====================>.........] - ETA: 0s - loss: 5.4812e-047/7 [==============================] - ETA: 0s - loss: 4.7089e-047/7 [==============================] - 0s 35ms/step - loss: 4.7089e-04
1/7 [===>..........................] - ETA: 0s - loss: 6.3674e-043/7 [===========>..................] - ETA: 0s - loss: 0.0047    5/7 [====================>.........] - ETA: 0s - loss: 0.00717/7 [==============================] - ETA: 0s - loss: 0.00577/7 [==============================] - 0s 32ms/step - loss: 0.0057
1/7 [===>..........................] - ETA: 0s - loss: 6.7274e-043/7 [===========>..................] - ETA: 0s - loss: 3.4614e-045/7 [====================>.........] - ETA: 0s - loss: 0.0022    7/7 [==============================] - 0s 23ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 6.8636e-043/7 [===========>..................] - ETA: 0s - loss: 3.0152e-045/7 [====================>.........] - ETA: 0s - loss: 1.9566e-047/7 [==============================] - ETA: 0s - loss: 2.5455e-047/7 [==============================] - 0s 25ms/step - loss: 2.5455e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.9098e-046/7 [========================>.....] - ETA: 0s - loss: 4.3350e-047/7 [==============================] - 0s 11ms/step - loss: 4.4180e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.3352e-043/7 [===========>..................] - ETA: 0s - loss: 1.5420e-046/7 [========================>.....] - ETA: 0s - loss: 2.3670e-047/7 [==============================] - 0s 23ms/step - loss: 2.2785e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.6025e-045/7 [====================>.........] - ETA: 0s - loss: 0.0055    7/7 [==============================] - 0s 12ms/step - loss: 0.0044
1/7 [===>..........................] - ETA: 0s - loss: 6.6164e-045/7 [====================>.........] - ETA: 0s - loss: 0.0022    7/7 [==============================] - 0s 14ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 4.2715e-045/7 [====================>.........] - ETA: 0s - loss: 2.4245e-047/7 [==============================] - 0s 14ms/step - loss: 2.9251e-04
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0014727565867360681:
Train Score: 0.00115 MSE 0.03395 RMSE
Test Score: 0.00020 MSE 0.01415 RMSE
Deviation Min [3.01544676e-05], Max [0.33460053]
Deviation 99.5th pctile [0.23814332]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1388,    9]))
Confusion matrix 
[[1388    0]
 [   2    7]]
precision 1.00000, recall 0.77778, f1 0.87500
Time to train: 355990 ms
Saving model models/A2Benchmark/synthetic_2.csv.h5
Total Time to proces all the selected files : 358374 ms
A2Benchmark : Avg precision 1.00000 recall 0.77778 f1 0.87500 time to train 355990.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_2.csv  --epochs 20 --n_iter 3 --patience 3 :: took 364 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_30.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 01:45:14 AM MST
2020-11-30 01:45:20.933924: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 01:45:20.952281: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 01:45:20.953596: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55a4b5668440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 01:45:20.953643: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 01:45:20.953829: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_30.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00573/7 [===========>..................] - ETA: 0s - loss: 0.00245/7 [====================>.........] - ETA: 0s - loss: 0.00177/7 [==============================] - 0s 23ms/step - loss: 0.0017
1/7 [===>..........................] - ETA: 0s - loss: 5.2086e-043/7 [===========>..................] - ETA: 0s - loss: 6.0186e-045/7 [====================>.........] - ETA: 0s - loss: 7.4621e-047/7 [==============================] - ETA: 0s - loss: 7.2825e-047/7 [==============================] - 0s 23ms/step - loss: 7.2825e-04
1/7 [===>..........................] - ETA: 0s - loss: 8.6772e-043/7 [===========>..................] - ETA: 0s - loss: 9.7009e-045/7 [====================>.........] - ETA: 0s - loss: 8.2000e-047/7 [==============================] - ETA: 0s - loss: 7.6858e-047/7 [==============================] - 0s 23ms/step - loss: 7.6858e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00173/7 [===========>..................] - ETA: 0s - loss: 0.00115/7 [====================>.........] - ETA: 0s - loss: 0.00307/7 [==============================] - 0s 23ms/step - loss: 0.0026
1/7 [===>..........................] - ETA: 0s - loss: 0.00133/7 [===========>..................] - ETA: 0s - loss: 8.3683e-044/7 [================>.............] - ETA: 0s - loss: 8.9112e-045/7 [====================>.........] - ETA: 0s - loss: 7.8598e-047/7 [==============================] - ETA: 0s - loss: 7.6592e-047/7 [==============================] - 0s 42ms/step - loss: 7.6592e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00483/7 [===========>..................] - ETA: 0s - loss: 0.00215/7 [====================>.........] - ETA: 0s - loss: 0.00177/7 [==============================] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 30ms/step - loss: 0.0018
1/7 [===>..........................] - ETA: 0s - loss: 6.5500e-043/7 [===========>..................] - ETA: 0s - loss: 0.0011    5/7 [====================>.........] - ETA: 0s - loss: 8.8670e-047/7 [==============================] - ETA: 0s - loss: 8.0665e-047/7 [==============================] - 0s 25ms/step - loss: 8.0665e-04
1/7 [===>..........................] - ETA: 0s - loss: 7.4367e-043/7 [===========>..................] - ETA: 0s - loss: 9.2396e-045/7 [====================>.........] - ETA: 0s - loss: 7.9012e-047/7 [==============================] - ETA: 0s - loss: 7.4414e-047/7 [==============================] - 0s 25ms/step - loss: 7.4414e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00103/7 [===========>..................] - ETA: 0s - loss: 7.2855e-045/7 [====================>.........] - ETA: 0s - loss: 0.0029    7/7 [==============================] - ETA: 0s - loss: 0.00257/7 [==============================] - 0s 30ms/step - loss: 0.0025
1/7 [===>..........................] - ETA: 0s - loss: 7.0301e-042/7 [=======>......................] - ETA: 0s - loss: 6.7229e-044/7 [================>.............] - ETA: 0s - loss: 0.0014    6/7 [========================>.....] - ETA: 0s - loss: 0.00117/7 [==============================] - 0s 40ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 0.00124/7 [================>.............] - ETA: 0s - loss: 6.2560e-047/7 [==============================] - ETA: 0s - loss: 6.4080e-047/7 [==============================] - 0s 20ms/step - loss: 6.4080e-04
1/7 [===>..........................] - ETA: 0s - loss: 8.1901e-045/7 [====================>.........] - ETA: 0s - loss: 0.0011    7/7 [==============================] - 0s 14ms/step - loss: 0.0010
1/7 [===>..........................] - ETA: 0s - loss: 5.7657e-045/7 [====================>.........] - ETA: 0s - loss: 6.1386e-047/7 [==============================] - 0s 14ms/step - loss: 5.9776e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00154/7 [================>.............] - ETA: 0s - loss: 8.7413e-047/7 [==============================] - ETA: 0s - loss: 0.0025    7/7 [==============================] - 0s 17ms/step - loss: 0.0025
1/7 [===>..........................] - ETA: 0s - loss: 0.00125/7 [====================>.........] - ETA: 0s - loss: 6.9763e-047/7 [==============================] - 0s 12ms/step - loss: 6.8715e-04
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0010886973119340836:
Train Score: 0.00100 MSE 0.03157 RMSE
Test Score: 0.00162 MSE 0.04023 RMSE
Deviation Min [3.22821047e-07], Max [0.56759596]
Deviation 99.5th pctile [0.08791585]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,    1]))
Confusion matrix 
[[1390    6]
 [   0    1]]
precision 0.14286, recall 1.00000, f1 0.25000
Time to train: 357747 ms
Saving model models/A2Benchmark/synthetic_30.csv.h5
Total Time to proces all the selected files : 360171 ms
A2Benchmark : Avg precision 0.14286 recall 1.00000 f1 0.25000 time to train 357747.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_30.csv  --epochs 20 --n_iter 3 --patience 3 :: took 367 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_31.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 01:51:26 AM MST
2020-11-30 01:51:32.713666: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 01:51:32.732311: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 01:51:32.733798: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x564320888740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 01:51:32.733847: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 01:51:32.734061: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_31.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00234/7 [================>.............] - ETA: 0s - loss: 0.00217/7 [==============================] - ETA: 0s - loss: 0.00227/7 [==============================] - 0s 19ms/step - loss: 0.0022
1/7 [===>..........................] - ETA: 0s - loss: 0.00335/7 [====================>.........] - ETA: 0s - loss: 0.00337/7 [==============================] - 0s 13ms/step - loss: 0.0035
1/7 [===>..........................] - ETA: 0s - loss: 0.00165/7 [====================>.........] - ETA: 0s - loss: 0.00547/7 [==============================] - 0s 13ms/step - loss: 0.0047
1/7 [===>..........................] - ETA: 0s - loss: 0.00114/7 [================>.............] - ETA: 0s - loss: 0.00217/7 [==============================] - 0s 16ms/step - loss: 0.0043
1/7 [===>..........................] - ETA: 0s - loss: 0.00655/7 [====================>.........] - ETA: 0s - loss: 0.00337/7 [==============================] - 0s 13ms/step - loss: 0.0038
1/7 [===>..........................] - ETA: 0s - loss: 0.00333/7 [===========>..................] - ETA: 0s - loss: 0.00275/7 [====================>.........] - ETA: 0s - loss: 0.00297/7 [==============================] - ETA: 0s - loss: 0.00297/7 [==============================] - 0s 31ms/step - loss: 0.0029
1/7 [===>..........................] - ETA: 0s - loss: 0.00163/7 [===========>..................] - ETA: 0s - loss: 0.00225/7 [====================>.........] - ETA: 0s - loss: 0.00237/7 [==============================] - ETA: 0s - loss: 0.00247/7 [==============================] - 0s 30ms/step - loss: 0.0024
1/7 [===>..........................] - ETA: 0s - loss: 0.00163/7 [===========>..................] - ETA: 0s - loss: 0.00215/7 [====================>.........] - ETA: 0s - loss: 0.00647/7 [==============================] - ETA: 0s - loss: 0.00557/7 [==============================] - 0s 26ms/step - loss: 0.0055
1/7 [===>..........................] - ETA: 0s - loss: 0.00123/7 [===========>..................] - ETA: 0s - loss: 0.00285/7 [====================>.........] - ETA: 0s - loss: 0.00527/7 [==============================] - ETA: 0s - loss: 0.00477/7 [==============================] - 0s 30ms/step - loss: 0.0047
1/7 [===>..........................] - ETA: 0s - loss: 0.00503/7 [===========>..................] - ETA: 0s - loss: 0.00335/7 [====================>.........] - ETA: 0s - loss: 0.00297/7 [==============================] - ETA: 0s - loss: 0.00317/7 [==============================] - 0s 25ms/step - loss: 0.0031
1/7 [===>..........................] - ETA: 0s - loss: 0.00353/7 [===========>..................] - ETA: 0s - loss: 0.00295/7 [====================>.........] - ETA: 0s - loss: 0.00287/7 [==============================] - 0s 22ms/step - loss: 0.0029
1/7 [===>..........................] - ETA: 0s - loss: 0.00303/7 [===========>..................] - ETA: 0s - loss: 0.00345/7 [====================>.........] - ETA: 0s - loss: 0.00387/7 [==============================] - ETA: 0s - loss: 0.00377/7 [==============================] - 0s 30ms/step - loss: 0.0037
1/7 [===>..........................] - ETA: 0s - loss: 0.00213/7 [===========>..................] - ETA: 0s - loss: 0.00235/7 [====================>.........] - ETA: 0s - loss: 0.00647/7 [==============================] - ETA: 0s - loss: 0.00567/7 [==============================] - 0s 25ms/step - loss: 0.0056
1/7 [===>..........................] - ETA: 0s - loss: 0.00133/7 [===========>..................] - ETA: 0s - loss: 0.00325/7 [====================>.........] - ETA: 0s - loss: 0.00547/7 [==============================] - ETA: 0s - loss: 0.00497/7 [==============================] - 0s 25ms/step - loss: 0.0049
1/7 [===>..........................] - ETA: 0s - loss: 0.00663/7 [===========>..................] - ETA: 0s - loss: 0.00395/7 [====================>.........] - ETA: 0s - loss: 0.00337/7 [==============================] - 0s 27ms/step - loss: 0.0037
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0036607835907489063:
Train Score: 0.00316 MSE 0.05617 RMSE
Test Score: 0.00209 MSE 0.04576 RMSE
Deviation Min [7.226633e-05], Max [0.56463411]
Deviation 99.5th pctile [0.13836393]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,    4]))
Confusion matrix 
[[1390    3]
 [   0    4]]
precision 0.57143, recall 1.00000, f1 0.72727
Time to train: 382343 ms
Saving model models/A2Benchmark/synthetic_31.csv.h5
Total Time to proces all the selected files : 384727 ms
A2Benchmark : Avg precision 0.57143 recall 1.00000 f1 0.72727 time to train 382343.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_31.csv  --epochs 20 --n_iter 3 --patience 3 :: took 391 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_32.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 01:58:02 AM MST
2020-11-30 01:58:08.845914: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 01:58:08.864206: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 01:58:08.865081: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55bdb716c740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 01:58:08.865107: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 01:58:08.865220: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_32.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00183/7 [===========>..................] - ETA: 0s - loss: 0.00195/7 [====================>.........] - ETA: 0s - loss: 0.00197/7 [==============================] - ETA: 0s - loss: 0.00177/7 [==============================] - 0s 27ms/step - loss: 0.0017
1/7 [===>..........................] - ETA: 0s - loss: 0.00353/7 [===========>..................] - ETA: 0s - loss: 0.00245/7 [====================>.........] - ETA: 0s - loss: 0.00267/7 [==============================] - ETA: 0s - loss: 0.00237/7 [==============================] - 0s 24ms/step - loss: 0.0023
1/7 [===>..........................] - ETA: 0s - loss: 0.00583/7 [===========>..................] - ETA: 0s - loss: 0.01305/7 [====================>.........] - ETA: 0s - loss: 0.01597/7 [==============================] - ETA: 0s - loss: 0.01307/7 [==============================] - 0s 25ms/step - loss: 0.0130
1/7 [===>..........................] - ETA: 0s - loss: 0.00213/7 [===========>..................] - ETA: 0s - loss: 0.00215/7 [====================>.........] - ETA: 0s - loss: 0.00697/7 [==============================] - ETA: 0s - loss: 0.00637/7 [==============================] - 0s 33ms/step - loss: 0.0063
1/7 [===>..........................] - ETA: 0s - loss: 0.00553/7 [===========>..................] - ETA: 0s - loss: 0.00305/7 [====================>.........] - ETA: 0s - loss: 0.00317/7 [==============================] - ETA: 0s - loss: 0.00307/7 [==============================] - 0s 25ms/step - loss: 0.0030
1/7 [===>..........................] - ETA: 0s - loss: 0.00134/7 [================>.............] - ETA: 0s - loss: 0.00136/7 [========================>.....] - ETA: 0s - loss: 0.00147/7 [==============================] - 0s 20ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 0.00135/7 [====================>.........] - ETA: 0s - loss: 0.00167/7 [==============================] - 0s 12ms/step - loss: 0.0016
1/7 [===>..........................] - ETA: 0s - loss: 0.00214/7 [================>.............] - ETA: 0s - loss: 0.01657/7 [==============================] - ETA: 0s - loss: 0.01117/7 [==============================] - 0s 16ms/step - loss: 0.0111
1/7 [===>..........................] - ETA: 0s - loss: 0.02865/7 [====================>.........] - ETA: 0s - loss: 0.06087/7 [==============================] - 0s 12ms/step - loss: 0.0558
1/7 [===>..........................] - ETA: 0s - loss: 0.00315/7 [====================>.........] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 15ms/step - loss: 0.0018
1/7 [===>..........................] - ETA: 0s - loss: 0.00134/7 [================>.............] - ETA: 0s - loss: 0.00137/7 [==============================] - ETA: 0s - loss: 0.00137/7 [==============================] - 0s 16ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 0.00154/7 [================>.............] - ETA: 0s - loss: 0.00167/7 [==============================] - ETA: 0s - loss: 0.00157/7 [==============================] - 0s 17ms/step - loss: 0.0015
1/7 [===>..........................] - ETA: 0s - loss: 0.00255/7 [====================>.........] - ETA: 0s - loss: 0.01377/7 [==============================] - 0s 13ms/step - loss: 0.0111
1/7 [===>..........................] - ETA: 0s - loss: 7.6937e-045/7 [====================>.........] - ETA: 0s - loss: 0.0065    7/7 [==============================] - 0s 16ms/step - loss: 0.0057
1/7 [===>..........................] - ETA: 0s - loss: 0.00364/7 [================>.............] - ETA: 0s - loss: 0.00207/7 [==============================] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 18ms/step - loss: 0.0020
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0043215473182499405:
Train Score: 0.00417 MSE 0.06460 RMSE
Test Score: 0.00240 MSE 0.04895 RMSE
Deviation Min [1.41181586e-05], Max [0.61125987]
Deviation 99.5th pctile [0.46547411]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1388,    9]))
Confusion matrix 
[[1388    0]
 [   2    7]]
precision 1.00000, recall 0.77778, f1 0.87500
Time to train: 369616 ms
Saving model models/A2Benchmark/synthetic_32.csv.h5
Total Time to proces all the selected files : 371727 ms
A2Benchmark : Avg precision 1.00000 recall 0.77778 f1 0.87500 time to train 369616.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_32.csv  --epochs 20 --n_iter 3 --patience 3 :: took 379 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_33.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 02:04:26 AM MST
2020-11-30 02:04:32.870530: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 02:04:32.889172: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 02:04:32.890374: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5604a7e67740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 02:04:32.890413: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 02:04:32.890564: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_33.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00463/7 [===========>..................] - ETA: 0s - loss: 0.00514/7 [================>.............] - ETA: 0s - loss: 0.00506/7 [========================>.....] - ETA: 0s - loss: 0.00497/7 [==============================] - 0s 34ms/step - loss: 0.0049
1/7 [===>..........................] - ETA: 0s - loss: 0.00703/7 [===========>..................] - ETA: 0s - loss: 0.00585/7 [====================>.........] - ETA: 0s - loss: 0.00667/7 [==============================] - ETA: 0s - loss: 0.00637/7 [==============================] - 0s 33ms/step - loss: 0.0063
1/7 [===>..........................] - ETA: 0s - loss: 0.00373/7 [===========>..................] - ETA: 0s - loss: 0.00485/7 [====================>.........] - ETA: 0s - loss: 0.00497/7 [==============================] - ETA: 0s - loss: 0.00517/7 [==============================] - 0s 34ms/step - loss: 0.0051
1/7 [===>..........................] - ETA: 0s - loss: 0.00823/7 [===========>..................] - ETA: 0s - loss: 0.00645/7 [====================>.........] - ETA: 0s - loss: 0.00887/7 [==============================] - ETA: 0s - loss: 0.00817/7 [==============================] - 0s 37ms/step - loss: 0.0081
1/7 [===>..........................] - ETA: 0s - loss: 0.00863/7 [===========>..................] - ETA: 0s - loss: 0.00635/7 [====================>.........] - ETA: 0s - loss: 0.00637/7 [==============================] - ETA: 0s - loss: 0.00627/7 [==============================] - 0s 27ms/step - loss: 0.0062
1/7 [===>..........................] - ETA: 0s - loss: 0.00496/7 [========================>.....] - ETA: 0s - loss: 0.00527/7 [==============================] - 0s 10ms/step - loss: 0.0051
1/7 [===>..........................] - ETA: 0s - loss: 0.00835/7 [====================>.........] - ETA: 0s - loss: 0.00787/7 [==============================] - 0s 16ms/step - loss: 0.0070
1/7 [===>..........................] - ETA: 0s - loss: 0.00394/7 [================>.............] - ETA: 0s - loss: 0.00517/7 [==============================] - ETA: 0s - loss: 0.00537/7 [==============================] - 0s 16ms/step - loss: 0.0053
1/7 [===>..........................] - ETA: 0s - loss: 0.00674/7 [================>.............] - ETA: 0s - loss: 0.00607/7 [==============================] - ETA: 0s - loss: 0.00737/7 [==============================] - 0s 17ms/step - loss: 0.0073
1/7 [===>..........................] - ETA: 0s - loss: 0.00816/7 [========================>.....] - ETA: 0s - loss: 0.00617/7 [==============================] - 0s 11ms/step - loss: 0.0060
1/7 [===>..........................] - ETA: 0s - loss: 0.00493/7 [===========>..................] - ETA: 0s - loss: 0.00475/7 [====================>.........] - ETA: 0s - loss: 0.00487/7 [==============================] - ETA: 0s - loss: 0.00457/7 [==============================] - 0s 36ms/step - loss: 0.0045
1/7 [===>..........................] - ETA: 0s - loss: 0.00633/7 [===========>..................] - ETA: 0s - loss: 0.00535/7 [====================>.........] - ETA: 0s - loss: 0.00617/7 [==============================] - ETA: 0s - loss: 0.00567/7 [==============================] - 0s 25ms/step - loss: 0.0056
1/7 [===>..........................] - ETA: 0s - loss: 0.00313/7 [===========>..................] - ETA: 0s - loss: 0.00515/7 [====================>.........] - ETA: 0s - loss: 0.00547/7 [==============================] - ETA: 0s - loss: 0.00577/7 [==============================] - 0s 36ms/step - loss: 0.0057
1/7 [===>..........................] - ETA: 0s - loss: 0.00793/7 [===========>..................] - ETA: 0s - loss: 0.00625/7 [====================>.........] - ETA: 0s - loss: 0.00857/7 [==============================] - ETA: 0s - loss: 0.00787/7 [==============================] - 0s 30ms/step - loss: 0.0078
1/7 [===>..........................] - ETA: 0s - loss: 0.00683/7 [===========>..................] - ETA: 0s - loss: 0.00535/7 [====================>.........] - ETA: 0s - loss: 0.00527/7 [==============================] - ETA: 0s - loss: 0.00497/7 [==============================] - 0s 27ms/step - loss: 0.0049
Best parameters {'n_units': 72, 'n_hidden': 2} best score 0.005696434527635574:
Train Score: 0.00566 MSE 0.07526 RMSE
Test Score: 0.00575 MSE 0.07582 RMSE
Deviation Min [0.00012375], Max [0.55263013]
Deviation 99.5th pctile [0.20770984]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,    1]))
Confusion matrix 
[[1390    6]
 [   0    1]]
precision 0.14286, recall 1.00000, f1 0.25000
Time to train: 482991 ms
Saving model models/A2Benchmark/synthetic_33.csv.h5
Total Time to proces all the selected files : 486601 ms
A2Benchmark : Avg precision 0.14286 recall 1.00000 f1 0.25000 time to train 482991.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_33.csv  --epochs 20 --n_iter 3 --patience 3 :: took 493 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_34.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 02:12:44 AM MST
2020-11-30 02:12:51.557121: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 02:12:51.576231: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 02:12:51.577603: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559643438960 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 02:12:51.577650: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 02:12:51.577843: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_34.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00213/7 [===========>..................] - ETA: 0s - loss: 0.00365/7 [====================>.........] - ETA: 0s - loss: 0.00367/7 [==============================] - ETA: 0s - loss: 0.00357/7 [==============================] - 0s 32ms/step - loss: 0.0035
1/7 [===>..........................] - ETA: 0s - loss: 8.0176e-043/7 [===========>..................] - ETA: 0s - loss: 0.0016    5/7 [====================>.........] - ETA: 0s - loss: 0.00177/7 [==============================] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 28ms/step - loss: 0.0018
1/7 [===>..........................] - ETA: 0s - loss: 0.00164/7 [================>.............] - ETA: 0s - loss: 0.00586/7 [========================>.....] - ETA: 0s - loss: 0.00437/7 [==============================] - 0s 21ms/step - loss: 0.0043
1/7 [===>..........................] - ETA: 0s - loss: 0.00213/7 [===========>..................] - ETA: 0s - loss: 0.00185/7 [====================>.........] - ETA: 0s - loss: 0.00437/7 [==============================] - ETA: 0s - loss: 0.00407/7 [==============================] - 0s 24ms/step - loss: 0.0040
1/7 [===>..........................] - ETA: 0s - loss: 0.00283/7 [===========>..................] - ETA: 0s - loss: 0.00245/7 [====================>.........] - ETA: 0s - loss: 0.00257/7 [==============================] - ETA: 0s - loss: 0.00247/7 [==============================] - 0s 29ms/step - loss: 0.0024
1/7 [===>..........................] - ETA: 0s - loss: 0.00164/7 [================>.............] - ETA: 0s - loss: 0.00177/7 [==============================] - ETA: 0s - loss: 0.00177/7 [==============================] - 0s 20ms/step - loss: 0.0017
1/7 [===>..........................] - ETA: 0s - loss: 0.00124/7 [================>.............] - ETA: 0s - loss: 0.00227/7 [==============================] - ETA: 0s - loss: 0.00217/7 [==============================] - 0s 17ms/step - loss: 0.0021
1/7 [===>..........................] - ETA: 0s - loss: 0.00204/7 [================>.............] - ETA: 0s - loss: 0.00587/7 [==============================] - ETA: 0s - loss: 0.00427/7 [==============================] - 0s 16ms/step - loss: 0.0042
1/7 [===>..........................] - ETA: 0s - loss: 0.00124/7 [================>.............] - ETA: 0s - loss: 0.00167/7 [==============================] - ETA: 0s - loss: 0.00347/7 [==============================] - 0s 17ms/step - loss: 0.0034
1/7 [===>..........................] - ETA: 0s - loss: 0.00444/7 [================>.............] - ETA: 0s - loss: 0.00307/7 [==============================] - 0s 14ms/step - loss: 0.0025
1/7 [===>..........................] - ETA: 0s - loss: 0.00174/7 [================>.............] - ETA: 0s - loss: 0.00197/7 [==============================] - 0s 15ms/step - loss: 0.0019
1/7 [===>..........................] - ETA: 0s - loss: 9.5258e-044/7 [================>.............] - ETA: 0s - loss: 0.0019    7/7 [==============================] - ETA: 0s - loss: 0.00197/7 [==============================] - 0s 17ms/step - loss: 0.0019
1/7 [===>..........................] - ETA: 0s - loss: 0.00125/7 [====================>.........] - ETA: 0s - loss: 0.00437/7 [==============================] - 0s 14ms/step - loss: 0.0037
1/7 [===>..........................] - ETA: 0s - loss: 0.00314/7 [================>.............] - ETA: 0s - loss: 0.00277/7 [==============================] - 0s 14ms/step - loss: 0.0041
1/7 [===>..........................] - ETA: 0s - loss: 0.00415/7 [====================>.........] - ETA: 0s - loss: 0.00267/7 [==============================] - 0s 13ms/step - loss: 0.0024
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.002780351578257978:
Train Score: 0.00226 MSE 0.04754 RMSE
Test Score: 0.00142 MSE 0.03775 RMSE
Deviation Min [1.85515686e-06], Max [0.47163218]
Deviation 99.5th pctile [0.13028152]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,    4]))
Confusion matrix 
[[1390    3]
 [   0    4]]
precision 0.57143, recall 1.00000, f1 0.72727
Time to train: 392358 ms
Saving model models/A2Benchmark/synthetic_34.csv.h5
Total Time to proces all the selected files : 394537 ms
A2Benchmark : Avg precision 0.57143 recall 1.00000 f1 0.72727 time to train 392358.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_34.csv  --epochs 20 --n_iter 3 --patience 3 :: took 402 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_35.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 02:19:31 AM MST
2020-11-30 02:19:37.425991: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 02:19:37.444292: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 02:19:37.445783: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x563ba93ac740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 02:19:37.445833: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 02:19:37.446086: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_35.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00165/7 [====================>.........] - ETA: 0s - loss: 0.00157/7 [==============================] - 0s 12ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 1.1537e-045/7 [====================>.........] - ETA: 0s - loss: 1.3813e-047/7 [==============================] - 0s 12ms/step - loss: 1.3133e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.6584e-045/7 [====================>.........] - ETA: 0s - loss: 0.0207    7/7 [==============================] - 0s 12ms/step - loss: 0.0166
1/7 [===>..........................] - ETA: 0s - loss: 1.3490e-044/7 [================>.............] - ETA: 0s - loss: 1.4160e-047/7 [==============================] - 0s 15ms/step - loss: 0.0080
1/7 [===>..........................] - ETA: 0s - loss: 0.00155/7 [====================>.........] - ETA: 0s - loss: 0.00127/7 [==============================] - 0s 12ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 6.4075e-043/7 [===========>..................] - ETA: 0s - loss: 7.3767e-045/7 [====================>.........] - ETA: 0s - loss: 5.9577e-047/7 [==============================] - ETA: 0s - loss: 4.8362e-047/7 [==============================] - 0s 26ms/step - loss: 4.8362e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.3922e-043/7 [===========>..................] - ETA: 0s - loss: 1.5521e-045/7 [====================>.........] - ETA: 0s - loss: 1.3279e-047/7 [==============================] - ETA: 0s - loss: 1.2274e-047/7 [==============================] - 0s 31ms/step - loss: 1.2274e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.0614e-043/7 [===========>..................] - ETA: 0s - loss: 0.0184    5/7 [====================>.........] - ETA: 0s - loss: 0.02277/7 [==============================] - ETA: 0s - loss: 0.01817/7 [==============================] - 0s 31ms/step - loss: 0.0181
1/7 [===>..........................] - ETA: 0s - loss: 1.1117e-043/7 [===========>..................] - ETA: 0s - loss: 9.9355e-055/7 [====================>.........] - ETA: 0s - loss: 0.0101    7/7 [==============================] - ETA: 0s - loss: 0.00887/7 [==============================] - 0s 31ms/step - loss: 0.0088
1/7 [===>..........................] - ETA: 0s - loss: 8.5934e-053/7 [===========>..................] - ETA: 0s - loss: 8.2665e-055/7 [====================>.........] - ETA: 0s - loss: 7.5063e-057/7 [==============================] - ETA: 0s - loss: 7.0301e-057/7 [==============================] - 0s 33ms/step - loss: 7.0301e-05
1/7 [===>..........................] - ETA: 0s - loss: 5.0990e-043/7 [===========>..................] - ETA: 0s - loss: 5.6740e-045/7 [====================>.........] - ETA: 0s - loss: 4.6123e-047/7 [==============================] - ETA: 0s - loss: 3.7912e-047/7 [==============================] - 0s 25ms/step - loss: 3.7912e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.0307e-053/7 [===========>..................] - ETA: 0s - loss: 9.8945e-055/7 [====================>.........] - ETA: 0s - loss: 1.4688e-047/7 [==============================] - ETA: 0s - loss: 1.5596e-047/7 [==============================] - 0s 27ms/step - loss: 1.5596e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.9889e-053/7 [===========>..................] - ETA: 0s - loss: 0.0186    5/7 [====================>.........] - ETA: 0s - loss: 0.02267/7 [==============================] - ETA: 0s - loss: 0.01807/7 [==============================] - 0s 38ms/step - loss: 0.0180
1/7 [===>..........................] - ETA: 0s - loss: 2.9996e-043/7 [===========>..................] - ETA: 0s - loss: 2.7413e-045/7 [====================>.........] - ETA: 0s - loss: 0.0105    7/7 [==============================] - ETA: 0s - loss: 0.00897/7 [==============================] - 0s 25ms/step - loss: 0.0089
1/7 [===>..........................] - ETA: 0s - loss: 6.7914e-043/7 [===========>..................] - ETA: 0s - loss: 6.9333e-045/7 [====================>.........] - ETA: 0s - loss: 6.3061e-047/7 [==============================] - ETA: 0s - loss: 5.9448e-047/7 [==============================] - 0s 28ms/step - loss: 5.9448e-04
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.005435150265111588:
Train Score: 0.00466 MSE 0.06827 RMSE
Test Score: 0.00053 MSE 0.02307 RMSE
Deviation Min [1.7349281e-05], Max [0.77443613]
Deviation 99.5th pctile [0.62819418]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1388,    9]))
Confusion matrix 
[[1388    0]
 [   2    7]]
precision 1.00000, recall 0.77778, f1 0.87500
Time to train: 326624 ms
Saving model models/A2Benchmark/synthetic_35.csv.h5
Total Time to proces all the selected files : 328751 ms
A2Benchmark : Avg precision 1.00000 recall 0.77778 f1 0.87500 time to train 326624.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_35.csv  --epochs 20 --n_iter 3 --patience 3 :: took 335 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_36.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 02:25:11 AM MST
2020-11-30 02:25:18.175770: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 02:25:18.194275: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 02:25:18.195594: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55a1666e4740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 02:25:18.195641: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 02:25:18.195816: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_36.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00874/7 [================>.............] - ETA: 0s - loss: 0.00747/7 [==============================] - ETA: 0s - loss: 0.00687/7 [==============================] - 0s 18ms/step - loss: 0.0068
1/7 [===>..........................] - ETA: 0s - loss: 0.00755/7 [====================>.........] - ETA: 0s - loss: 0.00887/7 [==============================] - 0s 13ms/step - loss: 0.0083
1/7 [===>..........................] - ETA: 0s - loss: 0.00504/7 [================>.............] - ETA: 0s - loss: 0.00747/7 [==============================] - ETA: 0s - loss: 0.00777/7 [==============================] - 0s 17ms/step - loss: 0.0077
1/7 [===>..........................] - ETA: 0s - loss: 0.00835/7 [====================>.........] - ETA: 0s - loss: 0.00767/7 [==============================] - 0s 15ms/step - loss: 0.0073
1/7 [===>..........................] - ETA: 0s - loss: 0.01015/7 [====================>.........] - ETA: 0s - loss: 0.00697/7 [==============================] - 0s 11ms/step - loss: 0.0065
1/7 [===>..........................] - ETA: 0s - loss: 0.00894/7 [================>.............] - ETA: 0s - loss: 0.00757/7 [==============================] - ETA: 0s - loss: 0.00707/7 [==============================] - 0s 15ms/step - loss: 0.0070
1/7 [===>..........................] - ETA: 0s - loss: 0.00796/7 [========================>.....] - ETA: 0s - loss: 0.00777/7 [==============================] - 0s 10ms/step - loss: 0.0076
1/7 [===>..........................] - ETA: 0s - loss: 0.00455/7 [====================>.........] - ETA: 0s - loss: 0.00647/7 [==============================] - 0s 13ms/step - loss: 0.0070
1/7 [===>..........................] - ETA: 0s - loss: 0.00834/7 [================>.............] - ETA: 0s - loss: 0.00747/7 [==============================] - ETA: 0s - loss: 0.00717/7 [==============================] - 0s 18ms/step - loss: 0.0071
1/7 [===>..........................] - ETA: 0s - loss: 0.01094/7 [================>.............] - ETA: 0s - loss: 0.00777/7 [==============================] - ETA: 0s - loss: 0.00667/7 [==============================] - 0s 18ms/step - loss: 0.0066
1/7 [===>..........................] - ETA: 0s - loss: 0.01135/7 [====================>.........] - ETA: 0s - loss: 0.00927/7 [==============================] - 0s 13ms/step - loss: 0.0083
1/7 [===>..........................] - ETA: 0s - loss: 0.00755/7 [====================>.........] - ETA: 0s - loss: 0.00897/7 [==============================] - 0s 14ms/step - loss: 0.0082
1/7 [===>..........................] - ETA: 0s - loss: 0.00475/7 [====================>.........] - ETA: 0s - loss: 0.00687/7 [==============================] - 0s 12ms/step - loss: 0.0081
1/7 [===>..........................] - ETA: 0s - loss: 0.00804/7 [================>.............] - ETA: 0s - loss: 0.00757/7 [==============================] - ETA: 0s - loss: 0.00727/7 [==============================] - 0s 16ms/step - loss: 0.0072
1/7 [===>..........................] - ETA: 0s - loss: 0.00925/7 [====================>.........] - ETA: 0s - loss: 0.00687/7 [==============================] - 0s 12ms/step - loss: 0.0064
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.007070943247526884:
Train Score: 0.00716 MSE 0.08465 RMSE
Test Score: 0.00737 MSE 0.08584 RMSE
Deviation Min [9.47981464e-05], Max [0.33276186]
Deviation 99.5th pctile [0.23252285]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,    1]))
Confusion matrix 
[[1390    6]
 [   0    1]]
precision 0.14286, recall 1.00000, f1 0.25000
Time to train: 211666 ms
Saving model models/A2Benchmark/synthetic_36.csv.h5
Total Time to proces all the selected files : 213947 ms
A2Benchmark : Avg precision 0.14286 recall 1.00000 f1 0.25000 time to train 211666.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_36.csv  --epochs 20 --n_iter 3 --patience 3 :: took 221 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_37.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 02:28:57 AM MST
2020-11-30 02:29:03.577368: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 02:29:03.596299: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 02:29:03.597497: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55b998e2e440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 02:29:03.597537: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 02:29:03.597693: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_37.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00123/7 [===========>..................] - ETA: 0s - loss: 6.1390e-045/7 [====================>.........] - ETA: 0s - loss: 4.8277e-047/7 [==============================] - 0s 25ms/step - loss: 4.5560e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.3022e-042/7 [=======>......................] - ETA: 0s - loss: 2.4708e-044/7 [================>.............] - ETA: 0s - loss: 3.4939e-046/7 [========================>.....] - ETA: 0s - loss: 3.8114e-047/7 [==============================] - 0s 29ms/step - loss: 3.7945e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.2679e-043/7 [===========>..................] - ETA: 0s - loss: 2.7073e-045/7 [====================>.........] - ETA: 0s - loss: 0.0075    7/7 [==============================] - 0s 23ms/step - loss: 0.0060
1/7 [===>..........................] - ETA: 0s - loss: 6.0131e-043/7 [===========>..................] - ETA: 0s - loss: 4.3951e-045/7 [====================>.........] - ETA: 0s - loss: 0.0072    7/7 [==============================] - ETA: 0s - loss: 0.00607/7 [==============================] - 0s 23ms/step - loss: 0.0060
1/7 [===>..........................] - ETA: 0s - loss: 3.9709e-043/7 [===========>..................] - ETA: 0s - loss: 3.5657e-045/7 [====================>.........] - ETA: 0s - loss: 3.6832e-047/7 [==============================] - 0s 24ms/step - loss: 3.4670e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00133/7 [===========>..................] - ETA: 0s - loss: 6.1569e-045/7 [====================>.........] - ETA: 0s - loss: 5.2663e-047/7 [==============================] - ETA: 0s - loss: 5.4557e-047/7 [==============================] - 0s 31ms/step - loss: 5.4557e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.7535e-043/7 [===========>..................] - ETA: 0s - loss: 6.9786e-045/7 [====================>.........] - ETA: 0s - loss: 5.4281e-047/7 [==============================] - ETA: 0s - loss: 4.8560e-047/7 [==============================] - 0s 30ms/step - loss: 4.8560e-04
1/7 [===>..........................] - ETA: 0s - loss: 9.6708e-043/7 [===========>..................] - ETA: 0s - loss: 7.2937e-045/7 [====================>.........] - ETA: 0s - loss: 0.0079    7/7 [==============================] - ETA: 0s - loss: 0.00647/7 [==============================] - 0s 27ms/step - loss: 0.0064
1/7 [===>..........................] - ETA: 0s - loss: 9.4854e-043/7 [===========>..................] - ETA: 0s - loss: 5.7982e-044/7 [================>.............] - ETA: 0s - loss: 5.2073e-046/7 [========================>.....] - ETA: 0s - loss: 0.0064    7/7 [==============================] - 0s 40ms/step - loss: 0.0061
1/7 [===>..........................] - ETA: 0s - loss: 9.5787e-043/7 [===========>..................] - ETA: 0s - loss: 9.4816e-045/7 [====================>.........] - ETA: 0s - loss: 6.6257e-047/7 [==============================] - ETA: 0s - loss: 7.5567e-047/7 [==============================] - 0s 26ms/step - loss: 7.5567e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00153/7 [===========>..................] - ETA: 0s - loss: 7.0750e-045/7 [====================>.........] - ETA: 0s - loss: 5.4773e-047/7 [==============================] - ETA: 0s - loss: 5.2849e-047/7 [==============================] - 0s 25ms/step - loss: 5.2849e-04
1/7 [===>..........................] - ETA: 0s - loss: 7.6954e-043/7 [===========>..................] - ETA: 0s - loss: 0.0012    5/7 [====================>.........] - ETA: 0s - loss: 8.8951e-047/7 [==============================] - ETA: 0s - loss: 8.1758e-047/7 [==============================] - 0s 29ms/step - loss: 8.1758e-04
1/7 [===>..........................] - ETA: 0s - loss: 6.5187e-043/7 [===========>..................] - ETA: 0s - loss: 4.4782e-045/7 [====================>.........] - ETA: 0s - loss: 0.0077    7/7 [==============================] - ETA: 0s - loss: 0.00627/7 [==============================] - 0s 24ms/step - loss: 0.0062
1/7 [===>..........................] - ETA: 0s - loss: 4.9008e-043/7 [===========>..................] - ETA: 0s - loss: 3.8529e-045/7 [====================>.........] - ETA: 0s - loss: 0.0071    7/7 [==============================] - ETA: 0s - loss: 0.00607/7 [==============================] - 0s 29ms/step - loss: 0.0060
1/7 [===>..........................] - ETA: 0s - loss: 2.9639e-043/7 [===========>..................] - ETA: 0s - loss: 3.0183e-045/7 [====================>.........] - ETA: 0s - loss: 3.7646e-047/7 [==============================] - ETA: 0s - loss: 3.5317e-047/7 [==============================] - 0s 35ms/step - loss: 3.5317e-04
Best parameters {'n_units': 48, 'n_hidden': 2} best score 0.0026222244487144053:
Train Score: 0.00241 MSE 0.04912 RMSE
Test Score: 0.00034 MSE 0.01834 RMSE
Deviation Min [2.52433116e-07], Max [0.74210941]
Deviation 99.5th pctile [0.09151652]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,    4]))
Confusion matrix 
[[1390    3]
 [   0    4]]
precision 0.57143, recall 1.00000, f1 0.72727
Time to train: 371695 ms
Saving model models/A2Benchmark/synthetic_37.csv.h5
Total Time to proces all the selected files : 375535 ms
A2Benchmark : Avg precision 0.57143 recall 1.00000 f1 0.72727 time to train 371695.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_37.csv  --epochs 20 --n_iter 3 --patience 3 :: took 382 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_38.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 02:35:24 AM MST
2020-11-30 02:35:29.970699: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 02:35:29.989244: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 02:35:29.990008: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x563cc4954380 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 02:35:29.990033: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 02:35:29.990155: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_38.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00446/7 [========================>.....] - ETA: 0s - loss: 0.00437/7 [==============================] - 0s 11ms/step - loss: 0.0043
1/7 [===>..........................] - ETA: 0s - loss: 0.00245/7 [====================>.........] - ETA: 0s - loss: 0.00407/7 [==============================] - 0s 15ms/step - loss: 0.0041
1/7 [===>..........................] - ETA: 0s - loss: 0.00235/7 [====================>.........] - ETA: 0s - loss: 0.00927/7 [==============================] - 0s 12ms/step - loss: 0.0079
1/7 [===>..........................] - ETA: 0s - loss: 0.00225/7 [====================>.........] - ETA: 0s - loss: 0.00547/7 [==============================] - 0s 15ms/step - loss: 0.0052
1/7 [===>..........................] - ETA: 0s - loss: 0.00774/7 [================>.............] - ETA: 0s - loss: 0.00517/7 [==============================] - ETA: 0s - loss: 0.00507/7 [==============================] - 0s 17ms/step - loss: 0.0050
1/7 [===>..........................] - ETA: 0s - loss: 0.00543/7 [===========>..................] - ETA: 0s - loss: 0.00455/7 [====================>.........] - ETA: 0s - loss: 0.00477/7 [==============================] - ETA: 0s - loss: 0.00477/7 [==============================] - 0s 29ms/step - loss: 0.0047
1/7 [===>..........................] - ETA: 0s - loss: 0.00343/7 [===========>..................] - ETA: 0s - loss: 0.00425/7 [====================>.........] - ETA: 0s - loss: 0.00497/7 [==============================] - ETA: 0s - loss: 0.00507/7 [==============================] - 0s 31ms/step - loss: 0.0050
1/7 [===>..........................] - ETA: 0s - loss: 0.00273/7 [===========>..................] - ETA: 0s - loss: 0.00845/7 [====================>.........] - ETA: 0s - loss: 0.01027/7 [==============================] - ETA: 0s - loss: 0.00877/7 [==============================] - 0s 25ms/step - loss: 0.0087
1/7 [===>..........................] - ETA: 0s - loss: 0.00223/7 [===========>..................] - ETA: 0s - loss: 0.00475/7 [====================>.........] - ETA: 0s - loss: 0.00627/7 [==============================] - ETA: 0s - loss: 0.00597/7 [==============================] - 0s 32ms/step - loss: 0.0059
1/7 [===>..........................] - ETA: 0s - loss: 0.00743/7 [===========>..................] - ETA: 0s - loss: 0.00565/7 [====================>.........] - ETA: 0s - loss: 0.00497/7 [==============================] - ETA: 0s - loss: 0.00517/7 [==============================] - 0s 36ms/step - loss: 0.0051
1/7 [===>..........................] - ETA: 0s - loss: 0.00503/7 [===========>..................] - ETA: 0s - loss: 0.00435/7 [====================>.........] - ETA: 0s - loss: 0.00477/7 [==============================] - 0s 23ms/step - loss: 0.0046
1/7 [===>..........................] - ETA: 0s - loss: 0.01073/7 [===========>..................] - ETA: 0s - loss: 0.00725/7 [====================>.........] - ETA: 0s - loss: 0.00807/7 [==============================] - ETA: 0s - loss: 0.00907/7 [==============================] - 0s 32ms/step - loss: 0.0090
1/7 [===>..........................] - ETA: 0s - loss: 0.00283/7 [===========>..................] - ETA: 0s - loss: 0.00825/7 [====================>.........] - ETA: 0s - loss: 0.00957/7 [==============================] - ETA: 0s - loss: 0.00837/7 [==============================] - 0s 23ms/step - loss: 0.0083
1/7 [===>..........................] - ETA: 0s - loss: 0.00233/7 [===========>..................] - ETA: 0s - loss: 0.00505/7 [====================>.........] - ETA: 0s - loss: 0.00637/7 [==============================] - ETA: 0s - loss: 0.00607/7 [==============================] - 0s 25ms/step - loss: 0.0060
1/7 [===>..........................] - ETA: 0s - loss: 0.00953/7 [===========>..................] - ETA: 0s - loss: 0.00615/7 [====================>.........] - ETA: 0s - loss: 0.00537/7 [==============================] - 0s 21ms/step - loss: 0.0057
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.005296503473073244:
Train Score: 0.00488 MSE 0.06982 RMSE
Test Score: 0.00372 MSE 0.06096 RMSE
Deviation Min [1.79566706e-06], Max [0.44521058]
Deviation 99.5th pctile [0.29518878]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1388,    9]))
Confusion matrix 
[[1388    0]
 [   2    7]]
precision 1.00000, recall 0.77778, f1 0.87500
Time to train: 416905 ms
Saving model models/A2Benchmark/synthetic_38.csv.h5
Total Time to proces all the selected files : 419249 ms
A2Benchmark : Avg precision 1.00000 recall 0.77778 f1 0.87500 time to train 416905.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_38.csv  --epochs 20 --n_iter 3 --patience 3 :: took 425 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_39.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 02:42:34 AM MST
2020-11-30 02:42:40.428805: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 02:42:40.447201: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 02:42:40.448083: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5591325df440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 02:42:40.448111: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 02:42:40.448232: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_39.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 7.3608e-043/7 [===========>..................] - ETA: 0s - loss: 6.5141e-045/7 [====================>.........] - ETA: 0s - loss: 6.6794e-047/7 [==============================] - ETA: 0s - loss: 6.2150e-047/7 [==============================] - 0s 27ms/step - loss: 6.2150e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.2844e-043/7 [===========>..................] - ETA: 0s - loss: 7.0597e-045/7 [====================>.........] - ETA: 0s - loss: 6.7064e-047/7 [==============================] - ETA: 0s - loss: 6.6774e-047/7 [==============================] - 0s 32ms/step - loss: 6.6774e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.1456e-043/7 [===========>..................] - ETA: 0s - loss: 6.7817e-045/7 [====================>.........] - ETA: 0s - loss: 6.5014e-047/7 [==============================] - ETA: 0s - loss: 6.3370e-047/7 [==============================] - 0s 33ms/step - loss: 6.3370e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.2472e-043/7 [===========>..................] - ETA: 0s - loss: 8.9196e-045/7 [====================>.........] - ETA: 0s - loss: 0.0038    7/7 [==============================] - ETA: 0s - loss: 0.00337/7 [==============================] - 0s 35ms/step - loss: 0.0033
1/7 [===>..........................] - ETA: 0s - loss: 0.00123/7 [===========>..................] - ETA: 0s - loss: 8.0070e-045/7 [====================>.........] - ETA: 0s - loss: 7.7547e-047/7 [==============================] - ETA: 0s - loss: 7.0339e-047/7 [==============================] - 0s 26ms/step - loss: 7.0339e-04
1/7 [===>..........................] - ETA: 0s - loss: 8.5385e-043/7 [===========>..................] - ETA: 0s - loss: 6.6439e-045/7 [====================>.........] - ETA: 0s - loss: 6.8179e-047/7 [==============================] - ETA: 0s - loss: 6.2645e-047/7 [==============================] - 0s 24ms/step - loss: 6.2645e-04
1/7 [===>..........................] - ETA: 0s - loss: 9.4015e-043/7 [===========>..................] - ETA: 0s - loss: 6.6879e-045/7 [====================>.........] - ETA: 0s - loss: 6.8477e-047/7 [==============================] - ETA: 0s - loss: 6.5524e-047/7 [==============================] - 0s 22ms/step - loss: 6.5524e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00124/7 [================>.............] - ETA: 0s - loss: 6.9698e-046/7 [========================>.....] - ETA: 0s - loss: 8.9551e-047/7 [==============================] - 0s 21ms/step - loss: 8.6349e-04
1/7 [===>..........................] - ETA: 0s - loss: 7.4352e-043/7 [===========>..................] - ETA: 0s - loss: 7.2469e-045/7 [====================>.........] - ETA: 0s - loss: 0.0037    7/7 [==============================] - ETA: 0s - loss: 0.00327/7 [==============================] - 0s 32ms/step - loss: 0.0032
1/7 [===>..........................] - ETA: 0s - loss: 0.00203/7 [===========>..................] - ETA: 0s - loss: 9.6993e-045/7 [====================>.........] - ETA: 0s - loss: 0.0011    7/7 [==============================] - ETA: 0s - loss: 9.6213e-047/7 [==============================] - 0s 32ms/step - loss: 9.6213e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.6771e-043/7 [===========>..................] - ETA: 0s - loss: 8.4217e-045/7 [====================>.........] - ETA: 0s - loss: 8.5430e-047/7 [==============================] - ETA: 0s - loss: 7.6687e-047/7 [==============================] - 0s 31ms/step - loss: 7.6687e-04
1/7 [===>..........................] - ETA: 0s - loss: 7.7707e-043/7 [===========>..................] - ETA: 0s - loss: 7.1607e-045/7 [====================>.........] - ETA: 0s - loss: 6.8532e-047/7 [==============================] - ETA: 0s - loss: 6.6725e-047/7 [==============================] - 0s 30ms/step - loss: 6.6725e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00133/7 [===========>..................] - ETA: 0s - loss: 7.8450e-045/7 [====================>.........] - ETA: 0s - loss: 9.4350e-047/7 [==============================] - ETA: 0s - loss: 8.9775e-047/7 [==============================] - 0s 31ms/step - loss: 8.9775e-04
1/7 [===>..........................] - ETA: 0s - loss: 7.0596e-043/7 [===========>..................] - ETA: 0s - loss: 7.5877e-045/7 [====================>.........] - ETA: 0s - loss: 0.0037    7/7 [==============================] - ETA: 0s - loss: 0.00327/7 [==============================] - 0s 36ms/step - loss: 0.0032
1/7 [===>..........................] - ETA: 0s - loss: 0.00153/7 [===========>..................] - ETA: 0s - loss: 7.8615e-045/7 [====================>.........] - ETA: 0s - loss: 8.4544e-047/7 [==============================] - ETA: 0s - loss: 7.4733e-047/7 [==============================] - 0s 29ms/step - loss: 7.4733e-04
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.0011764148366637528:
Train Score: 0.00111 MSE 0.03325 RMSE
Test Score: 0.00068 MSE 0.02601 RMSE
Deviation Min [2.02355787e-05], Max [0.68283454]
Deviation 99.5th pctile [0.06671744]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,    1]))
Confusion matrix 
[[1390    6]
 [   0    1]]
precision 0.14286, recall 1.00000, f1 0.25000
Time to train: 417869 ms
Saving model models/A2Benchmark/synthetic_39.csv.h5
Total Time to proces all the selected files : 422063 ms
A2Benchmark : Avg precision 0.14286 recall 1.00000 f1 0.25000 time to train 417869.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_39.csv  --epochs 20 --n_iter 3 --patience 3 :: took 428 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_3.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 02:49:47 AM MST
2020-11-30 02:49:53.605835: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 02:49:53.624250: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 02:49:53.625871: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x561d47d8c960 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 02:49:53.625926: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 02:49:53.626150: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_3.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 9.0806e-043/7 [===========>..................] - ETA: 0s - loss: 5.3276e-045/7 [====================>.........] - ETA: 0s - loss: 4.9983e-047/7 [==============================] - ETA: 0s - loss: 5.2777e-047/7 [==============================] - 0s 23ms/step - loss: 5.2777e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.1210e-043/7 [===========>..................] - ETA: 0s - loss: 3.3655e-045/7 [====================>.........] - ETA: 0s - loss: 3.1616e-047/7 [==============================] - 0s 30ms/step - loss: 3.2588e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.3501e-043/7 [===========>..................] - ETA: 0s - loss: 4.3965e-045/7 [====================>.........] - ETA: 0s - loss: 4.6325e-047/7 [==============================] - ETA: 0s - loss: 4.4759e-047/7 [==============================] - 0s 28ms/step - loss: 4.4759e-04
1/7 [===>..........................] - ETA: 0s - loss: 6.0242e-043/7 [===========>..................] - ETA: 0s - loss: 5.8447e-045/7 [====================>.........] - ETA: 0s - loss: 0.0033    7/7 [==============================] - 0s 21ms/step - loss: 0.0029
1/7 [===>..........................] - ETA: 0s - loss: 3.8935e-043/7 [===========>..................] - ETA: 0s - loss: 4.7255e-045/7 [====================>.........] - ETA: 0s - loss: 4.4633e-047/7 [==============================] - ETA: 0s - loss: 4.1023e-047/7 [==============================] - 0s 24ms/step - loss: 4.1023e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00254/7 [================>.............] - ETA: 0s - loss: 0.00117/7 [==============================] - ETA: 0s - loss: 0.00137/7 [==============================] - 0s 17ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 4.5307e-044/7 [================>.............] - ETA: 0s - loss: 7.9939e-047/7 [==============================] - ETA: 0s - loss: 8.1018e-047/7 [==============================] - 0s 17ms/step - loss: 8.1018e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.4515e-045/7 [====================>.........] - ETA: 0s - loss: 5.7810e-047/7 [==============================] - 0s 14ms/step - loss: 6.2753e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.9528e-046/7 [========================>.....] - ETA: 0s - loss: 0.0029    7/7 [==============================] - 0s 10ms/step - loss: 0.0027
1/7 [===>..........................] - ETA: 0s - loss: 7.9318e-044/7 [================>.............] - ETA: 0s - loss: 5.6659e-047/7 [==============================] - ETA: 0s - loss: 5.8760e-047/7 [==============================] - 0s 18ms/step - loss: 5.8760e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.8276e-043/7 [===========>..................] - ETA: 0s - loss: 2.9556e-045/7 [====================>.........] - ETA: 0s - loss: 2.5027e-047/7 [==============================] - ETA: 0s - loss: 2.5321e-047/7 [==============================] - 0s 36ms/step - loss: 2.5321e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.9449e-043/7 [===========>..................] - ETA: 0s - loss: 4.6038e-045/7 [====================>.........] - ETA: 0s - loss: 5.2273e-047/7 [==============================] - ETA: 0s - loss: 4.9132e-047/7 [==============================] - 0s 27ms/step - loss: 4.9132e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.7318e-043/7 [===========>..................] - ETA: 0s - loss: 2.2680e-045/7 [====================>.........] - ETA: 0s - loss: 2.2740e-047/7 [==============================] - ETA: 0s - loss: 2.3903e-047/7 [==============================] - 0s 25ms/step - loss: 2.3903e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.3026e-043/7 [===========>..................] - ETA: 0s - loss: 3.6102e-045/7 [====================>.........] - ETA: 0s - loss: 0.0033    7/7 [==============================] - ETA: 0s - loss: 0.00287/7 [==============================] - 0s 30ms/step - loss: 0.0028
1/7 [===>..........................] - ETA: 0s - loss: 4.2252e-043/7 [===========>..................] - ETA: 0s - loss: 3.7667e-045/7 [====================>.........] - ETA: 0s - loss: 3.8407e-047/7 [==============================] - ETA: 0s - loss: 3.5436e-047/7 [==============================] - 0s 26ms/step - loss: 3.5436e-04
Best parameters {'n_units': 72, 'n_hidden': 2} best score 0.0008296531363157555:
Train Score: 0.00063 MSE 0.02513 RMSE
Test Score: 0.00021 MSE 0.01444 RMSE
Deviation Min [1.36754572e-05], Max [0.66423548]
Deviation 99.5th pctile [0.05847155]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,    1]))
Confusion matrix 
[[1390    6]
 [   0    1]]
precision 0.14286, recall 1.00000, f1 0.25000
Time to train: 435166 ms
Saving model models/A2Benchmark/synthetic_3.csv.h5
Total Time to proces all the selected files : 438990 ms
A2Benchmark : Avg precision 0.14286 recall 1.00000 f1 0.25000 time to train 435166.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_3.csv  --epochs 20 --n_iter 3 --patience 3 :: took 446 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_40.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 02:57:18 AM MST
2020-11-30 02:57:23.791695: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 02:57:23.810282: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 02:57:23.811187: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55aa85c02740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 02:57:23.811216: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 02:57:23.811333: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_40.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00392/7 [=======>......................] - ETA: 0s - loss: 0.00434/7 [================>.............] - ETA: 0s - loss: 0.00486/7 [========================>.....] - ETA: 0s - loss: 0.00487/7 [==============================] - 0s 32ms/step - loss: 0.0047
1/7 [===>..........................] - ETA: 0s - loss: 0.00313/7 [===========>..................] - ETA: 0s - loss: 0.00545/7 [====================>.........] - ETA: 0s - loss: 0.00577/7 [==============================] - ETA: 0s - loss: 0.00567/7 [==============================] - 0s 28ms/step - loss: 0.0056
1/7 [===>..........................] - ETA: 0s - loss: 0.00263/7 [===========>..................] - ETA: 0s - loss: 0.00495/7 [====================>.........] - ETA: 0s - loss: 0.00807/7 [==============================] - ETA: 0s - loss: 0.00767/7 [==============================] - 0s 34ms/step - loss: 0.0076
1/7 [===>..........................] - ETA: 0s - loss: 0.00463/7 [===========>..................] - ETA: 0s - loss: 0.00605/7 [====================>.........] - ETA: 0s - loss: 0.00867/7 [==============================] - ETA: 0s - loss: 0.00827/7 [==============================] - 0s 35ms/step - loss: 0.0082
1/7 [===>..........................] - ETA: 0s - loss: 0.00873/7 [===========>..................] - ETA: 0s - loss: 0.00705/7 [====================>.........] - ETA: 0s - loss: 0.00697/7 [==============================] - ETA: 0s - loss: 0.00657/7 [==============================] - 0s 27ms/step - loss: 0.0065
1/7 [===>..........................] - ETA: 0s - loss: 0.00414/7 [================>.............] - ETA: 0s - loss: 0.00467/7 [==============================] - ETA: 0s - loss: 0.00457/7 [==============================] - 0s 15ms/step - loss: 0.0045
1/7 [===>..........................] - ETA: 0s - loss: 0.00854/7 [================>.............] - ETA: 0s - loss: 0.01117/7 [==============================] - ETA: 0s - loss: 0.01347/7 [==============================] - 0s 18ms/step - loss: 0.0134
1/7 [===>..........................] - ETA: 0s - loss: 0.00265/7 [====================>.........] - ETA: 0s - loss: 0.00747/7 [==============================] - 0s 13ms/step - loss: 0.0069
1/7 [===>..........................] - ETA: 0s - loss: 0.00345/7 [====================>.........] - ETA: 0s - loss: 0.00727/7 [==============================] - 0s 13ms/step - loss: 0.0069
1/7 [===>..........................] - ETA: 0s - loss: 0.00744/7 [================>.............] - ETA: 0s - loss: 0.00617/7 [==============================] - 0s 16ms/step - loss: 0.0055
1/7 [===>..........................] - ETA: 0s - loss: 0.00393/7 [===========>..................] - ETA: 0s - loss: 0.00465/7 [====================>.........] - ETA: 0s - loss: 0.00487/7 [==============================] - 0s 23ms/step - loss: 0.0047
1/7 [===>..........................] - ETA: 0s - loss: 0.00383/7 [===========>..................] - ETA: 0s - loss: 0.00575/7 [====================>.........] - ETA: 0s - loss: 0.00627/7 [==============================] - ETA: 0s - loss: 0.00607/7 [==============================] - 0s 23ms/step - loss: 0.0060
1/7 [===>..........................] - ETA: 0s - loss: 0.00263/7 [===========>..................] - ETA: 0s - loss: 0.00485/7 [====================>.........] - ETA: 0s - loss: 0.00797/7 [==============================] - ETA: 0s - loss: 0.00747/7 [==============================] - 0s 23ms/step - loss: 0.0074
1/7 [===>..........................] - ETA: 0s - loss: 0.00333/7 [===========>..................] - ETA: 0s - loss: 0.00505/7 [====================>.........] - ETA: 0s - loss: 0.00707/7 [==============================] - ETA: 0s - loss: 0.00687/7 [==============================] - 0s 32ms/step - loss: 0.0068
1/7 [===>..........................] - ETA: 0s - loss: 0.00993/7 [===========>..................] - ETA: 0s - loss: 0.00905/7 [====================>.........] - ETA: 0s - loss: 0.00877/7 [==============================] - ETA: 0s - loss: 0.00897/7 [==============================] - 0s 29ms/step - loss: 0.0089
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.006507422309368849:
Train Score: 0.00573 MSE 0.07571 RMSE
Test Score: 0.00601 MSE 0.07754 RMSE
Deviation Min [5.38782986e-06], Max [0.48210284]
Deviation 99.5th pctile [0.21439292]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,    4]))
Confusion matrix 
[[1390    3]
 [   0    4]]
precision 0.57143, recall 1.00000, f1 0.72727
Time to train: 543523 ms
Saving model models/A2Benchmark/synthetic_40.csv.h5
Total Time to proces all the selected files : 547281 ms
A2Benchmark : Avg precision 0.57143 recall 1.00000 f1 0.72727 time to train 543523.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_40.csv  --epochs 20 --n_iter 3 --patience 3 :: took 553 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_41.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 03:06:36 AM MST
2020-11-30 03:06:42.370967: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 03:06:42.389249: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 03:06:42.390129: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x555c005b4960 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 03:06:42.390157: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 03:06:42.390273: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_41.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 7.8814e-045/7 [====================>.........] - ETA: 0s - loss: 0.0010    7/7 [==============================] - 0s 14ms/step - loss: 9.9456e-04
1/7 [===>..........................] - ETA: 0s - loss: 6.5919e-044/7 [================>.............] - ETA: 0s - loss: 0.0011    7/7 [==============================] - ETA: 0s - loss: 0.00117/7 [==============================] - 0s 16ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 0.00114/7 [================>.............] - ETA: 0s - loss: 0.02007/7 [==============================] - ETA: 0s - loss: 0.01347/7 [==============================] - 0s 17ms/step - loss: 0.0134
1/7 [===>..........................] - ETA: 0s - loss: 0.00375/7 [====================>.........] - ETA: 0s - loss: 0.00907/7 [==============================] - 0s 12ms/step - loss: 0.0077
1/7 [===>..........................] - ETA: 0s - loss: 0.00195/7 [====================>.........] - ETA: 0s - loss: 0.00137/7 [==============================] - 0s 13ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 0.00145/7 [====================>.........] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 13ms/step - loss: 0.0016
1/7 [===>..........................] - ETA: 0s - loss: 6.6741e-046/7 [========================>.....] - ETA: 0s - loss: 0.0011    7/7 [==============================] - 0s 11ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 8.4999e-045/7 [====================>.........] - ETA: 0s - loss: 0.0156    7/7 [==============================] - 0s 14ms/step - loss: 0.0126
1/7 [===>..........................] - ETA: 0s - loss: 0.00214/7 [================>.............] - ETA: 0s - loss: 0.00177/7 [==============================] - 0s 15ms/step - loss: 0.0068
1/7 [===>..........................] - ETA: 0s - loss: 0.00435/7 [====================>.........] - ETA: 0s - loss: 0.00277/7 [==============================] - 0s 14ms/step - loss: 0.0023
1/7 [===>..........................] - ETA: 0s - loss: 0.00173/7 [===========>..................] - ETA: 0s - loss: 0.00336/7 [========================>.....] - ETA: 0s - loss: 0.00297/7 [==============================] - 0s 23ms/step - loss: 0.0029
1/7 [===>..........................] - ETA: 0s - loss: 0.00103/7 [===========>..................] - ETA: 0s - loss: 0.00155/7 [====================>.........] - ETA: 0s - loss: 0.00167/7 [==============================] - ETA: 0s - loss: 0.00177/7 [==============================] - 0s 34ms/step - loss: 0.0017
1/7 [===>..........................] - ETA: 0s - loss: 9.2321e-043/7 [===========>..................] - ETA: 0s - loss: 0.0150    5/7 [====================>.........] - ETA: 0s - loss: 0.01817/7 [==============================] - ETA: 0s - loss: 0.01467/7 [==============================] - 0s 38ms/step - loss: 0.0146
1/7 [===>..........................] - ETA: 0s - loss: 0.00323/7 [===========>..................] - ETA: 0s - loss: 0.00195/7 [====================>.........] - ETA: 0s - loss: 0.00877/7 [==============================] - ETA: 0s - loss: 0.00777/7 [==============================] - 0s 27ms/step - loss: 0.0077
1/7 [===>..........................] - ETA: 0s - loss: 0.00303/7 [===========>..................] - ETA: 0s - loss: 0.00175/7 [====================>.........] - ETA: 0s - loss: 0.00187/7 [==============================] - ETA: 0s - loss: 0.00167/7 [==============================] - 0s 25ms/step - loss: 0.0016
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.004855588590726256:
Train Score: 0.00457 MSE 0.06757 RMSE
Test Score: 0.00227 MSE 0.04766 RMSE
Deviation Min [1.89404523e-05], Max [0.68670855]
Deviation 99.5th pctile [0.54796317]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1388,    9]))
Confusion matrix 
[[1388    0]
 [   2    7]]
precision 1.00000, recall 0.77778, f1 0.87500
Time to train: 287865 ms
Saving model models/A2Benchmark/synthetic_41.csv.h5
Total Time to proces all the selected files : 289967 ms
A2Benchmark : Avg precision 1.00000 recall 0.77778 f1 0.87500 time to train 287865.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_41.csv  --epochs 20 --n_iter 3 --patience 3 :: took 296 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_42.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 03:11:37 AM MST
2020-11-30 03:11:43.767619: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 03:11:43.786218: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 03:11:43.787646: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55a1c080e740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 03:11:43.787695: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 03:11:43.787933: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_42.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00333/7 [===========>..................] - ETA: 0s - loss: 0.00345/7 [====================>.........] - ETA: 0s - loss: 0.00287/7 [==============================] - ETA: 0s - loss: 0.00237/7 [==============================] - 0s 27ms/step - loss: 0.0023
1/7 [===>..........................] - ETA: 0s - loss: 2.4766e-043/7 [===========>..................] - ETA: 0s - loss: 2.0089e-045/7 [====================>.........] - ETA: 0s - loss: 2.0135e-047/7 [==============================] - ETA: 0s - loss: 1.8594e-047/7 [==============================] - 0s 38ms/step - loss: 1.8594e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.0794e-043/7 [===========>..................] - ETA: 0s - loss: 1.4390e-045/7 [====================>.........] - ETA: 0s - loss: 1.5379e-047/7 [==============================] - ETA: 0s - loss: 1.5358e-047/7 [==============================] - 0s 36ms/step - loss: 1.5358e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.7778e-043/7 [===========>..................] - ETA: 0s - loss: 1.5513e-045/7 [====================>.........] - ETA: 0s - loss: 0.0022    7/7 [==============================] - ETA: 0s - loss: 0.00197/7 [==============================] - 0s 26ms/step - loss: 0.0019
1/7 [===>..........................] - ETA: 0s - loss: 2.0085e-043/7 [===========>..................] - ETA: 0s - loss: 4.1630e-045/7 [====================>.........] - ETA: 0s - loss: 8.8121e-047/7 [==============================] - ETA: 0s - loss: 0.0010    7/7 [==============================] - 0s 33ms/step - loss: 0.0010
1/7 [===>..........................] - ETA: 0s - loss: 0.00253/7 [===========>..................] - ETA: 0s - loss: 0.00255/7 [====================>.........] - ETA: 0s - loss: 0.00217/7 [==============================] - ETA: 0s - loss: 0.00177/7 [==============================] - 0s 31ms/step - loss: 0.0017
1/7 [===>..........................] - ETA: 0s - loss: 1.8678e-043/7 [===========>..................] - ETA: 0s - loss: 2.2400e-045/7 [====================>.........] - ETA: 0s - loss: 2.8693e-047/7 [==============================] - ETA: 0s - loss: 2.9492e-047/7 [==============================] - 0s 25ms/step - loss: 2.9492e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.9484e-043/7 [===========>..................] - ETA: 0s - loss: 6.7989e-045/7 [====================>.........] - ETA: 0s - loss: 7.8255e-047/7 [==============================] - ETA: 0s - loss: 7.6765e-047/7 [==============================] - 0s 25ms/step - loss: 7.6765e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.0511e-043/7 [===========>..................] - ETA: 0s - loss: 2.6224e-045/7 [====================>.........] - ETA: 0s - loss: 0.0024    7/7 [==============================] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 26ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 5.3239e-043/7 [===========>..................] - ETA: 0s - loss: 0.0013    5/7 [====================>.........] - ETA: 0s - loss: 0.00227/7 [==============================] - ETA: 0s - loss: 0.00267/7 [==============================] - 0s 36ms/step - loss: 0.0026
1/7 [===>..........................] - ETA: 0s - loss: 0.00175/7 [====================>.........] - ETA: 0s - loss: 0.00157/7 [==============================] - 0s 15ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 1.6811e-045/7 [====================>.........] - ETA: 0s - loss: 1.6809e-047/7 [==============================] - 0s 13ms/step - loss: 1.5901e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.5317e-044/7 [================>.............] - ETA: 0s - loss: 2.5110e-047/7 [==============================] - ETA: 0s - loss: 2.6673e-047/7 [==============================] - 0s 16ms/step - loss: 2.6673e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.06184/7 [================>.............] - ETA: 0s - loss: 0.05987/7 [==============================] - ETA: 0s - loss: 0.06767/7 [==============================] - 0s 15ms/step - loss: 0.0676
1/7 [===>..........................] - ETA: 0s - loss: 2.4311e-044/7 [================>.............] - ETA: 0s - loss: 3.4824e-047/7 [==============================] - 0s 14ms/step - loss: 4.8181e-04
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.0011104253091616556:
Train Score: 0.00088 MSE 0.02959 RMSE
Test Score: 0.00711 MSE 0.08431 RMSE
Deviation Min [1.14849099e-05], Max [0.55490535]
Deviation 99.5th pctile [0.12877606]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,    1]))
Confusion matrix 
[[1390    6]
 [   0    1]]
precision 0.14286, recall 1.00000, f1 0.25000
Time to train: 380326 ms
Saving model models/A2Benchmark/synthetic_42.csv.h5
Total Time to proces all the selected files : 384934 ms
A2Benchmark : Avg precision 0.14286 recall 1.00000 f1 0.25000 time to train 380326.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_42.csv  --epochs 20 --n_iter 3 --patience 3 :: took 392 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_43.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 03:18:14 AM MST
2020-11-30 03:18:19.899140: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 03:18:19.917249: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 03:18:19.918686: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x560628f4d440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 03:18:19.918733: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 03:18:19.918930: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_43.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00833/7 [===========>..................] - ETA: 0s - loss: 0.00685/7 [====================>.........] - ETA: 0s - loss: 0.00587/7 [==============================] - ETA: 0s - loss: 0.00517/7 [==============================] - 0s 28ms/step - loss: 0.0051
1/7 [===>..........................] - ETA: 0s - loss: 0.00303/7 [===========>..................] - ETA: 0s - loss: 0.00365/7 [====================>.........] - ETA: 0s - loss: 0.00407/7 [==============================] - ETA: 0s - loss: 0.00407/7 [==============================] - 0s 29ms/step - loss: 0.0040
1/7 [===>..........................] - ETA: 0s - loss: 0.00353/7 [===========>..................] - ETA: 0s - loss: 0.00285/7 [====================>.........] - ETA: 0s - loss: 0.01037/7 [==============================] - ETA: 0s - loss: 0.00967/7 [==============================] - 0s 30ms/step - loss: 0.0096
1/7 [===>..........................] - ETA: 0s - loss: 0.00333/7 [===========>..................] - ETA: 0s - loss: 0.00365/7 [====================>.........] - ETA: 0s - loss: 0.00957/7 [==============================] - ETA: 0s - loss: 0.00847/7 [==============================] - 0s 33ms/step - loss: 0.0084
1/7 [===>..........................] - ETA: 0s - loss: 0.00623/7 [===========>..................] - ETA: 0s - loss: 0.00455/7 [====================>.........] - ETA: 0s - loss: 0.00417/7 [==============================] - ETA: 0s - loss: 0.00387/7 [==============================] - 0s 22ms/step - loss: 0.0038
1/7 [===>..........................] - ETA: 0s - loss: 0.01255/7 [====================>.........] - ETA: 0s - loss: 0.00867/7 [==============================] - 0s 15ms/step - loss: 0.0078
1/7 [===>..........................] - ETA: 0s - loss: 0.00274/7 [================>.............] - ETA: 0s - loss: 0.00427/7 [==============================] - ETA: 0s - loss: 0.00417/7 [==============================] - 0s 15ms/step - loss: 0.0041
1/7 [===>..........................] - ETA: 0s - loss: 0.00196/7 [========================>.....] - ETA: 0s - loss: 0.00877/7 [==============================] - 0s 10ms/step - loss: 0.0084
1/7 [===>..........................] - ETA: 0s - loss: 0.00295/7 [====================>.........] - ETA: 0s - loss: 0.00917/7 [==============================] - 0s 12ms/step - loss: 0.0081
1/7 [===>..........................] - ETA: 0s - loss: 0.00635/7 [====================>.........] - ETA: 0s - loss: 0.00447/7 [==============================] - 0s 11ms/step - loss: 0.0041
1/7 [===>..........................] - ETA: 0s - loss: 0.00923/7 [===========>..................] - ETA: 0s - loss: 0.00735/7 [====================>.........] - ETA: 0s - loss: 0.00597/7 [==============================] - ETA: 0s - loss: 0.00517/7 [==============================] - 0s 31ms/step - loss: 0.0051
1/7 [===>..........................] - ETA: 0s - loss: 0.00233/7 [===========>..................] - ETA: 0s - loss: 0.00335/7 [====================>.........] - ETA: 0s - loss: 0.00407/7 [==============================] - ETA: 0s - loss: 0.00427/7 [==============================] - 0s 30ms/step - loss: 0.0042
1/7 [===>..........................] - ETA: 0s - loss: 0.00203/7 [===========>..................] - ETA: 0s - loss: 0.00285/7 [====================>.........] - ETA: 0s - loss: 0.01037/7 [==============================] - ETA: 0s - loss: 0.00897/7 [==============================] - 0s 31ms/step - loss: 0.0089
1/7 [===>..........................] - ETA: 0s - loss: 0.00333/7 [===========>..................] - ETA: 0s - loss: 0.00345/7 [====================>.........] - ETA: 0s - loss: 0.00947/7 [==============================] - ETA: 0s - loss: 0.00847/7 [==============================] - 0s 25ms/step - loss: 0.0084
1/7 [===>..........................] - ETA: 0s - loss: 0.01313/7 [===========>..................] - ETA: 0s - loss: 0.01185/7 [====================>.........] - ETA: 0s - loss: 0.00867/7 [==============================] - ETA: 0s - loss: 0.00767/7 [==============================] - 0s 32ms/step - loss: 0.0076
Best parameters {'n_units': 48, 'n_hidden': 2} best score 0.006157273799180985:
Train Score: 0.00550 MSE 0.07415 RMSE
Test Score: 0.00421 MSE 0.06487 RMSE
Deviation Min [5.67454168e-05], Max [0.77439907]
Deviation 99.5th pctile [0.16270023]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,    4]))
Confusion matrix 
[[1390    3]
 [   0    4]]
precision 0.57143, recall 1.00000, f1 0.72727
Time to train: 295335 ms
Saving model models/A2Benchmark/synthetic_43.csv.h5
Total Time to proces all the selected files : 298959 ms
A2Benchmark : Avg precision 0.57143 recall 1.00000 f1 0.72727 time to train 295335.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_43.csv  --epochs 20 --n_iter 3 --patience 3 :: took 305 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_44.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 03:23:24 AM MST
2020-11-30 03:23:30.055681: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 03:23:30.074229: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 03:23:30.075847: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56319c9f9440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 03:23:30.075914: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 03:23:30.076114: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_44.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 9.2787e-044/7 [================>.............] - ETA: 0s - loss: 7.2048e-047/7 [==============================] - ETA: 0s - loss: 6.5774e-047/7 [==============================] - 0s 19ms/step - loss: 6.5774e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.1903e-044/7 [================>.............] - ETA: 0s - loss: 0.0011    5/7 [====================>.........] - ETA: 0s - loss: 9.6317e-047/7 [==============================] - 0s 27ms/step - loss: 9.0095e-04
1/7 [===>..........................] - ETA: 0s - loss: 9.5885e-046/7 [========================>.....] - ETA: 0s - loss: 0.0115    7/7 [==============================] - 0s 10ms/step - loss: 0.0111
1/7 [===>..........................] - ETA: 0s - loss: 0.00264/7 [================>.............] - ETA: 0s - loss: 0.00197/7 [==============================] - ETA: 0s - loss: 0.00637/7 [==============================] - 0s 17ms/step - loss: 0.0063
1/7 [===>..........................] - ETA: 0s - loss: 0.00275/7 [====================>.........] - ETA: 0s - loss: 0.00157/7 [==============================] - 0s 12ms/step - loss: 0.0017
1/7 [===>..........................] - ETA: 0s - loss: 0.00323/7 [===========>..................] - ETA: 0s - loss: 0.00164/7 [================>.............] - ETA: 0s - loss: 0.00135/7 [====================>.........] - ETA: 0s - loss: 0.00137/7 [==============================] - ETA: 0s - loss: 0.00137/7 [==============================] - 0s 38ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 4.3329e-043/7 [===========>..................] - ETA: 0s - loss: 0.0011    5/7 [====================>.........] - ETA: 0s - loss: 9.3761e-047/7 [==============================] - ETA: 0s - loss: 8.6332e-047/7 [==============================] - 0s 23ms/step - loss: 8.6332e-04
1/7 [===>..........................] - ETA: 0s - loss: 9.4188e-043/7 [===========>..................] - ETA: 0s - loss: 0.0127    5/7 [====================>.........] - ETA: 0s - loss: 0.01517/7 [==============================] - ETA: 0s - loss: 0.01217/7 [==============================] - 0s 29ms/step - loss: 0.0121
1/7 [===>..........................] - ETA: 0s - loss: 0.00123/7 [===========>..................] - ETA: 0s - loss: 0.00105/7 [====================>.........] - ETA: 0s - loss: 0.00667/7 [==============================] - ETA: 0s - loss: 0.00587/7 [==============================] - 0s 28ms/step - loss: 0.0058
1/7 [===>..........................] - ETA: 0s - loss: 0.00153/7 [===========>..................] - ETA: 0s - loss: 0.00105/7 [====================>.........] - ETA: 0s - loss: 8.4265e-047/7 [==============================] - ETA: 0s - loss: 9.1455e-047/7 [==============================] - 0s 23ms/step - loss: 9.1455e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00653/7 [===========>..................] - ETA: 0s - loss: 0.00315/7 [====================>.........] - ETA: 0s - loss: 0.00247/7 [==============================] - ETA: 0s - loss: 0.00247/7 [==============================] - 0s 26ms/step - loss: 0.0024
1/7 [===>..........................] - ETA: 0s - loss: 3.9082e-043/7 [===========>..................] - ETA: 0s - loss: 0.0010    5/7 [====================>.........] - ETA: 0s - loss: 8.8365e-047/7 [==============================] - ETA: 0s - loss: 8.1860e-047/7 [==============================] - 0s 34ms/step - loss: 8.1860e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.6511e-043/7 [===========>..................] - ETA: 0s - loss: 0.0118    5/7 [====================>.........] - ETA: 0s - loss: 0.01517/7 [==============================] - ETA: 0s - loss: 0.01217/7 [==============================] - 0s 36ms/step - loss: 0.0121
1/7 [===>..........................] - ETA: 0s - loss: 9.5652e-043/7 [===========>..................] - ETA: 0s - loss: 8.2814e-045/7 [====================>.........] - ETA: 0s - loss: 0.0065    7/7 [==============================] - ETA: 0s - loss: 0.00567/7 [==============================] - 0s 29ms/step - loss: 0.0056
1/7 [===>..........................] - ETA: 0s - loss: 0.00493/7 [===========>..................] - ETA: 0s - loss: 0.00345/7 [====================>.........] - ETA: 0s - loss: 0.00267/7 [==============================] - ETA: 0s - loss: 0.00307/7 [==============================] - 0s 32ms/step - loss: 0.0030
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.004129683517385274:
Train Score: 0.00376 MSE 0.06128 RMSE
Test Score: 0.00231 MSE 0.04806 RMSE
Deviation Min [2.63084298e-05], Max [0.62445471]
Deviation 99.5th pctile [0.49006974]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1388,    9]))
Confusion matrix 
[[1388    0]
 [   2    7]]
precision 1.00000, recall 0.77778, f1 0.87500
Time to train: 363004 ms
Saving model models/A2Benchmark/synthetic_44.csv.h5
Total Time to proces all the selected files : 365448 ms
A2Benchmark : Avg precision 1.00000 recall 0.77778 f1 0.87500 time to train 363004.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_44.csv  --epochs 20 --n_iter 3 --patience 3 :: took 371 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_45.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 03:29:41 AM MST
2020-11-30 03:29:46.641837: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 03:29:46.660238: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 03:29:46.661934: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55b384f99740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 03:29:46.661994: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 03:29:46.662218: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_45.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00755/7 [====================>.........] - ETA: 0s - loss: 0.00687/7 [==============================] - 0s 12ms/step - loss: 0.0067
1/7 [===>..........................] - ETA: 0s - loss: 0.00804/7 [================>.............] - ETA: 0s - loss: 0.00647/7 [==============================] - ETA: 0s - loss: 0.00747/7 [==============================] - 0s 15ms/step - loss: 0.0074
1/7 [===>..........................] - ETA: 0s - loss: 0.00595/7 [====================>.........] - ETA: 0s - loss: 0.00637/7 [==============================] - 0s 12ms/step - loss: 0.0064
1/7 [===>..........................] - ETA: 0s - loss: 0.00734/7 [================>.............] - ETA: 0s - loss: 0.00787/7 [==============================] - 0s 14ms/step - loss: 0.0086
1/7 [===>..........................] - ETA: 0s - loss: 0.01114/7 [================>.............] - ETA: 0s - loss: 0.00677/7 [==============================] - ETA: 0s - loss: 0.00687/7 [==============================] - 0s 15ms/step - loss: 0.0068
1/7 [===>..........................] - ETA: 0s - loss: 0.00853/7 [===========>..................] - ETA: 0s - loss: 0.00745/7 [====================>.........] - ETA: 0s - loss: 0.00707/7 [==============================] - ETA: 0s - loss: 0.00707/7 [==============================] - 0s 28ms/step - loss: 0.0070
1/7 [===>..........................] - ETA: 0s - loss: 0.00673/7 [===========>..................] - ETA: 0s - loss: 0.00625/7 [====================>.........] - ETA: 0s - loss: 0.00717/7 [==============================] - ETA: 0s - loss: 0.00657/7 [==============================] - 0s 38ms/step - loss: 0.0065
1/7 [===>..........................] - ETA: 0s - loss: 0.00393/7 [===========>..................] - ETA: 0s - loss: 0.00535/7 [====================>.........] - ETA: 0s - loss: 0.00577/7 [==============================] - ETA: 0s - loss: 0.00577/7 [==============================] - 0s 32ms/step - loss: 0.0057
1/7 [===>..........................] - ETA: 0s - loss: 0.00713/7 [===========>..................] - ETA: 0s - loss: 0.00785/7 [====================>.........] - ETA: 0s - loss: 0.00907/7 [==============================] - ETA: 0s - loss: 0.00857/7 [==============================] - 0s 30ms/step - loss: 0.0085
1/7 [===>..........................] - ETA: 0s - loss: 0.01643/7 [===========>..................] - ETA: 0s - loss: 0.00975/7 [====================>.........] - ETA: 0s - loss: 0.00867/7 [==============================] - ETA: 0s - loss: 0.00957/7 [==============================] - 0s 32ms/step - loss: 0.0095
1/7 [===>..........................] - ETA: 0s - loss: 0.00653/7 [===========>..................] - ETA: 0s - loss: 0.00555/7 [====================>.........] - ETA: 0s - loss: 0.00557/7 [==============================] - ETA: 0s - loss: 0.00537/7 [==============================] - 0s 29ms/step - loss: 0.0053
1/7 [===>..........................] - ETA: 0s - loss: 0.00753/7 [===========>..................] - ETA: 0s - loss: 0.00685/7 [====================>.........] - ETA: 0s - loss: 0.00837/7 [==============================] - ETA: 0s - loss: 0.00757/7 [==============================] - 0s 34ms/step - loss: 0.0075
1/7 [===>..........................] - ETA: 0s - loss: 0.00653/7 [===========>..................] - ETA: 0s - loss: 0.00695/7 [====================>.........] - ETA: 0s - loss: 0.00757/7 [==============================] - 0s 29ms/step - loss: 0.0074
1/7 [===>..........................] - ETA: 0s - loss: 0.00703/7 [===========>..................] - ETA: 0s - loss: 0.00715/7 [====================>.........] - ETA: 0s - loss: 0.00867/7 [==============================] - ETA: 0s - loss: 0.00817/7 [==============================] - 0s 28ms/step - loss: 0.0081
1/7 [===>..........................] - ETA: 0s - loss: 0.00913/7 [===========>..................] - ETA: 0s - loss: 0.00625/7 [====================>.........] - ETA: 0s - loss: 0.00607/7 [==============================] - 0s 23ms/step - loss: 0.0059
Best parameters {'n_units': 48, 'n_hidden': 2} best score 0.006842242367565632:
Train Score: 0.00585 MSE 0.07646 RMSE
Test Score: 0.00528 MSE 0.07265 RMSE
Deviation Min [2.54033628e-05], Max [0.5574605]
Deviation 99.5th pctile [0.19965773]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,    1]))
Confusion matrix 
[[1390    6]
 [   0    1]]
precision 0.14286, recall 1.00000, f1 0.25000
Time to train: 471850 ms
Saving model models/A2Benchmark/synthetic_45.csv.h5
Total Time to proces all the selected files : 475694 ms
A2Benchmark : Avg precision 0.14286 recall 1.00000 f1 0.25000 time to train 471850.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_45.csv  --epochs 20 --n_iter 3 --patience 3 :: took 481 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_46.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 03:37:47 AM MST
2020-11-30 03:37:54.198232: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 03:37:54.217238: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 03:37:54.218806: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f98d3b5740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 03:37:54.218899: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 03:37:54.219107: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_46.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00145/7 [====================>.........] - ETA: 0s - loss: 0.00197/7 [==============================] - 0s 12ms/step - loss: 0.0017
1/7 [===>..........................] - ETA: 0s - loss: 0.00155/7 [====================>.........] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 12ms/step - loss: 0.0017
1/7 [===>..........................] - ETA: 0s - loss: 0.00415/7 [====================>.........] - ETA: 0s - loss: 0.00697/7 [==============================] - 0s 11ms/step - loss: 0.0058
1/7 [===>..........................] - ETA: 0s - loss: 8.8093e-045/7 [====================>.........] - ETA: 0s - loss: 0.0052    7/7 [==============================] - 0s 12ms/step - loss: 0.0046
1/7 [===>..........................] - ETA: 0s - loss: 0.00325/7 [====================>.........] - ETA: 0s - loss: 0.00237/7 [==============================] - 0s 15ms/step - loss: 0.0021
1/7 [===>..........................] - ETA: 0s - loss: 0.00134/7 [================>.............] - ETA: 0s - loss: 0.00246/7 [========================>.....] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 25ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 0.00124/7 [================>.............] - ETA: 0s - loss: 0.00207/7 [==============================] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 17ms/step - loss: 0.0018
1/7 [===>..........................] - ETA: 0s - loss: 0.00244/7 [================>.............] - ETA: 0s - loss: 0.00717/7 [==============================] - ETA: 0s - loss: 0.00517/7 [==============================] - 0s 18ms/step - loss: 0.0051
1/7 [===>..........................] - ETA: 0s - loss: 8.9142e-045/7 [====================>.........] - ETA: 0s - loss: 0.0053    7/7 [==============================] - 0s 13ms/step - loss: 0.0048
1/7 [===>..........................] - ETA: 0s - loss: 0.00355/7 [====================>.........] - ETA: 0s - loss: 0.00237/7 [==============================] - 0s 13ms/step - loss: 0.0021
1/7 [===>..........................] - ETA: 0s - loss: 0.00143/7 [===========>..................] - ETA: 0s - loss: 0.00305/7 [====================>.........] - ETA: 0s - loss: 0.00287/7 [==============================] - 0s 25ms/step - loss: 0.0025
1/7 [===>..........................] - ETA: 0s - loss: 0.00243/7 [===========>..................] - ETA: 0s - loss: 0.00225/7 [====================>.........] - ETA: 0s - loss: 0.00237/7 [==============================] - 0s 22ms/step - loss: 0.0022
1/7 [===>..........................] - ETA: 0s - loss: 0.00423/7 [===========>..................] - ETA: 0s - loss: 0.00235/7 [====================>.........] - ETA: 0s - loss: 0.00727/7 [==============================] - ETA: 0s - loss: 0.00617/7 [==============================] - 0s 23ms/step - loss: 0.0061
1/7 [===>..........................] - ETA: 0s - loss: 0.00113/7 [===========>..................] - ETA: 0s - loss: 0.00225/7 [====================>.........] - ETA: 0s - loss: 0.00557/7 [==============================] - 0s 28ms/step - loss: 0.0049
1/7 [===>..........................] - ETA: 0s - loss: 0.00503/7 [===========>..................] - ETA: 0s - loss: 0.00305/7 [====================>.........] - ETA: 0s - loss: 0.00307/7 [==============================] - ETA: 0s - loss: 0.00287/7 [==============================] - 0s 23ms/step - loss: 0.0028
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.003174827643670142:
Train Score: 0.00289 MSE 0.05379 RMSE
Test Score: 0.00194 MSE 0.04404 RMSE
Deviation Min [4.02847863e-05], Max [0.61537617]
Deviation 99.5th pctile [0.1156099]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,    4]))
Confusion matrix 
[[1390    3]
 [   0    4]]
precision 0.57143, recall 1.00000, f1 0.72727
Time to train: 402447 ms
Saving model models/A2Benchmark/synthetic_46.csv.h5
Total Time to proces all the selected files : 404500 ms
A2Benchmark : Avg precision 0.57143 recall 1.00000 f1 0.72727 time to train 402447.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_46.csv  --epochs 20 --n_iter 3 --patience 3 :: took 412 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_47.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 03:44:44 AM MST
2020-11-30 03:44:49.886840: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 03:44:49.905222: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 03:44:49.906121: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5631fecb7440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 03:44:49.906149: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 03:44:49.906268: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_47.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00153/7 [===========>..................] - ETA: 0s - loss: 0.00235/7 [====================>.........] - ETA: 0s - loss: 0.00247/7 [==============================] - ETA: 0s - loss: 0.00247/7 [==============================] - 0s 25ms/step - loss: 0.0024
1/7 [===>..........................] - ETA: 0s - loss: 0.00283/7 [===========>..................] - ETA: 0s - loss: 0.00325/7 [====================>.........] - ETA: 0s - loss: 0.00357/7 [==============================] - ETA: 0s - loss: 0.00347/7 [==============================] - 0s 31ms/step - loss: 0.0034
1/7 [===>..........................] - ETA: 0s - loss: 0.00223/7 [===========>..................] - ETA: 0s - loss: 0.01475/7 [====================>.........] - ETA: 0s - loss: 0.01757/7 [==============================] - ETA: 0s - loss: 0.01437/7 [==============================] - 0s 29ms/step - loss: 0.0143
1/7 [===>..........................] - ETA: 0s - loss: 0.00173/7 [===========>..................] - ETA: 0s - loss: 0.00255/7 [====================>.........] - ETA: 0s - loss: 0.00837/7 [==============================] - ETA: 0s - loss: 0.00747/7 [==============================] - 0s 31ms/step - loss: 0.0074
1/7 [===>..........................] - ETA: 0s - loss: 0.02473/7 [===========>..................] - ETA: 0s - loss: 0.01745/7 [====================>.........] - ETA: 0s - loss: 0.01947/7 [==============================] - ETA: 0s - loss: 0.01897/7 [==============================] - 0s 31ms/step - loss: 0.0189
1/7 [===>..........................] - ETA: 0s - loss: 0.00146/7 [========================>.....] - ETA: 0s - loss: 0.00217/7 [==============================] - 0s 10ms/step - loss: 0.0021
1/7 [===>..........................] - ETA: 0s - loss: 0.00124/7 [================>.............] - ETA: 0s - loss: 0.00227/7 [==============================] - ETA: 0s - loss: 0.00227/7 [==============================] - 0s 17ms/step - loss: 0.0022
1/7 [===>..........................] - ETA: 0s - loss: 0.00124/7 [================>.............] - ETA: 0s - loss: 0.01877/7 [==============================] - ETA: 0s - loss: 0.01297/7 [==============================] - 0s 18ms/step - loss: 0.0129
1/7 [===>..........................] - ETA: 0s - loss: 0.00145/7 [====================>.........] - ETA: 0s - loss: 0.00737/7 [==============================] - 0s 16ms/step - loss: 0.0065
1/7 [===>..........................] - ETA: 0s - loss: 0.00474/7 [================>.............] - ETA: 0s - loss: 0.00307/7 [==============================] - ETA: 0s - loss: 0.00297/7 [==============================] - 0s 19ms/step - loss: 0.0029
1/7 [===>..........................] - ETA: 0s - loss: 0.00153/7 [===========>..................] - ETA: 0s - loss: 0.00215/7 [====================>.........] - ETA: 0s - loss: 0.00237/7 [==============================] - ETA: 0s - loss: 0.00227/7 [==============================] - 0s 29ms/step - loss: 0.0022
1/7 [===>..........................] - ETA: 0s - loss: 0.00193/7 [===========>..................] - ETA: 0s - loss: 0.00245/7 [====================>.........] - ETA: 0s - loss: 0.00267/7 [==============================] - 0s 25ms/step - loss: 0.0026
1/7 [===>..........................] - ETA: 0s - loss: 0.00163/7 [===========>..................] - ETA: 0s - loss: 0.01455/7 [====================>.........] - ETA: 0s - loss: 0.01677/7 [==============================] - ETA: 0s - loss: 0.01377/7 [==============================] - 0s 28ms/step - loss: 0.0137
1/7 [===>..........................] - ETA: 0s - loss: 0.00193/7 [===========>..................] - ETA: 0s - loss: 0.00265/7 [====================>.........] - ETA: 0s - loss: 0.00847/7 [==============================] - 0s 28ms/step - loss: 0.0075
1/7 [===>..........................] - ETA: 0s - loss: 0.00473/7 [===========>..................] - ETA: 0s - loss: 0.00305/7 [====================>.........] - ETA: 0s - loss: 0.00317/7 [==============================] - ETA: 0s - loss: 0.00287/7 [==============================] - 0s 31ms/step - loss: 0.0028
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.005304077593609691:
Train Score: 0.00483 MSE 0.06948 RMSE
Test Score: 0.00244 MSE 0.04941 RMSE
Deviation Min [5.02378703e-06], Max [0.64064592]
Deviation 99.5th pctile [0.5038332]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1388,    9]))
Confusion matrix 
[[1388    0]
 [   2    7]]
precision 1.00000, recall 0.77778, f1 0.87500
Time to train: 410840 ms
Saving model models/A2Benchmark/synthetic_47.csv.h5
Total Time to proces all the selected files : 413068 ms
A2Benchmark : Avg precision 1.00000 recall 0.77778 f1 0.87500 time to train 410840.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_47.csv  --epochs 20 --n_iter 3 --patience 3 :: took 419 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_48.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 03:51:48 AM MST
2020-11-30 03:51:53.991225: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 03:51:54.010261: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 03:51:54.011905: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5590a59e6440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 03:51:54.011960: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 03:51:54.012186: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_48.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00215/7 [====================>.........] - ETA: 0s - loss: 0.00237/7 [==============================] - 0s 12ms/step - loss: 0.0021
1/7 [===>..........................] - ETA: 0s - loss: 0.00174/7 [================>.............] - ETA: 0s - loss: 0.00187/7 [==============================] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 18ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 0.00134/7 [================>.............] - ETA: 0s - loss: 0.00197/7 [==============================] - 0s 16ms/step - loss: 0.0019
1/7 [===>..........................] - ETA: 0s - loss: 0.00374/7 [================>.............] - ETA: 0s - loss: 0.00297/7 [==============================] - ETA: 0s - loss: 0.00377/7 [==============================] - 0s 18ms/step - loss: 0.0037
1/7 [===>..........................] - ETA: 0s - loss: 0.00294/7 [================>.............] - ETA: 0s - loss: 0.00217/7 [==============================] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 18ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 0.00303/7 [===========>..................] - ETA: 0s - loss: 0.00295/7 [====================>.........] - ETA: 0s - loss: 0.00307/7 [==============================] - ETA: 0s - loss: 0.00277/7 [==============================] - 0s 32ms/step - loss: 0.0027
1/7 [===>..........................] - ETA: 0s - loss: 0.00183/7 [===========>..................] - ETA: 0s - loss: 0.00185/7 [====================>.........] - ETA: 0s - loss: 0.00217/7 [==============================] - ETA: 0s - loss: 0.00217/7 [==============================] - 0s 28ms/step - loss: 0.0021
1/7 [===>..........................] - ETA: 0s - loss: 0.00173/7 [===========>..................] - ETA: 0s - loss: 0.00205/7 [====================>.........] - ETA: 0s - loss: 0.00237/7 [==============================] - ETA: 0s - loss: 0.00237/7 [==============================] - 0s 27ms/step - loss: 0.0023
1/7 [===>..........................] - ETA: 0s - loss: 0.00433/7 [===========>..................] - ETA: 0s - loss: 0.00275/7 [====================>.........] - ETA: 0s - loss: 0.00447/7 [==============================] - ETA: 0s - loss: 0.00407/7 [==============================] - 0s 38ms/step - loss: 0.0040
1/7 [===>..........................] - ETA: 0s - loss: 0.00723/7 [===========>..................] - ETA: 0s - loss: 0.00405/7 [====================>.........] - ETA: 0s - loss: 0.00457/7 [==============================] - ETA: 0s - loss: 0.00417/7 [==============================] - 0s 36ms/step - loss: 0.0041
1/7 [===>..........................] - ETA: 0s - loss: 0.00256/7 [========================>.....] - ETA: 0s - loss: 0.00247/7 [==============================] - 0s 10ms/step - loss: 0.0023
1/7 [===>..........................] - ETA: 0s - loss: 0.00166/7 [========================>.....] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 10ms/step - loss: 0.0018
1/7 [===>..........................] - ETA: 0s - loss: 0.00135/7 [====================>.........] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 12ms/step - loss: 0.0019
1/7 [===>..........................] - ETA: 0s - loss: 0.00254/7 [================>.............] - ETA: 0s - loss: 0.00227/7 [==============================] - ETA: 0s - loss: 0.00327/7 [==============================] - 0s 15ms/step - loss: 0.0032
1/7 [===>..........................] - ETA: 0s - loss: 0.00295/7 [====================>.........] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 11ms/step - loss: 0.0019
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.002241414925083518:
Train Score: 0.00223 MSE 0.04719 RMSE
Test Score: 0.00336 MSE 0.05799 RMSE
Deviation Min [5.41948013e-06], Max [0.43182051]
Deviation 99.5th pctile [0.12945027]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,    1]))
Confusion matrix 
[[1390    6]
 [   0    1]]
precision 0.14286, recall 1.00000, f1 0.25000
Time to train: 345327 ms
Saving model models/A2Benchmark/synthetic_48.csv.h5
Total Time to proces all the selected files : 347246 ms
A2Benchmark : Avg precision 0.14286 recall 1.00000 f1 0.25000 time to train 345327.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_48.csv  --epochs 20 --n_iter 3 --patience 3 :: took 353 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_49.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 03:57:46 AM MST
2020-11-30 03:57:52.343560: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 03:57:52.362265: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 03:57:52.363787: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5644685bc740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 03:57:52.363839: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 03:57:52.364049: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_49.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 2.8331e-044/7 [================>.............] - ETA: 0s - loss: 2.7225e-047/7 [==============================] - ETA: 0s - loss: 2.0613e-047/7 [==============================] - 0s 16ms/step - loss: 2.0613e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.6103e-055/7 [====================>.........] - ETA: 0s - loss: 8.9896e-057/7 [==============================] - 0s 13ms/step - loss: 9.3240e-05
1/7 [===>..........................] - ETA: 0s - loss: 6.3257e-056/7 [========================>.....] - ETA: 0s - loss: 0.0059    7/7 [==============================] - 0s 12ms/step - loss: 0.0056
1/7 [===>..........................] - ETA: 0s - loss: 3.3417e-044/7 [================>.............] - ETA: 0s - loss: 3.2818e-047/7 [==============================] - ETA: 0s - loss: 0.0059    7/7 [==============================] - 0s 17ms/step - loss: 0.0059
1/7 [===>..........................] - ETA: 0s - loss: 9.7208e-055/7 [====================>.........] - ETA: 0s - loss: 1.8950e-047/7 [==============================] - 0s 13ms/step - loss: 2.0268e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00185/7 [====================>.........] - ETA: 0s - loss: 0.00157/7 [==============================] - 0s 14ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 3.8960e-055/7 [====================>.........] - ETA: 0s - loss: 7.3784e-057/7 [==============================] - 0s 13ms/step - loss: 7.5339e-05
1/7 [===>..........................] - ETA: 0s - loss: 2.5896e-045/7 [====================>.........] - ETA: 0s - loss: 0.0072    7/7 [==============================] - 0s 12ms/step - loss: 0.0058
1/7 [===>..........................] - ETA: 0s - loss: 5.3073e-054/7 [================>.............] - ETA: 0s - loss: 7.3355e-057/7 [==============================] - ETA: 0s - loss: 0.0054    7/7 [==============================] - 0s 16ms/step - loss: 0.0054
1/7 [===>..........................] - ETA: 0s - loss: 1.4806e-045/7 [====================>.........] - ETA: 0s - loss: 1.0871e-047/7 [==============================] - 0s 12ms/step - loss: 1.0859e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.0372e-043/7 [===========>..................] - ETA: 0s - loss: 5.2636e-045/7 [====================>.........] - ETA: 0s - loss: 4.1344e-047/7 [==============================] - ETA: 0s - loss: 3.3846e-047/7 [==============================] - 0s 23ms/step - loss: 3.3846e-04
1/7 [===>..........................] - ETA: 0s - loss: 6.0382e-053/7 [===========>..................] - ETA: 0s - loss: 8.0549e-055/7 [====================>.........] - ETA: 0s - loss: 8.0244e-057/7 [==============================] - ETA: 0s - loss: 7.7787e-057/7 [==============================] - 0s 34ms/step - loss: 7.7787e-05
1/7 [===>..........................] - ETA: 0s - loss: 6.4623e-053/7 [===========>..................] - ETA: 0s - loss: 1.1943e-045/7 [====================>.........] - ETA: 0s - loss: 0.0072    7/7 [==============================] - ETA: 0s - loss: 0.00587/7 [==============================] - 0s 34ms/step - loss: 0.0058
1/7 [===>..........................] - ETA: 0s - loss: 6.0769e-043/7 [===========>..................] - ETA: 0s - loss: 5.5535e-045/7 [====================>.........] - ETA: 0s - loss: 0.0076    7/7 [==============================] - ETA: 0s - loss: 0.00637/7 [==============================] - 0s 30ms/step - loss: 0.0063
1/7 [===>..........................] - ETA: 0s - loss: 3.6282e-043/7 [===========>..................] - ETA: 0s - loss: 2.9579e-045/7 [====================>.........] - ETA: 0s - loss: 2.3097e-046/7 [========================>.....] - ETA: 0s - loss: 2.0724e-047/7 [==============================] - 0s 31ms/step - loss: 2.0851e-04
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0023929012750159018:
Train Score: 0.00209 MSE 0.04575 RMSE
Test Score: 0.00112 MSE 0.03342 RMSE
Deviation Min [3.27942448e-06], Max [0.73008388]
Deviation 99.5th pctile [0.1219987]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,    4]))
Confusion matrix 
[[1390    3]
 [   0    4]]
precision 0.57143, recall 1.00000, f1 0.72727
Time to train: 249503 ms
Saving model models/A2Benchmark/synthetic_49.csv.h5
Total Time to proces all the selected files : 251758 ms
A2Benchmark : Avg precision 0.57143 recall 1.00000 f1 0.72727 time to train 249503.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_49.csv  --epochs 20 --n_iter 3 --patience 3 :: took 258 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_4.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 04:02:09 AM MST
2020-11-30 04:02:15.193288: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 04:02:15.212236: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 04:02:15.213126: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5572e6da7740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 04:02:15.213155: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 04:02:15.213278: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_4.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 7.6841e-045/7 [====================>.........] - ETA: 0s - loss: 0.0010    7/7 [==============================] - 0s 14ms/step - loss: 9.0132e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.2988e-044/7 [================>.............] - ETA: 0s - loss: 8.6049e-047/7 [==============================] - ETA: 0s - loss: 7.3561e-047/7 [==============================] - 0s 18ms/step - loss: 7.3561e-04
1/7 [===>..........................] - ETA: 0s - loss: 7.5525e-044/7 [================>.............] - ETA: 0s - loss: 0.0034    7/7 [==============================] - ETA: 0s - loss: 0.00257/7 [==============================] - 0s 18ms/step - loss: 0.0025
1/7 [===>..........................] - ETA: 0s - loss: 3.1468e-045/7 [====================>.........] - ETA: 0s - loss: 0.0028    7/7 [==============================] - 0s 13ms/step - loss: 0.0025
1/7 [===>..........................] - ETA: 0s - loss: 0.00165/7 [====================>.........] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 13ms/step - loss: 0.0024
1/7 [===>..........................] - ETA: 0s - loss: 0.00124/7 [================>.............] - ETA: 0s - loss: 9.3287e-047/7 [==============================] - ETA: 0s - loss: 9.0791e-047/7 [==============================] - 0s 16ms/step - loss: 9.0791e-04
1/7 [===>..........................] - ETA: 0s - loss: 6.4449e-045/7 [====================>.........] - ETA: 0s - loss: 7.7003e-047/7 [==============================] - 0s 13ms/step - loss: 7.8157e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.9388e-045/7 [====================>.........] - ETA: 0s - loss: 0.0029    7/7 [==============================] - 0s 12ms/step - loss: 0.0024
1/7 [===>..........................] - ETA: 0s - loss: 1.8400e-044/7 [================>.............] - ETA: 0s - loss: 2.5458e-047/7 [==============================] - ETA: 0s - loss: 0.0023    7/7 [==============================] - 0s 16ms/step - loss: 0.0023
1/7 [===>..........................] - ETA: 0s - loss: 0.00104/7 [================>.............] - ETA: 0s - loss: 0.00247/7 [==============================] - 0s 13ms/step - loss: 0.0029
1/7 [===>..........................] - ETA: 0s - loss: 1.9392e-043/7 [===========>..................] - ETA: 0s - loss: 3.8029e-045/7 [====================>.........] - ETA: 0s - loss: 4.0470e-047/7 [==============================] - ETA: 0s - loss: 3.5683e-047/7 [==============================] - 0s 27ms/step - loss: 3.5683e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.3618e-043/7 [===========>..................] - ETA: 0s - loss: 2.6549e-045/7 [====================>.........] - ETA: 0s - loss: 2.8458e-047/7 [==============================] - ETA: 0s - loss: 2.7125e-047/7 [==============================] - 0s 23ms/step - loss: 2.7125e-04
1/7 [===>..........................] - ETA: 0s - loss: 6.4524e-043/7 [===========>..................] - ETA: 0s - loss: 6.3090e-045/7 [====================>.........] - ETA: 0s - loss: 0.0033    7/7 [==============================] - 0s 22ms/step - loss: 0.0028
1/7 [===>..........................] - ETA: 0s - loss: 6.2457e-043/7 [===========>..................] - ETA: 0s - loss: 9.4942e-045/7 [====================>.........] - ETA: 0s - loss: 0.0034    7/7 [==============================] - ETA: 0s - loss: 0.00337/7 [==============================] - 0s 34ms/step - loss: 0.0033
1/7 [===>..........................] - ETA: 0s - loss: 3.6042e-043/7 [===========>..................] - ETA: 0s - loss: 2.8422e-045/7 [====================>.........] - ETA: 0s - loss: 2.7519e-047/7 [==============================] - ETA: 0s - loss: 3.0079e-047/7 [==============================] - 0s 26ms/step - loss: 3.0079e-04
Best parameters {'n_units': 48, 'n_hidden': 2} best score 0.0013974914909340441:
Train Score: 0.00131 MSE 0.03617 RMSE
Test Score: 0.00191 MSE 0.04366 RMSE
Deviation Min [5.8158151e-06], Max [0.4580138]
Deviation 99.5th pctile [0.10397508]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,    4]))
Confusion matrix 
[[1390    3]
 [   0    4]]
precision 0.57143, recall 1.00000, f1 0.72727
Time to train: 400165 ms
Saving model models/A2Benchmark/synthetic_4.csv.h5
Total Time to proces all the selected files : 403620 ms
A2Benchmark : Avg precision 0.57143 recall 1.00000 f1 0.72727 time to train 400165.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_4.csv  --epochs 20 --n_iter 3 --patience 3 :: took 410 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_50.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 04:09:04 AM MST
2020-11-30 04:09:09.842052: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 04:09:09.860226: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 04:09:09.861603: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55764ead9440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 04:09:09.861651: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 04:09:09.861841: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_50.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.01133/7 [===========>..................] - ETA: 0s - loss: 0.00945/7 [====================>.........] - ETA: 0s - loss: 0.00897/7 [==============================] - ETA: 0s - loss: 0.00837/7 [==============================] - 0s 24ms/step - loss: 0.0083
1/7 [===>..........................] - ETA: 0s - loss: 0.00303/7 [===========>..................] - ETA: 0s - loss: 0.00435/7 [====================>.........] - ETA: 0s - loss: 0.00537/7 [==============================] - ETA: 0s - loss: 0.00547/7 [==============================] - 0s 31ms/step - loss: 0.0054
1/7 [===>..........................] - ETA: 0s - loss: 0.00293/7 [===========>..................] - ETA: 0s - loss: 0.01185/7 [====================>.........] - ETA: 0s - loss: 0.01417/7 [==============================] - ETA: 0s - loss: 0.01227/7 [==============================] - 0s 29ms/step - loss: 0.0122
1/7 [===>..........................] - ETA: 0s - loss: 0.00763/7 [===========>..................] - ETA: 0s - loss: 0.00575/7 [====================>.........] - ETA: 0s - loss: 0.00877/7 [==============================] - ETA: 0s - loss: 0.00817/7 [==============================] - 0s 26ms/step - loss: 0.0081
1/7 [===>..........................] - ETA: 0s - loss: 0.01023/7 [===========>..................] - ETA: 0s - loss: 0.00775/7 [====================>.........] - ETA: 0s - loss: 0.00627/7 [==============================] - ETA: 0s - loss: 0.00587/7 [==============================] - 0s 26ms/step - loss: 0.0058
1/7 [===>..........................] - ETA: 0s - loss: 0.00653/7 [===========>..................] - ETA: 0s - loss: 0.00555/7 [====================>.........] - ETA: 0s - loss: 0.00607/7 [==============================] - ETA: 0s - loss: 0.00557/7 [==============================] - 0s 32ms/step - loss: 0.0055
1/7 [===>..........................] - ETA: 0s - loss: 0.00323/7 [===========>..................] - ETA: 0s - loss: 0.00455/7 [====================>.........] - ETA: 0s - loss: 0.00547/7 [==============================] - 0s 28ms/step - loss: 0.0056
1/7 [===>..........................] - ETA: 0s - loss: 0.00313/7 [===========>..................] - ETA: 0s - loss: 0.01165/7 [====================>.........] - ETA: 0s - loss: 0.01417/7 [==============================] - ETA: 0s - loss: 0.01257/7 [==============================] - 0s 33ms/step - loss: 0.0125
1/7 [===>..........................] - ETA: 0s - loss: 0.00444/7 [================>.............] - ETA: 0s - loss: 0.00506/7 [========================>.....] - ETA: 0s - loss: 0.00787/7 [==============================] - 0s 24ms/step - loss: 0.0076
1/7 [===>..........................] - ETA: 0s - loss: 0.00713/7 [===========>..................] - ETA: 0s - loss: 0.00625/7 [====================>.........] - ETA: 0s - loss: 0.00617/7 [==============================] - ETA: 0s - loss: 0.00577/7 [==============================] - 0s 24ms/step - loss: 0.0057
1/7 [===>..........................] - ETA: 0s - loss: 0.01352/7 [=======>......................] - ETA: 0s - loss: 0.01393/7 [===========>..................] - ETA: 0s - loss: 0.01135/7 [====================>.........] - ETA: 0s - loss: 0.01027/7 [==============================] - ETA: 0s - loss: 0.00967/7 [==============================] - 0s 35ms/step - loss: 0.0096
1/7 [===>..........................] - ETA: 0s - loss: 0.00263/7 [===========>..................] - ETA: 0s - loss: 0.00495/7 [====================>.........] - ETA: 0s - loss: 0.00607/7 [==============================] - ETA: 0s - loss: 0.00807/7 [==============================] - 0s 27ms/step - loss: 0.0080
1/7 [===>..........................] - ETA: 0s - loss: 0.00323/7 [===========>..................] - ETA: 0s - loss: 0.01175/7 [====================>.........] - ETA: 0s - loss: 0.01427/7 [==============================] - ETA: 0s - loss: 0.01247/7 [==============================] - 0s 39ms/step - loss: 0.0124
1/7 [===>..........................] - ETA: 0s - loss: 0.00593/7 [===========>..................] - ETA: 0s - loss: 0.00515/7 [====================>.........] - ETA: 0s - loss: 0.00847/7 [==============================] - ETA: 0s - loss: 0.00797/7 [==============================] - 0s 25ms/step - loss: 0.0079
1/7 [===>..........................] - ETA: 0s - loss: 0.00943/7 [===========>..................] - ETA: 0s - loss: 0.00705/7 [====================>.........] - ETA: 0s - loss: 0.00587/7 [==============================] - ETA: 0s - loss: 0.00557/7 [==============================] - 0s 26ms/step - loss: 0.0055
Best parameters {'n_units': 48, 'n_hidden': 2} best score 0.007374861650168896:
Train Score: 0.00750 MSE 0.08659 RMSE
Test Score: 0.00632 MSE 0.07947 RMSE
Deviation Min [2.61732298e-05], Max [0.53383544]
Deviation 99.5th pctile [0.45418755]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1388,    9]))
Confusion matrix 
[[1388    0]
 [   2    7]]
precision 1.00000, recall 0.77778, f1 0.87500
Time to train: 336623 ms
Saving model models/A2Benchmark/synthetic_50.csv.h5
Total Time to proces all the selected files : 340312 ms
A2Benchmark : Avg precision 1.00000 recall 0.77778 f1 0.87500 time to train 336623.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_50.csv  --epochs 20 --n_iter 3 --patience 3 :: took 346 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_51.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 04:14:55 AM MST
2020-11-30 04:15:01.239756: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 04:15:01.258271: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 04:15:01.259606: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55e90e2b7440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 04:15:01.259654: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 04:15:01.259844: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_51.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 4.9394e-044/7 [================>.............] - ETA: 0s - loss: 2.6869e-047/7 [==============================] - ETA: 0s - loss: 2.4075e-047/7 [==============================] - 0s 16ms/step - loss: 2.4075e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.1206e-044/7 [================>.............] - ETA: 0s - loss: 2.1178e-047/7 [==============================] - 0s 15ms/step - loss: 2.2065e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.3875e-045/7 [====================>.........] - ETA: 0s - loss: 2.4402e-047/7 [==============================] - 0s 12ms/step - loss: 2.4519e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.0588e-045/7 [====================>.........] - ETA: 0s - loss: 0.0038    7/7 [==============================] - 0s 12ms/step - loss: 0.0031
1/7 [===>..........................] - ETA: 0s - loss: 2.9227e-044/7 [================>.............] - ETA: 0s - loss: 2.1553e-047/7 [==============================] - ETA: 0s - loss: 1.9963e-047/7 [==============================] - 0s 16ms/step - loss: 1.9963e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00153/7 [===========>..................] - ETA: 0s - loss: 6.7902e-045/7 [====================>.........] - ETA: 0s - loss: 5.1076e-047/7 [==============================] - ETA: 0s - loss: 4.7734e-047/7 [==============================] - 0s 23ms/step - loss: 4.7734e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.2946e-043/7 [===========>..................] - ETA: 0s - loss: 4.6867e-046/7 [========================>.....] - ETA: 0s - loss: 3.7942e-047/7 [==============================] - 0s 22ms/step - loss: 3.8338e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.8304e-043/7 [===========>..................] - ETA: 0s - loss: 5.3020e-045/7 [====================>.........] - ETA: 0s - loss: 3.9455e-047/7 [==============================] - 0s 23ms/step - loss: 3.9650e-04
1/7 [===>..........................] - ETA: 0s - loss: 7.7114e-043/7 [===========>..................] - ETA: 0s - loss: 5.0809e-045/7 [====================>.........] - ETA: 0s - loss: 0.0038    7/7 [==============================] - 0s 22ms/step - loss: 0.0031
1/7 [===>..........................] - ETA: 0s - loss: 0.00113/7 [===========>..................] - ETA: 0s - loss: 6.8615e-045/7 [====================>.........] - ETA: 0s - loss: 5.5311e-047/7 [==============================] - ETA: 0s - loss: 5.9852e-047/7 [==============================] - 0s 33ms/step - loss: 5.9852e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00193/7 [===========>..................] - ETA: 0s - loss: 8.7366e-045/7 [====================>.........] - ETA: 0s - loss: 6.2957e-047/7 [==============================] - ETA: 0s - loss: 5.7964e-047/7 [==============================] - 0s 30ms/step - loss: 5.7964e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.2067e-043/7 [===========>..................] - ETA: 0s - loss: 2.6466e-045/7 [====================>.........] - ETA: 0s - loss: 2.6378e-047/7 [==============================] - ETA: 0s - loss: 2.4769e-047/7 [==============================] - 0s 23ms/step - loss: 2.4769e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.5392e-043/7 [===========>..................] - ETA: 0s - loss: 2.1460e-045/7 [====================>.........] - ETA: 0s - loss: 3.0512e-047/7 [==============================] - ETA: 0s - loss: 2.8442e-047/7 [==============================] - 0s 32ms/step - loss: 2.8442e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.0392e-043/7 [===========>..................] - ETA: 0s - loss: 2.8501e-045/7 [====================>.........] - ETA: 0s - loss: 0.0036    7/7 [==============================] - 0s 25ms/step - loss: 0.0030
1/7 [===>..........................] - ETA: 0s - loss: 2.6316e-043/7 [===========>..................] - ETA: 0s - loss: 5.0527e-045/7 [====================>.........] - ETA: 0s - loss: 6.3821e-047/7 [==============================] - ETA: 0s - loss: 5.6847e-047/7 [==============================] - 0s 25ms/step - loss: 5.6847e-04
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.0008005274779861793:
Train Score: 0.00073 MSE 0.02705 RMSE
Test Score: 0.00033 MSE 0.01830 RMSE
Deviation Min [1.96183102e-06], Max [0.72281107]
Deviation 99.5th pctile [0.05048061]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,    1]))
Confusion matrix 
[[1390    6]
 [   0    1]]
precision 0.14286, recall 1.00000, f1 0.25000
Time to train: 302727 ms
Saving model models/A2Benchmark/synthetic_51.csv.h5
Total Time to proces all the selected files : 304944 ms
A2Benchmark : Avg precision 0.14286 recall 1.00000 f1 0.25000 time to train 302727.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_51.csv  --epochs 20 --n_iter 3 --patience 3 :: took 311 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_52.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 04:20:11 AM MST
2020-11-30 04:20:17.522213: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 04:20:17.541284: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 04:20:17.543050: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x555dfc41c740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 04:20:17.543111: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 04:20:17.543331: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_52.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00325/7 [====================>.........] - ETA: 0s - loss: 0.00337/7 [==============================] - 0s 12ms/step - loss: 0.0031
1/7 [===>..........................] - ETA: 0s - loss: 0.00195/7 [====================>.........] - ETA: 0s - loss: 0.00367/7 [==============================] - 0s 12ms/step - loss: 0.0036
1/7 [===>..........................] - ETA: 0s - loss: 0.00236/7 [========================>.....] - ETA: 0s - loss: 0.00517/7 [==============================] - 0s 11ms/step - loss: 0.0050
1/7 [===>..........................] - ETA: 0s - loss: 0.00215/7 [====================>.........] - ETA: 0s - loss: 0.00517/7 [==============================] - 0s 14ms/step - loss: 0.0048
1/7 [===>..........................] - ETA: 0s - loss: 0.00555/7 [====================>.........] - ETA: 0s - loss: 0.00417/7 [==============================] - 0s 12ms/step - loss: 0.0040
1/7 [===>..........................] - ETA: 0s - loss: 0.00365/7 [====================>.........] - ETA: 0s - loss: 0.00397/7 [==============================] - 0s 14ms/step - loss: 0.0036
1/7 [===>..........................] - ETA: 0s - loss: 0.00215/7 [====================>.........] - ETA: 0s - loss: 0.00387/7 [==============================] - 0s 14ms/step - loss: 0.0038
1/7 [===>..........................] - ETA: 0s - loss: 0.00214/7 [================>.............] - ETA: 0s - loss: 0.00697/7 [==============================] - 0s 14ms/step - loss: 0.0052
1/7 [===>..........................] - ETA: 0s - loss: 0.00265/7 [====================>.........] - ETA: 0s - loss: 0.00607/7 [==============================] - 0s 14ms/step - loss: 0.0057
1/7 [===>..........................] - ETA: 0s - loss: 0.01155/7 [====================>.........] - ETA: 0s - loss: 0.00627/7 [==============================] - 0s 14ms/step - loss: 0.0071
1/7 [===>..........................] - ETA: 0s - loss: 0.00365/7 [====================>.........] - ETA: 0s - loss: 0.00397/7 [==============================] - 0s 13ms/step - loss: 0.0036
1/7 [===>..........................] - ETA: 0s - loss: 0.00254/7 [================>.............] - ETA: 0s - loss: 0.00367/7 [==============================] - ETA: 0s - loss: 0.00387/7 [==============================] - 0s 17ms/step - loss: 0.0038
1/7 [===>..........................] - ETA: 0s - loss: 0.00224/7 [================>.............] - ETA: 0s - loss: 0.00657/7 [==============================] - ETA: 0s - loss: 0.00507/7 [==============================] - 0s 16ms/step - loss: 0.0050
1/7 [===>..........................] - ETA: 0s - loss: 0.00225/7 [====================>.........] - ETA: 0s - loss: 0.00567/7 [==============================] - 0s 12ms/step - loss: 0.0053
1/7 [===>..........................] - ETA: 0s - loss: 0.00735/7 [====================>.........] - ETA: 0s - loss: 0.00447/7 [==============================] - 0s 15ms/step - loss: 0.0046
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.004111090395599604:
Train Score: 0.00446 MSE 0.06677 RMSE
Test Score: 0.00374 MSE 0.06116 RMSE
Deviation Min [5.31247804e-05], Max [0.51555386]
Deviation 99.5th pctile [0.17549884]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,    4]))
Confusion matrix 
[[1390    3]
 [   0    4]]
precision 0.57143, recall 1.00000, f1 0.72727
Time to train: 253624 ms
Saving model models/A2Benchmark/synthetic_52.csv.h5
Total Time to proces all the selected files : 255663 ms
A2Benchmark : Avg precision 0.57143 recall 1.00000 f1 0.72727 time to train 253624.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_52.csv  --epochs 20 --n_iter 3 --patience 3 :: took 262 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_53.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 04:24:38 AM MST
2020-11-30 04:24:44.405913: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 04:24:44.424198: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 04:24:44.425111: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d801f41740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 04:24:44.425139: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 04:24:44.425257: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_53.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 8.2665e-043/7 [===========>..................] - ETA: 0s - loss: 9.1339e-045/7 [====================>.........] - ETA: 0s - loss: 9.4075e-047/7 [==============================] - ETA: 0s - loss: 8.5671e-047/7 [==============================] - 0s 27ms/step - loss: 8.5671e-04
1/7 [===>..........................] - ETA: 0s - loss: 8.3489e-043/7 [===========>..................] - ETA: 0s - loss: 9.9068e-045/7 [====================>.........] - ETA: 0s - loss: 9.5530e-047/7 [==============================] - ETA: 0s - loss: 8.9797e-047/7 [==============================] - 0s 30ms/step - loss: 8.9797e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00173/7 [===========>..................] - ETA: 0s - loss: 0.01845/7 [====================>.........] - ETA: 0s - loss: 0.02217/7 [==============================] - ETA: 0s - loss: 0.01777/7 [==============================] - 0s 31ms/step - loss: 0.0177
1/7 [===>..........................] - ETA: 0s - loss: 5.4160e-043/7 [===========>..................] - ETA: 0s - loss: 8.3886e-045/7 [====================>.........] - ETA: 0s - loss: 0.0097    7/7 [==============================] - ETA: 0s - loss: 0.00827/7 [==============================] - 0s 31ms/step - loss: 0.0082
1/7 [===>..........................] - ETA: 0s - loss: 0.00243/7 [===========>..................] - ETA: 0s - loss: 0.00165/7 [====================>.........] - ETA: 0s - loss: 0.00167/7 [==============================] - 0s 22ms/step - loss: 0.0018
1/7 [===>..........................] - ETA: 0s - loss: 8.9037e-043/7 [===========>..................] - ETA: 0s - loss: 8.6236e-045/7 [====================>.........] - ETA: 0s - loss: 9.0259e-047/7 [==============================] - ETA: 0s - loss: 8.2859e-047/7 [==============================] - 0s 35ms/step - loss: 8.2859e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00113/7 [===========>..................] - ETA: 0s - loss: 9.4509e-045/7 [====================>.........] - ETA: 0s - loss: 9.8212e-047/7 [==============================] - ETA: 0s - loss: 9.1641e-047/7 [==============================] - 0s 35ms/step - loss: 9.1641e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00132/7 [=======>......................] - ETA: 0s - loss: 8.4272e-044/7 [================>.............] - ETA: 0s - loss: 0.0271    6/7 [========================>.....] - ETA: 0s - loss: 0.01867/7 [==============================] - 0s 39ms/step - loss: 0.0178
1/7 [===>..........................] - ETA: 0s - loss: 5.1091e-043/7 [===========>..................] - ETA: 0s - loss: 9.5134e-045/7 [====================>.........] - ETA: 0s - loss: 0.0097    7/7 [==============================] - ETA: 0s - loss: 0.00877/7 [==============================] - 0s 28ms/step - loss: 0.0087
1/7 [===>..........................] - ETA: 0s - loss: 0.00263/7 [===========>..................] - ETA: 0s - loss: 0.00175/7 [====================>.........] - ETA: 0s - loss: 0.00177/7 [==============================] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 27ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 6.9461e-043/7 [===========>..................] - ETA: 0s - loss: 0.0011    5/7 [====================>.........] - ETA: 0s - loss: 0.00116/7 [========================>.....] - ETA: 0s - loss: 9.7579e-047/7 [==============================] - ETA: 0s - loss: 9.6281e-047/7 [==============================] - 0s 53ms/step - loss: 9.6281e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00103/7 [===========>..................] - ETA: 0s - loss: 9.5622e-045/7 [====================>.........] - ETA: 0s - loss: 0.0010    7/7 [==============================] - ETA: 0s - loss: 9.5185e-047/7 [==============================] - 0s 32ms/step - loss: 9.5185e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00213/7 [===========>..................] - ETA: 0s - loss: 0.01855/7 [====================>.........] - ETA: 0s - loss: 0.02227/7 [==============================] - ETA: 0s - loss: 0.01787/7 [==============================] - 0s 30ms/step - loss: 0.0178
1/7 [===>..........................] - ETA: 0s - loss: 4.0018e-043/7 [===========>..................] - ETA: 0s - loss: 0.0013    5/7 [====================>.........] - ETA: 0s - loss: 0.01037/7 [==============================] - ETA: 0s - loss: 0.00887/7 [==============================] - 0s 33ms/step - loss: 0.0088
1/7 [===>..........................] - ETA: 0s - loss: 0.00433/7 [===========>..................] - ETA: 0s - loss: 0.00295/7 [====================>.........] - ETA: 0s - loss: 0.00307/7 [==============================] - ETA: 0s - loss: 0.00347/7 [==============================] - 0s 25ms/step - loss: 0.0034
Best parameters {'n_units': 48, 'n_hidden': 2} best score 0.005884813284501434:
Train Score: 0.00522 MSE 0.07223 RMSE
Test Score: 0.00104 MSE 0.03231 RMSE
Deviation Min [3.33506e-05], Max [0.7508102]
Deviation 99.5th pctile [0.68383582]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1388,    9]))
Confusion matrix 
[[1388    0]
 [   2    7]]
precision 1.00000, recall 0.77778, f1 0.87500
Time to train: 466577 ms
Saving model models/A2Benchmark/synthetic_53.csv.h5
Total Time to proces all the selected files : 470175 ms
A2Benchmark : Avg precision 1.00000 recall 0.77778 f1 0.87500 time to train 466577.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_53.csv  --epochs 20 --n_iter 3 --patience 3 :: took 477 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_54.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 04:32:40 AM MST
2020-11-30 04:32:45.859311: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 04:32:45.878222: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 04:32:45.878989: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55cc3634e740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 04:32:45.879015: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 04:32:45.879133: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_54.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00753/7 [===========>..................] - ETA: 0s - loss: 0.00745/7 [====================>.........] - ETA: 0s - loss: 0.00767/7 [==============================] - ETA: 0s - loss: 0.00727/7 [==============================] - 0s 32ms/step - loss: 0.0072
1/7 [===>..........................] - ETA: 0s - loss: 0.00993/7 [===========>..................] - ETA: 0s - loss: 0.00855/7 [====================>.........] - ETA: 0s - loss: 0.00987/7 [==============================] - ETA: 0s - loss: 0.00897/7 [==============================] - 0s 25ms/step - loss: 0.0089
1/7 [===>..........................] - ETA: 0s - loss: 0.00523/7 [===========>..................] - ETA: 0s - loss: 0.00835/7 [====================>.........] - ETA: 0s - loss: 0.00807/7 [==============================] - ETA: 0s - loss: 0.00877/7 [==============================] - 0s 32ms/step - loss: 0.0087
1/7 [===>..........................] - ETA: 0s - loss: 0.01133/7 [===========>..................] - ETA: 0s - loss: 0.00985/7 [====================>.........] - ETA: 0s - loss: 0.01097/7 [==============================] - ETA: 0s - loss: 0.01047/7 [==============================] - 0s 32ms/step - loss: 0.0104
1/7 [===>..........................] - ETA: 0s - loss: 0.01283/7 [===========>..................] - ETA: 0s - loss: 0.00855/7 [====================>.........] - ETA: 0s - loss: 0.00897/7 [==============================] - ETA: 0s - loss: 0.00827/7 [==============================] - 0s 32ms/step - loss: 0.0082
1/7 [===>..........................] - ETA: 0s - loss: 0.00853/7 [===========>..................] - ETA: 0s - loss: 0.00785/7 [====================>.........] - ETA: 0s - loss: 0.00837/7 [==============================] - ETA: 0s - loss: 0.00787/7 [==============================] - 0s 35ms/step - loss: 0.0078
1/7 [===>..........................] - ETA: 0s - loss: 0.00953/7 [===========>..................] - ETA: 0s - loss: 0.00825/7 [====================>.........] - ETA: 0s - loss: 0.00947/7 [==============================] - ETA: 0s - loss: 0.00867/7 [==============================] - 0s 31ms/step - loss: 0.0086
1/7 [===>..........................] - ETA: 0s - loss: 0.00833/7 [===========>..................] - ETA: 0s - loss: 0.00975/7 [====================>.........] - ETA: 0s - loss: 0.00937/7 [==============================] - ETA: 0s - loss: 0.01017/7 [==============================] - 0s 29ms/step - loss: 0.0101
1/7 [===>..........................] - ETA: 0s - loss: 0.01043/7 [===========>..................] - ETA: 0s - loss: 0.00905/7 [====================>.........] - ETA: 0s - loss: 0.00997/7 [==============================] - ETA: 0s - loss: 0.00957/7 [==============================] - 0s 28ms/step - loss: 0.0095
1/7 [===>..........................] - ETA: 0s - loss: 0.01753/7 [===========>..................] - ETA: 0s - loss: 0.01205/7 [====================>.........] - ETA: 0s - loss: 0.01257/7 [==============================] - 0s 23ms/step - loss: 0.0121
1/7 [===>..........................] - ETA: 0s - loss: 0.00765/7 [====================>.........] - ETA: 0s - loss: 0.00767/7 [==============================] - 0s 12ms/step - loss: 0.0072
1/7 [===>..........................] - ETA: 0s - loss: 0.00944/7 [================>.............] - ETA: 0s - loss: 0.00857/7 [==============================] - 0s 13ms/step - loss: 0.0090
1/7 [===>..........................] - ETA: 0s - loss: 0.00706/7 [========================>.....] - ETA: 0s - loss: 0.00987/7 [==============================] - 0s 11ms/step - loss: 0.0098
1/7 [===>..........................] - ETA: 0s - loss: 0.01475/7 [====================>.........] - ETA: 0s - loss: 0.01357/7 [==============================] - 0s 12ms/step - loss: 0.0125
1/7 [===>..........................] - ETA: 0s - loss: 0.01284/7 [================>.............] - ETA: 0s - loss: 0.00887/7 [==============================] - ETA: 0s - loss: 0.00907/7 [==============================] - 0s 15ms/step - loss: 0.0090
Best parameters {'n_units': 72, 'n_hidden': 2} best score 0.008671891875565052:
Train Score: 0.00796 MSE 0.08923 RMSE
Test Score: 0.00948 MSE 0.09739 RMSE
Deviation Min [1.92216701e-05], Max [0.33244314]
Deviation 99.5th pctile [0.26021696]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,    1]))
Confusion matrix 
[[1390    6]
 [   0    1]]
precision 0.14286, recall 1.00000, f1 0.25000
Time to train: 550992 ms
Saving model models/A2Benchmark/synthetic_54.csv.h5
Total Time to proces all the selected files : 555204 ms
A2Benchmark : Avg precision 0.14286 recall 1.00000 f1 0.25000 time to train 550992.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_54.csv  --epochs 20 --n_iter 3 --patience 3 :: took 561 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_55.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 04:42:06 AM MST
2020-11-30 04:42:12.237827: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 04:42:12.256283: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 04:42:12.257867: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d71c425640 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 04:42:12.257922: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 04:42:12.258169: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_55.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00244/7 [================>.............] - ETA: 0s - loss: 0.00277/7 [==============================] - ETA: 0s - loss: 0.00277/7 [==============================] - 0s 16ms/step - loss: 0.0027
1/7 [===>..........................] - ETA: 0s - loss: 8.1685e-045/7 [====================>.........] - ETA: 0s - loss: 0.0014    7/7 [==============================] - 0s 13ms/step - loss: 0.0014
1/7 [===>..........................] - ETA: 0s - loss: 0.00114/7 [================>.............] - ETA: 0s - loss: 0.00817/7 [==============================] - ETA: 0s - loss: 0.00587/7 [==============================] - 0s 16ms/step - loss: 0.0058
1/7 [===>..........................] - ETA: 0s - loss: 0.00274/7 [================>.............] - ETA: 0s - loss: 0.00225/7 [====================>.........] - ETA: 0s - loss: 0.00647/7 [==============================] - 0s 25ms/step - loss: 0.0056
1/7 [===>..........................] - ETA: 0s - loss: 0.00424/7 [================>.............] - ETA: 0s - loss: 0.00287/7 [==============================] - ETA: 0s - loss: 0.00247/7 [==============================] - 0s 16ms/step - loss: 0.0024
1/7 [===>..........................] - ETA: 0s - loss: 0.00183/7 [===========>..................] - ETA: 0s - loss: 0.00355/7 [====================>.........] - ETA: 0s - loss: 0.00337/7 [==============================] - ETA: 0s - loss: 0.00307/7 [==============================] - 0s 25ms/step - loss: 0.0030
1/7 [===>..........................] - ETA: 0s - loss: 0.00113/7 [===========>..................] - ETA: 0s - loss: 0.00165/7 [====================>.........] - ETA: 0s - loss: 0.00177/7 [==============================] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 27ms/step - loss: 0.0018
1/7 [===>..........................] - ETA: 0s - loss: 0.00163/7 [===========>..................] - ETA: 0s - loss: 0.00155/7 [====================>.........] - ETA: 0s - loss: 0.00737/7 [==============================] - ETA: 0s - loss: 0.00607/7 [==============================] - 0s 25ms/step - loss: 0.0060
1/7 [===>..........................] - ETA: 0s - loss: 0.00273/7 [===========>..................] - ETA: 0s - loss: 0.00205/7 [====================>.........] - ETA: 0s - loss: 0.00647/7 [==============================] - ETA: 0s - loss: 0.00587/7 [==============================] - 0s 30ms/step - loss: 0.0058
1/7 [===>..........................] - ETA: 0s - loss: 0.00273/7 [===========>..................] - ETA: 0s - loss: 0.00195/7 [====================>.........] - ETA: 0s - loss: 0.00197/7 [==============================] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 27ms/step - loss: 0.0018
1/7 [===>..........................] - ETA: 0s - loss: 0.00124/7 [================>.............] - ETA: 0s - loss: 0.00147/7 [==============================] - ETA: 0s - loss: 0.00157/7 [==============================] - 0s 17ms/step - loss: 0.0015
1/7 [===>..........................] - ETA: 0s - loss: 8.7909e-044/7 [================>.............] - ETA: 0s - loss: 0.0016    7/7 [==============================] - ETA: 0s - loss: 0.00157/7 [==============================] - 0s 18ms/step - loss: 0.0015
1/7 [===>..........................] - ETA: 0s - loss: 0.00124/7 [================>.............] - ETA: 0s - loss: 0.00797/7 [==============================] - ETA: 0s - loss: 0.00557/7 [==============================] - 0s 16ms/step - loss: 0.0055
1/7 [===>..........................] - ETA: 0s - loss: 0.00154/7 [================>.............] - ETA: 0s - loss: 0.00167/7 [==============================] - ETA: 0s - loss: 0.00507/7 [==============================] - 0s 19ms/step - loss: 0.0050
1/7 [===>..........................] - ETA: 0s - loss: 0.00294/7 [================>.............] - ETA: 0s - loss: 0.00217/7 [==============================] - 0s 14ms/step - loss: 0.0018
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0030456695007160307:
Train Score: 0.00279 MSE 0.05285 RMSE
Test Score: 0.00148 MSE 0.03843 RMSE
Deviation Min [2.92902487e-05], Max [0.66141391]
Deviation 99.5th pctile [0.11884853]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,    4]))
Confusion matrix 
[[1390    3]
 [   0    4]]
precision 0.57143, recall 1.00000, f1 0.72727
Time to train: 270505 ms
Saving model models/A2Benchmark/synthetic_55.csv.h5
Total Time to proces all the selected files : 272796 ms
A2Benchmark : Avg precision 0.57143 recall 1.00000 f1 0.72727 time to train 270505.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_55.csv  --epochs 20 --n_iter 3 --patience 3 :: took 279 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_56.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 04:46:50 AM MST
2020-11-30 04:46:56.668751: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 04:46:56.687301: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 04:46:56.688211: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55787b892740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 04:46:56.688238: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 04:46:56.688344: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_56.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00203/7 [===========>..................] - ETA: 0s - loss: 0.00205/7 [====================>.........] - ETA: 0s - loss: 0.00167/7 [==============================] - ETA: 0s - loss: 0.00137/7 [==============================] - 0s 35ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 9.6231e-052/7 [=======>......................] - ETA: 0s - loss: 1.5927e-044/7 [================>.............] - ETA: 0s - loss: 2.2718e-046/7 [========================>.....] - ETA: 0s - loss: 2.2587e-047/7 [==============================] - 0s 39ms/step - loss: 2.3396e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.6680e-043/7 [===========>..................] - ETA: 0s - loss: 0.0113    5/7 [====================>.........] - ETA: 0s - loss: 0.01387/7 [==============================] - ETA: 0s - loss: 0.01107/7 [==============================] - 0s 26ms/step - loss: 0.0110
1/7 [===>..........................] - ETA: 0s - loss: 2.2616e-043/7 [===========>..................] - ETA: 0s - loss: 2.2996e-045/7 [====================>.........] - ETA: 0s - loss: 0.0062    7/7 [==============================] - ETA: 0s - loss: 0.00547/7 [==============================] - 0s 32ms/step - loss: 0.0054
1/7 [===>..........................] - ETA: 0s - loss: 5.0605e-043/7 [===========>..................] - ETA: 0s - loss: 3.5778e-045/7 [====================>.........] - ETA: 0s - loss: 2.8260e-047/7 [==============================] - ETA: 0s - loss: 2.5650e-047/7 [==============================] - 0s 32ms/step - loss: 2.5650e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00123/7 [===========>..................] - ETA: 0s - loss: 0.00125/7 [====================>.........] - ETA: 0s - loss: 9.7302e-047/7 [==============================] - ETA: 0s - loss: 8.0527e-047/7 [==============================] - 0s 32ms/step - loss: 8.0527e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.6391e-043/7 [===========>..................] - ETA: 0s - loss: 2.0507e-045/7 [====================>.........] - ETA: 0s - loss: 2.1051e-047/7 [==============================] - 0s 29ms/step - loss: 2.0611e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.0982e-044/7 [================>.............] - ETA: 0s - loss: 0.0167    6/7 [========================>.....] - ETA: 0s - loss: 0.01167/7 [==============================] - 0s 20ms/step - loss: 0.0111
1/7 [===>..........................] - ETA: 0s - loss: 1.2671e-043/7 [===========>..................] - ETA: 0s - loss: 1.6551e-045/7 [====================>.........] - ETA: 0s - loss: 0.0060    7/7 [==============================] - ETA: 0s - loss: 0.00527/7 [==============================] - 0s 28ms/step - loss: 0.0052
1/7 [===>..........................] - ETA: 0s - loss: 0.00103/7 [===========>..................] - ETA: 0s - loss: 9.7257e-045/7 [====================>.........] - ETA: 0s - loss: 8.4288e-047/7 [==============================] - 0s 24ms/step - loss: 7.9450e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00154/7 [================>.............] - ETA: 0s - loss: 0.00137/7 [==============================] - ETA: 0s - loss: 0.00107/7 [==============================] - 0s 15ms/step - loss: 0.0010
1/7 [===>..........................] - ETA: 0s - loss: 2.6204e-045/7 [====================>.........] - ETA: 0s - loss: 3.1796e-047/7 [==============================] - 0s 12ms/step - loss: 3.1070e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.6969e-045/7 [====================>.........] - ETA: 0s - loss: 0.0128    7/7 [==============================] - 0s 10ms/step - loss: 0.0103
1/7 [===>..........................] - ETA: 0s - loss: 0.06715/7 [====================>.........] - ETA: 0s - loss: 0.07847/7 [==============================] - 0s 12ms/step - loss: 0.0801
1/7 [===>..........................] - ETA: 0s - loss: 5.4758e-044/7 [================>.............] - ETA: 0s - loss: 3.4464e-047/7 [==============================] - 0s 14ms/step - loss: 2.7588e-04
Best parameters {'n_units': 48, 'n_hidden': 2} best score 0.0036044644337380307:
Train Score: 0.00310 MSE 0.05564 RMSE
Test Score: 0.00123 MSE 0.03506 RMSE
Deviation Min [5.61309557e-06], Max [0.57966038]
Deviation 99.5th pctile [0.5331958]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1388,    9]))
Confusion matrix 
[[1388    0]
 [   2    7]]
precision 1.00000, recall 0.77778, f1 0.87500
Time to train: 393963 ms
Saving model models/A2Benchmark/synthetic_56.csv.h5
Total Time to proces all the selected files : 397403 ms
A2Benchmark : Avg precision 1.00000 recall 0.77778 f1 0.87500 time to train 393963.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_56.csv  --epochs 20 --n_iter 3 --patience 3 :: took 404 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_57.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 04:53:39 AM MST
2020-11-30 04:53:45.074616: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 04:53:45.093235: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 04:53:45.094701: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f9f27af440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 04:53:45.094750: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 04:53:45.094965: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_57.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00826/7 [========================>.....] - ETA: 0s - loss: 0.00687/7 [==============================] - 0s 11ms/step - loss: 0.0067
1/7 [===>..........................] - ETA: 0s - loss: 0.00725/7 [====================>.........] - ETA: 0s - loss: 0.00817/7 [==============================] - 0s 13ms/step - loss: 0.0076
1/7 [===>..........................] - ETA: 0s - loss: 0.00404/7 [================>.............] - ETA: 0s - loss: 0.00597/7 [==============================] - ETA: 0s - loss: 0.00667/7 [==============================] - 0s 17ms/step - loss: 0.0066
1/7 [===>..........................] - ETA: 0s - loss: 0.01156/7 [========================>.....] - ETA: 0s - loss: 0.00957/7 [==============================] - 0s 10ms/step - loss: 0.0095
1/7 [===>..........................] - ETA: 0s - loss: 0.01034/7 [================>.............] - ETA: 0s - loss: 0.00767/7 [==============================] - ETA: 0s - loss: 0.00657/7 [==============================] - 0s 17ms/step - loss: 0.0065
1/7 [===>..........................] - ETA: 0s - loss: 0.00793/7 [===========>..................] - ETA: 0s - loss: 0.00665/7 [====================>.........] - ETA: 0s - loss: 0.00647/7 [==============================] - ETA: 0s - loss: 0.00607/7 [==============================] - 0s 33ms/step - loss: 0.0060
1/7 [===>..........................] - ETA: 0s - loss: 0.00763/7 [===========>..................] - ETA: 0s - loss: 0.00685/7 [====================>.........] - ETA: 0s - loss: 0.00797/7 [==============================] - ETA: 0s - loss: 0.00747/7 [==============================] - 0s 26ms/step - loss: 0.0074
1/7 [===>..........................] - ETA: 0s - loss: 0.00403/7 [===========>..................] - ETA: 0s - loss: 0.00595/7 [====================>.........] - ETA: 0s - loss: 0.00617/7 [==============================] - ETA: 0s - loss: 0.00687/7 [==============================] - 0s 27ms/step - loss: 0.0068
1/7 [===>..........................] - ETA: 0s - loss: 0.00833/7 [===========>..................] - ETA: 0s - loss: 0.00685/7 [====================>.........] - ETA: 0s - loss: 0.00967/7 [==============================] - ETA: 0s - loss: 0.00907/7 [==============================] - 0s 32ms/step - loss: 0.0090
1/7 [===>..........................] - ETA: 0s - loss: 0.01013/7 [===========>..................] - ETA: 0s - loss: 0.00705/7 [====================>.........] - ETA: 0s - loss: 0.00667/7 [==============================] - ETA: 0s - loss: 0.00627/7 [==============================] - 0s 32ms/step - loss: 0.0062
1/7 [===>..........................] - ETA: 0s - loss: 0.00923/7 [===========>..................] - ETA: 0s - loss: 0.00735/7 [====================>.........] - ETA: 0s - loss: 0.00717/7 [==============================] - ETA: 0s - loss: 0.00667/7 [==============================] - 0s 27ms/step - loss: 0.0066
1/7 [===>..........................] - ETA: 0s - loss: 0.00683/7 [===========>..................] - ETA: 0s - loss: 0.00595/7 [====================>.........] - ETA: 0s - loss: 0.00787/7 [==============================] - ETA: 0s - loss: 0.00757/7 [==============================] - 0s 26ms/step - loss: 0.0075
1/7 [===>..........................] - ETA: 0s - loss: 0.00413/7 [===========>..................] - ETA: 0s - loss: 0.00585/7 [====================>.........] - ETA: 0s - loss: 0.00617/7 [==============================] - ETA: 0s - loss: 0.00667/7 [==============================] - 0s 27ms/step - loss: 0.0066
1/7 [===>..........................] - ETA: 0s - loss: 0.00963/7 [===========>..................] - ETA: 0s - loss: 0.00715/7 [====================>.........] - ETA: 0s - loss: 0.00977/7 [==============================] - ETA: 0s - loss: 0.00917/7 [==============================] - 0s 26ms/step - loss: 0.0091
1/7 [===>..........................] - ETA: 0s - loss: 0.01023/7 [===========>..................] - ETA: 0s - loss: 0.00715/7 [====================>.........] - ETA: 0s - loss: 0.00687/7 [==============================] - ETA: 0s - loss: 0.00647/7 [==============================] - 0s 31ms/step - loss: 0.0064
Best parameters {'n_units': 72, 'n_hidden': 2} best score 0.007103766407817602:
Train Score: 0.00687 MSE 0.08288 RMSE
Test Score: 0.00668 MSE 0.08172 RMSE
Deviation Min [0.0001683], Max [0.67142171]
Deviation 99.5th pctile [0.2107069]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,    1]))
Confusion matrix 
[[1390    6]
 [   0    1]]
precision 0.14286, recall 1.00000, f1 0.25000
Time to train: 331608 ms
Saving model models/A2Benchmark/synthetic_57.csv.h5
Total Time to proces all the selected files : 335273 ms
A2Benchmark : Avg precision 0.14286 recall 1.00000 f1 0.25000 time to train 331608.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_57.csv  --epochs 20 --n_iter 3 --patience 3 :: took 341 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_58.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 04:59:25 AM MST
2020-11-30 04:59:31.419972: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 04:59:31.438249: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 04:59:31.439377: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56237ce26640 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 04:59:31.439426: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 04:59:31.439625: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_58.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00353/7 [===========>..................] - ETA: 0s - loss: 0.00185/7 [====================>.........] - ETA: 0s - loss: 0.00157/7 [==============================] - ETA: 0s - loss: 0.00147/7 [==============================] - 0s 25ms/step - loss: 0.0014
1/7 [===>..........................] - ETA: 0s - loss: 3.9084e-043/7 [===========>..................] - ETA: 0s - loss: 7.7474e-045/7 [====================>.........] - ETA: 0s - loss: 0.0012    7/7 [==============================] - ETA: 0s - loss: 0.00127/7 [==============================] - 0s 23ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 0.00123/7 [===========>..................] - ETA: 0s - loss: 0.00135/7 [====================>.........] - ETA: 0s - loss: 0.00607/7 [==============================] - ETA: 0s - loss: 0.00497/7 [==============================] - 0s 35ms/step - loss: 0.0049
1/7 [===>..........................] - ETA: 0s - loss: 0.00113/7 [===========>..................] - ETA: 0s - loss: 9.4296e-045/7 [====================>.........] - ETA: 0s - loss: 0.0049    7/7 [==============================] - ETA: 0s - loss: 0.00427/7 [==============================] - 0s 25ms/step - loss: 0.0042
1/7 [===>..........................] - ETA: 0s - loss: 0.00313/7 [===========>..................] - ETA: 0s - loss: 0.00225/7 [====================>.........] - ETA: 0s - loss: 0.00187/7 [==============================] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 25ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 0.00293/7 [===========>..................] - ETA: 0s - loss: 0.00155/7 [====================>.........] - ETA: 0s - loss: 0.00137/7 [==============================] - 0s 24ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 5.7902e-043/7 [===========>..................] - ETA: 0s - loss: 0.0010    5/7 [====================>.........] - ETA: 0s - loss: 9.5955e-047/7 [==============================] - ETA: 0s - loss: 9.0596e-047/7 [==============================] - 0s 32ms/step - loss: 9.0596e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00163/7 [===========>..................] - ETA: 0s - loss: 0.00165/7 [====================>.........] - ETA: 0s - loss: 0.00627/7 [==============================] - ETA: 0s - loss: 0.00527/7 [==============================] - 0s 27ms/step - loss: 0.0052
1/7 [===>..........................] - ETA: 0s - loss: 0.00123/7 [===========>..................] - ETA: 0s - loss: 0.00105/7 [====================>.........] - ETA: 0s - loss: 0.00507/7 [==============================] - ETA: 0s - loss: 0.00427/7 [==============================] - 0s 24ms/step - loss: 0.0042
1/7 [===>..........................] - ETA: 0s - loss: 8.1717e-043/7 [===========>..................] - ETA: 0s - loss: 0.0016    5/7 [====================>.........] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 26ms/step - loss: 0.0016
1/7 [===>..........................] - ETA: 0s - loss: 0.00393/7 [===========>..................] - ETA: 0s - loss: 0.00205/7 [====================>.........] - ETA: 0s - loss: 0.00177/7 [==============================] - ETA: 0s - loss: 0.00167/7 [==============================] - 0s 27ms/step - loss: 0.0016
1/7 [===>..........................] - ETA: 0s - loss: 6.4557e-043/7 [===========>..................] - ETA: 0s - loss: 0.0012    5/7 [====================>.........] - ETA: 0s - loss: 0.00107/7 [==============================] - ETA: 0s - loss: 9.7422e-047/7 [==============================] - 0s 29ms/step - loss: 9.7422e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00133/7 [===========>..................] - ETA: 0s - loss: 0.00125/7 [====================>.........] - ETA: 0s - loss: 0.00597/7 [==============================] - ETA: 0s - loss: 0.00497/7 [==============================] - 0s 25ms/step - loss: 0.0049
1/7 [===>..........................] - ETA: 0s - loss: 0.00113/7 [===========>..................] - ETA: 0s - loss: 9.4123e-045/7 [====================>.........] - ETA: 0s - loss: 0.0050    7/7 [==============================] - ETA: 0s - loss: 0.00437/7 [==============================] - 0s 32ms/step - loss: 0.0043
1/7 [===>..........................] - ETA: 0s - loss: 0.00143/7 [===========>..................] - ETA: 0s - loss: 0.00105/7 [====================>.........] - ETA: 0s - loss: 9.0725e-047/7 [==============================] - ETA: 0s - loss: 9.5373e-047/7 [==============================] - 0s 35ms/step - loss: 9.5373e-04
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.0025411442387849093:
Train Score: 0.00211 MSE 0.04595 RMSE
Test Score: 0.00118 MSE 0.03433 RMSE
Deviation Min [0.00011762], Max [0.59649775]
Deviation 99.5th pctile [0.10138871]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,    4]))
Confusion matrix 
[[1390    3]
 [   0    4]]
precision 0.57143, recall 1.00000, f1 0.72727
Time to train: 435682 ms
Saving model models/A2Benchmark/synthetic_58.csv.h5
Total Time to proces all the selected files : 439778 ms
A2Benchmark : Avg precision 0.57143 recall 1.00000 f1 0.72727 time to train 435682.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_58.csv  --epochs 20 --n_iter 3 --patience 3 :: took 446 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_59.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 05:06:56 AM MST
2020-11-30 05:07:02.616129: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 05:07:02.623078: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 05:07:02.623793: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55a1836e7960 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 05:07:02.623816: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 05:07:02.623939: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_59.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00163/7 [===========>..................] - ETA: 0s - loss: 0.00145/7 [====================>.........] - ETA: 0s - loss: 0.00167/7 [==============================] - ETA: 0s - loss: 0.00157/7 [==============================] - 0s 32ms/step - loss: 0.0015
1/7 [===>..........................] - ETA: 0s - loss: 0.00103/7 [===========>..................] - ETA: 0s - loss: 0.00145/7 [====================>.........] - ETA: 0s - loss: 0.00177/7 [==============================] - ETA: 0s - loss: 0.00177/7 [==============================] - 0s 31ms/step - loss: 0.0017
1/7 [===>..........................] - ETA: 0s - loss: 0.00143/7 [===========>..................] - ETA: 0s - loss: 0.01535/7 [====================>.........] - ETA: 0s - loss: 0.01807/7 [==============================] - ETA: 0s - loss: 0.01477/7 [==============================] - 0s 39ms/step - loss: 0.0147
1/7 [===>..........................] - ETA: 0s - loss: 8.8454e-043/7 [===========>..................] - ETA: 0s - loss: 0.0015    5/7 [====================>.........] - ETA: 0s - loss: 0.00807/7 [==============================] - ETA: 0s - loss: 0.00717/7 [==============================] - 0s 35ms/step - loss: 0.0071
1/7 [===>..........................] - ETA: 0s - loss: 0.00323/7 [===========>..................] - ETA: 0s - loss: 0.00235/7 [====================>.........] - ETA: 0s - loss: 0.00207/7 [==============================] - ETA: 0s - loss: 0.00237/7 [==============================] - 0s 27ms/step - loss: 0.0023
1/7 [===>..........................] - ETA: 0s - loss: 0.00184/7 [================>.............] - ETA: 0s - loss: 0.00177/7 [==============================] - ETA: 0s - loss: 0.00177/7 [==============================] - 0s 16ms/step - loss: 0.0017
1/7 [===>..........................] - ETA: 0s - loss: 9.6104e-044/7 [================>.............] - ETA: 0s - loss: 0.0016    7/7 [==============================] - ETA: 0s - loss: 0.00167/7 [==============================] - 0s 16ms/step - loss: 0.0016
1/7 [===>..........................] - ETA: 0s - loss: 8.8288e-045/7 [====================>.........] - ETA: 0s - loss: 0.0166    7/7 [==============================] - 0s 12ms/step - loss: 0.0134
1/7 [===>..........................] - ETA: 0s - loss: 8.2344e-044/7 [================>.............] - ETA: 0s - loss: 0.0015    7/7 [==============================] - ETA: 0s - loss: 0.00677/7 [==============================] - 0s 16ms/step - loss: 0.0067
1/7 [===>..........................] - ETA: 0s - loss: 0.00275/7 [====================>.........] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 14ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 0.00204/7 [================>.............] - ETA: 0s - loss: 0.00177/7 [==============================] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 18ms/step - loss: 0.0018
1/7 [===>..........................] - ETA: 0s - loss: 8.6600e-045/7 [====================>.........] - ETA: 0s - loss: 0.0015    7/7 [==============================] - 0s 14ms/step - loss: 0.0015
1/7 [===>..........................] - ETA: 0s - loss: 8.7026e-045/7 [====================>.........] - ETA: 0s - loss: 0.0166    7/7 [==============================] - 0s 14ms/step - loss: 0.0135
1/7 [===>..........................] - ETA: 0s - loss: 0.00114/7 [================>.............] - ETA: 0s - loss: 0.00227/7 [==============================] - ETA: 0s - loss: 0.00737/7 [==============================] - 0s 17ms/step - loss: 0.0073
1/7 [===>..........................] - ETA: 0s - loss: 0.00545/7 [====================>.........] - ETA: 0s - loss: 0.00357/7 [==============================] - 0s 14ms/step - loss: 0.0041
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.00509476768784225:
Train Score: 0.00463 MSE 0.06807 RMSE
Test Score: 0.00149 MSE 0.03863 RMSE
Deviation Min [2.21336278e-05], Max [0.68287361]
Deviation 99.5th pctile [0.53330493]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1388,    9]))
Confusion matrix 
[[1388    0]
 [   2    7]]
precision 1.00000, recall 0.77778, f1 0.87500
Time to train: 277556 ms
Saving model models/A2Benchmark/synthetic_59.csv.h5
Total Time to proces all the selected files : 279605 ms
A2Benchmark : Avg precision 1.00000 recall 0.77778 f1 0.87500 time to train 277556.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_59.csv  --epochs 20 --n_iter 3 --patience 3 :: took 286 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_5.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 05:11:47 AM MST
2020-11-30 05:11:53.413671: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 05:11:53.432194: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 05:11:53.432971: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f393882440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 05:11:53.432997: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 05:11:53.433116: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_5.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 2.4287e-042/7 [=======>......................] - ETA: 0s - loss: 3.5957e-043/7 [===========>..................] - ETA: 0s - loss: 3.6961e-044/7 [================>.............] - ETA: 0s - loss: 3.7506e-045/7 [====================>.........] - ETA: 0s - loss: 3.7468e-047/7 [==============================] - ETA: 0s - loss: 3.9601e-047/7 [==============================] - 0s 44ms/step - loss: 3.9601e-04
1/7 [===>..........................] - ETA: 0s - loss: 6.0764e-043/7 [===========>..................] - ETA: 0s - loss: 5.5170e-045/7 [====================>.........] - ETA: 0s - loss: 5.5136e-047/7 [==============================] - ETA: 0s - loss: 5.4163e-047/7 [==============================] - 0s 24ms/step - loss: 5.4163e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.6909e-043/7 [===========>..................] - ETA: 0s - loss: 0.0076    5/7 [====================>.........] - ETA: 0s - loss: 0.00967/7 [==============================] - ETA: 0s - loss: 0.00777/7 [==============================] - 0s 31ms/step - loss: 0.0077
1/7 [===>..........................] - ETA: 0s - loss: 1.1936e-043/7 [===========>..................] - ETA: 0s - loss: 1.6720e-045/7 [====================>.........] - ETA: 0s - loss: 0.0033    7/7 [==============================] - ETA: 0s - loss: 0.00317/7 [==============================] - 0s 32ms/step - loss: 0.0031
1/7 [===>..........................] - ETA: 0s - loss: 2.4524e-043/7 [===========>..................] - ETA: 0s - loss: 9.6924e-045/7 [====================>.........] - ETA: 0s - loss: 8.3403e-047/7 [==============================] - ETA: 0s - loss: 8.3910e-047/7 [==============================] - 0s 26ms/step - loss: 8.3910e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.7176e-043/7 [===========>..................] - ETA: 0s - loss: 2.4593e-045/7 [====================>.........] - ETA: 0s - loss: 3.5505e-047/7 [==============================] - ETA: 0s - loss: 3.1678e-047/7 [==============================] - 0s 30ms/step - loss: 3.1678e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.9859e-043/7 [===========>..................] - ETA: 0s - loss: 3.6387e-045/7 [====================>.........] - ETA: 0s - loss: 3.9448e-047/7 [==============================] - ETA: 0s - loss: 3.7433e-047/7 [==============================] - 0s 38ms/step - loss: 3.7433e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.5538e-043/7 [===========>..................] - ETA: 0s - loss: 0.0080    4/7 [================>.............] - ETA: 0s - loss: 0.01126/7 [========================>.....] - ETA: 0s - loss: 0.00797/7 [==============================] - 0s 36ms/step - loss: 0.0076
1/7 [===>..........................] - ETA: 0s - loss: 1.4147e-043/7 [===========>..................] - ETA: 0s - loss: 1.8634e-045/7 [====================>.........] - ETA: 0s - loss: 0.0035    7/7 [==============================] - ETA: 0s - loss: 0.00327/7 [==============================] - 0s 27ms/step - loss: 0.0032
1/7 [===>..........................] - ETA: 0s - loss: 2.5243e-043/7 [===========>..................] - ETA: 0s - loss: 5.2898e-045/7 [====================>.........] - ETA: 0s - loss: 4.4288e-046/7 [========================>.....] - ETA: 0s - loss: 4.7363e-047/7 [==============================] - 0s 34ms/step - loss: 4.6883e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.0095e-045/7 [====================>.........] - ETA: 0s - loss: 3.9446e-047/7 [==============================] - 0s 14ms/step - loss: 4.0719e-04
1/7 [===>..........................] - ETA: 0s - loss: 7.4644e-044/7 [================>.............] - ETA: 0s - loss: 5.1141e-047/7 [==============================] - ETA: 0s - loss: 5.0990e-047/7 [==============================] - 0s 17ms/step - loss: 5.0990e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.5378e-045/7 [====================>.........] - ETA: 0s - loss: 0.0084    7/7 [==============================] - 0s 14ms/step - loss: 0.0067
1/7 [===>..........................] - ETA: 0s - loss: 2.8672e-046/7 [========================>.....] - ETA: 0s - loss: 0.0032    7/7 [==============================] - 0s 13ms/step - loss: 0.0031
1/7 [===>..........................] - ETA: 0s - loss: 4.6559e-045/7 [====================>.........] - ETA: 0s - loss: 3.9661e-047/7 [==============================] - 0s 14ms/step - loss: 3.7678e-04
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.002210770396050066:
Train Score: 0.00192 MSE 0.04384 RMSE
Test Score: 0.00034 MSE 0.01844 RMSE
Deviation Min [2.85553274e-06], Max [0.42150235]
Deviation 99.5th pctile [0.31232322]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1388,    9]))
Confusion matrix 
[[1388    0]
 [   2    7]]
precision 1.00000, recall 0.77778, f1 0.87500
Time to train: 370505 ms
Saving model models/A2Benchmark/synthetic_5.csv.h5
Total Time to proces all the selected files : 372650 ms
A2Benchmark : Avg precision 1.00000 recall 0.77778 f1 0.87500 time to train 370505.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_5.csv  --epochs 20 --n_iter 3 --patience 3 :: took 379 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_60.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 05:18:11 AM MST
2020-11-30 05:18:17.255742: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 05:18:17.274144: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 05:18:17.275780: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55b7aaa6c440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 05:18:17.275829: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 05:18:17.276020: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_60.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 2.2767e-053/7 [===========>..................] - ETA: 0s - loss: 4.8393e-045/7 [====================>.........] - ETA: 0s - loss: 4.4080e-047/7 [==============================] - ETA: 0s - loss: 3.7659e-047/7 [==============================] - 0s 33ms/step - loss: 3.7659e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.9600e-043/7 [===========>..................] - ETA: 0s - loss: 3.7446e-045/7 [====================>.........] - ETA: 0s - loss: 3.5651e-047/7 [==============================] - ETA: 0s - loss: 3.1936e-047/7 [==============================] - 0s 32ms/step - loss: 3.1936e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.3418e-043/7 [===========>..................] - ETA: 0s - loss: 3.7373e-045/7 [====================>.........] - ETA: 0s - loss: 3.6262e-047/7 [==============================] - ETA: 0s - loss: 3.2440e-047/7 [==============================] - 0s 29ms/step - loss: 3.2440e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.1684e-043/7 [===========>..................] - ETA: 0s - loss: 3.2590e-045/7 [====================>.........] - ETA: 0s - loss: 0.0023    7/7 [==============================] - ETA: 0s - loss: 0.00197/7 [==============================] - 0s 29ms/step - loss: 0.0019
1/7 [===>..........................] - ETA: 0s - loss: 0.00143/7 [===========>..................] - ETA: 0s - loss: 5.5371e-045/7 [====================>.........] - ETA: 0s - loss: 6.0204e-047/7 [==============================] - ETA: 0s - loss: 5.2155e-047/7 [==============================] - 0s 25ms/step - loss: 5.2155e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.3090e-054/7 [================>.............] - ETA: 0s - loss: 2.1411e-047/7 [==============================] - 0s 16ms/step - loss: 1.9030e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.2939e-054/7 [================>.............] - ETA: 0s - loss: 3.7489e-047/7 [==============================] - ETA: 0s - loss: 3.2133e-047/7 [==============================] - 0s 19ms/step - loss: 3.2133e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.3310e-045/7 [====================>.........] - ETA: 0s - loss: 2.3090e-047/7 [==============================] - 0s 12ms/step - loss: 2.0141e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.0841e-044/7 [================>.............] - ETA: 0s - loss: 1.5494e-047/7 [==============================] - ETA: 0s - loss: 0.0019    7/7 [==============================] - 0s 20ms/step - loss: 0.0019
1/7 [===>..........................] - ETA: 0s - loss: 9.9138e-054/7 [================>.............] - ETA: 0s - loss: 2.4219e-047/7 [==============================] - ETA: 0s - loss: 2.4850e-047/7 [==============================] - 0s 19ms/step - loss: 2.4850e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.4839e-044/7 [================>.............] - ETA: 0s - loss: 6.8784e-046/7 [========================>.....] - ETA: 0s - loss: 4.7218e-047/7 [==============================] - 0s 20ms/step - loss: 4.6549e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.1632e-045/7 [====================>.........] - ETA: 0s - loss: 1.4602e-047/7 [==============================] - 0s 13ms/step - loss: 1.3507e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.04575/7 [====================>.........] - ETA: 0s - loss: 0.04877/7 [==============================] - 0s 12ms/step - loss: 0.0572
1/7 [===>..........................] - ETA: 0s - loss: 2.5666e-055/7 [====================>.........] - ETA: 0s - loss: 0.0024    7/7 [==============================] - 0s 12ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 1.8628e-044/7 [================>.............] - ETA: 0s - loss: 0.0013    7/7 [==============================] - 0s 15ms/step - loss: 0.0024
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0005688118282705546:
Train Score: 0.00062 MSE 0.02487 RMSE
Test Score: 0.00026 MSE 0.01617 RMSE
Deviation Min [2.3889778e-05], Max [0.57461476]
Deviation 99.5th pctile [0.03472782]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,    1]))
Confusion matrix 
[[1390    6]
 [   0    1]]
precision 0.14286, recall 1.00000, f1 0.25000
Time to train: 322804 ms
Saving model models/A2Benchmark/synthetic_60.csv.h5
Total Time to proces all the selected files : 324906 ms
A2Benchmark : Avg precision 0.14286 recall 1.00000 f1 0.25000 time to train 322804.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_60.csv  --epochs 20 --n_iter 3 --patience 3 :: took 331 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_61.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 05:23:47 AM MST
2020-11-30 05:23:53.492534: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 05:23:53.511247: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 05:23:53.512645: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55bac4db4440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 05:23:53.512688: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 05:23:53.512843: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_61.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 1.5941e-045/7 [====================>.........] - ETA: 0s - loss: 5.9659e-047/7 [==============================] - 0s 12ms/step - loss: 6.4596e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.7541e-044/7 [================>.............] - ETA: 0s - loss: 3.6948e-047/7 [==============================] - ETA: 0s - loss: 3.5000e-047/7 [==============================] - 0s 16ms/step - loss: 3.5000e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.0900e-045/7 [====================>.........] - ETA: 0s - loss: 0.0063    7/7 [==============================] - 0s 12ms/step - loss: 0.0050
1/7 [===>..........................] - ETA: 0s - loss: 8.1252e-054/7 [================>.............] - ETA: 0s - loss: 1.0105e-047/7 [==============================] - ETA: 0s - loss: 0.0052    7/7 [==============================] - 0s 17ms/step - loss: 0.0052
1/7 [===>..........................] - ETA: 0s - loss: 4.1948e-044/7 [================>.............] - ETA: 0s - loss: 3.3825e-047/7 [==============================] - 0s 12ms/step - loss: 2.9706e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.8416e-043/7 [===========>..................] - ETA: 0s - loss: 3.0126e-045/7 [====================>.........] - ETA: 0s - loss: 3.5289e-047/7 [==============================] - ETA: 0s - loss: 3.0011e-047/7 [==============================] - 0s 23ms/step - loss: 3.0011e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.4190e-053/7 [===========>..................] - ETA: 0s - loss: 2.0450e-045/7 [====================>.........] - ETA: 0s - loss: 1.5204e-047/7 [==============================] - ETA: 0s - loss: 1.8297e-047/7 [==============================] - 0s 29ms/step - loss: 1.8297e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.2382e-044/7 [================>.............] - ETA: 0s - loss: 0.0078    6/7 [========================>.....] - ETA: 0s - loss: 0.00547/7 [==============================] - 0s 22ms/step - loss: 0.0052
1/7 [===>..........................] - ETA: 0s - loss: 9.2252e-053/7 [===========>..................] - ETA: 0s - loss: 1.9905e-045/7 [====================>.........] - ETA: 0s - loss: 0.0061    7/7 [==============================] - 0s 26ms/step - loss: 0.0053
1/7 [===>..........................] - ETA: 0s - loss: 2.9693e-043/7 [===========>..................] - ETA: 0s - loss: 4.0489e-045/7 [====================>.........] - ETA: 0s - loss: 3.7395e-047/7 [==============================] - ETA: 0s - loss: 3.5659e-047/7 [==============================] - 0s 29ms/step - loss: 3.5659e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.7103e-043/7 [===========>..................] - ETA: 0s - loss: 3.7770e-045/7 [====================>.........] - ETA: 0s - loss: 3.5224e-047/7 [==============================] - ETA: 0s - loss: 3.7069e-047/7 [==============================] - 0s 35ms/step - loss: 3.7069e-04
1/7 [===>..........................] - ETA: 0s - loss: 6.4115e-053/7 [===========>..................] - ETA: 0s - loss: 6.6310e-055/7 [====================>.........] - ETA: 0s - loss: 8.2141e-057/7 [==============================] - ETA: 0s - loss: 7.6771e-057/7 [==============================] - 0s 27ms/step - loss: 7.6771e-05
1/7 [===>..........................] - ETA: 0s - loss: 2.4114e-053/7 [===========>..................] - ETA: 0s - loss: 1.4064e-045/7 [====================>.........] - ETA: 0s - loss: 0.0069    7/7 [==============================] - ETA: 0s - loss: 0.00557/7 [==============================] - 0s 32ms/step - loss: 0.0055
1/7 [===>..........................] - ETA: 0s - loss: 1.3306e-043/7 [===========>..................] - ETA: 0s - loss: 1.6310e-045/7 [====================>.........] - ETA: 0s - loss: 0.0062    7/7 [==============================] - ETA: 0s - loss: 0.00557/7 [==============================] - 0s 32ms/step - loss: 0.0055
1/7 [===>..........................] - ETA: 0s - loss: 4.0273e-043/7 [===========>..................] - ETA: 0s - loss: 3.7168e-045/7 [====================>.........] - ETA: 0s - loss: 3.3277e-047/7 [==============================] - ETA: 0s - loss: 3.7638e-047/7 [==============================] - 0s 25ms/step - loss: 3.7638e-04
Best parameters {'n_units': 48, 'n_hidden': 2} best score 0.0022680998750729485:
Train Score: 0.00229 MSE 0.04780 RMSE
Test Score: 0.00056 MSE 0.02371 RMSE
Deviation Min [1.65347057e-05], Max [0.68976074]
Deviation 99.5th pctile [0.13127804]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,    4]))
Confusion matrix 
[[1390    3]
 [   0    4]]
precision 0.57143, recall 1.00000, f1 0.72727
Time to train: 436257 ms
Saving model models/A2Benchmark/synthetic_61.csv.h5
Total Time to proces all the selected files : 439671 ms
A2Benchmark : Avg precision 0.57143 recall 1.00000 f1 0.72727 time to train 436257.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_61.csv  --epochs 20 --n_iter 3 --patience 3 :: took 446 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_62.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 05:31:18 AM MST
2020-11-30 05:31:24.043396: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 05:31:24.062274: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 05:31:24.063678: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55ad4dcd3740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 05:31:24.063729: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 05:31:24.063965: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_62.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00183/7 [===========>..................] - ETA: 0s - loss: 0.00195/7 [====================>.........] - ETA: 0s - loss: 0.00167/7 [==============================] - ETA: 0s - loss: 0.00147/7 [==============================] - 0s 26ms/step - loss: 0.0014
1/7 [===>..........................] - ETA: 0s - loss: 2.6664e-043/7 [===========>..................] - ETA: 0s - loss: 5.5662e-045/7 [====================>.........] - ETA: 0s - loss: 5.1974e-047/7 [==============================] - ETA: 0s - loss: 5.8820e-047/7 [==============================] - 0s 27ms/step - loss: 5.8820e-04
1/7 [===>..........................] - ETA: 0s - loss: 8.0590e-043/7 [===========>..................] - ETA: 0s - loss: 0.0105    5/7 [====================>.........] - ETA: 0s - loss: 0.01247/7 [==============================] - ETA: 0s - loss: 0.01017/7 [==============================] - 0s 34ms/step - loss: 0.0101
1/7 [===>..........................] - ETA: 0s - loss: 0.00263/7 [===========>..................] - ETA: 0s - loss: 0.00115/7 [====================>.........] - ETA: 0s - loss: 0.00687/7 [==============================] - ETA: 0s - loss: 0.00597/7 [==============================] - 0s 34ms/step - loss: 0.0059
1/7 [===>..........................] - ETA: 0s - loss: 0.00682/7 [=======>......................] - ETA: 0s - loss: 0.00464/7 [================>.............] - ETA: 0s - loss: 0.00436/7 [========================>.....] - ETA: 0s - loss: 0.00397/7 [==============================] - 0s 31ms/step - loss: 0.0038
1/7 [===>..........................] - ETA: 0s - loss: 2.0749e-044/7 [================>.............] - ETA: 0s - loss: 2.0402e-047/7 [==============================] - ETA: 0s - loss: 2.3415e-047/7 [==============================] - 0s 17ms/step - loss: 2.3415e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.3602e-045/7 [====================>.........] - ETA: 0s - loss: 5.2052e-047/7 [==============================] - 0s 14ms/step - loss: 6.6997e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.8268e-044/7 [================>.............] - ETA: 0s - loss: 0.0139    7/7 [==============================] - 0s 14ms/step - loss: 0.0092
1/7 [===>..........................] - ETA: 0s - loss: 0.00164/7 [================>.............] - ETA: 0s - loss: 0.00107/7 [==============================] - 0s 14ms/step - loss: 0.0051
1/7 [===>..........................] - ETA: 0s - loss: 0.00165/7 [====================>.........] - ETA: 0s - loss: 7.9223e-047/7 [==============================] - 0s 14ms/step - loss: 6.5538e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00124/7 [================>.............] - ETA: 0s - loss: 8.5148e-047/7 [==============================] - ETA: 0s - loss: 7.9639e-047/7 [==============================] - 0s 16ms/step - loss: 7.9639e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.9435e-046/7 [========================>.....] - ETA: 0s - loss: 3.9036e-047/7 [==============================] - 0s 11ms/step - loss: 4.4571e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.8587e-045/7 [====================>.........] - ETA: 0s - loss: 0.0113    7/7 [==============================] - 0s 15ms/step - loss: 0.0091
1/7 [===>..........................] - ETA: 0s - loss: 0.00144/7 [================>.............] - ETA: 0s - loss: 9.2233e-047/7 [==============================] - ETA: 0s - loss: 0.0050    7/7 [==============================] - 0s 15ms/step - loss: 0.0050
1/7 [===>..........................] - ETA: 0s - loss: 0.00135/7 [====================>.........] - ETA: 0s - loss: 6.1539e-047/7 [==============================] - 0s 13ms/step - loss: 5.5455e-04
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0031714303739136087:
Train Score: 0.00252 MSE 0.05017 RMSE
Test Score: 0.00044 MSE 0.02102 RMSE
Deviation Min [3.56697446e-06], Max [0.56008652]
Deviation 99.5th pctile [0.41801661]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1388,    9]))
Confusion matrix 
[[1388    0]
 [   2    7]]
precision 1.00000, recall 0.77778, f1 0.87500
Time to train: 307941 ms
Saving model models/A2Benchmark/synthetic_62.csv.h5
Total Time to proces all the selected files : 310149 ms
A2Benchmark : Avg precision 1.00000 recall 0.77778 f1 0.87500 time to train 307941.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_62.csv  --epochs 20 --n_iter 3 --patience 3 :: took 316 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_63.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 05:36:39 AM MST
2020-11-30 05:36:45.330711: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 05:36:45.349176: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 05:36:45.350596: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f3c6cb0440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 05:36:45.350644: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 05:36:45.350835: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_63.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00153/7 [===========>..................] - ETA: 0s - loss: 0.00145/7 [====================>.........] - ETA: 0s - loss: 0.00117/7 [==============================] - ETA: 0s - loss: 9.2681e-047/7 [==============================] - 0s 27ms/step - loss: 9.2681e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.3901e-053/7 [===========>..................] - ETA: 0s - loss: 7.3886e-065/7 [====================>.........] - ETA: 0s - loss: 4.7485e-067/7 [==============================] - ETA: 0s - loss: 3.8702e-067/7 [==============================] - 0s 28ms/step - loss: 3.8702e-06
1/7 [===>..........................] - ETA: 0s - loss: 6.0679e-053/7 [===========>..................] - ETA: 0s - loss: 1.0142e-045/7 [====================>.........] - ETA: 0s - loss: 1.1941e-047/7 [==============================] - ETA: 0s - loss: 1.1512e-047/7 [==============================] - 0s 34ms/step - loss: 1.1512e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.4319e-043/7 [===========>..................] - ETA: 0s - loss: 1.2801e-045/7 [====================>.........] - ETA: 0s - loss: 0.0036    7/7 [==============================] - ETA: 0s - loss: 0.00297/7 [==============================] - 0s 37ms/step - loss: 0.0029
1/7 [===>..........................] - ETA: 0s - loss: 3.0542e-053/7 [===========>..................] - ETA: 0s - loss: 1.4159e-055/7 [====================>.........] - ETA: 0s - loss: 1.6035e-057/7 [==============================] - ETA: 0s - loss: 1.9826e-057/7 [==============================] - 0s 27ms/step - loss: 1.9826e-05
1/7 [===>..........................] - ETA: 0s - loss: 0.00133/7 [===========>..................] - ETA: 0s - loss: 0.00125/7 [====================>.........] - ETA: 0s - loss: 9.8596e-047/7 [==============================] - 0s 28ms/step - loss: 8.0944e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.3651e-053/7 [===========>..................] - ETA: 0s - loss: 2.9064e-055/7 [====================>.........] - ETA: 0s - loss: 2.2036e-057/7 [==============================] - ETA: 0s - loss: 2.0692e-057/7 [==============================] - 0s 32ms/step - loss: 2.0692e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.6382e-043/7 [===========>..................] - ETA: 0s - loss: 2.1796e-045/7 [====================>.........] - ETA: 0s - loss: 2.2315e-047/7 [==============================] - ETA: 0s - loss: 2.0291e-047/7 [==============================] - 0s 25ms/step - loss: 2.0291e-04
1/7 [===>..........................] - ETA: 0s - loss: 7.1277e-053/7 [===========>..................] - ETA: 0s - loss: 5.8577e-055/7 [====================>.........] - ETA: 0s - loss: 0.0035    7/7 [==============================] - ETA: 0s - loss: 0.00297/7 [==============================] - 0s 27ms/step - loss: 0.0029
1/7 [===>..........................] - ETA: 0s - loss: 2.2413e-053/7 [===========>..................] - ETA: 0s - loss: 1.0386e-055/7 [====================>.........] - ETA: 0s - loss: 2.1858e-057/7 [==============================] - ETA: 0s - loss: 2.9656e-057/7 [==============================] - 0s 32ms/step - loss: 2.9656e-05
1/7 [===>..........................] - ETA: 0s - loss: 0.00135/7 [====================>.........] - ETA: 0s - loss: 0.00107/7 [==============================] - 0s 14ms/step - loss: 8.8769e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.5940e-065/7 [====================>.........] - ETA: 0s - loss: 8.0522e-067/7 [==============================] - 0s 12ms/step - loss: 9.3589e-06
1/7 [===>..........................] - ETA: 0s - loss: 9.8204e-054/7 [================>.............] - ETA: 0s - loss: 1.6412e-047/7 [==============================] - ETA: 0s - loss: 1.6818e-047/7 [==============================] - 0s 16ms/step - loss: 1.6818e-04
1/7 [===>..........................] - ETA: 0s - loss: 6.5775e-065/7 [====================>.........] - ETA: 0s - loss: 0.0034    7/7 [==============================] - 0s 12ms/step - loss: 0.0028
1/7 [===>..........................] - ETA: 0s - loss: 1.6182e-054/7 [================>.............] - ETA: 0s - loss: 1.9939e-047/7 [==============================] - ETA: 0s - loss: 3.4067e-047/7 [==============================] - 0s 16ms/step - loss: 3.4067e-04
Best parameters {'n_units': 48, 'n_hidden': 2} best score 0.0007847655087971361:
Train Score: 0.00059 MSE 0.02420 RMSE
Test Score: 0.00105 MSE 0.03239 RMSE
Deviation Min [7.08821935e-06], Max [0.72279751]
Deviation 99.5th pctile [0.0493544]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,    1]))
Confusion matrix 
[[1390    6]
 [   0    1]]
precision 0.14286, recall 1.00000, f1 0.25000
Time to train: 318147 ms
Saving model models/A2Benchmark/synthetic_63.csv.h5
Total Time to proces all the selected files : 321736 ms
A2Benchmark : Avg precision 0.14286 recall 1.00000 f1 0.25000 time to train 318147.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_63.csv  --epochs 20 --n_iter 3 --patience 3 :: took 328 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_64.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 05:42:12 AM MST
2020-11-30 05:42:18.286570: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 05:42:18.305300: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 05:42:18.306868: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x562a06459740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 05:42:18.306930: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 05:42:18.307119: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_64.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00173/7 [===========>..................] - ETA: 0s - loss: 0.00145/7 [====================>.........] - ETA: 0s - loss: 0.00157/7 [==============================] - ETA: 0s - loss: 0.00137/7 [==============================] - 0s 25ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 3.0830e-043/7 [===========>..................] - ETA: 0s - loss: 4.9901e-045/7 [====================>.........] - ETA: 0s - loss: 6.2310e-047/7 [==============================] - ETA: 0s - loss: 6.0348e-047/7 [==============================] - 0s 31ms/step - loss: 6.0348e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.0803e-043/7 [===========>..................] - ETA: 0s - loss: 2.8630e-045/7 [====================>.........] - ETA: 0s - loss: 0.0023    7/7 [==============================] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 32ms/step - loss: 0.0018
1/7 [===>..........................] - ETA: 0s - loss: 2.7563e-043/7 [===========>..................] - ETA: 0s - loss: 5.2763e-045/7 [====================>.........] - ETA: 0s - loss: 0.0021    7/7 [==============================] - 0s 23ms/step - loss: 0.0019
1/7 [===>..........................] - ETA: 0s - loss: 9.0304e-043/7 [===========>..................] - ETA: 0s - loss: 6.0344e-045/7 [====================>.........] - ETA: 0s - loss: 4.9042e-047/7 [==============================] - ETA: 0s - loss: 4.4506e-047/7 [==============================] - 0s 25ms/step - loss: 4.4506e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00124/7 [================>.............] - ETA: 0s - loss: 9.2742e-047/7 [==============================] - ETA: 0s - loss: 6.7983e-047/7 [==============================] - 0s 15ms/step - loss: 6.7983e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.3861e-045/7 [====================>.........] - ETA: 0s - loss: 0.0011    7/7 [==============================] - 0s 12ms/step - loss: 9.1572e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.5057e-045/7 [====================>.........] - ETA: 0s - loss: 0.0024    7/7 [==============================] - 0s 11ms/step - loss: 0.0022
1/7 [===>..........................] - ETA: 0s - loss: 2.5512e-045/7 [====================>.........] - ETA: 0s - loss: 0.0025    7/7 [==============================] - 0s 12ms/step - loss: 0.0024
1/7 [===>..........................] - ETA: 0s - loss: 9.4990e-044/7 [================>.............] - ETA: 0s - loss: 7.0096e-047/7 [==============================] - ETA: 0s - loss: 6.8637e-047/7 [==============================] - 0s 15ms/step - loss: 6.8637e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00143/7 [===========>..................] - ETA: 0s - loss: 0.00125/7 [====================>.........] - ETA: 0s - loss: 9.3744e-047/7 [==============================] - ETA: 0s - loss: 7.8255e-047/7 [==============================] - 0s 30ms/step - loss: 7.8255e-04
1/7 [===>..........................] - ETA: 0s - loss: 8.7444e-043/7 [===========>..................] - ETA: 0s - loss: 0.0013    5/7 [====================>.........] - ETA: 0s - loss: 0.00177/7 [==============================] - ETA: 0s - loss: 0.00147/7 [==============================] - 0s 23ms/step - loss: 0.0014
1/7 [===>..........................] - ETA: 0s - loss: 1.5193e-043/7 [===========>..................] - ETA: 0s - loss: 3.7605e-045/7 [====================>.........] - ETA: 0s - loss: 0.0024    7/7 [==============================] - 0s 27ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 2.6286e-043/7 [===========>..................] - ETA: 0s - loss: 3.8564e-045/7 [====================>.........] - ETA: 0s - loss: 0.0021    7/7 [==============================] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 33ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 0.00113/7 [===========>..................] - ETA: 0s - loss: 0.00135/7 [====================>.........] - ETA: 0s - loss: 0.00107/7 [==============================] - ETA: 0s - loss: 9.0841e-047/7 [==============================] - 0s 28ms/step - loss: 9.0841e-04
Best parameters {'n_units': 72, 'n_hidden': 2} best score 0.0012018804787658154:
Train Score: 0.00088 MSE 0.02971 RMSE
Test Score: 0.00048 MSE 0.02183 RMSE
Deviation Min [1.09580466e-05], Max [0.38700475]
Deviation 99.5th pctile [0.06521902]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,    4]))
Confusion matrix 
[[1390    3]
 [   0    4]]
precision 0.57143, recall 1.00000, f1 0.72727
Time to train: 430016 ms
Saving model models/A2Benchmark/synthetic_64.csv.h5
Total Time to proces all the selected files : 434134 ms
A2Benchmark : Avg precision 0.57143 recall 1.00000 f1 0.72727 time to train 430016.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_64.csv  --epochs 20 --n_iter 3 --patience 3 :: took 440 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_65.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 05:49:37 AM MST
2020-11-30 05:49:43.711858: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 05:49:43.730249: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 05:49:43.731960: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x564f366c0740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 05:49:43.732015: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 05:49:43.732218: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_65.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 1.1284e-044/7 [================>.............] - ETA: 0s - loss: 6.0969e-057/7 [==============================] - ETA: 0s - loss: 9.3135e-057/7 [==============================] - 0s 17ms/step - loss: 9.3135e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.2075e-054/7 [================>.............] - ETA: 0s - loss: 2.2712e-057/7 [==============================] - ETA: 0s - loss: 3.9140e-057/7 [==============================] - 0s 19ms/step - loss: 3.9140e-05
1/7 [===>..........................] - ETA: 0s - loss: 7.9838e-054/7 [================>.............] - ETA: 0s - loss: 0.0240    7/7 [==============================] - 0s 14ms/step - loss: 0.0156
1/7 [===>..........................] - ETA: 0s - loss: 1.4313e-055/7 [====================>.........] - ETA: 0s - loss: 0.0089    7/7 [==============================] - 0s 14ms/step - loss: 0.0075
1/7 [===>..........................] - ETA: 0s - loss: 3.5041e-045/7 [====================>.........] - ETA: 0s - loss: 2.7236e-047/7 [==============================] - 0s 12ms/step - loss: 3.2242e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.0041e-043/7 [===========>..................] - ETA: 0s - loss: 1.6633e-045/7 [====================>.........] - ETA: 0s - loss: 1.2104e-047/7 [==============================] - ETA: 0s - loss: 1.1541e-047/7 [==============================] - 0s 23ms/step - loss: 1.1541e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.0308e-043/7 [===========>..................] - ETA: 0s - loss: 3.2626e-045/7 [====================>.........] - ETA: 0s - loss: 2.1695e-047/7 [==============================] - ETA: 0s - loss: 1.9682e-047/7 [==============================] - 0s 23ms/step - loss: 1.9682e-04
1/7 [===>..........................] - ETA: 0s - loss: 6.5289e-053/7 [===========>..................] - ETA: 0s - loss: 0.0179    5/7 [====================>.........] - ETA: 0s - loss: 0.02147/7 [==============================] - ETA: 0s - loss: 0.01707/7 [==============================] - 0s 32ms/step - loss: 0.0170
1/7 [===>..........................] - ETA: 0s - loss: 2.5869e-053/7 [===========>..................] - ETA: 0s - loss: 1.7770e-055/7 [====================>.........] - ETA: 0s - loss: 0.0097    7/7 [==============================] - ETA: 0s - loss: 0.00857/7 [==============================] - 0s 23ms/step - loss: 0.0085
1/7 [===>..........................] - ETA: 0s - loss: 0.00113/7 [===========>..................] - ETA: 0s - loss: 0.00125/7 [====================>.........] - ETA: 0s - loss: 0.00107/7 [==============================] - ETA: 0s - loss: 0.00117/7 [==============================] - 0s 23ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 1.7004e-053/7 [===========>..................] - ETA: 0s - loss: 1.8738e-045/7 [====================>.........] - ETA: 0s - loss: 1.8919e-047/7 [==============================] - ETA: 0s - loss: 1.7501e-047/7 [==============================] - 0s 26ms/step - loss: 1.7501e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.1019e-063/7 [===========>..................] - ETA: 0s - loss: 8.9100e-065/7 [====================>.........] - ETA: 0s - loss: 3.6395e-057/7 [==============================] - ETA: 0s - loss: 3.6173e-057/7 [==============================] - 0s 27ms/step - loss: 3.6173e-05
1/7 [===>..........................] - ETA: 0s - loss: 4.8453e-043/7 [===========>..................] - ETA: 0s - loss: 0.0187    5/7 [====================>.........] - ETA: 0s - loss: 0.02207/7 [==============================] - ETA: 0s - loss: 0.01767/7 [==============================] - 0s 25ms/step - loss: 0.0176
1/7 [===>..........................] - ETA: 0s - loss: 5.0264e-052/7 [=======>......................] - ETA: 0s - loss: 1.1273e-044/7 [================>.............] - ETA: 0s - loss: 3.5514e-046/7 [========================>.....] - ETA: 0s - loss: 0.0092    7/7 [==============================] - 0s 32ms/step - loss: 0.0088
1/7 [===>..........................] - ETA: 0s - loss: 7.0004e-042/7 [=======>......................] - ETA: 0s - loss: 7.3771e-044/7 [================>.............] - ETA: 0s - loss: 5.8680e-046/7 [========================>.....] - ETA: 0s - loss: 6.1562e-047/7 [==============================] - 0s 28ms/step - loss: 6.5026e-04
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.004697467048390536:
Train Score: 0.00416 MSE 0.06448 RMSE
Test Score: 0.00010 MSE 0.00982 RMSE
Deviation Min [0.00101052], Max [0.73560485]
Deviation 99.5th pctile [0.56077522]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1388,    9]))
Confusion matrix 
[[1388    0]
 [   2    7]]
precision 1.00000, recall 0.77778, f1 0.87500
Time to train: 328886 ms
Saving model models/A2Benchmark/synthetic_65.csv.h5
Total Time to proces all the selected files : 331185 ms
A2Benchmark : Avg precision 1.00000 recall 0.77778 f1 0.87500 time to train 328886.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_65.csv  --epochs 20 --n_iter 3 --patience 3 :: took 338 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_66.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 05:55:20 AM MST
2020-11-30 05:55:26.001604: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 05:55:26.020242: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 05:55:26.021745: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56414232d440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 05:55:26.021793: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 05:55:26.022012: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_66.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00235/7 [====================>.........] - ETA: 0s - loss: 0.00137/7 [==============================] - 0s 14ms/step - loss: 0.0014
1/7 [===>..........................] - ETA: 0s - loss: 8.6699e-045/7 [====================>.........] - ETA: 0s - loss: 7.8103e-047/7 [==============================] - 0s 12ms/step - loss: 7.4312e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.0917e-044/7 [================>.............] - ETA: 0s - loss: 7.8152e-047/7 [==============================] - 0s 14ms/step - loss: 7.8764e-04
1/7 [===>..........................] - ETA: 0s - loss: 6.6919e-045/7 [====================>.........] - ETA: 0s - loss: 0.0014    7/7 [==============================] - 0s 12ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 0.00115/7 [====================>.........] - ETA: 0s - loss: 0.00117/7 [==============================] - 0s 12ms/step - loss: 0.0010
1/7 [===>..........................] - ETA: 0s - loss: 0.00543/7 [===========>..................] - ETA: 0s - loss: 0.00295/7 [====================>.........] - ETA: 0s - loss: 0.00247/7 [==============================] - ETA: 0s - loss: 0.00307/7 [==============================] - 0s 31ms/step - loss: 0.0030
1/7 [===>..........................] - ETA: 0s - loss: 8.3375e-043/7 [===========>..................] - ETA: 0s - loss: 0.0011    5/7 [====================>.........] - ETA: 0s - loss: 9.7007e-047/7 [==============================] - ETA: 0s - loss: 9.3050e-047/7 [==============================] - 0s 30ms/step - loss: 9.3050e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.8851e-043/7 [===========>..................] - ETA: 0s - loss: 4.4396e-045/7 [====================>.........] - ETA: 0s - loss: 4.5720e-047/7 [==============================] - ETA: 0s - loss: 4.7467e-047/7 [==============================] - 0s 30ms/step - loss: 4.7467e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.5252e-043/7 [===========>..................] - ETA: 0s - loss: 5.5864e-045/7 [====================>.........] - ETA: 0s - loss: 0.0013    7/7 [==============================] - ETA: 0s - loss: 0.00127/7 [==============================] - 0s 31ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 9.4211e-043/7 [===========>..................] - ETA: 0s - loss: 0.0018    5/7 [====================>.........] - ETA: 0s - loss: 0.00137/7 [==============================] - ETA: 0s - loss: 0.00127/7 [==============================] - 0s 27ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 0.00154/7 [================>.............] - ETA: 0s - loss: 8.3525e-047/7 [==============================] - ETA: 0s - loss: 8.6412e-047/7 [==============================] - 0s 19ms/step - loss: 8.6412e-04
1/7 [===>..........................] - ETA: 0s - loss: 7.0060e-044/7 [================>.............] - ETA: 0s - loss: 8.2945e-047/7 [==============================] - 0s 14ms/step - loss: 8.8992e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.6073e-045/7 [====================>.........] - ETA: 0s - loss: 9.3933e-047/7 [==============================] - 0s 13ms/step - loss: 9.5061e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00114/7 [================>.............] - ETA: 0s - loss: 0.00177/7 [==============================] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 16ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 8.7356e-045/7 [====================>.........] - ETA: 0s - loss: 7.7919e-047/7 [==============================] - 0s 14ms/step - loss: 7.2570e-04
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.0010409597656689585:
Train Score: 0.00094 MSE 0.03062 RMSE
Test Score: 0.00107 MSE 0.03278 RMSE
Deviation Min [0.00010492], Max [0.31423]
Deviation 99.5th pctile [0.08341186]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,    1]))
Confusion matrix 
[[1390    6]
 [   0    1]]
precision 0.14286, recall 1.00000, f1 0.25000
Time to train: 325256 ms
Saving model models/A2Benchmark/synthetic_66.csv.h5
Total Time to proces all the selected files : 327479 ms
A2Benchmark : Avg precision 0.14286 recall 1.00000 f1 0.25000 time to train 325256.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_66.csv  --epochs 20 --n_iter 3 --patience 3 :: took 333 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_67.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 06:00:58 AM MST
2020-11-30 06:01:04.583798: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 06:01:04.602312: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 06:01:04.603922: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d28bb6b440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 06:01:04.603987: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 06:01:04.604097: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_67.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 4.6386e-045/7 [====================>.........] - ETA: 0s - loss: 6.8299e-047/7 [==============================] - 0s 15ms/step - loss: 5.7311e-04
1/7 [===>..........................] - ETA: 0s - loss: 8.5426e-054/7 [================>.............] - ETA: 0s - loss: 8.4380e-057/7 [==============================] - ETA: 0s - loss: 7.2641e-057/7 [==============================] - 0s 17ms/step - loss: 7.2641e-05
1/7 [===>..........................] - ETA: 0s - loss: 0.00116/7 [========================>.....] - ETA: 0s - loss: 0.00637/7 [==============================] - 0s 10ms/step - loss: 0.0060
1/7 [===>..........................] - ETA: 0s - loss: 2.8717e-055/7 [====================>.........] - ETA: 0s - loss: 0.0065    7/7 [==============================] - 0s 15ms/step - loss: 0.0054
1/7 [===>..........................] - ETA: 0s - loss: 5.4077e-045/7 [====================>.........] - ETA: 0s - loss: 2.5855e-047/7 [==============================] - 0s 12ms/step - loss: 2.2423e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.2694e-055/7 [====================>.........] - ETA: 0s - loss: 1.2581e-047/7 [==============================] - 0s 12ms/step - loss: 1.0546e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.0503e-045/7 [====================>.........] - ETA: 0s - loss: 7.9255e-057/7 [==============================] - 0s 13ms/step - loss: 7.4898e-05
1/7 [===>..........................] - ETA: 0s - loss: 7.4964e-054/7 [================>.............] - ETA: 0s - loss: 0.0083    7/7 [==============================] - ETA: 0s - loss: 0.00547/7 [==============================] - 0s 18ms/step - loss: 0.0054
1/7 [===>..........................] - ETA: 0s - loss: 2.2542e-055/7 [====================>.........] - ETA: 0s - loss: 0.0066    7/7 [==============================] - 0s 15ms/step - loss: 0.0056
1/7 [===>..........................] - ETA: 0s - loss: 3.4721e-045/7 [====================>.........] - ETA: 0s - loss: 1.4184e-047/7 [==============================] - 0s 13ms/step - loss: 1.2501e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.8052e-043/7 [===========>..................] - ETA: 0s - loss: 5.7539e-045/7 [====================>.........] - ETA: 0s - loss: 5.1991e-047/7 [==============================] - ETA: 0s - loss: 4.2274e-047/7 [==============================] - 0s 29ms/step - loss: 4.2274e-04
1/7 [===>..........................] - ETA: 0s - loss: 6.8036e-053/7 [===========>..................] - ETA: 0s - loss: 1.5361e-045/7 [====================>.........] - ETA: 0s - loss: 1.3363e-047/7 [==============================] - ETA: 0s - loss: 1.2011e-047/7 [==============================] - 0s 33ms/step - loss: 1.2011e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.2031e-043/7 [===========>..................] - ETA: 0s - loss: 2.1713e-045/7 [====================>.........] - ETA: 0s - loss: 0.0072    7/7 [==============================] - ETA: 0s - loss: 0.00587/7 [==============================] - 0s 30ms/step - loss: 0.0058
1/7 [===>..........................] - ETA: 0s - loss: 5.3409e-053/7 [===========>..................] - ETA: 0s - loss: 5.3958e-045/7 [====================>.........] - ETA: 0s - loss: 0.0072    7/7 [==============================] - ETA: 0s - loss: 0.00617/7 [==============================] - 0s 32ms/step - loss: 0.0061
1/7 [===>..........................] - ETA: 0s - loss: 8.9824e-043/7 [===========>..................] - ETA: 0s - loss: 4.8112e-045/7 [====================>.........] - ETA: 0s - loss: 5.6681e-047/7 [==============================] - ETA: 0s - loss: 6.1129e-047/7 [==============================] - 0s 27ms/step - loss: 6.1129e-04
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0022628549879300406:
Train Score: 0.00201 MSE 0.04485 RMSE
Test Score: 0.00041 MSE 0.02023 RMSE
Deviation Min [1.08814956e-05], Max [0.73515942]
Deviation 99.5th pctile [0.10993031]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,    4]))
Confusion matrix 
[[1390    3]
 [   0    4]]
precision 0.57143, recall 1.00000, f1 0.72727
Time to train: 297860 ms
Saving model models/A2Benchmark/synthetic_67.csv.h5
Total Time to proces all the selected files : 300145 ms
A2Benchmark : Avg precision 0.57143 recall 1.00000 f1 0.72727 time to train 297860.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_67.csv  --epochs 20 --n_iter 3 --patience 3 :: took 307 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_68.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 06:06:10 AM MST
2020-11-30 06:06:15.818831: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 06:06:15.837191: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 06:06:15.838645: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55a8b6d6a440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 06:06:15.838695: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 06:06:15.838947: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_68.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 3.9995e-043/7 [===========>..................] - ETA: 0s - loss: 7.6479e-045/7 [====================>.........] - ETA: 0s - loss: 6.5655e-047/7 [==============================] - ETA: 0s - loss: 6.9468e-047/7 [==============================] - 0s 28ms/step - loss: 6.9468e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.9082e-043/7 [===========>..................] - ETA: 0s - loss: 5.5164e-045/7 [====================>.........] - ETA: 0s - loss: 5.9568e-047/7 [==============================] - ETA: 0s - loss: 5.5770e-047/7 [==============================] - 0s 32ms/step - loss: 5.5770e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.5722e-043/7 [===========>..................] - ETA: 0s - loss: 0.0055    5/7 [====================>.........] - ETA: 0s - loss: 0.00767/7 [==============================] - ETA: 0s - loss: 0.00617/7 [==============================] - 0s 31ms/step - loss: 0.0061
1/7 [===>..........................] - ETA: 0s - loss: 6.1959e-043/7 [===========>..................] - ETA: 0s - loss: 9.1765e-045/7 [====================>.........] - ETA: 0s - loss: 0.0030    7/7 [==============================] - 0s 23ms/step - loss: 0.0029
1/7 [===>..........................] - ETA: 0s - loss: 0.00173/7 [===========>..................] - ETA: 0s - loss: 8.6402e-045/7 [====================>.........] - ETA: 0s - loss: 9.7999e-047/7 [==============================] - ETA: 0s - loss: 8.5369e-047/7 [==============================] - 0s 30ms/step - loss: 8.5369e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.0488e-046/7 [========================>.....] - ETA: 0s - loss: 0.0011    7/7 [==============================] - 0s 9ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 0.00135/7 [====================>.........] - ETA: 0s - loss: 0.00117/7 [==============================] - 0s 12ms/step - loss: 9.6524e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.3705e-045/7 [====================>.........] - ETA: 0s - loss: 0.0058    7/7 [==============================] - 0s 12ms/step - loss: 0.0048
1/7 [===>..........................] - ETA: 0s - loss: 5.6345e-045/7 [====================>.........] - ETA: 0s - loss: 0.0027    7/7 [==============================] - 0s 13ms/step - loss: 0.0027
1/7 [===>..........................] - ETA: 0s - loss: 0.00176/7 [========================>.....] - ETA: 0s - loss: 0.00147/7 [==============================] - 0s 11ms/step - loss: 0.0014
1/7 [===>..........................] - ETA: 0s - loss: 5.2593e-044/7 [================>.............] - ETA: 0s - loss: 7.0136e-047/7 [==============================] - 0s 14ms/step - loss: 6.6835e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.3408e-044/7 [================>.............] - ETA: 0s - loss: 6.3622e-047/7 [==============================] - ETA: 0s - loss: 5.8191e-047/7 [==============================] - 0s 17ms/step - loss: 5.8191e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00105/7 [====================>.........] - ETA: 0s - loss: 0.00597/7 [==============================] - 0s 14ms/step - loss: 0.0048
1/7 [===>..........................] - ETA: 0s - loss: 2.6559e-044/7 [================>.............] - ETA: 0s - loss: 4.4629e-047/7 [==============================] - 0s 14ms/step - loss: 0.0022
1/7 [===>..........................] - ETA: 0s - loss: 8.7870e-044/7 [================>.............] - ETA: 0s - loss: 6.8683e-047/7 [==============================] - ETA: 0s - loss: 6.2443e-047/7 [==============================] - 0s 18ms/step - loss: 6.2443e-04
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0017722174408845604:
Train Score: 0.00158 MSE 0.03979 RMSE
Test Score: 0.00062 MSE 0.02484 RMSE
Deviation Min [2.49239274e-05], Max [0.32966161]
Deviation 99.5th pctile [0.22900528]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1388,    9]))
Confusion matrix 
[[1388    0]
 [   2    7]]
precision 1.00000, recall 0.77778, f1 0.87500
Time to train: 338181 ms
Saving model models/A2Benchmark/synthetic_68.csv.h5
Total Time to proces all the selected files : 340686 ms
A2Benchmark : Avg precision 1.00000 recall 0.77778 f1 0.87500 time to train 338181.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_68.csv  --epochs 20 --n_iter 3 --patience 3 :: took 346 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_69.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 06:12:01 AM MST
2020-11-30 06:12:07.765957: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 06:12:07.784183: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 06:12:07.785083: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x562a83baf740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 06:12:07.785111: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 06:12:07.785222: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_69.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 8.0483e-043/7 [===========>..................] - ETA: 0s - loss: 9.2724e-045/7 [====================>.........] - ETA: 0s - loss: 7.5870e-047/7 [==============================] - ETA: 0s - loss: 6.4020e-047/7 [==============================] - 0s 32ms/step - loss: 6.4020e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.4815e-043/7 [===========>..................] - ETA: 0s - loss: 2.4630e-045/7 [====================>.........] - ETA: 0s - loss: 2.5636e-047/7 [==============================] - ETA: 0s - loss: 2.6081e-047/7 [==============================] - 0s 24ms/step - loss: 2.6081e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.0759e-043/7 [===========>..................] - ETA: 0s - loss: 2.4085e-045/7 [====================>.........] - ETA: 0s - loss: 2.6704e-047/7 [==============================] - ETA: 0s - loss: 2.4709e-047/7 [==============================] - 0s 29ms/step - loss: 2.4709e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.3119e-043/7 [===========>..................] - ETA: 0s - loss: 2.4627e-045/7 [====================>.........] - ETA: 0s - loss: 0.0033    7/7 [==============================] - ETA: 0s - loss: 0.00287/7 [==============================] - 0s 24ms/step - loss: 0.0028
1/7 [===>..........................] - ETA: 0s - loss: 8.4114e-043/7 [===========>..................] - ETA: 0s - loss: 3.4506e-045/7 [====================>.........] - ETA: 0s - loss: 3.9589e-047/7 [==============================] - 0s 24ms/step - loss: 3.4148e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.2616e-043/7 [===========>..................] - ETA: 0s - loss: 5.4214e-045/7 [====================>.........] - ETA: 0s - loss: 4.6296e-047/7 [==============================] - ETA: 0s - loss: 4.0924e-047/7 [==============================] - 0s 28ms/step - loss: 4.0924e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.2575e-043/7 [===========>..................] - ETA: 0s - loss: 2.0933e-045/7 [====================>.........] - ETA: 0s - loss: 2.1386e-047/7 [==============================] - 0s 25ms/step - loss: 2.2111e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.1510e-043/7 [===========>..................] - ETA: 0s - loss: 2.1935e-045/7 [====================>.........] - ETA: 0s - loss: 2.4975e-047/7 [==============================] - ETA: 0s - loss: 2.3208e-047/7 [==============================] - 0s 29ms/step - loss: 2.3208e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.8201e-043/7 [===========>..................] - ETA: 0s - loss: 1.9578e-045/7 [====================>.........] - ETA: 0s - loss: 0.0033    7/7 [==============================] - 0s 22ms/step - loss: 0.0028
1/7 [===>..........................] - ETA: 0s - loss: 6.4596e-043/7 [===========>..................] - ETA: 0s - loss: 2.9648e-045/7 [====================>.........] - ETA: 0s - loss: 3.1331e-047/7 [==============================] - ETA: 0s - loss: 2.9962e-047/7 [==============================] - 0s 29ms/step - loss: 2.9962e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.7893e-044/7 [================>.............] - ETA: 0s - loss: 1.9573e-047/7 [==============================] - 0s 14ms/step - loss: 1.9173e-04
1/7 [===>..........................] - ETA: 0s - loss: 7.0916e-055/7 [====================>.........] - ETA: 0s - loss: 1.3360e-047/7 [==============================] - 0s 12ms/step - loss: 1.6499e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.3764e-045/7 [====================>.........] - ETA: 0s - loss: 1.7673e-047/7 [==============================] - 0s 14ms/step - loss: 1.7265e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.3057e-045/7 [====================>.........] - ETA: 0s - loss: 0.0033    7/7 [==============================] - 0s 12ms/step - loss: 0.0027
1/7 [===>..........................] - ETA: 0s - loss: 1.4459e-044/7 [================>.............] - ETA: 0s - loss: 1.7617e-047/7 [==============================] - ETA: 0s - loss: 2.3000e-047/7 [==============================] - 0s 17ms/step - loss: 2.3000e-04
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0006979253550525755:
Train Score: 0.00064 MSE 0.02527 RMSE
Test Score: 0.00026 MSE 0.01617 RMSE
Deviation Min [1.26804456e-06], Max [0.69100046]
Deviation 99.5th pctile [0.0544939]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,    1]))
Confusion matrix 
[[1390    6]
 [   0    1]]
precision 0.14286, recall 1.00000, f1 0.25000
Time to train: 335868 ms
Saving model models/A2Benchmark/synthetic_69.csv.h5
Total Time to proces all the selected files : 338046 ms
A2Benchmark : Avg precision 0.14286 recall 1.00000 f1 0.25000 time to train 335868.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_69.csv  --epochs 20 --n_iter 3 --patience 3 :: took 345 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_6.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 06:17:51 AM MST
2020-11-30 06:17:57.113296: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 06:17:57.132316: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 06:17:57.133817: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d3930ce440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 06:17:57.133879: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 06:17:57.134092: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_6.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00153/7 [===========>..................] - ETA: 0s - loss: 0.00195/7 [====================>.........] - ETA: 0s - loss: 0.00197/7 [==============================] - ETA: 0s - loss: 0.00167/7 [==============================] - 0s 29ms/step - loss: 0.0016
1/7 [===>..........................] - ETA: 0s - loss: 4.1334e-043/7 [===========>..................] - ETA: 0s - loss: 3.9623e-045/7 [====================>.........] - ETA: 0s - loss: 4.3400e-047/7 [==============================] - ETA: 0s - loss: 4.3561e-047/7 [==============================] - 0s 27ms/step - loss: 4.3561e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.4652e-043/7 [===========>..................] - ETA: 0s - loss: 4.9595e-045/7 [====================>.........] - ETA: 0s - loss: 5.7366e-047/7 [==============================] - ETA: 0s - loss: 6.0128e-047/7 [==============================] - 0s 25ms/step - loss: 6.0128e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.7416e-042/7 [=======>......................] - ETA: 0s - loss: 3.2118e-043/7 [===========>..................] - ETA: 0s - loss: 3.5868e-044/7 [================>.............] - ETA: 0s - loss: 3.5482e-046/7 [========================>.....] - ETA: 0s - loss: 0.0015    7/7 [==============================] - 0s 35ms/step - loss: 0.0014
1/7 [===>..........................] - ETA: 0s - loss: 0.00153/7 [===========>..................] - ETA: 0s - loss: 0.00155/7 [====================>.........] - ETA: 0s - loss: 0.00167/7 [==============================] - ETA: 0s - loss: 0.00167/7 [==============================] - 0s 28ms/step - loss: 0.0016
1/7 [===>..........................] - ETA: 0s - loss: 0.00124/7 [================>.............] - ETA: 0s - loss: 0.00167/7 [==============================] - ETA: 0s - loss: 0.00177/7 [==============================] - 0s 17ms/step - loss: 0.0017
1/7 [===>..........................] - ETA: 0s - loss: 3.3678e-045/7 [====================>.........] - ETA: 0s - loss: 3.9554e-047/7 [==============================] - 0s 13ms/step - loss: 4.0591e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.6750e-044/7 [================>.............] - ETA: 0s - loss: 4.1519e-047/7 [==============================] - ETA: 0s - loss: 4.3826e-047/7 [==============================] - 0s 18ms/step - loss: 4.3826e-04
1/7 [===>..........................] - ETA: 0s - loss: 6.0751e-044/7 [================>.............] - ETA: 0s - loss: 8.5101e-047/7 [==============================] - 0s 15ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 0.00264/7 [================>.............] - ETA: 0s - loss: 0.00247/7 [==============================] - ETA: 0s - loss: 0.00257/7 [==============================] - 0s 17ms/step - loss: 0.0025
1/7 [===>..........................] - ETA: 0s - loss: 6.4764e-045/7 [====================>.........] - ETA: 0s - loss: 0.0013    7/7 [==============================] - 0s 15ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 3.5542e-045/7 [====================>.........] - ETA: 0s - loss: 8.6606e-047/7 [==============================] - 0s 14ms/step - loss: 0.0010
1/7 [===>..........................] - ETA: 0s - loss: 3.1282e-045/7 [====================>.........] - ETA: 0s - loss: 5.3763e-047/7 [==============================] - 0s 15ms/step - loss: 5.7974e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00134/7 [================>.............] - ETA: 0s - loss: 0.00157/7 [==============================] - ETA: 0s - loss: 0.00287/7 [==============================] - 0s 17ms/step - loss: 0.0028
1/7 [===>..........................] - ETA: 0s - loss: 0.00156/7 [========================>.....] - ETA: 0s - loss: 0.00407/7 [==============================] - 0s 11ms/step - loss: 0.0039
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.00114556610933505:
Train Score: 0.00080 MSE 0.02833 RMSE
Test Score: 0.00211 MSE 0.04590 RMSE
Deviation Min [4.39916786e-05], Max [0.44981863]
Deviation 99.5th pctile [0.08813548]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,    1]))
Confusion matrix 
[[1390    6]
 [   0    1]]
precision 0.14286, recall 1.00000, f1 0.25000
Time to train: 375936 ms
Saving model models/A2Benchmark/synthetic_6.csv.h5
Total Time to proces all the selected files : 380188 ms
A2Benchmark : Avg precision 0.14286 recall 1.00000 f1 0.25000 time to train 375936.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_6.csv  --epochs 20 --n_iter 3 --patience 3 :: took 386 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_70.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 06:24:22 AM MST
2020-11-30 06:24:28.497004: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 06:24:28.515262: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 06:24:28.516804: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x558838e55740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 06:24:28.516907: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 06:24:28.517141: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_70.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00113/7 [===========>..................] - ETA: 0s - loss: 9.5024e-045/7 [====================>.........] - ETA: 0s - loss: 7.1708e-047/7 [==============================] - ETA: 0s - loss: 5.7783e-047/7 [==============================] - 0s 32ms/step - loss: 5.7783e-04
1/7 [===>..........................] - ETA: 0s - loss: 9.2531e-053/7 [===========>..................] - ETA: 0s - loss: 9.7475e-055/7 [====================>.........] - ETA: 0s - loss: 8.4816e-057/7 [==============================] - 0s 27ms/step - loss: 8.4648e-05
1/7 [===>..........................] - ETA: 0s - loss: 2.5133e-054/7 [================>.............] - ETA: 0s - loss: 0.0053    6/7 [========================>.....] - ETA: 0s - loss: 0.00377/7 [==============================] - 0s 21ms/step - loss: 0.0035
1/7 [===>..........................] - ETA: 0s - loss: 1.0549e-043/7 [===========>..................] - ETA: 0s - loss: 1.2221e-045/7 [====================>.........] - ETA: 0s - loss: 0.0041    7/7 [==============================] - ETA: 0s - loss: 0.00357/7 [==============================] - 0s 23ms/step - loss: 0.0035
1/7 [===>..........................] - ETA: 0s - loss: 2.3188e-043/7 [===========>..................] - ETA: 0s - loss: 1.1791e-045/7 [====================>.........] - ETA: 0s - loss: 8.4062e-057/7 [==============================] - ETA: 0s - loss: 8.1997e-057/7 [==============================] - 0s 33ms/step - loss: 8.1997e-05
1/7 [===>..........................] - ETA: 0s - loss: 0.00173/7 [===========>..................] - ETA: 0s - loss: 0.00165/7 [====================>.........] - ETA: 0s - loss: 0.00127/7 [==============================] - ETA: 0s - loss: 0.00107/7 [==============================] - 0s 33ms/step - loss: 0.0010
1/7 [===>..........................] - ETA: 0s - loss: 2.0073e-053/7 [===========>..................] - ETA: 0s - loss: 1.0842e-045/7 [====================>.........] - ETA: 0s - loss: 2.0126e-047/7 [==============================] - ETA: 0s - loss: 2.3223e-047/7 [==============================] - 0s 25ms/step - loss: 2.3223e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.3345e-053/7 [===========>..................] - ETA: 0s - loss: 7.7273e-065/7 [====================>.........] - ETA: 0s - loss: 0.0044    7/7 [==============================] - ETA: 0s - loss: 0.00357/7 [==============================] - 0s 26ms/step - loss: 0.0035
1/7 [===>..........................] - ETA: 0s - loss: 4.5810e-043/7 [===========>..................] - ETA: 0s - loss: 4.2512e-045/7 [====================>.........] - ETA: 0s - loss: 0.0047    7/7 [==============================] - ETA: 0s - loss: 0.00397/7 [==============================] - 0s 31ms/step - loss: 0.0039
1/7 [===>..........................] - ETA: 0s - loss: 1.2507e-043/7 [===========>..................] - ETA: 0s - loss: 2.4590e-045/7 [====================>.........] - ETA: 0s - loss: 4.1748e-047/7 [==============================] - ETA: 0s - loss: 4.9729e-047/7 [==============================] - 0s 27ms/step - loss: 4.9729e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00135/7 [====================>.........] - ETA: 0s - loss: 9.3624e-047/7 [==============================] - 0s 14ms/step - loss: 7.7586e-04
1/7 [===>..........................] - ETA: 0s - loss: 9.4715e-054/7 [================>.............] - ETA: 0s - loss: 8.8340e-057/7 [==============================] - 0s 14ms/step - loss: 8.1833e-05
1/7 [===>..........................] - ETA: 0s - loss: 3.0809e-045/7 [====================>.........] - ETA: 0s - loss: 0.0045    7/7 [==============================] - 0s 14ms/step - loss: 0.0037
1/7 [===>..........................] - ETA: 0s - loss: 3.7622e-055/7 [====================>.........] - ETA: 0s - loss: 0.0040    7/7 [==============================] - 0s 13ms/step - loss: 0.0033
1/7 [===>..........................] - ETA: 0s - loss: 5.1921e-054/7 [================>.............] - ETA: 0s - loss: 2.1178e-047/7 [==============================] - 0s 15ms/step - loss: 3.5149e-04
Best parameters {'n_units': 48, 'n_hidden': 2} best score 0.001543945937009994:
Train Score: 0.00136 MSE 0.03690 RMSE
Test Score: 0.00008 MSE 0.00868 RMSE
Deviation Min [5.35251302e-05], Max [0.58358249]
Deviation 99.5th pctile [0.05834305]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,    4]))
Confusion matrix 
[[1390    3]
 [   0    4]]
precision 0.57143, recall 1.00000, f1 0.72727
Time to train: 400024 ms
Saving model models/A2Benchmark/synthetic_70.csv.h5
Total Time to proces all the selected files : 403743 ms
A2Benchmark : Avg precision 0.57143 recall 1.00000 f1 0.72727 time to train 400024.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_70.csv  --epochs 20 --n_iter 3 --patience 3 :: took 410 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_71.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 06:31:17 AM MST
2020-11-30 06:31:23.418037: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 06:31:23.436250: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 06:31:23.437752: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55b47d707740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 06:31:23.437795: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 06:31:23.438005: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_71.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00494/7 [================>.............] - ETA: 0s - loss: 0.00357/7 [==============================] - ETA: 0s - loss: 0.00287/7 [==============================] - 0s 16ms/step - loss: 0.0028
1/7 [===>..........................] - ETA: 0s - loss: 6.1335e-045/7 [====================>.........] - ETA: 0s - loss: 0.0014    7/7 [==============================] - 0s 13ms/step - loss: 0.0015
1/7 [===>..........................] - ETA: 0s - loss: 5.0601e-045/7 [====================>.........] - ETA: 0s - loss: 0.0225    7/7 [==============================] - 0s 13ms/step - loss: 0.0181
1/7 [===>..........................] - ETA: 0s - loss: 7.4227e-044/7 [================>.............] - ETA: 0s - loss: 0.0014    7/7 [==============================] - ETA: 0s - loss: 0.00907/7 [==============================] - 0s 16ms/step - loss: 0.0090
1/7 [===>..........................] - ETA: 0s - loss: 0.00264/7 [================>.............] - ETA: 0s - loss: 0.00157/7 [==============================] - ETA: 0s - loss: 0.00137/7 [==============================] - 0s 18ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 0.00264/7 [================>.............] - ETA: 0s - loss: 0.00177/7 [==============================] - ETA: 0s - loss: 0.00137/7 [==============================] - 0s 16ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 8.4930e-044/7 [================>.............] - ETA: 0s - loss: 0.0013    7/7 [==============================] - 0s 14ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 6.0415e-045/7 [====================>.........] - ETA: 0s - loss: 0.0234    7/7 [==============================] - 0s 12ms/step - loss: 0.0194
1/7 [===>..........................] - ETA: 0s - loss: 9.3997e-045/7 [====================>.........] - ETA: 0s - loss: 0.0102    7/7 [==============================] - 0s 16ms/step - loss: 0.0087
1/7 [===>..........................] - ETA: 0s - loss: 0.00265/7 [====================>.........] - ETA: 0s - loss: 0.00127/7 [==============================] - 0s 14ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 0.00255/7 [====================>.........] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 15ms/step - loss: 0.0017
1/7 [===>..........................] - ETA: 0s - loss: 7.5852e-045/7 [====================>.........] - ETA: 0s - loss: 0.0014    7/7 [==============================] - 0s 13ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 5.4546e-045/7 [====================>.........] - ETA: 0s - loss: 0.0221    7/7 [==============================] - 0s 12ms/step - loss: 0.0182
1/7 [===>..........................] - ETA: 0s - loss: 8.3492e-045/7 [====================>.........] - ETA: 0s - loss: 0.0106    7/7 [==============================] - 0s 13ms/step - loss: 0.0091
1/7 [===>..........................] - ETA: 0s - loss: 0.00334/7 [================>.............] - ETA: 0s - loss: 0.00187/7 [==============================] - ETA: 0s - loss: 0.00157/7 [==============================] - 0s 15ms/step - loss: 0.0015
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.006346437823958695:
Train Score: 0.00561 MSE 0.07489 RMSE
Test Score: 0.00100 MSE 0.03155 RMSE
Deviation Min [3.20780956e-05], Max [0.77555222]
Deviation 99.5th pctile [0.62269013]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1388,    9]))
Confusion matrix 
[[1388    0]
 [   2    7]]
precision 1.00000, recall 0.77778, f1 0.87500
Time to train: 275970 ms
Saving model models/A2Benchmark/synthetic_71.csv.h5
Total Time to proces all the selected files : 278088 ms
A2Benchmark : Avg precision 1.00000 recall 0.77778 f1 0.87500 time to train 275970.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_71.csv  --epochs 20 --n_iter 3 --patience 3 :: took 284 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_72.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 06:36:06 AM MST
2020-11-30 06:36:12.855970: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 06:36:12.874269: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 06:36:12.875419: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5587a78bc440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 06:36:12.875474: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 06:36:12.875691: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_72.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00583/7 [===========>..................] - ETA: 0s - loss: 0.00335/7 [====================>.........] - ETA: 0s - loss: 0.00257/7 [==============================] - ETA: 0s - loss: 0.00237/7 [==============================] - 0s 25ms/step - loss: 0.0023
1/7 [===>..........................] - ETA: 0s - loss: 8.2599e-053/7 [===========>..................] - ETA: 0s - loss: 1.6915e-045/7 [====================>.........] - ETA: 0s - loss: 1.1151e-047/7 [==============================] - ETA: 0s - loss: 9.8057e-057/7 [==============================] - 0s 30ms/step - loss: 9.8057e-05
1/7 [===>..........................] - ETA: 0s - loss: 5.4180e-053/7 [===========>..................] - ETA: 0s - loss: 7.3287e-055/7 [====================>.........] - ETA: 0s - loss: 6.2497e-057/7 [==============================] - ETA: 0s - loss: 5.7332e-057/7 [==============================] - 0s 29ms/step - loss: 5.7332e-05
1/7 [===>..........................] - ETA: 0s - loss: 4.4040e-043/7 [===========>..................] - ETA: 0s - loss: 2.8548e-045/7 [====================>.........] - ETA: 0s - loss: 0.0023    7/7 [==============================] - ETA: 0s - loss: 0.00197/7 [==============================] - 0s 25ms/step - loss: 0.0019
1/7 [===>..........................] - ETA: 0s - loss: 4.6393e-053/7 [===========>..................] - ETA: 0s - loss: 3.4986e-045/7 [====================>.........] - ETA: 0s - loss: 5.0802e-047/7 [==============================] - ETA: 0s - loss: 4.4415e-047/7 [==============================] - 0s 33ms/step - loss: 4.4415e-04
1/7 [===>..........................] - ETA: 0s - loss: 8.4092e-044/7 [================>.............] - ETA: 0s - loss: 2.8426e-047/7 [==============================] - ETA: 0s - loss: 2.4340e-047/7 [==============================] - 0s 15ms/step - loss: 2.4340e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00524/7 [================>.............] - ETA: 0s - loss: 0.01687/7 [==============================] - ETA: 0s - loss: 0.01817/7 [==============================] - 0s 15ms/step - loss: 0.0181
1/7 [===>..........................] - ETA: 0s - loss: 0.01994/7 [================>.............] - ETA: 0s - loss: 0.03417/7 [==============================] - 0s 15ms/step - loss: 0.0352
1/7 [===>..........................] - ETA: 0s - loss: 1.6083e-045/7 [====================>.........] - ETA: 0s - loss: 0.0022    7/7 [==============================] - 0s 15ms/step - loss: 0.0018
1/7 [===>..........................] - ETA: 0s - loss: 2.8049e-046/7 [========================>.....] - ETA: 0s - loss: 0.0025    7/7 [==============================] - 0s 10ms/step - loss: 0.0025
1/7 [===>..........................] - ETA: 0s - loss: 0.00353/7 [===========>..................] - ETA: 0s - loss: 0.00195/7 [====================>.........] - ETA: 0s - loss: 0.00157/7 [==============================] - ETA: 0s - loss: 0.00147/7 [==============================] - 0s 30ms/step - loss: 0.0014
1/7 [===>..........................] - ETA: 0s - loss: 1.9970e-053/7 [===========>..................] - ETA: 0s - loss: 3.7948e-055/7 [====================>.........] - ETA: 0s - loss: 1.7843e-047/7 [==============================] - ETA: 0s - loss: 1.8238e-047/7 [==============================] - 0s 23ms/step - loss: 1.8238e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.4025e-043/7 [===========>..................] - ETA: 0s - loss: 1.1373e-045/7 [====================>.........] - ETA: 0s - loss: 8.7757e-057/7 [==============================] - 0s 23ms/step - loss: 7.6792e-05
1/7 [===>..........................] - ETA: 0s - loss: 3.0177e-043/7 [===========>..................] - ETA: 0s - loss: 1.8676e-045/7 [====================>.........] - ETA: 0s - loss: 0.0022    7/7 [==============================] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 29ms/step - loss: 0.0018
1/7 [===>..........................] - ETA: 0s - loss: 2.5422e-053/7 [===========>..................] - ETA: 0s - loss: 3.3940e-045/7 [====================>.........] - ETA: 0s - loss: 4.8615e-047/7 [==============================] - ETA: 0s - loss: 4.2749e-047/7 [==============================] - 0s 26ms/step - loss: 4.2749e-04
Best parameters {'n_units': 48, 'n_hidden': 2} best score 0.0007876302435761318:
Train Score: 0.00040 MSE 0.01991 RMSE
Test Score: 0.00201 MSE 0.04486 RMSE
Deviation Min [2.34685344e-06], Max [0.57666516]
Deviation 99.5th pctile [0.08557486]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,    1]))
Confusion matrix 
[[1390    6]
 [   0    1]]
precision 0.14286, recall 1.00000, f1 0.25000
Time to train: 378306 ms
Saving model models/A2Benchmark/synthetic_72.csv.h5
Total Time to proces all the selected files : 382149 ms
A2Benchmark : Avg precision 0.14286 recall 1.00000 f1 0.25000 time to train 378306.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_72.csv  --epochs 20 --n_iter 3 --patience 3 :: took 389 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_73.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 06:42:40 AM MST
2020-11-30 06:42:46.259971: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 06:42:46.278264: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 06:42:46.279806: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d897fea440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 06:42:46.279876: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 06:42:46.280106: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_73.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 9.7528e-043/7 [===========>..................] - ETA: 0s - loss: 7.1492e-045/7 [====================>.........] - ETA: 0s - loss: 5.9434e-047/7 [==============================] - ETA: 0s - loss: 6.5378e-047/7 [==============================] - 0s 26ms/step - loss: 6.5378e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.8790e-043/7 [===========>..................] - ETA: 0s - loss: 5.9478e-045/7 [====================>.........] - ETA: 0s - loss: 7.8553e-047/7 [==============================] - ETA: 0s - loss: 7.4527e-047/7 [==============================] - 0s 28ms/step - loss: 7.4527e-04
1/7 [===>..........................] - ETA: 0s - loss: 6.5258e-043/7 [===========>..................] - ETA: 0s - loss: 5.0389e-045/7 [====================>.........] - ETA: 0s - loss: 0.0052    7/7 [==============================] - ETA: 0s - loss: 0.00437/7 [==============================] - 0s 27ms/step - loss: 0.0043
1/7 [===>..........................] - ETA: 0s - loss: 3.4151e-043/7 [===========>..................] - ETA: 0s - loss: 9.8455e-044/7 [================>.............] - ETA: 0s - loss: 8.9969e-046/7 [========================>.....] - ETA: 0s - loss: 0.0039    7/7 [==============================] - 0s 39ms/step - loss: 0.0037
1/7 [===>..........................] - ETA: 0s - loss: 0.00343/7 [===========>..................] - ETA: 0s - loss: 0.00165/7 [====================>.........] - ETA: 0s - loss: 0.00137/7 [==============================] - ETA: 0s - loss: 0.00177/7 [==============================] - 0s 26ms/step - loss: 0.0017
1/7 [===>..........................] - ETA: 0s - loss: 5.9446e-043/7 [===========>..................] - ETA: 0s - loss: 4.7761e-044/7 [================>.............] - ETA: 0s - loss: 6.1254e-046/7 [========================>.....] - ETA: 0s - loss: 6.3639e-047/7 [==============================] - 0s 36ms/step - loss: 6.1454e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00133/7 [===========>..................] - ETA: 0s - loss: 0.00115/7 [====================>.........] - ETA: 0s - loss: 0.00147/7 [==============================] - ETA: 0s - loss: 0.00147/7 [==============================] - 0s 28ms/step - loss: 0.0014
1/7 [===>..........................] - ETA: 0s - loss: 3.6472e-043/7 [===========>..................] - ETA: 0s - loss: 5.1382e-045/7 [====================>.........] - ETA: 0s - loss: 0.0051    7/7 [==============================] - ETA: 0s - loss: 0.00417/7 [==============================] - 0s 25ms/step - loss: 0.0041
1/7 [===>..........................] - ETA: 0s - loss: 4.7867e-043/7 [===========>..................] - ETA: 0s - loss: 0.0028    5/7 [====================>.........] - ETA: 0s - loss: 0.00527/7 [==============================] - ETA: 0s - loss: 0.00457/7 [==============================] - 0s 31ms/step - loss: 0.0045
1/7 [===>..........................] - ETA: 0s - loss: 5.7560e-043/7 [===========>..................] - ETA: 0s - loss: 5.2155e-045/7 [====================>.........] - ETA: 0s - loss: 4.8676e-047/7 [==============================] - ETA: 0s - loss: 4.5491e-047/7 [==============================] - 0s 23ms/step - loss: 4.5491e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00125/7 [====================>.........] - ETA: 0s - loss: 8.1506e-047/7 [==============================] - 0s 13ms/step - loss: 9.2231e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.5583e-045/7 [====================>.........] - ETA: 0s - loss: 0.0011    7/7 [==============================] - 0s 12ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 3.7971e-044/7 [================>.............] - ETA: 0s - loss: 0.0053    7/7 [==============================] - ETA: 0s - loss: 0.00357/7 [==============================] - 0s 17ms/step - loss: 0.0035
1/7 [===>..........................] - ETA: 0s - loss: 2.8776e-045/7 [====================>.........] - ETA: 0s - loss: 0.0040    7/7 [==============================] - 0s 11ms/step - loss: 0.0034
1/7 [===>..........................] - ETA: 0s - loss: 0.00275/7 [====================>.........] - ETA: 0s - loss: 0.00147/7 [==============================] - 0s 15ms/step - loss: 0.0015
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.002077119646128267:
Train Score: 0.00154 MSE 0.03929 RMSE
Test Score: 0.00045 MSE 0.02115 RMSE
Deviation Min [2.5597194e-05], Max [0.55024841]
Deviation 99.5th pctile [0.10256986]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,    4]))
Confusion matrix 
[[1390    3]
 [   0    4]]
precision 0.57143, recall 1.00000, f1 0.72727
Time to train: 398686 ms
Saving model models/A2Benchmark/synthetic_73.csv.h5
Total Time to proces all the selected files : 400762 ms
A2Benchmark : Avg precision 0.57143 recall 1.00000 f1 0.72727 time to train 398686.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_73.csv  --epochs 20 --n_iter 3 --patience 3 :: took 407 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_74.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 06:49:32 AM MST
2020-11-30 06:49:38.240777: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 06:49:38.259284: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 06:49:38.260888: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x564f3cac6440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 06:49:38.260943: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 06:49:38.261185: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_74.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 1.0137e-044/7 [================>.............] - ETA: 0s - loss: 1.1284e-047/7 [==============================] - ETA: 0s - loss: 1.5433e-047/7 [==============================] - 0s 17ms/step - loss: 1.5433e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.4226e-045/7 [====================>.........] - ETA: 0s - loss: 1.9654e-047/7 [==============================] - 0s 12ms/step - loss: 1.8668e-04
1/7 [===>..........................] - ETA: 0s - loss: 9.5013e-044/7 [================>.............] - ETA: 0s - loss: 0.0154    7/7 [==============================] - ETA: 0s - loss: 0.01007/7 [==============================] - 0s 19ms/step - loss: 0.0100
1/7 [===>..........................] - ETA: 0s - loss: 5.6110e-045/7 [====================>.........] - ETA: 0s - loss: 0.0055    7/7 [==============================] - 0s 14ms/step - loss: 0.0050
1/7 [===>..........................] - ETA: 0s - loss: 8.5741e-043/7 [===========>..................] - ETA: 0s - loss: 3.8459e-046/7 [========================>.....] - ETA: 0s - loss: 4.5282e-047/7 [==============================] - 0s 17ms/step - loss: 4.3604e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.9407e-043/7 [===========>..................] - ETA: 0s - loss: 2.4187e-045/7 [====================>.........] - ETA: 0s - loss: 3.9002e-047/7 [==============================] - ETA: 0s - loss: 3.9059e-047/7 [==============================] - 0s 27ms/step - loss: 3.9059e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.6560e-043/7 [===========>..................] - ETA: 0s - loss: 2.9838e-045/7 [====================>.........] - ETA: 0s - loss: 2.6363e-047/7 [==============================] - ETA: 0s - loss: 2.3640e-047/7 [==============================] - 0s 32ms/step - loss: 2.3640e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.6756e-043/7 [===========>..................] - ETA: 0s - loss: 0.0108    5/7 [====================>.........] - ETA: 0s - loss: 0.01347/7 [==============================] - ETA: 0s - loss: 0.01077/7 [==============================] - 0s 33ms/step - loss: 0.0107
1/7 [===>..........................] - ETA: 0s - loss: 6.1258e-053/7 [===========>..................] - ETA: 0s - loss: 3.6832e-045/7 [====================>.........] - ETA: 0s - loss: 0.0061    7/7 [==============================] - ETA: 0s - loss: 0.00537/7 [==============================] - 0s 28ms/step - loss: 0.0053
1/7 [===>..........................] - ETA: 0s - loss: 0.00153/7 [===========>..................] - ETA: 0s - loss: 7.7657e-045/7 [====================>.........] - ETA: 0s - loss: 9.5371e-047/7 [==============================] - ETA: 0s - loss: 0.0011    7/7 [==============================] - 0s 38ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 5.3379e-053/7 [===========>..................] - ETA: 0s - loss: 3.2870e-045/7 [====================>.........] - ETA: 0s - loss: 2.9280e-047/7 [==============================] - ETA: 0s - loss: 2.5218e-047/7 [==============================] - 0s 26ms/step - loss: 2.5218e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.1670e-043/7 [===========>..................] - ETA: 0s - loss: 2.7084e-045/7 [====================>.........] - ETA: 0s - loss: 2.5074e-047/7 [==============================] - ETA: 0s - loss: 2.2363e-047/7 [==============================] - 0s 30ms/step - loss: 2.2363e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00123/7 [===========>..................] - ETA: 0s - loss: 0.01145/7 [====================>.........] - ETA: 0s - loss: 0.01397/7 [==============================] - ETA: 0s - loss: 0.01117/7 [==============================] - 0s 25ms/step - loss: 0.0111
1/7 [===>..........................] - ETA: 0s - loss: 2.0345e-053/7 [===========>..................] - ETA: 0s - loss: 6.7997e-045/7 [====================>.........] - ETA: 0s - loss: 0.0065    7/7 [==============================] - ETA: 0s - loss: 0.00567/7 [==============================] - 0s 26ms/step - loss: 0.0056
1/7 [===>..........................] - ETA: 0s - loss: 4.8705e-043/7 [===========>..................] - ETA: 0s - loss: 3.5433e-045/7 [====================>.........] - ETA: 0s - loss: 3.1600e-047/7 [==============================] - ETA: 0s - loss: 2.8656e-047/7 [==============================] - 0s 25ms/step - loss: 2.8656e-04
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.003152231633430347:
Train Score: 0.00266 MSE 0.05155 RMSE
Test Score: 0.00026 MSE 0.01599 RMSE
Deviation Min [3.42878461e-06], Max [0.58757701]
Deviation 99.5th pctile [0.46017205]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1388,    9]))
Confusion matrix 
[[1388    0]
 [   2    7]]
precision 1.00000, recall 0.77778, f1 0.87500
Time to train: 418119 ms
Saving model models/A2Benchmark/synthetic_74.csv.h5
Total Time to proces all the selected files : 420381 ms
A2Benchmark : Avg precision 1.00000 recall 0.77778 f1 0.87500 time to train 418119.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_74.csv  --epochs 20 --n_iter 3 --patience 3 :: took 427 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_75.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 06:56:44 AM MST
2020-11-30 06:56:49.628267: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 06:56:49.647228: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 06:56:49.648613: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5628b00bb440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 06:56:49.648660: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 06:56:49.648847: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_75.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00133/7 [===========>..................] - ETA: 0s - loss: 0.00145/7 [====================>.........] - ETA: 0s - loss: 0.00147/7 [==============================] - ETA: 0s - loss: 0.00147/7 [==============================] - 0s 30ms/step - loss: 0.0014
1/7 [===>..........................] - ETA: 0s - loss: 0.00183/7 [===========>..................] - ETA: 0s - loss: 0.00155/7 [====================>.........] - ETA: 0s - loss: 0.00177/7 [==============================] - ETA: 0s - loss: 0.00167/7 [==============================] - 0s 30ms/step - loss: 0.0016
1/7 [===>..........................] - ETA: 0s - loss: 8.2634e-043/7 [===========>..................] - ETA: 0s - loss: 0.0012    5/7 [====================>.........] - ETA: 0s - loss: 0.00127/7 [==============================] - ETA: 0s - loss: 0.00137/7 [==============================] - 0s 27ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 0.00163/7 [===========>..................] - ETA: 0s - loss: 0.00155/7 [====================>.........] - ETA: 0s - loss: 0.00407/7 [==============================] - ETA: 0s - loss: 0.00367/7 [==============================] - 0s 27ms/step - loss: 0.0036
1/7 [===>..........................] - ETA: 0s - loss: 0.00163/7 [===========>..................] - ETA: 0s - loss: 0.00145/7 [====================>.........] - ETA: 0s - loss: 0.00137/7 [==============================] - ETA: 0s - loss: 0.00147/7 [==============================] - 0s 34ms/step - loss: 0.0014
1/7 [===>..........................] - ETA: 0s - loss: 0.00125/7 [====================>.........] - ETA: 0s - loss: 0.00147/7 [==============================] - 0s 11ms/step - loss: 0.0014
1/7 [===>..........................] - ETA: 0s - loss: 0.00245/7 [====================>.........] - ETA: 0s - loss: 0.00217/7 [==============================] - 0s 14ms/step - loss: 0.0022
1/7 [===>..........................] - ETA: 0s - loss: 9.4494e-045/7 [====================>.........] - ETA: 0s - loss: 0.0016    7/7 [==============================] - 0s 15ms/step - loss: 0.0017
1/7 [===>..........................] - ETA: 0s - loss: 0.00245/7 [====================>.........] - ETA: 0s - loss: 0.00487/7 [==============================] - 0s 12ms/step - loss: 0.0043
1/7 [===>..........................] - ETA: 0s - loss: 0.00195/7 [====================>.........] - ETA: 0s - loss: 0.00157/7 [==============================] - 0s 12ms/step - loss: 0.0015
1/7 [===>..........................] - ETA: 0s - loss: 0.00134/7 [================>.............] - ETA: 0s - loss: 0.00157/7 [==============================] - ETA: 0s - loss: 0.00157/7 [==============================] - 0s 18ms/step - loss: 0.0015
1/7 [===>..........................] - ETA: 0s - loss: 0.00214/7 [================>.............] - ETA: 0s - loss: 0.00177/7 [==============================] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 19ms/step - loss: 0.0018
1/7 [===>..........................] - ETA: 0s - loss: 8.3444e-044/7 [================>.............] - ETA: 0s - loss: 0.0018    7/7 [==============================] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 18ms/step - loss: 0.0018
1/7 [===>..........................] - ETA: 0s - loss: 0.00174/7 [================>.............] - ETA: 0s - loss: 0.00157/7 [==============================] - ETA: 0s - loss: 0.00377/7 [==============================] - 0s 16ms/step - loss: 0.0037
1/7 [===>..........................] - ETA: 0s - loss: 0.00194/7 [================>.............] - ETA: 0s - loss: 0.00167/7 [==============================] - ETA: 0s - loss: 0.00177/7 [==============================] - 0s 18ms/step - loss: 0.0017
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.001840440579690039:
Train Score: 0.00185 MSE 0.04302 RMSE
Test Score: 0.00170 MSE 0.04119 RMSE
Deviation Min [7.04531411e-05], Max [0.61888951]
Deviation 99.5th pctile [0.11528673]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,    1]))
Confusion matrix 
[[1390    6]
 [   0    1]]
precision 0.14286, recall 1.00000, f1 0.25000
Time to train: 340747 ms
Saving model models/A2Benchmark/synthetic_75.csv.h5
Total Time to proces all the selected files : 345067 ms
A2Benchmark : Avg precision 0.14286 recall 1.00000 f1 0.25000 time to train 340747.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_75.csv  --epochs 20 --n_iter 3 --patience 3 :: took 351 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_76.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 07:02:40 AM MST
2020-11-30 07:02:45.786389: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 07:02:45.805298: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 07:02:45.806975: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f660407740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 07:02:45.807003: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 07:02:45.807108: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_76.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 8.1350e-043/7 [===========>..................] - ETA: 0s - loss: 8.6761e-045/7 [====================>.........] - ETA: 0s - loss: 7.5525e-047/7 [==============================] - ETA: 0s - loss: 7.0941e-047/7 [==============================] - 0s 33ms/step - loss: 7.0941e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.6514e-043/7 [===========>..................] - ETA: 0s - loss: 6.5272e-045/7 [====================>.........] - ETA: 0s - loss: 6.4321e-047/7 [==============================] - ETA: 0s - loss: 6.6646e-047/7 [==============================] - 0s 23ms/step - loss: 6.6646e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00113/7 [===========>..................] - ETA: 0s - loss: 8.5776e-045/7 [====================>.........] - ETA: 0s - loss: 0.0052    7/7 [==============================] - ETA: 0s - loss: 0.00437/7 [==============================] - 0s 30ms/step - loss: 0.0043
1/7 [===>..........................] - ETA: 0s - loss: 6.0282e-043/7 [===========>..................] - ETA: 0s - loss: 3.9940e-045/7 [====================>.........] - ETA: 0s - loss: 0.0040    7/7 [==============================] - ETA: 0s - loss: 0.00357/7 [==============================] - 0s 28ms/step - loss: 0.0035
1/7 [===>..........................] - ETA: 0s - loss: 0.00213/7 [===========>..................] - ETA: 0s - loss: 9.0902e-045/7 [====================>.........] - ETA: 0s - loss: 9.9906e-047/7 [==============================] - ETA: 0s - loss: 9.1327e-047/7 [==============================] - 0s 31ms/step - loss: 9.1327e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00143/7 [===========>..................] - ETA: 0s - loss: 0.00165/7 [====================>.........] - ETA: 0s - loss: 0.00137/7 [==============================] - ETA: 0s - loss: 0.00117/7 [==============================] - 0s 25ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 3.6212e-043/7 [===========>..................] - ETA: 0s - loss: 6.0654e-045/7 [====================>.........] - ETA: 0s - loss: 6.1915e-047/7 [==============================] - ETA: 0s - loss: 6.2590e-047/7 [==============================] - 0s 26ms/step - loss: 6.2590e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.8153e-043/7 [===========>..................] - ETA: 0s - loss: 4.3662e-045/7 [====================>.........] - ETA: 0s - loss: 0.0045    7/7 [==============================] - ETA: 0s - loss: 0.00377/7 [==============================] - 0s 27ms/step - loss: 0.0037
1/7 [===>..........................] - ETA: 0s - loss: 6.9805e-043/7 [===========>..................] - ETA: 0s - loss: 5.2843e-045/7 [====================>.........] - ETA: 0s - loss: 0.0040    7/7 [==============================] - ETA: 0s - loss: 0.00377/7 [==============================] - 0s 36ms/step - loss: 0.0037
1/7 [===>..........................] - ETA: 0s - loss: 0.00313/7 [===========>..................] - ETA: 0s - loss: 0.00145/7 [====================>.........] - ETA: 0s - loss: 0.00187/7 [==============================] - ETA: 0s - loss: 0.00157/7 [==============================] - 0s 28ms/step - loss: 0.0015
1/7 [===>..........................] - ETA: 0s - loss: 9.3816e-043/7 [===========>..................] - ETA: 0s - loss: 9.5877e-045/7 [====================>.........] - ETA: 0s - loss: 8.3711e-047/7 [==============================] - ETA: 0s - loss: 7.0815e-047/7 [==============================] - 0s 29ms/step - loss: 7.0815e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.5104e-043/7 [===========>..................] - ETA: 0s - loss: 5.1534e-045/7 [====================>.........] - ETA: 0s - loss: 5.2349e-047/7 [==============================] - ETA: 0s - loss: 5.0455e-047/7 [==============================] - 0s 26ms/step - loss: 5.0455e-04
1/7 [===>..........................] - ETA: 0s - loss: 8.2102e-043/7 [===========>..................] - ETA: 0s - loss: 6.5335e-045/7 [====================>.........] - ETA: 0s - loss: 0.0050    7/7 [==============================] - ETA: 0s - loss: 0.00417/7 [==============================] - 0s 27ms/step - loss: 0.0041
1/7 [===>..........................] - ETA: 0s - loss: 0.00113/7 [===========>..................] - ETA: 0s - loss: 5.9794e-045/7 [====================>.........] - ETA: 0s - loss: 0.0041    7/7 [==============================] - ETA: 0s - loss: 0.00377/7 [==============================] - 0s 27ms/step - loss: 0.0037
1/7 [===>..........................] - ETA: 0s - loss: 0.00353/7 [===========>..................] - ETA: 0s - loss: 0.00155/7 [====================>.........] - ETA: 0s - loss: 0.00187/7 [==============================] - ETA: 0s - loss: 0.00157/7 [==============================] - 0s 38ms/step - loss: 0.0015
Best parameters {'n_units': 48, 'n_hidden': 2} best score 0.002022664784453809:
Train Score: 0.00171 MSE 0.04134 RMSE
Test Score: 0.00124 MSE 0.03522 RMSE
Deviation Min [6.85113544e-06], Max [0.56162855]
Deviation 99.5th pctile [0.09697409]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,    4]))
Confusion matrix 
[[1390    3]
 [   0    4]]
precision 0.57143, recall 1.00000, f1 0.72727
Time to train: 582469 ms
Saving model models/A2Benchmark/synthetic_76.csv.h5
Total Time to proces all the selected files : 585969 ms
A2Benchmark : Avg precision 0.57143 recall 1.00000 f1 0.72727 time to train 582469.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_76.csv  --epochs 20 --n_iter 3 --patience 3 :: took 592 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_77.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 07:12:37 AM MST
2020-11-30 07:12:43.145715: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 07:12:43.164230: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 07:12:43.165749: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5609dc564740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 07:12:43.165796: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 07:12:43.166022: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_77.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00143/7 [===========>..................] - ETA: 0s - loss: 0.00135/7 [====================>.........] - ETA: 0s - loss: 0.00107/7 [==============================] - ETA: 0s - loss: 8.5629e-047/7 [==============================] - 0s 30ms/step - loss: 8.5629e-04
1/7 [===>..........................] - ETA: 0s - loss: 6.1906e-052/7 [=======>......................] - ETA: 0s - loss: 7.4620e-054/7 [================>.............] - ETA: 0s - loss: 9.9653e-056/7 [========================>.....] - ETA: 0s - loss: 1.1064e-047/7 [==============================] - 0s 41ms/step - loss: 1.1134e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.1866e-043/7 [===========>..................] - ETA: 0s - loss: 0.0179    5/7 [====================>.........] - ETA: 0s - loss: 0.02167/7 [==============================] - ETA: 0s - loss: 0.01727/7 [==============================] - 0s 39ms/step - loss: 0.0172
1/7 [===>..........................] - ETA: 0s - loss: 2.6455e-043/7 [===========>..................] - ETA: 0s - loss: 2.5766e-045/7 [====================>.........] - ETA: 0s - loss: 0.0103    7/7 [==============================] - ETA: 0s - loss: 0.00877/7 [==============================] - 0s 30ms/step - loss: 0.0087
1/7 [===>..........................] - ETA: 0s - loss: 0.00113/7 [===========>..................] - ETA: 0s - loss: 0.00145/7 [====================>.........] - ETA: 0s - loss: 0.00157/7 [==============================] - ETA: 0s - loss: 0.00157/7 [==============================] - 0s 38ms/step - loss: 0.0015
1/7 [===>..........................] - ETA: 0s - loss: 7.7831e-054/7 [================>.............] - ETA: 0s - loss: 5.5753e-057/7 [==============================] - ETA: 0s - loss: 3.7398e-057/7 [==============================] - 0s 17ms/step - loss: 3.7398e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.6692e-044/7 [================>.............] - ETA: 0s - loss: 1.7076e-047/7 [==============================] - ETA: 0s - loss: 1.6914e-047/7 [==============================] - 0s 16ms/step - loss: 1.6914e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.6002e-065/7 [====================>.........] - ETA: 0s - loss: 0.0197    7/7 [==============================] - 0s 13ms/step - loss: 0.0157
1/7 [===>..........................] - ETA: 0s - loss: 6.4740e-044/7 [================>.............] - ETA: 0s - loss: 6.4958e-047/7 [==============================] - ETA: 0s - loss: 0.0083    7/7 [==============================] - 0s 18ms/step - loss: 0.0083
1/7 [===>..........................] - ETA: 0s - loss: 0.00134/7 [================>.............] - ETA: 0s - loss: 0.00147/7 [==============================] - ETA: 0s - loss: 0.00147/7 [==============================] - 0s 17ms/step - loss: 0.0014
1/7 [===>..........................] - ETA: 0s - loss: 2.7100e-045/7 [====================>.........] - ETA: 0s - loss: 1.9424e-047/7 [==============================] - 0s 12ms/step - loss: 1.6266e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.1191e-065/7 [====================>.........] - ETA: 0s - loss: 9.0629e-067/7 [==============================] - 0s 11ms/step - loss: 9.9853e-06
1/7 [===>..........................] - ETA: 0s - loss: 2.2031e-055/7 [====================>.........] - ETA: 0s - loss: 0.0191    7/7 [==============================] - 0s 13ms/step - loss: 0.0152
1/7 [===>..........................] - ETA: 0s - loss: 8.6707e-056/7 [========================>.....] - ETA: 0s - loss: 0.0079    7/7 [==============================] - 0s 11ms/step - loss: 0.0075
1/7 [===>..........................] - ETA: 0s - loss: 3.4869e-064/7 [================>.............] - ETA: 0s - loss: 5.4399e-067/7 [==============================] - ETA: 0s - loss: 6.0364e-067/7 [==============================] - 0s 17ms/step - loss: 6.0364e-06
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.004589833822137734:
Train Score: 0.00394 MSE 0.06274 RMSE
Test Score: 0.00033 MSE 0.01830 RMSE
Deviation Min [4.30372263e-05], Max [0.7470527]
Deviation 99.5th pctile [0.61115048]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1388,    9]))
Confusion matrix 
[[1388    0]
 [   2    7]]
precision 1.00000, recall 0.77778, f1 0.87500
Time to train: 299176 ms
Saving model models/A2Benchmark/synthetic_77.csv.h5
Total Time to proces all the selected files : 301165 ms
A2Benchmark : Avg precision 1.00000 recall 0.77778 f1 0.87500 time to train 299176.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_77.csv  --epochs 20 --n_iter 3 --patience 3 :: took 307 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_78.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 07:17:49 AM MST
2020-11-30 07:17:55.527230: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 07:17:55.546219: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 07:17:55.547124: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d231919740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 07:17:55.547151: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 07:17:55.547251: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_78.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00335/7 [====================>.........] - ETA: 0s - loss: 0.00277/7 [==============================] - 0s 12ms/step - loss: 0.0025
1/7 [===>..........................] - ETA: 0s - loss: 0.00264/7 [================>.............] - ETA: 0s - loss: 0.00267/7 [==============================] - 0s 13ms/step - loss: 0.0027
1/7 [===>..........................] - ETA: 0s - loss: 0.00165/7 [====================>.........] - ETA: 0s - loss: 0.00267/7 [==============================] - 0s 12ms/step - loss: 0.0034
1/7 [===>..........................] - ETA: 0s - loss: 0.00265/7 [====================>.........] - ETA: 0s - loss: 0.00317/7 [==============================] - 0s 13ms/step - loss: 0.0030
1/7 [===>..........................] - ETA: 0s - loss: 0.00414/7 [================>.............] - ETA: 0s - loss: 0.00317/7 [==============================] - ETA: 0s - loss: 0.00267/7 [==============================] - 0s 16ms/step - loss: 0.0026
1/7 [===>..........................] - ETA: 0s - loss: 0.00233/7 [===========>..................] - ETA: 0s - loss: 0.00235/7 [====================>.........] - ETA: 0s - loss: 0.00257/7 [==============================] - ETA: 0s - loss: 0.00237/7 [==============================] - 0s 32ms/step - loss: 0.0023
1/7 [===>..........................] - ETA: 0s - loss: 0.00323/7 [===========>..................] - ETA: 0s - loss: 0.00265/7 [====================>.........] - ETA: 0s - loss: 0.00307/7 [==============================] - ETA: 0s - loss: 0.00277/7 [==============================] - 0s 25ms/step - loss: 0.0027
1/7 [===>..........................] - ETA: 0s - loss: 0.00263/7 [===========>..................] - ETA: 0s - loss: 0.00235/7 [====================>.........] - ETA: 0s - loss: 0.00247/7 [==============================] - ETA: 0s - loss: 0.00277/7 [==============================] - 0s 32ms/step - loss: 0.0027
1/7 [===>..........................] - ETA: 0s - loss: 0.00333/7 [===========>..................] - ETA: 0s - loss: 0.00265/7 [====================>.........] - ETA: 0s - loss: 0.00327/7 [==============================] - ETA: 0s - loss: 0.00317/7 [==============================] - 0s 36ms/step - loss: 0.0031
1/7 [===>..........................] - ETA: 0s - loss: 0.00443/7 [===========>..................] - ETA: 0s - loss: 0.00285/7 [====================>.........] - ETA: 0s - loss: 0.00277/7 [==============================] - ETA: 0s - loss: 0.00257/7 [==============================] - 0s 30ms/step - loss: 0.0025
1/7 [===>..........................] - ETA: 0s - loss: 0.00273/7 [===========>..................] - ETA: 0s - loss: 0.00255/7 [====================>.........] - ETA: 0s - loss: 0.00247/7 [==============================] - ETA: 0s - loss: 0.00237/7 [==============================] - 0s 26ms/step - loss: 0.0023
1/7 [===>..........................] - ETA: 0s - loss: 0.00253/7 [===========>..................] - ETA: 0s - loss: 0.00205/7 [====================>.........] - ETA: 0s - loss: 0.00327/7 [==============================] - ETA: 0s - loss: 0.00317/7 [==============================] - 0s 27ms/step - loss: 0.0031
1/7 [===>..........................] - ETA: 0s - loss: 0.00133/7 [===========>..................] - ETA: 0s - loss: 0.00235/7 [====================>.........] - ETA: 0s - loss: 0.00247/7 [==============================] - ETA: 0s - loss: 0.00297/7 [==============================] - 0s 38ms/step - loss: 0.0029
1/7 [===>..........................] - ETA: 0s - loss: 0.00263/7 [===========>..................] - ETA: 0s - loss: 0.00225/7 [====================>.........] - ETA: 0s - loss: 0.00307/7 [==============================] - ETA: 0s - loss: 0.00307/7 [==============================] - 0s 26ms/step - loss: 0.0030
1/7 [===>..........................] - ETA: 0s - loss: 0.01103/7 [===========>..................] - ETA: 0s - loss: 0.00595/7 [====================>.........] - ETA: 0s - loss: 0.00507/7 [==============================] - ETA: 0s - loss: 0.00437/7 [==============================] - 0s 25ms/step - loss: 0.0043
Best parameters {'n_units': 72, 'n_hidden': 2} best score 0.0026864327024668454:
Train Score: 0.00250 MSE 0.05000 RMSE
Test Score: 0.00264 MSE 0.05142 RMSE
Deviation Min [0.00012587], Max [0.33463316]
Deviation 99.5th pctile [0.14361154]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,    1]))
Confusion matrix 
[[1390    6]
 [   0    1]]
precision 0.14286, recall 1.00000, f1 0.25000
Time to train: 458179 ms
Saving model models/A2Benchmark/synthetic_78.csv.h5
Total Time to proces all the selected files : 462081 ms
A2Benchmark : Avg precision 0.14286 recall 1.00000 f1 0.25000 time to train 458179.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_78.csv  --epochs 20 --n_iter 3 --patience 3 :: took 469 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_79.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 07:25:43 AM MST
2020-11-30 07:25:48.824240: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 07:25:48.843181: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 07:25:48.844477: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f8322da440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 07:25:48.844521: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 07:25:48.844712: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_79.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 1.3026e-044/7 [================>.............] - ETA: 0s - loss: 4.4348e-057/7 [==============================] - ETA: 0s - loss: 3.8693e-057/7 [==============================] - 0s 17ms/step - loss: 3.8693e-05
1/7 [===>..........................] - ETA: 0s - loss: 4.8604e-054/7 [================>.............] - ETA: 0s - loss: 8.1826e-057/7 [==============================] - 0s 15ms/step - loss: 6.2730e-05
1/7 [===>..........................] - ETA: 0s - loss: 7.7200e-054/7 [================>.............] - ETA: 0s - loss: 0.0083    7/7 [==============================] - ETA: 0s - loss: 0.00547/7 [==============================] - 0s 17ms/step - loss: 0.0054
1/7 [===>..........................] - ETA: 0s - loss: 3.7928e-044/7 [================>.............] - ETA: 0s - loss: 2.3169e-047/7 [==============================] - 0s 16ms/step - loss: 0.0057
1/7 [===>..........................] - ETA: 0s - loss: 0.00114/7 [================>.............] - ETA: 0s - loss: 8.3305e-047/7 [==============================] - ETA: 0s - loss: 8.7000e-047/7 [==============================] - 0s 18ms/step - loss: 8.7000e-04
1/7 [===>..........................] - ETA: 0s - loss: 9.0884e-045/7 [====================>.........] - ETA: 0s - loss: 3.6370e-047/7 [==============================] - 0s 13ms/step - loss: 3.4259e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.2271e-055/7 [====================>.........] - ETA: 0s - loss: 7.6008e-057/7 [==============================] - 0s 13ms/step - loss: 7.4719e-05
1/7 [===>..........................] - ETA: 0s - loss: 2.6726e-045/7 [====================>.........] - ETA: 0s - loss: 0.0069    7/7 [==============================] - 0s 13ms/step - loss: 0.0055
1/7 [===>..........................] - ETA: 0s - loss: 1.3926e-044/7 [================>.............] - ETA: 0s - loss: 6.2678e-057/7 [==============================] - ETA: 0s - loss: 0.0055    7/7 [==============================] - 0s 17ms/step - loss: 0.0055
1/7 [===>..........................] - ETA: 0s - loss: 2.8976e-044/7 [================>.............] - ETA: 0s - loss: 1.8377e-047/7 [==============================] - ETA: 0s - loss: 2.0647e-047/7 [==============================] - 0s 17ms/step - loss: 2.0647e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00103/7 [===========>..................] - ETA: 0s - loss: 4.5875e-045/7 [====================>.........] - ETA: 0s - loss: 2.8594e-047/7 [==============================] - ETA: 0s - loss: 2.4071e-047/7 [==============================] - 0s 38ms/step - loss: 2.4071e-04
1/7 [===>..........................] - ETA: 0s - loss: 9.8293e-053/7 [===========>..................] - ETA: 0s - loss: 1.0906e-045/7 [====================>.........] - ETA: 0s - loss: 7.1321e-057/7 [==============================] - ETA: 0s - loss: 6.0711e-057/7 [==============================] - 0s 27ms/step - loss: 6.0711e-05
1/7 [===>..........................] - ETA: 0s - loss: 2.1361e-042/7 [=======>......................] - ETA: 0s - loss: 2.5613e-044/7 [================>.............] - ETA: 0s - loss: 0.0087    6/7 [========================>.....] - ETA: 0s - loss: 0.00607/7 [==============================] - 0s 46ms/step - loss: 0.0057
1/7 [===>..........................] - ETA: 0s - loss: 4.8605e-053/7 [===========>..................] - ETA: 0s - loss: 2.9812e-045/7 [====================>.........] - ETA: 0s - loss: 0.0069    7/7 [==============================] - ETA: 0s - loss: 0.00637/7 [==============================] - 0s 33ms/step - loss: 0.0063
1/7 [===>..........................] - ETA: 0s - loss: 1.5408e-043/7 [===========>..................] - ETA: 0s - loss: 2.9896e-045/7 [====================>.........] - ETA: 0s - loss: 3.9207e-047/7 [==============================] - ETA: 0s - loss: 3.4815e-047/7 [==============================] - 0s 25ms/step - loss: 3.4815e-04
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0023307973038754425:
Train Score: 0.00230 MSE 0.04797 RMSE
Test Score: 0.00063 MSE 0.02518 RMSE
Deviation Min [2.6383615e-06], Max [0.75760129]
Deviation 99.5th pctile [0.0984647]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,    4]))
Confusion matrix 
[[1390    3]
 [   0    4]]
precision 0.57143, recall 1.00000, f1 0.72727
Time to train: 278888 ms
Saving model models/A2Benchmark/synthetic_79.csv.h5
Total Time to proces all the selected files : 281281 ms
A2Benchmark : Avg precision 0.57143 recall 1.00000 f1 0.72727 time to train 278888.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_79.csv  --epochs 20 --n_iter 3 --patience 3 :: took 287 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_7.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 07:30:35 AM MST
2020-11-30 07:30:41.465502: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 07:30:41.484224: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 07:30:41.485697: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x562390de4740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 07:30:41.485749: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 07:30:41.485988: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_7.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 7.1258e-045/7 [====================>.........] - ETA: 0s - loss: 0.0016    7/7 [==============================] - 0s 13ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 0.00115/7 [====================>.........] - ETA: 0s - loss: 6.2647e-047/7 [==============================] - 0s 12ms/step - loss: 5.2130e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.7369e-045/7 [====================>.........] - ETA: 0s - loss: 0.0065    7/7 [==============================] - 0s 12ms/step - loss: 0.0053
1/7 [===>..........................] - ETA: 0s - loss: 2.3634e-045/7 [====================>.........] - ETA: 0s - loss: 0.0061    7/7 [==============================] - 0s 14ms/step - loss: 0.0050
1/7 [===>..........................] - ETA: 0s - loss: 0.00134/7 [================>.............] - ETA: 0s - loss: 0.00137/7 [==============================] - ETA: 0s - loss: 8.5915e-047/7 [==============================] - 0s 15ms/step - loss: 8.5915e-04
1/7 [===>..........................] - ETA: 0s - loss: 7.0038e-045/7 [====================>.........] - ETA: 0s - loss: 0.0016    7/7 [==============================] - 0s 14ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 1.5325e-045/7 [====================>.........] - ETA: 0s - loss: 2.9489e-047/7 [==============================] - 0s 14ms/step - loss: 5.8234e-04
1/7 [===>..........................] - ETA: 0s - loss: 9.7164e-054/7 [================>.............] - ETA: 0s - loss: 0.0086    7/7 [==============================] - ETA: 0s - loss: 0.00607/7 [==============================] - 0s 17ms/step - loss: 0.0060
1/7 [===>..........................] - ETA: 0s - loss: 4.1764e-045/7 [====================>.........] - ETA: 0s - loss: 0.0063    7/7 [==============================] - 0s 13ms/step - loss: 0.0053
1/7 [===>..........................] - ETA: 0s - loss: 4.6543e-045/7 [====================>.........] - ETA: 0s - loss: 2.9655e-047/7 [==============================] - 0s 14ms/step - loss: 3.0388e-04
1/7 [===>..........................] - ETA: 0s - loss: 7.4788e-043/7 [===========>..................] - ETA: 0s - loss: 0.0025    5/7 [====================>.........] - ETA: 0s - loss: 0.00247/7 [==============================] - 0s 31ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 9.9330e-043/7 [===========>..................] - ETA: 0s - loss: 0.0015    5/7 [====================>.........] - ETA: 0s - loss: 0.00107/7 [==============================] - ETA: 0s - loss: 0.00117/7 [==============================] - 0s 26ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 0.00103/7 [===========>..................] - ETA: 0s - loss: 8.7001e-045/7 [====================>.........] - ETA: 0s - loss: 0.0110    7/7 [==============================] - ETA: 0s - loss: 0.01147/7 [==============================] - 0s 34ms/step - loss: 0.0114
1/7 [===>..........................] - ETA: 0s - loss: 0.00673/7 [===========>..................] - ETA: 0s - loss: 0.00335/7 [====================>.........] - ETA: 0s - loss: 0.00857/7 [==============================] - ETA: 0s - loss: 0.00747/7 [==============================] - 0s 25ms/step - loss: 0.0074
1/7 [===>..........................] - ETA: 0s - loss: 0.00123/7 [===========>..................] - ETA: 0s - loss: 8.0472e-045/7 [====================>.........] - ETA: 0s - loss: 5.1412e-047/7 [==============================] - ETA: 0s - loss: 4.3487e-047/7 [==============================] - 0s 26ms/step - loss: 4.3487e-04
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.0025710290297865867:
Train Score: 0.00195 MSE 0.04420 RMSE
Test Score: 0.00072 MSE 0.02683 RMSE
Deviation Min [1.74971977e-05], Max [0.70476303]
Deviation 99.5th pctile [0.11576936]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,    4]))
Confusion matrix 
[[1390    3]
 [   0    4]]
precision 0.57143, recall 1.00000, f1 0.72727
Time to train: 217748 ms
Saving model models/A2Benchmark/synthetic_7.csv.h5
Total Time to proces all the selected files : 219848 ms
A2Benchmark : Avg precision 0.57143 recall 1.00000 f1 0.72727 time to train 217748.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_7.csv  --epochs 20 --n_iter 3 --patience 3 :: took 226 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_80.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 07:34:26 AM MST
2020-11-30 07:34:32.301262: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 07:34:32.320276: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 07:34:32.321799: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f481003440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 07:34:32.321867: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 07:34:32.322091: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_80.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00223/7 [===========>..................] - ETA: 0s - loss: 0.00185/7 [====================>.........] - ETA: 0s - loss: 0.00197/7 [==============================] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 25ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 0.00213/7 [===========>..................] - ETA: 0s - loss: 0.00215/7 [====================>.........] - ETA: 0s - loss: 0.00277/7 [==============================] - ETA: 0s - loss: 0.00267/7 [==============================] - 0s 25ms/step - loss: 0.0026
1/7 [===>..........................] - ETA: 0s - loss: 7.8272e-043/7 [===========>..................] - ETA: 0s - loss: 0.0065    5/7 [====================>.........] - ETA: 0s - loss: 0.00827/7 [==============================] - ETA: 0s - loss: 0.00677/7 [==============================] - 0s 34ms/step - loss: 0.0067
1/7 [===>..........................] - ETA: 0s - loss: 7.6984e-043/7 [===========>..................] - ETA: 0s - loss: 0.0023    5/7 [====================>.........] - ETA: 0s - loss: 0.00447/7 [==============================] - ETA: 0s - loss: 0.00417/7 [==============================] - 0s 33ms/step - loss: 0.0041
1/7 [===>..........................] - ETA: 0s - loss: 0.00843/7 [===========>..................] - ETA: 0s - loss: 0.00415/7 [====================>.........] - ETA: 0s - loss: 0.00357/7 [==============================] - ETA: 0s - loss: 0.00417/7 [==============================] - 0s 29ms/step - loss: 0.0041
1/7 [===>..........................] - ETA: 0s - loss: 0.00206/7 [========================>.....] - ETA: 0s - loss: 0.00147/7 [==============================] - 0s 10ms/step - loss: 0.0014
1/7 [===>..........................] - ETA: 0s - loss: 6.1876e-045/7 [====================>.........] - ETA: 0s - loss: 0.0013    7/7 [==============================] - 0s 12ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 7.5402e-045/7 [====================>.........] - ETA: 0s - loss: 0.0083    7/7 [==============================] - 0s 12ms/step - loss: 0.0067
1/7 [===>..........................] - ETA: 0s - loss: 6.5560e-044/7 [================>.............] - ETA: 0s - loss: 0.0017    7/7 [==============================] - ETA: 0s - loss: 0.00367/7 [==============================] - 0s 16ms/step - loss: 0.0036
1/7 [===>..........................] - ETA: 0s - loss: 0.00525/7 [====================>.........] - ETA: 0s - loss: 0.00267/7 [==============================] - 0s 15ms/step - loss: 0.0028
1/7 [===>..........................] - ETA: 0s - loss: 0.00124/7 [================>.............] - ETA: 0s - loss: 0.00127/7 [==============================] - ETA: 0s - loss: 0.00127/7 [==============================] - 0s 16ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 7.0757e-043/7 [===========>..................] - ETA: 0s - loss: 0.0011    7/7 [==============================] - ETA: 0s - loss: 0.00137/7 [==============================] - 0s 16ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 7.5973e-045/7 [====================>.........] - ETA: 0s - loss: 0.0080    7/7 [==============================] - 0s 14ms/step - loss: 0.0066
1/7 [===>..........................] - ETA: 0s - loss: 8.4808e-044/7 [================>.............] - ETA: 0s - loss: 0.0033    7/7 [==============================] - ETA: 0s - loss: 0.00487/7 [==============================] - 0s 17ms/step - loss: 0.0048
1/7 [===>..........................] - ETA: 0s - loss: 0.00274/7 [================>.............] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 13ms/step - loss: 0.0020
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.003149157902225852:
Train Score: 0.00243 MSE 0.04926 RMSE
Test Score: 0.00107 MSE 0.03271 RMSE
Deviation Min [2.56248381e-05], Max [0.43523865]
Deviation 99.5th pctile [0.30696518]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1388,    9]))
Confusion matrix 
[[1388    0]
 [   2    7]]
precision 1.00000, recall 0.77778, f1 0.87500
Time to train: 391003 ms
Saving model models/A2Benchmark/synthetic_80.csv.h5
Total Time to proces all the selected files : 393181 ms
A2Benchmark : Avg precision 1.00000 recall 0.77778 f1 0.87500 time to train 391003.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_80.csv  --epochs 20 --n_iter 3 --patience 3 :: took 399 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_81.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 07:41:10 AM MST
2020-11-30 07:41:16.702570: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 07:41:16.721264: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 07:41:16.722773: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x560be1b8a740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 07:41:16.722820: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 07:41:16.723035: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_81.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 2.5081e-043/7 [===========>..................] - ETA: 0s - loss: 4.7934e-045/7 [====================>.........] - ETA: 0s - loss: 4.0296e-047/7 [==============================] - ETA: 0s - loss: 3.3263e-047/7 [==============================] - 0s 32ms/step - loss: 3.3263e-04
1/7 [===>..........................] - ETA: 0s - loss: 6.2373e-053/7 [===========>..................] - ETA: 0s - loss: 1.4548e-045/7 [====================>.........] - ETA: 0s - loss: 1.1575e-047/7 [==============================] - ETA: 0s - loss: 1.1562e-047/7 [==============================] - 0s 32ms/step - loss: 1.1562e-04
1/7 [===>..........................] - ETA: 0s - loss: 8.1033e-043/7 [===========>..................] - ETA: 0s - loss: 3.9349e-045/7 [====================>.........] - ETA: 0s - loss: 4.8831e-047/7 [==============================] - ETA: 0s - loss: 4.4644e-047/7 [==============================] - 0s 24ms/step - loss: 4.4644e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.1022e-053/7 [===========>..................] - ETA: 0s - loss: 1.3691e-045/7 [====================>.........] - ETA: 0s - loss: 0.0034    7/7 [==============================] - ETA: 0s - loss: 0.00287/7 [==============================] - 0s 22ms/step - loss: 0.0028
1/7 [===>..........................] - ETA: 0s - loss: 5.6735e-043/7 [===========>..................] - ETA: 0s - loss: 3.2118e-045/7 [====================>.........] - ETA: 0s - loss: 4.0133e-047/7 [==============================] - ETA: 0s - loss: 4.5716e-047/7 [==============================] - 0s 29ms/step - loss: 4.5716e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.5053e-046/7 [========================>.....] - ETA: 0s - loss: 4.7568e-047/7 [==============================] - 0s 11ms/step - loss: 4.6272e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.1938e-046/7 [========================>.....] - ETA: 0s - loss: 6.3902e-057/7 [==============================] - 0s 10ms/step - loss: 6.7320e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.6485e-045/7 [====================>.........] - ETA: 0s - loss: 9.8542e-057/7 [==============================] - 0s 12ms/step - loss: 8.8704e-05
1/7 [===>..........................] - ETA: 0s - loss: 9.1769e-055/7 [====================>.........] - ETA: 0s - loss: 0.0037    7/7 [==============================] - 0s 13ms/step - loss: 0.0030
1/7 [===>..........................] - ETA: 0s - loss: 2.6125e-045/7 [====================>.........] - ETA: 0s - loss: 7.3331e-047/7 [==============================] - 0s 14ms/step - loss: 8.4427e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.6560e-043/7 [===========>..................] - ETA: 0s - loss: 3.1206e-045/7 [====================>.........] - ETA: 0s - loss: 2.8112e-047/7 [==============================] - ETA: 0s - loss: 2.3509e-047/7 [==============================] - 0s 27ms/step - loss: 2.3509e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.8025e-053/7 [===========>..................] - ETA: 0s - loss: 1.7262e-045/7 [====================>.........] - ETA: 0s - loss: 1.3173e-047/7 [==============================] - ETA: 0s - loss: 1.2964e-047/7 [==============================] - 0s 32ms/step - loss: 1.2964e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.5992e-043/7 [===========>..................] - ETA: 0s - loss: 1.3648e-045/7 [====================>.........] - ETA: 0s - loss: 1.4452e-047/7 [==============================] - ETA: 0s - loss: 1.3075e-047/7 [==============================] - 0s 30ms/step - loss: 1.3075e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.1113e-043/7 [===========>..................] - ETA: 0s - loss: 1.0874e-045/7 [====================>.........] - ETA: 0s - loss: 0.0034    7/7 [==============================] - ETA: 0s - loss: 0.00287/7 [==============================] - 0s 28ms/step - loss: 0.0028
1/7 [===>..........................] - ETA: 0s - loss: 9.7962e-043/7 [===========>..................] - ETA: 0s - loss: 4.9900e-045/7 [====================>.........] - ETA: 0s - loss: 5.6761e-047/7 [==============================] - ETA: 0s - loss: 5.3934e-047/7 [==============================] - 0s 29ms/step - loss: 5.3934e-04
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.0007758183113764971:
Train Score: 0.00066 MSE 0.02565 RMSE
Test Score: 0.00010 MSE 0.01015 RMSE
Deviation Min [1.02585351e-05], Max [0.72328764]
Deviation 99.5th pctile [0.03701838]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,    1]))
Confusion matrix 
[[1390    6]
 [   0    1]]
precision 0.14286, recall 1.00000, f1 0.25000
Time to train: 341088 ms
Saving model models/A2Benchmark/synthetic_81.csv.h5
Total Time to proces all the selected files : 344874 ms
A2Benchmark : Avg precision 0.14286 recall 1.00000 f1 0.25000 time to train 341088.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_81.csv  --epochs 20 --n_iter 3 --patience 3 :: took 351 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_82.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 07:47:07 AM MST
2020-11-30 07:47:12.717000: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 07:47:12.735247: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 07:47:12.736721: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55890cf61640 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 07:47:12.736768: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 07:47:12.736968: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_82.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00133/7 [===========>..................] - ETA: 0s - loss: 0.00275/7 [====================>.........] - ETA: 0s - loss: 0.00247/7 [==============================] - ETA: 0s - loss: 0.00257/7 [==============================] - 0s 24ms/step - loss: 0.0025
1/7 [===>..........................] - ETA: 0s - loss: 0.00143/7 [===========>..................] - ETA: 0s - loss: 0.00205/7 [====================>.........] - ETA: 0s - loss: 0.00217/7 [==============================] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 33ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 9.7827e-042/7 [=======>......................] - ETA: 0s - loss: 0.0025    4/7 [================>.............] - ETA: 0s - loss: 0.00736/7 [========================>.....] - ETA: 0s - loss: 0.00607/7 [==============================] - 0s 31ms/step - loss: 0.0059
1/7 [===>..........................] - ETA: 0s - loss: 0.00143/7 [===========>..................] - ETA: 0s - loss: 0.00195/7 [====================>.........] - ETA: 0s - loss: 0.00467/7 [==============================] - ETA: 0s - loss: 0.00457/7 [==============================] - 0s 27ms/step - loss: 0.0045
1/7 [===>..........................] - ETA: 0s - loss: 0.00223/7 [===========>..................] - ETA: 0s - loss: 0.00245/7 [====================>.........] - ETA: 0s - loss: 0.00227/7 [==============================] - ETA: 0s - loss: 0.00247/7 [==============================] - 0s 26ms/step - loss: 0.0024
1/7 [===>..........................] - ETA: 0s - loss: 0.00133/7 [===========>..................] - ETA: 0s - loss: 0.00245/7 [====================>.........] - ETA: 0s - loss: 0.00237/7 [==============================] - ETA: 0s - loss: 0.00237/7 [==============================] - 0s 32ms/step - loss: 0.0023
1/7 [===>..........................] - ETA: 0s - loss: 0.00183/7 [===========>..................] - ETA: 0s - loss: 0.00205/7 [====================>.........] - ETA: 0s - loss: 0.00227/7 [==============================] - 0s 23ms/step - loss: 0.0021
1/7 [===>..........................] - ETA: 0s - loss: 0.00113/7 [===========>..................] - ETA: 0s - loss: 0.00195/7 [====================>.........] - ETA: 0s - loss: 0.00567/7 [==============================] - ETA: 0s - loss: 0.00497/7 [==============================] - 0s 28ms/step - loss: 0.0049
1/7 [===>..........................] - ETA: 0s - loss: 0.00103/7 [===========>..................] - ETA: 0s - loss: 0.00175/7 [====================>.........] - ETA: 0s - loss: 0.00467/7 [==============================] - ETA: 0s - loss: 0.00437/7 [==============================] - 0s 33ms/step - loss: 0.0043
1/7 [===>..........................] - ETA: 0s - loss: 0.00333/7 [===========>..................] - ETA: 0s - loss: 0.00345/7 [====================>.........] - ETA: 0s - loss: 0.00327/7 [==============================] - ETA: 0s - loss: 0.00367/7 [==============================] - 0s 31ms/step - loss: 0.0036
1/7 [===>..........................] - ETA: 0s - loss: 0.00334/7 [================>.............] - ETA: 0s - loss: 0.00617/7 [==============================] - ETA: 0s - loss: 0.00597/7 [==============================] - 0s 17ms/step - loss: 0.0059
1/7 [===>..........................] - ETA: 0s - loss: 0.00103/7 [===========>..................] - ETA: 0s - loss: 0.00196/7 [========================>.....] - ETA: 0s - loss: 0.00197/7 [==============================] - 0s 20ms/step - loss: 0.0019
1/7 [===>..........................] - ETA: 0s - loss: 8.7915e-045/7 [====================>.........] - ETA: 0s - loss: 0.0054    7/7 [==============================] - 0s 12ms/step - loss: 0.0050
1/7 [===>..........................] - ETA: 0s - loss: 9.6147e-044/7 [================>.............] - ETA: 0s - loss: 0.0017    7/7 [==============================] - ETA: 0s - loss: 0.00427/7 [==============================] - 0s 18ms/step - loss: 0.0042
1/7 [===>..........................] - ETA: 0s - loss: 0.00225/7 [====================>.........] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 16ms/step - loss: 0.0019
Best parameters {'n_units': 48, 'n_hidden': 2} best score 0.0034373336005955935:
Train Score: 0.00338 MSE 0.05814 RMSE
Test Score: 0.00512 MSE 0.07154 RMSE
Deviation Min [7.57311783e-06], Max [0.51764911]
Deviation 99.5th pctile [0.15885407]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,    4]))
Confusion matrix 
[[1390    3]
 [   0    4]]
precision 0.57143, recall 1.00000, f1 0.72727
Time to train: 527110 ms
Saving model models/A2Benchmark/synthetic_82.csv.h5
Total Time to proces all the selected files : 531016 ms
A2Benchmark : Avg precision 0.57143 recall 1.00000 f1 0.72727 time to train 527110.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_82.csv  --epochs 20 --n_iter 3 --patience 3 :: took 537 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_83.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 07:56:09 AM MST
2020-11-30 07:56:14.930103: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 07:56:14.948192: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 07:56:14.949535: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x564476fa2440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 07:56:14.949582: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 07:56:14.949763: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_83.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 7.1527e-043/7 [===========>..................] - ETA: 0s - loss: 7.4205e-045/7 [====================>.........] - ETA: 0s - loss: 6.4893e-047/7 [==============================] - ETA: 0s - loss: 5.5242e-047/7 [==============================] - 0s 25ms/step - loss: 5.5242e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.2421e-043/7 [===========>..................] - ETA: 0s - loss: 2.0957e-045/7 [====================>.........] - ETA: 0s - loss: 2.0948e-047/7 [==============================] - ETA: 0s - loss: 2.1699e-047/7 [==============================] - 0s 26ms/step - loss: 2.1699e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.3862e-043/7 [===========>..................] - ETA: 0s - loss: 0.0170    5/7 [====================>.........] - ETA: 0s - loss: 0.02027/7 [==============================] - ETA: 0s - loss: 0.01617/7 [==============================] - 0s 26ms/step - loss: 0.0161
1/7 [===>..........................] - ETA: 0s - loss: 5.0855e-043/7 [===========>..................] - ETA: 0s - loss: 2.5942e-045/7 [====================>.........] - ETA: 0s - loss: 0.0091    7/7 [==============================] - ETA: 0s - loss: 0.00777/7 [==============================] - 0s 26ms/step - loss: 0.0077
1/7 [===>..........................] - ETA: 0s - loss: 5.3133e-043/7 [===========>..................] - ETA: 0s - loss: 2.7829e-045/7 [====================>.........] - ETA: 0s - loss: 3.5707e-047/7 [==============================] - ETA: 0s - loss: 3.0675e-047/7 [==============================] - 0s 30ms/step - loss: 3.0675e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.9634e-043/7 [===========>..................] - ETA: 0s - loss: 3.9177e-045/7 [====================>.........] - ETA: 0s - loss: 3.2792e-047/7 [==============================] - ETA: 0s - loss: 3.1956e-047/7 [==============================] - 0s 24ms/step - loss: 3.1956e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.8481e-044/7 [================>.............] - ETA: 0s - loss: 2.4825e-046/7 [========================>.....] - ETA: 0s - loss: 2.6429e-047/7 [==============================] - 0s 26ms/step - loss: 2.6838e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.2417e-043/7 [===========>..................] - ETA: 0s - loss: 0.0169    5/7 [====================>.........] - ETA: 0s - loss: 0.02037/7 [==============================] - ETA: 0s - loss: 0.01627/7 [==============================] - 0s 30ms/step - loss: 0.0162
1/7 [===>..........................] - ETA: 0s - loss: 0.00153/7 [===========>..................] - ETA: 0s - loss: 7.1021e-045/7 [====================>.........] - ETA: 0s - loss: 0.0100    7/7 [==============================] - ETA: 0s - loss: 0.00867/7 [==============================] - 0s 33ms/step - loss: 0.0086
1/7 [===>..........................] - ETA: 0s - loss: 2.4632e-043/7 [===========>..................] - ETA: 0s - loss: 3.0670e-045/7 [====================>.........] - ETA: 0s - loss: 2.5756e-047/7 [==============================] - ETA: 0s - loss: 2.8123e-047/7 [==============================] - 0s 30ms/step - loss: 2.8123e-04
1/7 [===>..........................] - ETA: 0s - loss: 8.1343e-043/7 [===========>..................] - ETA: 0s - loss: 8.9867e-045/7 [====================>.........] - ETA: 0s - loss: 7.8038e-047/7 [==============================] - ETA: 0s - loss: 6.5367e-047/7 [==============================] - 0s 31ms/step - loss: 6.5367e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.3723e-043/7 [===========>..................] - ETA: 0s - loss: 2.4379e-045/7 [====================>.........] - ETA: 0s - loss: 2.4436e-047/7 [==============================] - ETA: 0s - loss: 2.6785e-047/7 [==============================] - 0s 36ms/step - loss: 2.6785e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.9131e-043/7 [===========>..................] - ETA: 0s - loss: 0.0172    5/7 [====================>.........] - ETA: 0s - loss: 0.02067/7 [==============================] - ETA: 0s - loss: 0.01657/7 [==============================] - 0s 29ms/step - loss: 0.0165
1/7 [===>..........................] - ETA: 0s - loss: 0.00103/7 [===========>..................] - ETA: 0s - loss: 4.7593e-045/7 [====================>.........] - ETA: 0s - loss: 0.0096    7/7 [==============================] - ETA: 0s - loss: 0.00847/7 [==============================] - 0s 30ms/step - loss: 0.0084
1/7 [===>..........................] - ETA: 0s - loss: 0.00293/7 [===========>..................] - ETA: 0s - loss: 0.00185/7 [====================>.........] - ETA: 0s - loss: 0.00237/7 [==============================] - ETA: 0s - loss: 0.00217/7 [==============================] - 0s 25ms/step - loss: 0.0021
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.0049734952597646044:
Train Score: 0.00441 MSE 0.06639 RMSE
Test Score: 0.00043 MSE 0.02080 RMSE
Deviation Min [4.13233628e-06], Max [0.72752516]
Deviation 99.5th pctile [0.65600485]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1388,    9]))
Confusion matrix 
[[1388    0]
 [   2    7]]
precision 1.00000, recall 0.77778, f1 0.87500
Time to train: 446530 ms
Saving model models/A2Benchmark/synthetic_83.csv.h5
Total Time to proces all the selected files : 450402 ms
A2Benchmark : Avg precision 1.00000 recall 0.77778 f1 0.87500 time to train 446530.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_83.csv  --epochs 20 --n_iter 3 --patience 3 :: took 456 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_84.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 08:03:50 AM MST
2020-11-30 08:03:56.555963: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 08:03:56.574230: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 08:03:56.575118: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55c866b9a740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 08:03:56.575145: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 08:03:56.575264: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_84.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00283/7 [===========>..................] - ETA: 0s - loss: 0.00255/7 [====================>.........] - ETA: 0s - loss: 0.00207/7 [==============================] - ETA: 0s - loss: 0.00177/7 [==============================] - 0s 32ms/step - loss: 0.0017
1/7 [===>..........................] - ETA: 0s - loss: 9.1317e-053/7 [===========>..................] - ETA: 0s - loss: 8.0700e-055/7 [====================>.........] - ETA: 0s - loss: 7.2787e-057/7 [==============================] - ETA: 0s - loss: 7.0679e-057/7 [==============================] - 0s 40ms/step - loss: 7.0679e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.2602e-043/7 [===========>..................] - ETA: 0s - loss: 2.1959e-045/7 [====================>.........] - ETA: 0s - loss: 2.6953e-047/7 [==============================] - ETA: 0s - loss: 2.7076e-047/7 [==============================] - 0s 27ms/step - loss: 2.7076e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.4958e-053/7 [===========>..................] - ETA: 0s - loss: 1.2412e-055/7 [====================>.........] - ETA: 0s - loss: 0.0021    7/7 [==============================] - ETA: 0s - loss: 0.00177/7 [==============================] - 0s 33ms/step - loss: 0.0017
1/7 [===>..........................] - ETA: 0s - loss: 5.1083e-043/7 [===========>..................] - ETA: 0s - loss: 9.9048e-045/7 [====================>.........] - ETA: 0s - loss: 0.0016    7/7 [==============================] - ETA: 0s - loss: 0.00197/7 [==============================] - 0s 29ms/step - loss: 0.0019
1/7 [===>..........................] - ETA: 0s - loss: 5.3620e-043/7 [===========>..................] - ETA: 0s - loss: 4.5146e-045/7 [====================>.........] - ETA: 0s - loss: 3.1634e-047/7 [==============================] - ETA: 0s - loss: 2.5287e-047/7 [==============================] - 0s 25ms/step - loss: 2.5287e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.2598e-053/7 [===========>..................] - ETA: 0s - loss: 2.6658e-055/7 [====================>.........] - ETA: 0s - loss: 4.9626e-057/7 [==============================] - ETA: 0s - loss: 5.5045e-057/7 [==============================] - 0s 24ms/step - loss: 5.5045e-05
1/7 [===>..........................] - ETA: 0s - loss: 5.5973e-053/7 [===========>..................] - ETA: 0s - loss: 1.0457e-045/7 [====================>.........] - ETA: 0s - loss: 1.2888e-047/7 [==============================] - ETA: 0s - loss: 1.2676e-047/7 [==============================] - 0s 30ms/step - loss: 1.2676e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.5585e-043/7 [===========>..................] - ETA: 0s - loss: 2.3041e-045/7 [====================>.........] - ETA: 0s - loss: 0.0024    7/7 [==============================] - ETA: 0s - loss: 0.00197/7 [==============================] - 0s 30ms/step - loss: 0.0019
1/7 [===>..........................] - ETA: 0s - loss: 8.4496e-053/7 [===========>..................] - ETA: 0s - loss: 3.7736e-045/7 [====================>.........] - ETA: 0s - loss: 8.4966e-047/7 [==============================] - ETA: 0s - loss: 0.0011    7/7 [==============================] - 0s 34ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 0.00205/7 [====================>.........] - ETA: 0s - loss: 0.00157/7 [==============================] - 0s 13ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 2.6271e-054/7 [================>.............] - ETA: 0s - loss: 1.6759e-057/7 [==============================] - ETA: 0s - loss: 1.5965e-057/7 [==============================] - 0s 17ms/step - loss: 1.5965e-05
1/7 [===>..........................] - ETA: 0s - loss: 5.4777e-055/7 [====================>.........] - ETA: 0s - loss: 9.4403e-057/7 [==============================] - 0s 13ms/step - loss: 9.2794e-05
1/7 [===>..........................] - ETA: 0s - loss: 3.4753e-056/7 [========================>.....] - ETA: 0s - loss: 0.0018    7/7 [==============================] - 0s 11ms/step - loss: 0.0017
1/7 [===>..........................] - ETA: 0s - loss: 1.2265e-045/7 [====================>.........] - ETA: 0s - loss: 1.1380e-047/7 [==============================] - 0s 14ms/step - loss: 1.6212e-04
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0006461718785431003:
Train Score: 0.00036 MSE 0.01886 RMSE
Test Score: 0.00137 MSE 0.03701 RMSE
Deviation Min [4.9282509e-06], Max [0.56879774]
Deviation 99.5th pctile [0.0614264]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,    1]))
Confusion matrix 
[[1390    6]
 [   0    1]]
precision 0.14286, recall 1.00000, f1 0.25000
Time to train: 365225 ms
Saving model models/A2Benchmark/synthetic_84.csv.h5
Total Time to proces all the selected files : 367721 ms
A2Benchmark : Avg precision 0.14286 recall 1.00000 f1 0.25000 time to train 365225.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_84.csv  --epochs 20 --n_iter 3 --patience 3 :: took 374 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_85.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 08:10:09 AM MST
2020-11-30 08:10:15.551490: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 08:10:15.570248: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 08:10:15.571133: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55947f93f740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 08:10:15.571159: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 08:10:15.571272: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_85.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00433/7 [===========>..................] - ETA: 0s - loss: 0.00315/7 [====================>.........] - ETA: 0s - loss: 0.00297/7 [==============================] - ETA: 0s - loss: 0.00257/7 [==============================] - 0s 25ms/step - loss: 0.0025
1/7 [===>..........................] - ETA: 0s - loss: 0.00153/7 [===========>..................] - ETA: 0s - loss: 0.00205/7 [====================>.........] - ETA: 0s - loss: 0.00207/7 [==============================] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 33ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 7.3915e-043/7 [===========>..................] - ETA: 0s - loss: 9.4448e-045/7 [====================>.........] - ETA: 0s - loss: 0.0087    7/7 [==============================] - ETA: 0s - loss: 0.00737/7 [==============================] - 0s 24ms/step - loss: 0.0073
1/7 [===>..........................] - ETA: 0s - loss: 0.00223/7 [===========>..................] - ETA: 0s - loss: 0.00145/7 [====================>.........] - ETA: 0s - loss: 0.00817/7 [==============================] - ETA: 0s - loss: 0.00707/7 [==============================] - 0s 25ms/step - loss: 0.0070
1/7 [===>..........................] - ETA: 0s - loss: 0.00273/7 [===========>..................] - ETA: 0s - loss: 0.00175/7 [====================>.........] - ETA: 0s - loss: 0.00157/7 [==============================] - ETA: 0s - loss: 0.00147/7 [==============================] - 0s 26ms/step - loss: 0.0014
1/7 [===>..........................] - ETA: 0s - loss: 0.00144/7 [================>.............] - ETA: 0s - loss: 0.00127/7 [==============================] - ETA: 0s - loss: 0.00117/7 [==============================] - 0s 18ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 9.5082e-045/7 [====================>.........] - ETA: 0s - loss: 0.0018    7/7 [==============================] - 0s 14ms/step - loss: 0.0019
1/7 [===>..........................] - ETA: 0s - loss: 5.7864e-044/7 [================>.............] - ETA: 0s - loss: 0.0102    7/7 [==============================] - ETA: 0s - loss: 0.00717/7 [==============================] - 0s 17ms/step - loss: 0.0071
1/7 [===>..........................] - ETA: 0s - loss: 0.00614/7 [================>.............] - ETA: 0s - loss: 0.00337/7 [==============================] - ETA: 0s - loss: 0.00817/7 [==============================] - 0s 18ms/step - loss: 0.0081
1/7 [===>..........................] - ETA: 0s - loss: 0.00714/7 [================>.............] - ETA: 0s - loss: 0.00587/7 [==============================] - ETA: 0s - loss: 0.00417/7 [==============================] - 0s 17ms/step - loss: 0.0041
1/7 [===>..........................] - ETA: 0s - loss: 0.00353/7 [===========>..................] - ETA: 0s - loss: 0.00255/7 [====================>.........] - ETA: 0s - loss: 0.00237/7 [==============================] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 26ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 0.00113/7 [===========>..................] - ETA: 0s - loss: 0.00135/7 [====================>.........] - ETA: 0s - loss: 0.00167/7 [==============================] - ETA: 0s - loss: 0.00167/7 [==============================] - 0s 34ms/step - loss: 0.0016
1/7 [===>..........................] - ETA: 0s - loss: 6.5687e-043/7 [===========>..................] - ETA: 0s - loss: 0.0014    5/7 [====================>.........] - ETA: 0s - loss: 0.00897/7 [==============================] - ETA: 0s - loss: 0.00737/7 [==============================] - 0s 38ms/step - loss: 0.0073
1/7 [===>..........................] - ETA: 0s - loss: 0.00113/7 [===========>..................] - ETA: 0s - loss: 0.00145/7 [====================>.........] - ETA: 0s - loss: 0.00827/7 [==============================] - ETA: 0s - loss: 0.00707/7 [==============================] - 0s 25ms/step - loss: 0.0070
1/7 [===>..........................] - ETA: 0s - loss: 0.00413/7 [===========>..................] - ETA: 0s - loss: 0.00305/7 [====================>.........] - ETA: 0s - loss: 0.00227/7 [==============================] - ETA: 0s - loss: 0.00197/7 [==============================] - 0s 31ms/step - loss: 0.0019
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.003967237821780145:
Train Score: 0.00357 MSE 0.05974 RMSE
Test Score: 0.00201 MSE 0.04480 RMSE
Deviation Min [9.72812663e-06], Max [0.77402374]
Deviation 99.5th pctile [0.12239785]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,    4]))
Confusion matrix 
[[1390    3]
 [   0    4]]
precision 0.57143, recall 1.00000, f1 0.72727
Time to train: 305568 ms
Saving model models/A2Benchmark/synthetic_85.csv.h5
Total Time to proces all the selected files : 309606 ms
A2Benchmark : Avg precision 0.57143 recall 1.00000 f1 0.72727 time to train 305568.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_85.csv  --epochs 20 --n_iter 3 --patience 3 :: took 316 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_86.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 08:15:30 AM MST
2020-11-30 08:15:36.437172: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 08:15:36.456320: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 08:15:36.457929: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5640c3967960 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 08:15:36.457982: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 08:15:36.458218: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_86.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00133/7 [===========>..................] - ETA: 0s - loss: 6.3676e-045/7 [====================>.........] - ETA: 0s - loss: 5.0049e-047/7 [==============================] - ETA: 0s - loss: 4.8050e-047/7 [==============================] - 0s 35ms/step - loss: 4.8050e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.6725e-053/7 [===========>..................] - ETA: 0s - loss: 5.4974e-055/7 [====================>.........] - ETA: 0s - loss: 1.1553e-047/7 [==============================] - ETA: 0s - loss: 1.1712e-047/7 [==============================] - 0s 34ms/step - loss: 1.1712e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00103/7 [===========>..................] - ETA: 0s - loss: 0.01255/7 [====================>.........] - ETA: 0s - loss: 0.01457/7 [==============================] - ETA: 0s - loss: 0.01177/7 [==============================] - 0s 26ms/step - loss: 0.0117
1/7 [===>..........................] - ETA: 0s - loss: 3.3145e-042/7 [=======>......................] - ETA: 0s - loss: 3.2595e-044/7 [================>.............] - ETA: 0s - loss: 2.1162e-046/7 [========================>.....] - ETA: 0s - loss: 0.0055    7/7 [==============================] - 0s 34ms/step - loss: 0.0052
1/7 [===>..........................] - ETA: 0s - loss: 4.9689e-043/7 [===========>..................] - ETA: 0s - loss: 2.7556e-045/7 [====================>.........] - ETA: 0s - loss: 1.9256e-047/7 [==============================] - ETA: 0s - loss: 2.2905e-047/7 [==============================] - 0s 30ms/step - loss: 2.2905e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00253/7 [===========>..................] - ETA: 0s - loss: 0.00135/7 [====================>.........] - ETA: 0s - loss: 9.4603e-047/7 [==============================] - ETA: 0s - loss: 8.8975e-047/7 [==============================] - 0s 27ms/step - loss: 8.8975e-04
1/7 [===>..........................] - ETA: 0s - loss: 8.0447e-053/7 [===========>..................] - ETA: 0s - loss: 1.1177e-045/7 [====================>.........] - ETA: 0s - loss: 1.3586e-047/7 [==============================] - ETA: 0s - loss: 1.2436e-047/7 [==============================] - 0s 26ms/step - loss: 1.2436e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.1191e-043/7 [===========>..................] - ETA: 0s - loss: 0.0111    5/7 [====================>.........] - ETA: 0s - loss: 0.01367/7 [==============================] - ETA: 0s - loss: 0.01097/7 [==============================] - 0s 26ms/step - loss: 0.0109
1/7 [===>..........................] - ETA: 0s - loss: 4.8144e-043/7 [===========>..................] - ETA: 0s - loss: 3.4294e-045/7 [====================>.........] - ETA: 0s - loss: 0.0063    7/7 [==============================] - ETA: 0s - loss: 0.00557/7 [==============================] - 0s 26ms/step - loss: 0.0055
1/7 [===>..........................] - ETA: 0s - loss: 0.00303/7 [===========>..................] - ETA: 0s - loss: 0.00315/7 [====================>.........] - ETA: 0s - loss: 0.00287/7 [==============================] - ETA: 0s - loss: 0.00317/7 [==============================] - 0s 26ms/step - loss: 0.0031
1/7 [===>..........................] - ETA: 0s - loss: 6.9519e-045/7 [====================>.........] - ETA: 0s - loss: 3.0700e-047/7 [==============================] - 0s 13ms/step - loss: 3.0116e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.2242e-054/7 [================>.............] - ETA: 0s - loss: 1.2782e-047/7 [==============================] - ETA: 0s - loss: 1.0052e-047/7 [==============================] - 0s 21ms/step - loss: 1.0052e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.6893e-044/7 [================>.............] - ETA: 0s - loss: 0.0156    7/7 [==============================] - ETA: 0s - loss: 0.01027/7 [==============================] - 0s 17ms/step - loss: 0.0102
1/7 [===>..........................] - ETA: 0s - loss: 0.00204/7 [================>.............] - ETA: 0s - loss: 0.00197/7 [==============================] - ETA: 0s - loss: 0.00667/7 [==============================] - 0s 15ms/step - loss: 0.0066
1/7 [===>..........................] - ETA: 0s - loss: 6.5018e-055/7 [====================>.........] - ETA: 0s - loss: 4.1345e-047/7 [==============================] - 0s 13ms/step - loss: 3.7423e-04
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0035179096084902994:
Train Score: 0.00272 MSE 0.05216 RMSE
Test Score: 0.00014 MSE 0.01193 RMSE
Deviation Min [4.74947584e-06], Max [0.59290512]
Deviation 99.5th pctile [0.45500856]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1388,    9]))
Confusion matrix 
[[1388    0]
 [   2    7]]
precision 1.00000, recall 0.77778, f1 0.87500
Time to train: 380097 ms
Saving model models/A2Benchmark/synthetic_86.csv.h5
Total Time to proces all the selected files : 382188 ms
A2Benchmark : Avg precision 1.00000 recall 0.77778 f1 0.87500 time to train 380097.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_86.csv  --epochs 20 --n_iter 3 --patience 3 :: took 389 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_87.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 08:22:04 AM MST
2020-11-30 08:22:09.951666: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 08:22:09.970290: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 08:22:09.971800: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5565183b2960 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 08:22:09.971848: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 08:22:09.972049: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_87.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00373/7 [===========>..................] - ETA: 0s - loss: 0.00315/7 [====================>.........] - ETA: 0s - loss: 0.00327/7 [==============================] - ETA: 0s - loss: 0.00327/7 [==============================] - 0s 38ms/step - loss: 0.0032
1/7 [===>..........................] - ETA: 0s - loss: 0.00323/7 [===========>..................] - ETA: 0s - loss: 0.00265/7 [====================>.........] - ETA: 0s - loss: 0.00307/7 [==============================] - ETA: 0s - loss: 0.00277/7 [==============================] - 0s 26ms/step - loss: 0.0027
1/7 [===>..........................] - ETA: 0s - loss: 0.00183/7 [===========>..................] - ETA: 0s - loss: 0.00245/7 [====================>.........] - ETA: 0s - loss: 0.00257/7 [==============================] - ETA: 0s - loss: 0.00257/7 [==============================] - 0s 38ms/step - loss: 0.0025
1/7 [===>..........................] - ETA: 0s - loss: 0.00303/7 [===========>..................] - ETA: 0s - loss: 0.00335/7 [====================>.........] - ETA: 0s - loss: 0.00637/7 [==============================] - ETA: 0s - loss: 0.00587/7 [==============================] - 0s 32ms/step - loss: 0.0058
1/7 [===>..........................] - ETA: 0s - loss: 0.00833/7 [===========>..................] - ETA: 0s - loss: 0.00465/7 [====================>.........] - ETA: 0s - loss: 0.00417/7 [==============================] - ETA: 0s - loss: 0.00467/7 [==============================] - 0s 34ms/step - loss: 0.0046
1/7 [===>..........................] - ETA: 0s - loss: 0.00364/7 [================>.............] - ETA: 0s - loss: 0.00307/7 [==============================] - ETA: 0s - loss: 0.00307/7 [==============================] - 0s 18ms/step - loss: 0.0030
1/7 [===>..........................] - ETA: 0s - loss: 0.00286/7 [========================>.....] - ETA: 0s - loss: 0.00297/7 [==============================] - 0s 10ms/step - loss: 0.0028
1/7 [===>..........................] - ETA: 0s - loss: 0.00204/7 [================>.............] - ETA: 0s - loss: 0.00336/7 [========================>.....] - ETA: 0s - loss: 0.00327/7 [==============================] - 0s 32ms/step - loss: 0.0031
1/7 [===>..........................] - ETA: 0s - loss: 0.00324/7 [================>.............] - ETA: 0s - loss: 0.00347/7 [==============================] - ETA: 0s - loss: 0.00567/7 [==============================] - 0s 18ms/step - loss: 0.0056
1/7 [===>..........................] - ETA: 0s - loss: 0.00385/7 [====================>.........] - ETA: 0s - loss: 0.00277/7 [==============================] - 0s 14ms/step - loss: 0.0026
1/7 [===>..........................] - ETA: 0s - loss: 0.00333/7 [===========>..................] - ETA: 0s - loss: 0.00265/7 [====================>.........] - ETA: 0s - loss: 0.00277/7 [==============================] - ETA: 0s - loss: 0.00267/7 [==============================] - 0s 32ms/step - loss: 0.0026
1/7 [===>..........................] - ETA: 0s - loss: 0.00393/7 [===========>..................] - ETA: 0s - loss: 0.00285/7 [====================>.........] - ETA: 0s - loss: 0.00337/7 [==============================] - ETA: 0s - loss: 0.00327/7 [==============================] - 0s 23ms/step - loss: 0.0032
1/7 [===>..........................] - ETA: 0s - loss: 0.00153/7 [===========>..................] - ETA: 0s - loss: 0.00255/7 [====================>.........] - ETA: 0s - loss: 0.00317/7 [==============================] - ETA: 0s - loss: 0.00317/7 [==============================] - 0s 33ms/step - loss: 0.0031
1/7 [===>..........................] - ETA: 0s - loss: 0.00313/7 [===========>..................] - ETA: 0s - loss: 0.00355/7 [====================>.........] - ETA: 0s - loss: 0.00667/7 [==============================] - ETA: 0s - loss: 0.00607/7 [==============================] - 0s 24ms/step - loss: 0.0060
1/7 [===>..........................] - ETA: 0s - loss: 0.00943/7 [===========>..................] - ETA: 0s - loss: 0.00505/7 [====================>.........] - ETA: 0s - loss: 0.00457/7 [==============================] - ETA: 0s - loss: 0.00497/7 [==============================] - 0s 32ms/step - loss: 0.0049
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0034314906690269707:
Train Score: 0.00357 MSE 0.05972 RMSE
Test Score: 0.00440 MSE 0.06636 RMSE
Deviation Min [9.82417183e-07], Max [0.70356452]
Deviation 99.5th pctile [0.15333926]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,    1]))
Confusion matrix 
[[1390    6]
 [   0    1]]
precision 0.14286, recall 1.00000, f1 0.25000
Time to train: 478257 ms
Saving model models/A2Benchmark/synthetic_87.csv.h5
Total Time to proces all the selected files : 480854 ms
A2Benchmark : Avg precision 0.14286 recall 1.00000 f1 0.25000 time to train 478257.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_87.csv  --epochs 20 --n_iter 3 --patience 3 :: took 487 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_88.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 08:30:16 AM MST
2020-11-30 08:30:22.248540: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 08:30:22.267323: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 08:30:22.268937: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55b7d1ce9440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 08:30:22.268992: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 08:30:22.269146: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_88.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 1.2184e-044/7 [================>.............] - ETA: 0s - loss: 3.1946e-047/7 [==============================] - ETA: 0s - loss: 2.7158e-047/7 [==============================] - 0s 18ms/step - loss: 2.7158e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.1522e-045/7 [====================>.........] - ETA: 0s - loss: 2.8344e-047/7 [==============================] - 0s 13ms/step - loss: 2.6206e-04
1/7 [===>..........................] - ETA: 0s - loss: 8.0226e-044/7 [================>.............] - ETA: 0s - loss: 0.0058    7/7 [==============================] - ETA: 0s - loss: 0.00387/7 [==============================] - 0s 17ms/step - loss: 0.0038
1/7 [===>..........................] - ETA: 0s - loss: 2.9155e-044/7 [================>.............] - ETA: 0s - loss: 2.3420e-047/7 [==============================] - ETA: 0s - loss: 0.0036    7/7 [==============================] - 0s 17ms/step - loss: 0.0036
1/7 [===>..........................] - ETA: 0s - loss: 2.5544e-044/7 [================>.............] - ETA: 0s - loss: 3.0772e-047/7 [==============================] - ETA: 0s - loss: 3.1611e-047/7 [==============================] - 0s 17ms/step - loss: 3.1611e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00115/7 [====================>.........] - ETA: 0s - loss: 0.00147/7 [==============================] - ETA: 0s - loss: 0.00127/7 [==============================] - 0s 18ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 6.5286e-054/7 [================>.............] - ETA: 0s - loss: 5.2286e-047/7 [==============================] - 0s 15ms/step - loss: 4.4177e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.7472e-045/7 [====================>.........] - ETA: 0s - loss: 0.0046    7/7 [==============================] - 0s 15ms/step - loss: 0.0037
1/7 [===>..........................] - ETA: 0s - loss: 3.1845e-044/7 [================>.............] - ETA: 0s - loss: 2.5075e-047/7 [==============================] - ETA: 0s - loss: 0.0035    7/7 [==============================] - 0s 16ms/step - loss: 0.0035
1/7 [===>..........................] - ETA: 0s - loss: 0.00155/7 [====================>.........] - ETA: 0s - loss: 6.1353e-047/7 [==============================] - 0s 13ms/step - loss: 5.3755e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.4313e-044/7 [================>.............] - ETA: 0s - loss: 8.1639e-047/7 [==============================] - 0s 14ms/step - loss: 5.7430e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.8330e-045/7 [====================>.........] - ETA: 0s - loss: 2.6349e-047/7 [==============================] - 0s 14ms/step - loss: 2.5747e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00194/7 [================>.............] - ETA: 0s - loss: 0.00666/7 [========================>.....] - ETA: 0s - loss: 0.00487/7 [==============================] - 0s 18ms/step - loss: 0.0046
1/7 [===>..........................] - ETA: 0s - loss: 3.5401e-044/7 [================>.............] - ETA: 0s - loss: 2.3787e-047/7 [==============================] - 0s 14ms/step - loss: 0.0035
1/7 [===>..........................] - ETA: 0s - loss: 2.9765e-045/7 [====================>.........] - ETA: 0s - loss: 4.6994e-047/7 [==============================] - 0s 12ms/step - loss: 7.2271e-04
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0016551805136259645:
Train Score: 0.00146 MSE 0.03820 RMSE
Test Score: 0.00183 MSE 0.04282 RMSE
Deviation Min [3.820712e-05], Max [0.58986079]
Deviation 99.5th pctile [0.09913817]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,    4]))
Confusion matrix 
[[1390    3]
 [   0    4]]
precision 0.57143, recall 1.00000, f1 0.72727
Time to train: 295393 ms
Saving model models/A2Benchmark/synthetic_88.csv.h5
Total Time to proces all the selected files : 297441 ms
A2Benchmark : Avg precision 0.57143 recall 1.00000 f1 0.72727 time to train 295393.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_88.csv  --epochs 20 --n_iter 3 --patience 3 :: took 304 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_89.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 08:35:25 AM MST
2020-11-30 08:35:30.894512: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 08:35:30.913262: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 08:35:30.914040: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x555670707740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 08:35:30.914066: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 08:35:30.914171: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_89.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00102/7 [=======>......................] - ETA: 0s - loss: 0.00104/7 [================>.............] - ETA: 0s - loss: 0.00135/7 [====================>.........] - ETA: 0s - loss: 0.00127/7 [==============================] - ETA: 0s - loss: 0.00117/7 [==============================] - 0s 43ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 0.00103/7 [===========>..................] - ETA: 0s - loss: 0.00115/7 [====================>.........] - ETA: 0s - loss: 0.00127/7 [==============================] - ETA: 0s - loss: 0.00117/7 [==============================] - 0s 26ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 5.3694e-043/7 [===========>..................] - ETA: 0s - loss: 0.0162    5/7 [====================>.........] - ETA: 0s - loss: 0.01797/7 [==============================] - ETA: 0s - loss: 0.01507/7 [==============================] - 0s 32ms/step - loss: 0.0150
1/7 [===>..........................] - ETA: 0s - loss: 7.6639e-043/7 [===========>..................] - ETA: 0s - loss: 0.0013    5/7 [====================>.........] - ETA: 0s - loss: 0.00807/7 [==============================] - ETA: 0s - loss: 0.00697/7 [==============================] - 0s 35ms/step - loss: 0.0069
1/7 [===>..........................] - ETA: 0s - loss: 0.00453/7 [===========>..................] - ETA: 0s - loss: 0.00225/7 [====================>.........] - ETA: 0s - loss: 0.00277/7 [==============================] - ETA: 0s - loss: 0.00237/7 [==============================] - 0s 32ms/step - loss: 0.0023
1/7 [===>..........................] - ETA: 0s - loss: 4.8314e-045/7 [====================>.........] - ETA: 0s - loss: 0.0011    7/7 [==============================] - 0s 12ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 6.6224e-046/7 [========================>.....] - ETA: 0s - loss: 8.7110e-047/7 [==============================] - 0s 10ms/step - loss: 9.1623e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.9923e-044/7 [================>.............] - ETA: 0s - loss: 0.0189    7/7 [==============================] - ETA: 0s - loss: 0.01267/7 [==============================] - 0s 16ms/step - loss: 0.0126
1/7 [===>..........................] - ETA: 0s - loss: 7.2741e-044/7 [================>.............] - ETA: 0s - loss: 0.0015    7/7 [==============================] - ETA: 0s - loss: 0.00647/7 [==============================] - 0s 18ms/step - loss: 0.0064
1/7 [===>..........................] - ETA: 0s - loss: 0.00524/7 [================>.............] - ETA: 0s - loss: 0.00277/7 [==============================] - ETA: 0s - loss: 0.00287/7 [==============================] - 0s 17ms/step - loss: 0.0028
1/7 [===>..........................] - ETA: 0s - loss: 4.8677e-043/7 [===========>..................] - ETA: 0s - loss: 0.0011    5/7 [====================>.........] - ETA: 0s - loss: 0.00107/7 [==============================] - ETA: 0s - loss: 0.00107/7 [==============================] - 0s 23ms/step - loss: 0.0010
1/7 [===>..........................] - ETA: 0s - loss: 0.00123/7 [===========>..................] - ETA: 0s - loss: 0.00135/7 [====================>.........] - ETA: 0s - loss: 0.00147/7 [==============================] - ETA: 0s - loss: 0.00137/7 [==============================] - 0s 24ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 3.5773e-043/7 [===========>..................] - ETA: 0s - loss: 0.0156    5/7 [====================>.........] - ETA: 0s - loss: 0.01737/7 [==============================] - 0s 23ms/step - loss: 0.0144
1/7 [===>..........................] - ETA: 0s - loss: 0.00163/7 [===========>..................] - ETA: 0s - loss: 0.00135/7 [====================>.........] - ETA: 0s - loss: 0.00747/7 [==============================] - ETA: 0s - loss: 0.00637/7 [==============================] - 0s 28ms/step - loss: 0.0063
1/7 [===>..........................] - ETA: 0s - loss: 0.00263/7 [===========>..................] - ETA: 0s - loss: 0.00155/7 [====================>.........] - ETA: 0s - loss: 0.00177/7 [==============================] - 0s 23ms/step - loss: 0.0015
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.004792879021260887:
Train Score: 0.00397 MSE 0.06301 RMSE
Test Score: 0.00105 MSE 0.03242 RMSE
Deviation Min [1.28165814e-05], Max [0.65918306]
Deviation 99.5th pctile [0.49003278]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1388,    9]))
Confusion matrix 
[[1388    0]
 [   2    7]]
precision 1.00000, recall 0.77778, f1 0.87500
Time to train: 402359 ms
Saving model models/A2Benchmark/synthetic_89.csv.h5
Total Time to proces all the selected files : 404516 ms
A2Benchmark : Avg precision 1.00000 recall 0.77778 f1 0.87500 time to train 402359.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_89.csv  --epochs 20 --n_iter 3 --patience 3 :: took 410 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_8.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 08:42:20 AM MST
2020-11-30 08:42:26.651679: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 08:42:26.670243: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 08:42:26.671951: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x558dd7e26640 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 08:42:26.671994: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 08:42:26.672177: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_8.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00193/7 [===========>..................] - ETA: 0s - loss: 0.00225/7 [====================>.........] - ETA: 0s - loss: 0.00207/7 [==============================] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 24ms/step - loss: 0.0018
1/7 [===>..........................] - ETA: 0s - loss: 7.2353e-043/7 [===========>..................] - ETA: 0s - loss: 0.0019    5/7 [====================>.........] - ETA: 0s - loss: 0.00277/7 [==============================] - ETA: 0s - loss: 0.00277/7 [==============================] - 0s 34ms/step - loss: 0.0027
1/7 [===>..........................] - ETA: 0s - loss: 6.4290e-043/7 [===========>..................] - ETA: 0s - loss: 0.0049    5/7 [====================>.........] - ETA: 0s - loss: 0.00597/7 [==============================] - ETA: 0s - loss: 0.00517/7 [==============================] - 0s 33ms/step - loss: 0.0051
1/7 [===>..........................] - ETA: 0s - loss: 0.00293/7 [===========>..................] - ETA: 0s - loss: 0.00185/7 [====================>.........] - ETA: 0s - loss: 0.00347/7 [==============================] - ETA: 0s - loss: 0.00357/7 [==============================] - 0s 23ms/step - loss: 0.0035
1/7 [===>..........................] - ETA: 0s - loss: 0.00323/7 [===========>..................] - ETA: 0s - loss: 0.00205/7 [====================>.........] - ETA: 0s - loss: 0.00167/7 [==============================] - 0s 28ms/step - loss: 0.0015
1/7 [===>..........................] - ETA: 0s - loss: 8.7062e-043/7 [===========>..................] - ETA: 0s - loss: 0.0013    5/7 [====================>.........] - ETA: 0s - loss: 0.00147/7 [==============================] - ETA: 0s - loss: 0.00137/7 [==============================] - 0s 33ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 5.5528e-043/7 [===========>..................] - ETA: 0s - loss: 0.0011    5/7 [====================>.........] - ETA: 0s - loss: 0.00167/7 [==============================] - ETA: 0s - loss: 0.00157/7 [==============================] - 0s 36ms/step - loss: 0.0015
1/7 [===>..........................] - ETA: 0s - loss: 6.5544e-043/7 [===========>..................] - ETA: 0s - loss: 0.0053    5/7 [====================>.........] - ETA: 0s - loss: 0.00597/7 [==============================] - ETA: 0s - loss: 0.00487/7 [==============================] - 0s 28ms/step - loss: 0.0048
1/7 [===>..........................] - ETA: 0s - loss: 0.00133/7 [===========>..................] - ETA: 0s - loss: 0.00145/7 [====================>.........] - ETA: 0s - loss: 0.00337/7 [==============================] - ETA: 0s - loss: 0.00327/7 [==============================] - 0s 35ms/step - loss: 0.0032
1/7 [===>..........................] - ETA: 0s - loss: 0.00112/7 [=======>......................] - ETA: 0s - loss: 0.00124/7 [================>.............] - ETA: 0s - loss: 0.00126/7 [========================>.....] - ETA: 0s - loss: 0.00127/7 [==============================] - 0s 37ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 0.00114/7 [================>.............] - ETA: 0s - loss: 0.00137/7 [==============================] - ETA: 0s - loss: 0.00137/7 [==============================] - 0s 18ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 0.00114/7 [================>.............] - ETA: 0s - loss: 0.00177/7 [==============================] - 0s 15ms/step - loss: 0.0016
1/7 [===>..........................] - ETA: 0s - loss: 6.8524e-045/7 [====================>.........] - ETA: 0s - loss: 0.0058    7/7 [==============================] - 0s 13ms/step - loss: 0.0050
1/7 [===>..........................] - ETA: 0s - loss: 5.5171e-045/7 [====================>.........] - ETA: 0s - loss: 0.0026    7/7 [==============================] - 0s 12ms/step - loss: 0.0025
1/7 [===>..........................] - ETA: 0s - loss: 0.00194/7 [================>.............] - ETA: 0s - loss: 0.00147/7 [==============================] - ETA: 0s - loss: 0.00137/7 [==============================] - 0s 16ms/step - loss: 0.0013
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.002344522485509515:
Train Score: 0.00205 MSE 0.04524 RMSE
Test Score: 0.00117 MSE 0.03414 RMSE
Deviation Min [2.46016178e-05], Max [0.34404271]
Deviation 99.5th pctile [0.2380673]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1388,    9]))
Confusion matrix 
[[1388    0]
 [   2    7]]
precision 1.00000, recall 0.77778, f1 0.87500
Time to train: 388637 ms
Saving model models/A2Benchmark/synthetic_8.csv.h5
Total Time to proces all the selected files : 390708 ms
A2Benchmark : Avg precision 1.00000 recall 0.77778 f1 0.87500 time to train 388637.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_8.csv  --epochs 20 --n_iter 3 --patience 3 :: took 397 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_90.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 08:49:02 AM MST
2020-11-30 08:49:08.708684: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 08:49:08.727288: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 08:49:08.728210: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5588d08f6440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 08:49:08.728239: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 08:49:08.728356: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_90.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00103/7 [===========>..................] - ETA: 0s - loss: 0.00115/7 [====================>.........] - ETA: 0s - loss: 9.1119e-047/7 [==============================] - ETA: 0s - loss: 8.3152e-047/7 [==============================] - 0s 30ms/step - loss: 8.3152e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.3873e-043/7 [===========>..................] - ETA: 0s - loss: 4.5578e-045/7 [====================>.........] - ETA: 0s - loss: 4.8714e-047/7 [==============================] - ETA: 0s - loss: 5.3564e-047/7 [==============================] - 0s 32ms/step - loss: 5.3564e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.5463e-043/7 [===========>..................] - ETA: 0s - loss: 4.3517e-045/7 [====================>.........] - ETA: 0s - loss: 4.9720e-047/7 [==============================] - ETA: 0s - loss: 5.0015e-047/7 [==============================] - 0s 24ms/step - loss: 5.0015e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.3104e-043/7 [===========>..................] - ETA: 0s - loss: 7.4454e-045/7 [====================>.........] - ETA: 0s - loss: 0.0024    7/7 [==============================] - ETA: 0s - loss: 0.00237/7 [==============================] - 0s 37ms/step - loss: 0.0023
1/7 [===>..........................] - ETA: 0s - loss: 6.9940e-043/7 [===========>..................] - ETA: 0s - loss: 7.2480e-045/7 [====================>.........] - ETA: 0s - loss: 6.8233e-047/7 [==============================] - ETA: 0s - loss: 8.5490e-047/7 [==============================] - 0s 33ms/step - loss: 8.5490e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00225/7 [====================>.........] - ETA: 0s - loss: 0.00177/7 [==============================] - 0s 13ms/step - loss: 0.0015
1/7 [===>..........................] - ETA: 0s - loss: 2.9220e-045/7 [====================>.........] - ETA: 0s - loss: 4.3524e-047/7 [==============================] - 0s 13ms/step - loss: 4.9977e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.7692e-045/7 [====================>.........] - ETA: 0s - loss: 4.2574e-047/7 [==============================] - 0s 13ms/step - loss: 4.4172e-04
1/7 [===>..........................] - ETA: 0s - loss: 6.9604e-045/7 [====================>.........] - ETA: 0s - loss: 0.0023    7/7 [==============================] - 0s 13ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 2.6348e-045/7 [====================>.........] - ETA: 0s - loss: 5.0059e-047/7 [==============================] - 0s 10ms/step - loss: 6.2604e-04
1/7 [===>..........................] - ETA: 0s - loss: 6.9398e-043/7 [===========>..................] - ETA: 0s - loss: 6.5634e-045/7 [====================>.........] - ETA: 0s - loss: 6.1229e-047/7 [==============================] - ETA: 0s - loss: 5.6749e-047/7 [==============================] - 0s 23ms/step - loss: 5.6749e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.1887e-044/7 [================>.............] - ETA: 0s - loss: 6.7992e-046/7 [========================>.....] - ETA: 0s - loss: 6.5962e-047/7 [==============================] - 0s 21ms/step - loss: 7.3783e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.3340e-043/7 [===========>..................] - ETA: 0s - loss: 4.6220e-045/7 [====================>.........] - ETA: 0s - loss: 5.0869e-047/7 [==============================] - ETA: 0s - loss: 4.9760e-047/7 [==============================] - 0s 26ms/step - loss: 4.9760e-04
1/7 [===>..........................] - ETA: 0s - loss: 7.0725e-043/7 [===========>..................] - ETA: 0s - loss: 5.6839e-045/7 [====================>.........] - ETA: 0s - loss: 0.0023    7/7 [==============================] - ETA: 0s - loss: 0.00217/7 [==============================] - 0s 24ms/step - loss: 0.0021
1/7 [===>..........................] - ETA: 0s - loss: 6.3555e-043/7 [===========>..................] - ETA: 0s - loss: 0.0015    5/7 [====================>.........] - ETA: 0s - loss: 0.00207/7 [==============================] - ETA: 0s - loss: 0.00277/7 [==============================] - 0s 33ms/step - loss: 0.0027
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0009952811582479627:
Train Score: 0.00075 MSE 0.02737 RMSE
Test Score: 0.00050 MSE 0.02229 RMSE
Deviation Min [2.53841768e-05], Max [0.53093156]
Deviation 99.5th pctile [0.05975607]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,    1]))
Confusion matrix 
[[1390    6]
 [   0    1]]
precision 0.14286, recall 1.00000, f1 0.25000
Time to train: 420796 ms
Saving model models/A2Benchmark/synthetic_90.csv.h5
Total Time to proces all the selected files : 423126 ms
A2Benchmark : Avg precision 0.14286 recall 1.00000 f1 0.25000 time to train 420796.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_90.csv  --epochs 20 --n_iter 3 --patience 3 :: took 430 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_91.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 08:56:17 AM MST
2020-11-30 08:56:23.143495: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 08:56:23.162262: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 08:56:23.163772: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x560e8e8f7440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 08:56:23.163817: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 08:56:23.164014: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_91.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 5.5184e-045/7 [====================>.........] - ETA: 0s - loss: 3.9374e-047/7 [==============================] - 0s 12ms/step - loss: 3.2408e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.9275e-055/7 [====================>.........] - ETA: 0s - loss: 6.4316e-057/7 [==============================] - 0s 12ms/step - loss: 7.4953e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.1797e-044/7 [================>.............] - ETA: 0s - loss: 0.0084    7/7 [==============================] - 0s 13ms/step - loss: 0.0054
1/7 [===>..........................] - ETA: 0s - loss: 2.1099e-044/7 [================>.............] - ETA: 0s - loss: 2.1731e-047/7 [==============================] - ETA: 0s - loss: 0.0056    7/7 [==============================] - 0s 17ms/step - loss: 0.0056
1/7 [===>..........................] - ETA: 0s - loss: 1.1714e-045/7 [====================>.........] - ETA: 0s - loss: 1.3022e-047/7 [==============================] - 0s 12ms/step - loss: 1.3444e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00104/7 [================>.............] - ETA: 0s - loss: 7.7403e-046/7 [========================>.....] - ETA: 0s - loss: 5.5435e-047/7 [==============================] - 0s 22ms/step - loss: 5.2708e-04
1/7 [===>..........................] - ETA: 0s - loss: 7.2342e-053/7 [===========>..................] - ETA: 0s - loss: 6.1507e-055/7 [====================>.........] - ETA: 0s - loss: 5.0022e-057/7 [==============================] - ETA: 0s - loss: 4.6152e-057/7 [==============================] - 0s 32ms/step - loss: 4.6152e-05
1/7 [===>..........................] - ETA: 0s - loss: 3.8004e-053/7 [===========>..................] - ETA: 0s - loss: 5.4428e-055/7 [====================>.........] - ETA: 0s - loss: 0.0070    7/7 [==============================] - ETA: 0s - loss: 0.00567/7 [==============================] - 0s 32ms/step - loss: 0.0056
1/7 [===>..........................] - ETA: 0s - loss: 7.7248e-053/7 [===========>..................] - ETA: 0s - loss: 6.9357e-055/7 [====================>.........] - ETA: 0s - loss: 0.0067    7/7 [==============================] - 0s 22ms/step - loss: 0.0056
1/7 [===>..........................] - ETA: 0s - loss: 2.7965e-042/7 [=======>......................] - ETA: 0s - loss: 2.8360e-044/7 [================>.............] - ETA: 0s - loss: 2.6916e-046/7 [========================>.....] - ETA: 0s - loss: 2.4710e-047/7 [==============================] - 0s 35ms/step - loss: 2.4811e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.5371e-044/7 [================>.............] - ETA: 0s - loss: 4.4308e-047/7 [==============================] - ETA: 0s - loss: 3.1736e-047/7 [==============================] - 0s 18ms/step - loss: 3.1736e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.9134e-054/7 [================>.............] - ETA: 0s - loss: 2.7952e-057/7 [==============================] - ETA: 0s - loss: 3.0506e-057/7 [==============================] - 0s 17ms/step - loss: 3.0506e-05
1/7 [===>..........................] - ETA: 0s - loss: 2.4296e-044/7 [================>.............] - ETA: 0s - loss: 0.0086    7/7 [==============================] - ETA: 0s - loss: 0.00577/7 [==============================] - 0s 16ms/step - loss: 0.0057
1/7 [===>..........................] - ETA: 0s - loss: 3.3853e-044/7 [================>.............] - ETA: 0s - loss: 3.4413e-047/7 [==============================] - ETA: 0s - loss: 0.0057    7/7 [==============================] - 0s 17ms/step - loss: 0.0057
1/7 [===>..........................] - ETA: 0s - loss: 8.0967e-045/7 [====================>.........] - ETA: 0s - loss: 6.6407e-047/7 [==============================] - 0s 13ms/step - loss: 6.3053e-04
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.0023149954780819827:
Train Score: 0.00220 MSE 0.04688 RMSE
Test Score: 0.00020 MSE 0.01425 RMSE
Deviation Min [3.90620143e-05], Max [0.74770916]
Deviation 99.5th pctile [0.06715991]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,    4]))
Confusion matrix 
[[1390    3]
 [   0    4]]
precision 0.57143, recall 1.00000, f1 0.72727
Time to train: 286887 ms
Saving model models/A2Benchmark/synthetic_91.csv.h5
Total Time to proces all the selected files : 288921 ms
A2Benchmark : Avg precision 0.57143 recall 1.00000 f1 0.72727 time to train 286887.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_91.csv  --epochs 20 --n_iter 3 --patience 3 :: took 295 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_92.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 09:01:17 AM MST
2020-11-30 09:01:23.373392: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 09:01:23.392277: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 09:01:23.394106: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x558d49981740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 09:01:23.394161: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 09:01:23.394365: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_92.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00645/7 [====================>.........] - ETA: 0s - loss: 0.00397/7 [==============================] - 0s 12ms/step - loss: 0.0034
1/7 [===>..........................] - ETA: 0s - loss: 0.00274/7 [================>.............] - ETA: 0s - loss: 0.00267/7 [==============================] - 0s 16ms/step - loss: 0.0024
1/7 [===>..........................] - ETA: 0s - loss: 0.00134/7 [================>.............] - ETA: 0s - loss: 0.01687/7 [==============================] - ETA: 0s - loss: 0.01187/7 [==============================] - 0s 16ms/step - loss: 0.0118
1/7 [===>..........................] - ETA: 0s - loss: 0.00175/7 [====================>.........] - ETA: 0s - loss: 0.00737/7 [==============================] - 0s 12ms/step - loss: 0.0065
1/7 [===>..........................] - ETA: 0s - loss: 0.00354/7 [================>.............] - ETA: 0s - loss: 0.00287/7 [==============================] - ETA: 0s - loss: 0.00257/7 [==============================] - 0s 16ms/step - loss: 0.0025
1/7 [===>..........................] - ETA: 0s - loss: 0.01063/7 [===========>..................] - ETA: 0s - loss: 0.00805/7 [====================>.........] - ETA: 0s - loss: 0.00597/7 [==============================] - ETA: 0s - loss: 0.00507/7 [==============================] - 0s 24ms/step - loss: 0.0050
1/7 [===>..........................] - ETA: 0s - loss: 0.00283/7 [===========>..................] - ETA: 0s - loss: 0.00285/7 [====================>.........] - ETA: 0s - loss: 0.00287/7 [==============================] - ETA: 0s - loss: 0.00277/7 [==============================] - 0s 31ms/step - loss: 0.0027
1/7 [===>..........................] - ETA: 0s - loss: 0.00263/7 [===========>..................] - ETA: 0s - loss: 0.01245/7 [====================>.........] - ETA: 0s - loss: 0.01537/7 [==============================] - ETA: 0s - loss: 0.01377/7 [==============================] - 0s 33ms/step - loss: 0.0137
1/7 [===>..........................] - ETA: 0s - loss: 0.00303/7 [===========>..................] - ETA: 0s - loss: 0.00245/7 [====================>.........] - ETA: 0s - loss: 0.00797/7 [==============================] - 0s 22ms/step - loss: 0.0071
1/7 [===>..........................] - ETA: 0s - loss: 0.00513/7 [===========>..................] - ETA: 0s - loss: 0.00335/7 [====================>.........] - ETA: 0s - loss: 0.00317/7 [==============================] - ETA: 0s - loss: 0.00287/7 [==============================] - 0s 28ms/step - loss: 0.0028
1/7 [===>..........................] - ETA: 0s - loss: 0.00765/7 [====================>.........] - ETA: 0s - loss: 0.00487/7 [==============================] - 0s 13ms/step - loss: 0.0042
1/7 [===>..........................] - ETA: 0s - loss: 0.00124/7 [================>.............] - ETA: 0s - loss: 0.00217/7 [==============================] - ETA: 0s - loss: 0.00267/7 [==============================] - 0s 17ms/step - loss: 0.0026
1/7 [===>..........................] - ETA: 0s - loss: 0.00164/7 [================>.............] - ETA: 0s - loss: 0.01687/7 [==============================] - ETA: 0s - loss: 0.01187/7 [==============================] - 0s 17ms/step - loss: 0.0118
1/7 [===>..........................] - ETA: 0s - loss: 0.01454/7 [================>.............] - ETA: 0s - loss: 0.00837/7 [==============================] - 0s 16ms/step - loss: 0.0112
1/7 [===>..........................] - ETA: 0s - loss: 0.00444/7 [================>.............] - ETA: 0s - loss: 0.00287/7 [==============================] - ETA: 0s - loss: 0.00247/7 [==============================] - 0s 16ms/step - loss: 0.0024
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.005312250647693873:
Train Score: 0.00473 MSE 0.06874 RMSE
Test Score: 0.00362 MSE 0.06015 RMSE
Deviation Min [6.49431703e-05], Max [0.60169407]
Deviation 99.5th pctile [0.4939345]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1388,    9]))
Confusion matrix 
[[1388    0]
 [   2    7]]
precision 1.00000, recall 0.77778, f1 0.87500
Time to train: 251834 ms
Saving model models/A2Benchmark/synthetic_92.csv.h5
Total Time to proces all the selected files : 253747 ms
A2Benchmark : Avg precision 1.00000 recall 0.77778 f1 0.87500 time to train 251834.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_92.csv  --epochs 20 --n_iter 3 --patience 3 :: took 260 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_93.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 09:05:42 AM MST
2020-11-30 09:05:48.285768: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 09:05:48.304276: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 09:05:48.305886: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55ddf7561960 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 09:05:48.305942: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 09:05:48.306148: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_93.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 4.1039e-044/7 [================>.............] - ETA: 0s - loss: 1.7470e-047/7 [==============================] - ETA: 0s - loss: 1.4752e-047/7 [==============================] - 0s 16ms/step - loss: 1.4752e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.6132e-045/7 [====================>.........] - ETA: 0s - loss: 2.2989e-047/7 [==============================] - 0s 12ms/step - loss: 2.2014e-04
1/7 [===>..........................] - ETA: 0s - loss: 8.4659e-054/7 [================>.............] - ETA: 0s - loss: 6.5730e-057/7 [==============================] - ETA: 0s - loss: 5.5161e-057/7 [==============================] - 0s 16ms/step - loss: 5.5161e-05
1/7 [===>..........................] - ETA: 0s - loss: 9.3922e-054/7 [================>.............] - ETA: 0s - loss: 5.8068e-057/7 [==============================] - ETA: 0s - loss: 0.0029    7/7 [==============================] - 0s 16ms/step - loss: 0.0029
1/7 [===>..........................] - ETA: 0s - loss: 4.7443e-054/7 [================>.............] - ETA: 0s - loss: 2.3739e-047/7 [==============================] - ETA: 0s - loss: 2.2795e-047/7 [==============================] - 0s 17ms/step - loss: 2.2795e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00144/7 [================>.............] - ETA: 0s - loss: 6.8435e-047/7 [==============================] - ETA: 0s - loss: 5.7267e-047/7 [==============================] - 0s 17ms/step - loss: 5.7267e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.8629e-055/7 [====================>.........] - ETA: 0s - loss: 2.9881e-057/7 [==============================] - 0s 11ms/step - loss: 2.8827e-05
1/7 [===>..........................] - ETA: 0s - loss: 4.4850e-055/7 [====================>.........] - ETA: 0s - loss: 3.9588e-057/7 [==============================] - 0s 16ms/step - loss: 4.0159e-05
1/7 [===>..........................] - ETA: 0s - loss: 9.2148e-055/7 [====================>.........] - ETA: 0s - loss: 0.0034    7/7 [==============================] - 0s 15ms/step - loss: 0.0028
1/7 [===>..........................] - ETA: 0s - loss: 7.2281e-054/7 [================>.............] - ETA: 0s - loss: 4.0054e-057/7 [==============================] - ETA: 0s - loss: 3.1717e-057/7 [==============================] - 0s 15ms/step - loss: 3.1717e-05
1/7 [===>..........................] - ETA: 0s - loss: 0.00203/7 [===========>..................] - ETA: 0s - loss: 0.00115/7 [====================>.........] - ETA: 0s - loss: 7.7635e-047/7 [==============================] - ETA: 0s - loss: 6.8688e-047/7 [==============================] - 0s 30ms/step - loss: 6.8688e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.2322e-043/7 [===========>..................] - ETA: 0s - loss: 1.5059e-045/7 [====================>.........] - ETA: 0s - loss: 1.1530e-047/7 [==============================] - ETA: 0s - loss: 1.0750e-047/7 [==============================] - 0s 31ms/step - loss: 1.0750e-04
1/7 [===>..........................] - ETA: 0s - loss: 9.8561e-053/7 [===========>..................] - ETA: 0s - loss: 8.5442e-055/7 [====================>.........] - ETA: 0s - loss: 6.0555e-057/7 [==============================] - ETA: 0s - loss: 5.6301e-057/7 [==============================] - 0s 28ms/step - loss: 5.6301e-05
1/7 [===>..........................] - ETA: 0s - loss: 2.6879e-053/7 [===========>..................] - ETA: 0s - loss: 8.3871e-055/7 [====================>.........] - ETA: 0s - loss: 0.0034    7/7 [==============================] - ETA: 0s - loss: 0.00297/7 [==============================] - 0s 36ms/step - loss: 0.0029
1/7 [===>..........................] - ETA: 0s - loss: 2.5106e-043/7 [===========>..................] - ETA: 0s - loss: 1.4584e-045/7 [====================>.........] - ETA: 0s - loss: 1.0852e-047/7 [==============================] - ETA: 0s - loss: 1.1591e-047/7 [==============================] - 0s 26ms/step - loss: 1.1591e-04
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0007021147590421606:
Train Score: 0.00059 MSE 0.02424 RMSE
Test Score: 0.00220 MSE 0.04693 RMSE
Deviation Min [2.15353925e-06], Max [0.72013062]
Deviation 99.5th pctile [0.07434837]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,    1]))
Confusion matrix 
[[1390    6]
 [   0    1]]
precision 0.14286, recall 1.00000, f1 0.25000
Time to train: 239734 ms
Saving model models/A2Benchmark/synthetic_93.csv.h5
Total Time to proces all the selected files : 241904 ms
A2Benchmark : Avg precision 0.14286 recall 1.00000 f1 0.25000 time to train 239734.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_93.csv  --epochs 20 --n_iter 3 --patience 3 :: took 248 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_94.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 09:09:55 AM MST
2020-11-30 09:10:01.432962: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 09:10:01.451062: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 09:10:01.451805: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x563b8a634440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 09:10:01.451831: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 09:10:01.451981: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_94.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00205/7 [====================>.........] - ETA: 0s - loss: 0.00237/7 [==============================] - 0s 13ms/step - loss: 0.0021
1/7 [===>..........................] - ETA: 0s - loss: 0.00105/7 [====================>.........] - ETA: 0s - loss: 0.00187/7 [==============================] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 16ms/step - loss: 0.0018
1/7 [===>..........................] - ETA: 0s - loss: 7.1828e-045/7 [====================>.........] - ETA: 0s - loss: 0.0052    7/7 [==============================] - 0s 13ms/step - loss: 0.0043
1/7 [===>..........................] - ETA: 0s - loss: 7.4273e-046/7 [========================>.....] - ETA: 0s - loss: 0.0034    7/7 [==============================] - 0s 11ms/step - loss: 0.0033
1/7 [===>..........................] - ETA: 0s - loss: 0.00375/7 [====================>.........] - ETA: 0s - loss: 0.00217/7 [==============================] - 0s 13ms/step - loss: 0.0021
1/7 [===>..........................] - ETA: 0s - loss: 0.00193/7 [===========>..................] - ETA: 0s - loss: 0.00165/7 [====================>.........] - ETA: 0s - loss: 0.00217/7 [==============================] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 24ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 0.00193/7 [===========>..................] - ETA: 0s - loss: 0.00165/7 [====================>.........] - ETA: 0s - loss: 0.00227/7 [==============================] - 0s 31ms/step - loss: 0.0023
1/7 [===>..........................] - ETA: 0s - loss: 0.00133/7 [===========>..................] - ETA: 0s - loss: 0.00155/7 [====================>.........] - ETA: 0s - loss: 0.00497/7 [==============================] - ETA: 0s - loss: 0.00427/7 [==============================] - 0s 27ms/step - loss: 0.0042
1/7 [===>..........................] - ETA: 0s - loss: 8.9268e-044/7 [================>.............] - ETA: 0s - loss: 0.0022    6/7 [========================>.....] - ETA: 0s - loss: 0.00427/7 [==============================] - 0s 22ms/step - loss: 0.0040
1/7 [===>..........................] - ETA: 0s - loss: 0.00533/7 [===========>..................] - ETA: 0s - loss: 0.00305/7 [====================>.........] - ETA: 0s - loss: 0.00266/7 [========================>.....] - ETA: 0s - loss: 0.00297/7 [==============================] - 0s 34ms/step - loss: 0.0030
1/7 [===>..........................] - ETA: 0s - loss: 0.00455/7 [====================>.........] - ETA: 0s - loss: 0.01087/7 [==============================] - 0s 13ms/step - loss: 0.0119
1/7 [===>..........................] - ETA: 0s - loss: 8.3249e-044/7 [================>.............] - ETA: 0s - loss: 0.0016    7/7 [==============================] - ETA: 0s - loss: 0.00167/7 [==============================] - 0s 17ms/step - loss: 0.0016
1/7 [===>..........................] - ETA: 0s - loss: 0.00115/7 [====================>.........] - ETA: 0s - loss: 0.00477/7 [==============================] - 0s 14ms/step - loss: 0.0040
1/7 [===>..........................] - ETA: 0s - loss: 8.2689e-045/7 [====================>.........] - ETA: 0s - loss: 0.0038    7/7 [==============================] - 0s 12ms/step - loss: 0.0034
1/7 [===>..........................] - ETA: 0s - loss: 0.00464/7 [================>.............] - ETA: 0s - loss: 0.00247/7 [==============================] - ETA: 0s - loss: 0.00257/7 [==============================] - 0s 16ms/step - loss: 0.0025
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.002717178943566978:
Train Score: 0.00251 MSE 0.05008 RMSE
Test Score: 0.00175 MSE 0.04183 RMSE
Deviation Min [0.00015207], Max [0.52732754]
Deviation 99.5th pctile [0.1152683]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,    4]))
Confusion matrix 
[[1390    3]
 [   0    4]]
precision 0.57143, recall 1.00000, f1 0.72727
Time to train: 322241 ms
Saving model models/A2Benchmark/synthetic_94.csv.h5
Total Time to proces all the selected files : 324462 ms
A2Benchmark : Avg precision 0.57143 recall 1.00000 f1 0.72727 time to train 322241.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_94.csv  --epochs 20 --n_iter 3 --patience 3 :: took 331 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_95.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 09:15:31 AM MST
2020-11-30 09:15:37.147291: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 09:15:37.166304: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 09:15:37.167922: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56019fe79440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 09:15:37.167977: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 09:15:37.168224: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_95.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 1.0151e-044/7 [================>.............] - ETA: 0s - loss: 2.3458e-047/7 [==============================] - ETA: 0s - loss: 1.7541e-047/7 [==============================] - 0s 17ms/step - loss: 1.7541e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.1493e-045/7 [====================>.........] - ETA: 0s - loss: 1.0005e-047/7 [==============================] - ETA: 0s - loss: 9.5027e-057/7 [==============================] - 0s 23ms/step - loss: 9.5027e-05
1/7 [===>..........................] - ETA: 0s - loss: 9.8495e-045/7 [====================>.........] - ETA: 0s - loss: 0.0210    7/7 [==============================] - 0s 13ms/step - loss: 0.0168
1/7 [===>..........................] - ETA: 0s - loss: 4.5875e-055/7 [====================>.........] - ETA: 0s - loss: 0.0091    7/7 [==============================] - 0s 13ms/step - loss: 0.0075
1/7 [===>..........................] - ETA: 0s - loss: 2.3596e-045/7 [====================>.........] - ETA: 0s - loss: 1.7197e-047/7 [==============================] - 0s 13ms/step - loss: 1.8824e-04
1/7 [===>..........................] - ETA: 0s - loss: 7.6833e-053/7 [===========>..................] - ETA: 0s - loss: 1.4852e-045/7 [====================>.........] - ETA: 0s - loss: 1.4407e-047/7 [==============================] - ETA: 0s - loss: 1.2858e-047/7 [==============================] - 0s 23ms/step - loss: 1.2858e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.3401e-043/7 [===========>..................] - ETA: 0s - loss: 2.0669e-045/7 [====================>.........] - ETA: 0s - loss: 1.7870e-047/7 [==============================] - ETA: 0s - loss: 1.6043e-047/7 [==============================] - 0s 28ms/step - loss: 1.6043e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.4912e-043/7 [===========>..................] - ETA: 0s - loss: 0.0177    5/7 [====================>.........] - ETA: 0s - loss: 0.02166/7 [========================>.....] - ETA: 0s - loss: 0.01807/7 [==============================] - 0s 38ms/step - loss: 0.0172
1/7 [===>..........................] - ETA: 0s - loss: 1.4444e-043/7 [===========>..................] - ETA: 0s - loss: 5.7849e-045/7 [====================>.........] - ETA: 0s - loss: 0.0104    7/7 [==============================] - 0s 23ms/step - loss: 0.0087
1/7 [===>..........................] - ETA: 0s - loss: 0.00133/7 [===========>..................] - ETA: 0s - loss: 8.9673e-045/7 [====================>.........] - ETA: 0s - loss: 0.0010    7/7 [==============================] - ETA: 0s - loss: 0.00127/7 [==============================] - 0s 29ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 9.0177e-053/7 [===========>..................] - ETA: 0s - loss: 1.3082e-045/7 [====================>.........] - ETA: 0s - loss: 1.3927e-047/7 [==============================] - ETA: 0s - loss: 1.2589e-047/7 [==============================] - 0s 36ms/step - loss: 1.2589e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.9105e-053/7 [===========>..................] - ETA: 0s - loss: 3.8618e-045/7 [====================>.........] - ETA: 0s - loss: 3.3708e-047/7 [==============================] - ETA: 0s - loss: 3.5222e-047/7 [==============================] - 0s 26ms/step - loss: 3.5222e-04
1/7 [===>..........................] - ETA: 0s - loss: 8.9415e-043/7 [===========>..................] - ETA: 0s - loss: 0.0185    5/7 [====================>.........] - ETA: 0s - loss: 0.02237/7 [==============================] - ETA: 0s - loss: 0.01787/7 [==============================] - 0s 33ms/step - loss: 0.0178
1/7 [===>..........................] - ETA: 0s - loss: 7.3045e-053/7 [===========>..................] - ETA: 0s - loss: 3.9872e-045/7 [====================>.........] - ETA: 0s - loss: 0.0101    7/7 [==============================] - ETA: 0s - loss: 0.00857/7 [==============================] - 0s 27ms/step - loss: 0.0085
1/7 [===>..........................] - ETA: 0s - loss: 9.2279e-053/7 [===========>..................] - ETA: 0s - loss: 3.6606e-045/7 [====================>.........] - ETA: 0s - loss: 3.0399e-047/7 [==============================] - ETA: 0s - loss: 2.6530e-047/7 [==============================] - 0s 27ms/step - loss: 2.6530e-04
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0049562124913791195:
Train Score: 0.00417 MSE 0.06456 RMSE
Test Score: 0.00036 MSE 0.01910 RMSE
Deviation Min [4.57341971e-06], Max [0.74839638]
Deviation 99.5th pctile [0.59406049]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1388,    9]))
Confusion matrix 
[[1388    0]
 [   2    7]]
precision 1.00000, recall 0.77778, f1 0.87500
Time to train: 341631 ms
Saving model models/A2Benchmark/synthetic_95.csv.h5
Total Time to proces all the selected files : 343937 ms
A2Benchmark : Avg precision 1.00000 recall 0.77778 f1 0.87500 time to train 341631.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_95.csv  --epochs 20 --n_iter 3 --patience 3 :: took 350 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_96.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 09:21:26 AM MST
2020-11-30 09:21:32.423224: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 09:21:32.442164: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 09:21:32.443506: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x560b326ac440 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 09:21:32.443554: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 09:21:32.443756: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_96.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00363/7 [===========>..................] - ETA: 0s - loss: 0.00415/7 [====================>.........] - ETA: 0s - loss: 0.00417/7 [==============================] - ETA: 0s - loss: 0.00397/7 [==============================] - 0s 30ms/step - loss: 0.0039
1/7 [===>..........................] - ETA: 0s - loss: 0.00543/7 [===========>..................] - ETA: 0s - loss: 0.00435/7 [====================>.........] - ETA: 0s - loss: 0.00507/7 [==============================] - ETA: 0s - loss: 0.00467/7 [==============================] - 0s 25ms/step - loss: 0.0046
1/7 [===>..........................] - ETA: 0s - loss: 0.00263/7 [===========>..................] - ETA: 0s - loss: 0.00465/7 [====================>.........] - ETA: 0s - loss: 0.00447/7 [==============================] - ETA: 0s - loss: 0.00497/7 [==============================] - 0s 24ms/step - loss: 0.0049
1/7 [===>..........................] - ETA: 0s - loss: 0.00503/7 [===========>..................] - ETA: 0s - loss: 0.00485/7 [====================>.........] - ETA: 0s - loss: 0.00597/7 [==============================] - ETA: 0s - loss: 0.00577/7 [==============================] - 0s 34ms/step - loss: 0.0057
1/7 [===>..........................] - ETA: 0s - loss: 0.00823/7 [===========>..................] - ETA: 0s - loss: 0.00575/7 [====================>.........] - ETA: 0s - loss: 0.00607/7 [==============================] - ETA: 0s - loss: 0.00587/7 [==============================] - 0s 27ms/step - loss: 0.0058
1/7 [===>..........................] - ETA: 0s - loss: 0.01035/7 [====================>.........] - ETA: 0s - loss: 0.00957/7 [==============================] - 0s 14ms/step - loss: 0.0087
1/7 [===>..........................] - ETA: 0s - loss: 0.00485/7 [====================>.........] - ETA: 0s - loss: 0.00477/7 [==============================] - 0s 13ms/step - loss: 0.0044
1/7 [===>..........................] - ETA: 0s - loss: 0.00305/7 [====================>.........] - ETA: 0s - loss: 0.00397/7 [==============================] - 0s 14ms/step - loss: 0.0040
1/7 [===>..........................] - ETA: 0s - loss: 0.00484/7 [================>.............] - ETA: 0s - loss: 0.00467/7 [==============================] - ETA: 0s - loss: 0.00537/7 [==============================] - 0s 19ms/step - loss: 0.0053
1/7 [===>..........................] - ETA: 0s - loss: 0.01174/7 [================>.............] - ETA: 0s - loss: 0.00667/7 [==============================] - 0s 14ms/step - loss: 0.0065
1/7 [===>..........................] - ETA: 0s - loss: 0.00373/7 [===========>..................] - ETA: 0s - loss: 0.00585/7 [====================>.........] - ETA: 0s - loss: 0.00547/7 [==============================] - ETA: 0s - loss: 0.00557/7 [==============================] - 0s 34ms/step - loss: 0.0055
1/7 [===>..........................] - ETA: 0s - loss: 0.00933/7 [===========>..................] - ETA: 0s - loss: 0.00765/7 [====================>.........] - ETA: 0s - loss: 0.00877/7 [==============================] - ETA: 0s - loss: 0.00827/7 [==============================] - 0s 29ms/step - loss: 0.0082
1/7 [===>..........................] - ETA: 0s - loss: 0.00273/7 [===========>..................] - ETA: 0s - loss: 0.00385/7 [====================>.........] - ETA: 0s - loss: 0.00387/7 [==============================] - ETA: 0s - loss: 0.00407/7 [==============================] - 0s 28ms/step - loss: 0.0040
1/7 [===>..........................] - ETA: 0s - loss: 0.00553/7 [===========>..................] - ETA: 0s - loss: 0.00555/7 [====================>.........] - ETA: 0s - loss: 0.00697/7 [==============================] - 0s 23ms/step - loss: 0.0065
1/7 [===>..........................] - ETA: 0s - loss: 0.00713/7 [===========>..................] - ETA: 0s - loss: 0.00585/7 [====================>.........] - ETA: 0s - loss: 0.00567/7 [==============================] - ETA: 0s - loss: 0.00637/7 [==============================] - 0s 30ms/step - loss: 0.0063
Best parameters {'n_units': 72, 'n_hidden': 2} best score 0.004996180254966021:
Train Score: 0.00422 MSE 0.06495 RMSE
Test Score: 0.00425 MSE 0.06517 RMSE
Deviation Min [0.00012464], Max [0.40498668]
Deviation 99.5th pctile [0.17041909]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,    1]))
Confusion matrix 
[[1390    6]
 [   0    1]]
precision 0.14286, recall 1.00000, f1 0.25000
Time to train: 489258 ms
Saving model models/A2Benchmark/synthetic_96.csv.h5
Total Time to proces all the selected files : 493378 ms
A2Benchmark : Avg precision 0.14286 recall 1.00000 f1 0.25000 time to train 489258.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_96.csv  --epochs 20 --n_iter 3 --patience 3 :: took 500 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_97.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 09:29:51 AM MST
2020-11-30 09:29:56.978869: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 09:29:56.997211: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 09:29:56.998630: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x565544537740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 09:29:56.998678: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 09:29:56.998905: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_97.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00405/7 [====================>.........] - ETA: 0s - loss: 0.00397/7 [==============================] - 0s 13ms/step - loss: 0.0033
1/7 [===>..........................] - ETA: 0s - loss: 1.5689e-044/7 [================>.............] - ETA: 0s - loss: 3.0098e-047/7 [==============================] - 0s 14ms/step - loss: 2.9917e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.2987e-044/7 [================>.............] - ETA: 0s - loss: 0.0078    7/7 [==============================] - ETA: 0s - loss: 0.00537/7 [==============================] - 0s 15ms/step - loss: 0.0053
1/7 [===>..........................] - ETA: 0s - loss: 2.3893e-044/7 [================>.............] - ETA: 0s - loss: 2.8052e-047/7 [==============================] - ETA: 0s - loss: 0.0053    7/7 [==============================] - 0s 16ms/step - loss: 0.0053
1/7 [===>..........................] - ETA: 0s - loss: 2.4129e-045/7 [====================>.........] - ETA: 0s - loss: 2.9522e-047/7 [==============================] - 0s 13ms/step - loss: 3.2699e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.8917e-043/7 [===========>..................] - ETA: 0s - loss: 5.0586e-045/7 [====================>.........] - ETA: 0s - loss: 4.5123e-047/7 [==============================] - ETA: 0s - loss: 4.2920e-047/7 [==============================] - 0s 26ms/step - loss: 4.2920e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.5100e-043/7 [===========>..................] - ETA: 0s - loss: 3.3744e-045/7 [====================>.........] - ETA: 0s - loss: 3.6671e-047/7 [==============================] - ETA: 0s - loss: 3.4310e-047/7 [==============================] - 0s 31ms/step - loss: 3.4310e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.5404e-043/7 [===========>..................] - ETA: 0s - loss: 3.2712e-045/7 [====================>.........] - ETA: 0s - loss: 0.0071    7/7 [==============================] - ETA: 0s - loss: 0.00577/7 [==============================] - 0s 32ms/step - loss: 0.0057
1/7 [===>..........................] - ETA: 0s - loss: 0.00122/7 [=======>......................] - ETA: 0s - loss: 6.9126e-044/7 [================>.............] - ETA: 0s - loss: 8.1917e-046/7 [========================>.....] - ETA: 0s - loss: 0.0059    7/7 [==============================] - 0s 37ms/step - loss: 0.0057
1/7 [===>..........................] - ETA: 0s - loss: 0.00113/7 [===========>..................] - ETA: 0s - loss: 5.1468e-045/7 [====================>.........] - ETA: 0s - loss: 6.2932e-047/7 [==============================] - ETA: 0s - loss: 5.4480e-047/7 [==============================] - 0s 37ms/step - loss: 5.4480e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.7950e-045/7 [====================>.........] - ETA: 0s - loss: 2.9632e-047/7 [==============================] - 0s 14ms/step - loss: 2.7969e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.8457e-045/7 [====================>.........] - ETA: 0s - loss: 4.2153e-047/7 [==============================] - 0s 11ms/step - loss: 4.8686e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.1191e-045/7 [====================>.........] - ETA: 0s - loss: 0.0066    7/7 [==============================] - 0s 12ms/step - loss: 0.0053
1/7 [===>..........................] - ETA: 0s - loss: 3.8163e-045/7 [====================>.........] - ETA: 0s - loss: 0.0060    7/7 [==============================] - 0s 12ms/step - loss: 0.0050
1/7 [===>..........................] - ETA: 0s - loss: 6.2519e-044/7 [================>.............] - ETA: 0s - loss: 4.3309e-047/7 [==============================] - ETA: 0s - loss: 3.9477e-047/7 [==============================] - 0s 15ms/step - loss: 3.9477e-04
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.00229642967460677:
Train Score: 0.00211 MSE 0.04597 RMSE
Test Score: 0.00034 MSE 0.01846 RMSE
Deviation Min [1.38126386e-05], Max [0.72057696]
Deviation 99.5th pctile [0.1263197]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,    4]))
Confusion matrix 
[[1390    3]
 [   0    4]]
precision 0.57143, recall 1.00000, f1 0.72727
Time to train: 278498 ms
Saving model models/A2Benchmark/synthetic_97.csv.h5
Total Time to proces all the selected files : 280641 ms
A2Benchmark : Avg precision 0.57143 recall 1.00000 f1 0.72727 time to train 278498.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_97.csv  --epochs 20 --n_iter 3 --patience 3 :: took 287 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_98.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 09:34:43 AM MST
2020-11-30 09:34:49.013416: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 09:34:49.032284: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 09:34:49.033185: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56135501f960 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 09:34:49.033212: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 09:34:49.033317: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_98.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00233/7 [===========>..................] - ETA: 0s - loss: 0.00205/7 [====================>.........] - ETA: 0s - loss: 0.00167/7 [==============================] - ETA: 0s - loss: 0.00147/7 [==============================] - 0s 27ms/step - loss: 0.0014
1/7 [===>..........................] - ETA: 0s - loss: 3.9788e-053/7 [===========>..................] - ETA: 0s - loss: 5.1462e-055/7 [====================>.........] - ETA: 0s - loss: 4.8688e-057/7 [==============================] - ETA: 0s - loss: 4.7961e-057/7 [==============================] - 0s 33ms/step - loss: 4.7961e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.5552e-054/7 [================>.............] - ETA: 0s - loss: 0.0154    7/7 [==============================] - ETA: 0s - loss: 0.01017/7 [==============================] - 0s 18ms/step - loss: 0.0101
1/7 [===>..........................] - ETA: 0s - loss: 5.2127e-043/7 [===========>..................] - ETA: 0s - loss: 5.1306e-045/7 [====================>.........] - ETA: 0s - loss: 0.0068    7/7 [==============================] - ETA: 0s - loss: 0.00577/7 [==============================] - 0s 32ms/step - loss: 0.0057
1/7 [===>..........................] - ETA: 0s - loss: 0.00213/7 [===========>..................] - ETA: 0s - loss: 0.00225/7 [====================>.........] - ETA: 0s - loss: 0.00227/7 [==============================] - ETA: 0s - loss: 0.00227/7 [==============================] - 0s 23ms/step - loss: 0.0022
1/7 [===>..........................] - ETA: 0s - loss: 0.00203/7 [===========>..................] - ETA: 0s - loss: 0.00185/7 [====================>.........] - ETA: 0s - loss: 0.00147/7 [==============================] - ETA: 0s - loss: 0.00127/7 [==============================] - 0s 34ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 5.9299e-053/7 [===========>..................] - ETA: 0s - loss: 6.6820e-055/7 [====================>.........] - ETA: 0s - loss: 6.0524e-057/7 [==============================] - ETA: 0s - loss: 5.8634e-057/7 [==============================] - 0s 25ms/step - loss: 5.8634e-05
1/7 [===>..........................] - ETA: 0s - loss: 2.6980e-043/7 [===========>..................] - ETA: 0s - loss: 0.0112    5/7 [====================>.........] - ETA: 0s - loss: 0.01357/7 [==============================] - ETA: 0s - loss: 0.01087/7 [==============================] - 0s 26ms/step - loss: 0.0108
1/7 [===>..........................] - ETA: 0s - loss: 9.4805e-043/7 [===========>..................] - ETA: 0s - loss: 9.1919e-045/7 [====================>.........] - ETA: 0s - loss: 0.0074    7/7 [==============================] - ETA: 0s - loss: 0.00617/7 [==============================] - 0s 34ms/step - loss: 0.0061
1/7 [===>..........................] - ETA: 0s - loss: 4.5742e-053/7 [===========>..................] - ETA: 0s - loss: 1.4467e-045/7 [====================>.........] - ETA: 0s - loss: 3.0306e-047/7 [==============================] - ETA: 0s - loss: 3.8349e-047/7 [==============================] - 0s 25ms/step - loss: 3.8349e-04
1/7 [===>..........................] - ETA: 0s - loss: 6.9095e-045/7 [====================>.........] - ETA: 0s - loss: 4.5684e-047/7 [==============================] - 0s 13ms/step - loss: 3.7029e-04
1/7 [===>..........................] - ETA: 0s - loss: 7.0838e-054/7 [================>.............] - ETA: 0s - loss: 5.8574e-057/7 [==============================] - ETA: 0s - loss: 4.7272e-057/7 [==============================] - 0s 18ms/step - loss: 4.7272e-05
1/7 [===>..........................] - ETA: 0s - loss: 3.6590e-045/7 [====================>.........] - ETA: 0s - loss: 0.0127    7/7 [==============================] - 0s 13ms/step - loss: 0.0102
1/7 [===>..........................] - ETA: 0s - loss: 4.3370e-054/7 [================>.............] - ETA: 0s - loss: 4.6141e-057/7 [==============================] - ETA: 0s - loss: 0.0047    7/7 [==============================] - 0s 15ms/step - loss: 0.0047
1/7 [===>..........................] - ETA: 0s - loss: 5.4801e-046/7 [========================>.....] - ETA: 0s - loss: 1.7321e-047/7 [==============================] - 0s 10ms/step - loss: 1.6680e-04
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.003095877234591171:
Train Score: 0.00290 MSE 0.05382 RMSE
Test Score: 0.00021 MSE 0.01460 RMSE
Deviation Min [7.58576659e-05], Max [0.59848283]
Deviation 99.5th pctile [0.47673537]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1388,    9]))
Confusion matrix 
[[1388    0]
 [   2    7]]
precision 1.00000, recall 0.77778, f1 0.87500
Time to train: 380192 ms
Saving model models/A2Benchmark/synthetic_98.csv.h5
Total Time to proces all the selected files : 382408 ms
A2Benchmark : Avg precision 1.00000 recall 0.77778 f1 0.87500 time to train 380192.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_98.csv  --epochs 20 --n_iter 3 --patience 3 :: took 388 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_99.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 09:41:16 AM MST
2020-11-30 09:41:22.679698: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 09:41:22.698297: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 09:41:22.699500: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559b9869b740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 09:41:22.699537: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 09:41:22.699682: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_99.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00494/7 [================>.............] - ETA: 0s - loss: 0.00347/7 [==============================] - ETA: 0s - loss: 0.00307/7 [==============================] - 0s 17ms/step - loss: 0.0030
1/7 [===>..........................] - ETA: 0s - loss: 0.00284/7 [================>.............] - ETA: 0s - loss: 0.00277/7 [==============================] - ETA: 0s - loss: 0.00327/7 [==============================] - 0s 16ms/step - loss: 0.0032
1/7 [===>..........................] - ETA: 0s - loss: 0.00164/7 [================>.............] - ETA: 0s - loss: 0.00247/7 [==============================] - ETA: 0s - loss: 0.00297/7 [==============================] - 0s 16ms/step - loss: 0.0029
1/7 [===>..........................] - ETA: 0s - loss: 0.00405/7 [====================>.........] - ETA: 0s - loss: 0.00617/7 [==============================] - 0s 13ms/step - loss: 0.0056
1/7 [===>..........................] - ETA: 0s - loss: 0.00615/7 [====================>.........] - ETA: 0s - loss: 0.00407/7 [==============================] - 0s 14ms/step - loss: 0.0036
1/7 [===>..........................] - ETA: 0s - loss: 0.00643/7 [===========>..................] - ETA: 0s - loss: 0.00475/7 [====================>.........] - ETA: 0s - loss: 0.00417/7 [==============================] - ETA: 0s - loss: 0.00367/7 [==============================] - 0s 32ms/step - loss: 0.0036
1/7 [===>..........................] - ETA: 0s - loss: 0.00353/7 [===========>..................] - ETA: 0s - loss: 0.00265/7 [====================>.........] - ETA: 0s - loss: 0.00357/7 [==============================] - ETA: 0s - loss: 0.00327/7 [==============================] - 0s 33ms/step - loss: 0.0032
1/7 [===>..........................] - ETA: 0s - loss: 0.00183/7 [===========>..................] - ETA: 0s - loss: 0.00275/7 [====================>.........] - ETA: 0s - loss: 0.00277/7 [==============================] - ETA: 0s - loss: 0.00317/7 [==============================] - 0s 32ms/step - loss: 0.0031
1/7 [===>..........................] - ETA: 0s - loss: 0.00353/7 [===========>..................] - ETA: 0s - loss: 0.00295/7 [====================>.........] - ETA: 0s - loss: 0.00617/7 [==============================] - ETA: 0s - loss: 0.00557/7 [==============================] - 0s 25ms/step - loss: 0.0055
1/7 [===>..........................] - ETA: 0s - loss: 0.00453/7 [===========>..................] - ETA: 0s - loss: 0.00305/7 [====================>.........] - ETA: 0s - loss: 0.00307/7 [==============================] - ETA: 0s - loss: 0.00287/7 [==============================] - 0s 26ms/step - loss: 0.0028
1/7 [===>..........................] - ETA: 0s - loss: 0.00623/7 [===========>..................] - ETA: 0s - loss: 0.00455/7 [====================>.........] - ETA: 0s - loss: 0.00397/7 [==============================] - ETA: 0s - loss: 0.00347/7 [==============================] - 0s 26ms/step - loss: 0.0034
1/7 [===>..........................] - ETA: 0s - loss: 0.00322/7 [=======>......................] - ETA: 0s - loss: 0.00304/7 [================>.............] - ETA: 0s - loss: 0.00306/7 [========================>.....] - ETA: 0s - loss: 0.00367/7 [==============================] - 0s 29ms/step - loss: 0.0036
1/7 [===>..........................] - ETA: 0s - loss: 0.00183/7 [===========>..................] - ETA: 0s - loss: 0.00295/7 [====================>.........] - ETA: 0s - loss: 0.00287/7 [==============================] - ETA: 0s - loss: 0.00307/7 [==============================] - 0s 27ms/step - loss: 0.0030
1/7 [===>..........................] - ETA: 0s - loss: 0.00603/7 [===========>..................] - ETA: 0s - loss: 0.00375/7 [====================>.........] - ETA: 0s - loss: 0.00656/7 [========================>.....] - ETA: 0s - loss: 0.00607/7 [==============================] - 0s 38ms/step - loss: 0.0059
1/7 [===>..........................] - ETA: 0s - loss: 0.00673/7 [===========>..................] - ETA: 0s - loss: 0.00495/7 [====================>.........] - ETA: 0s - loss: 0.00387/7 [==============================] - ETA: 0s - loss: 0.00357/7 [==============================] - 0s 26ms/step - loss: 0.0035
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.003634402481839061:
Train Score: 0.00341 MSE 0.05839 RMSE
Test Score: 0.00347 MSE 0.05890 RMSE
Deviation Min [1.93777911e-06], Max [0.71755418]
Deviation 99.5th pctile [0.14802463]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,    1]))
Confusion matrix 
[[1390    6]
 [   0    1]]
precision 0.14286, recall 1.00000, f1 0.25000
Time to train: 294776 ms
Saving model models/A2Benchmark/synthetic_99.csv.h5
Total Time to proces all the selected files : 297299 ms
A2Benchmark : Avg precision 0.14286 recall 1.00000 f1 0.25000 time to train 294776.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_99.csv  --epochs 20 --n_iter 3 --patience 3 :: took 304 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_9.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 09:46:25 AM MST
2020-11-30 09:46:31.311208: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 09:46:31.330260: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 09:46:31.331889: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56167f43c740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 09:46:31.331945: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 09:46:31.332142: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A2Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A2Benchmark/synthetic_9.csv
Shapes: time variant data with labels (1421, 2), full data (1421, 3)
Look back data shapes: lookbackX (1397, 24, 1) lookbackY (1397, 2)
Shapes: Xtrain_full (1117, 24, 1), Ytrain_full (1117, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1006, 24, 1), Ytrain (1006, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00213/7 [===========>..................] - ETA: 0s - loss: 0.00115/7 [====================>.........] - ETA: 0s - loss: 0.00117/7 [==============================] - ETA: 0s - loss: 0.00147/7 [==============================] - 0s 33ms/step - loss: 0.0014
1/7 [===>..........................] - ETA: 0s - loss: 7.5125e-043/7 [===========>..................] - ETA: 0s - loss: 0.0016    4/7 [================>.............] - ETA: 0s - loss: 0.00136/7 [========================>.....] - ETA: 0s - loss: 0.00117/7 [==============================] - 0s 36ms/step - loss: 0.0010
1/7 [===>..........................] - ETA: 0s - loss: 0.00283/7 [===========>..................] - ETA: 0s - loss: 0.00315/7 [====================>.........] - ETA: 0s - loss: 0.00197/7 [==============================] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 26ms/step - loss: 0.0018
1/7 [===>..........................] - ETA: 0s - loss: 0.00112/7 [=======>......................] - ETA: 0s - loss: 9.0000e-044/7 [================>.............] - ETA: 0s - loss: 5.5972e-046/7 [========================>.....] - ETA: 0s - loss: 0.0036    7/7 [==============================] - 0s 30ms/step - loss: 0.0035
1/7 [===>..........................] - ETA: 0s - loss: 0.00113/7 [===========>..................] - ETA: 0s - loss: 6.1848e-045/7 [====================>.........] - ETA: 0s - loss: 5.3711e-047/7 [==============================] - ETA: 0s - loss: 6.2814e-047/7 [==============================] - 0s 31ms/step - loss: 6.2814e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.01046/7 [========================>.....] - ETA: 0s - loss: 0.00447/7 [==============================] - 0s 11ms/step - loss: 0.0045
1/7 [===>..........................] - ETA: 0s - loss: 3.2687e-044/7 [================>.............] - ETA: 0s - loss: 7.6643e-047/7 [==============================] - ETA: 0s - loss: 6.7418e-047/7 [==============================] - 0s 15ms/step - loss: 6.7418e-04
1/7 [===>..........................] - ETA: 0s - loss: 8.4615e-045/7 [====================>.........] - ETA: 0s - loss: 6.8008e-047/7 [==============================] - 0s 13ms/step - loss: 6.0678e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00154/7 [================>.............] - ETA: 0s - loss: 7.9797e-047/7 [==============================] - 0s 14ms/step - loss: 0.0036
1/7 [===>..........................] - ETA: 0s - loss: 0.00144/7 [================>.............] - ETA: 0s - loss: 6.6459e-047/7 [==============================] - ETA: 0s - loss: 6.3899e-047/7 [==============================] - 0s 15ms/step - loss: 6.3899e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.1649e-044/7 [================>.............] - ETA: 0s - loss: 6.9216e-047/7 [==============================] - ETA: 0s - loss: 6.0645e-047/7 [==============================] - 0s 19ms/step - loss: 6.0645e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.0703e-044/7 [================>.............] - ETA: 0s - loss: 6.6966e-047/7 [==============================] - ETA: 0s - loss: 5.4656e-047/7 [==============================] - 0s 19ms/step - loss: 5.4656e-04
1/7 [===>..........................] - ETA: 0s - loss: 9.0552e-044/7 [================>.............] - ETA: 0s - loss: 9.6183e-047/7 [==============================] - ETA: 0s - loss: 7.3267e-047/7 [==============================] - 0s 19ms/step - loss: 7.3267e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00184/7 [================>.............] - ETA: 0s - loss: 0.00117/7 [==============================] - 0s 14ms/step - loss: 0.0038
1/7 [===>..........................] - ETA: 0s - loss: 0.00165/7 [====================>.........] - ETA: 0s - loss: 6.4357e-047/7 [==============================] - 0s 15ms/step - loss: 7.2831e-04
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0012875975808128715:
Train Score: 0.00119 MSE 0.03450 RMSE
Test Score: 0.00096 MSE 0.03091 RMSE
Deviation Min [4.25687424e-05], Max [0.74406448]
Deviation 99.5th pctile [0.06266094]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1390,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,    1]))
Confusion matrix 
[[1390    6]
 [   0    1]]
precision 0.14286, recall 1.00000, f1 0.25000
Time to train: 298641 ms
Saving model models/A2Benchmark/synthetic_9.csv.h5
Total Time to proces all the selected files : 301127 ms
A2Benchmark : Avg precision 0.14286 recall 1.00000 f1 0.25000 time to train 298641.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A2Benchmark --save 1 --file_name synthetic_9.csv  --epochs 20 --n_iter 3 --patience 3 :: took 307 seconds

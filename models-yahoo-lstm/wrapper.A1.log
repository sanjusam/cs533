nohup: ignoring input
DATA_FOLDER : ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_10.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Sun 29 Nov 2020 11:13:01 PM MST
2020-11-29 23:13:07.703531: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-29 23:13:07.753237: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-29 23:13:07.754446: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559d835568c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-29 23:13:07.754490: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-29 23:13:07.760648: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_10.csv
Shapes: time variant data with labels (1439, 2), full data (1439, 3)
Look back data shapes: lookbackX (1415, 24, 1) lookbackY (1415, 2)
Shapes: Xtrain_full (1132, 24, 1), Ytrain_full (1132, 1), Xtest (283, 24, 1), Ytest (283, 1)
Shapes: Xtrain (1019, 24, 1), Ytrain (1019, 1), Xvalid (113, 24, 1), Yvalid (113, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00484/7 [================>.............] - ETA: 0s - loss: 0.00527/7 [==============================] - 0s 15ms/step - loss: 0.0050
1/7 [===>..........................] - ETA: 0s - loss: 0.00255/7 [====================>.........] - ETA: 0s - loss: 0.00427/7 [==============================] - 0s 12ms/step - loss: 0.0040
1/7 [===>..........................] - ETA: 0s - loss: 0.00395/7 [====================>.........] - ETA: 0s - loss: 0.00357/7 [==============================] - 0s 13ms/step - loss: 0.0036
1/7 [===>..........................] - ETA: 0s - loss: 0.00195/7 [====================>.........] - ETA: 0s - loss: 0.00397/7 [==============================] - 0s 13ms/step - loss: 0.0040
1/7 [===>..........................] - ETA: 0s - loss: 0.00554/7 [================>.............] - ETA: 0s - loss: 0.00327/7 [==============================] - 0s 15ms/step - loss: 0.0040
1/7 [===>..........................] - ETA: 0s - loss: 0.00513/7 [===========>..................] - ETA: 0s - loss: 0.00615/7 [====================>.........] - ETA: 0s - loss: 0.00557/7 [==============================] - ETA: 0s - loss: 0.00547/7 [==============================] - 0s 24ms/step - loss: 0.0054
1/7 [===>..........................] - ETA: 0s - loss: 0.00263/7 [===========>..................] - ETA: 0s - loss: 0.00405/7 [====================>.........] - ETA: 0s - loss: 0.00457/7 [==============================] - ETA: 0s - loss: 0.00427/7 [==============================] - 0s 25ms/step - loss: 0.0042
1/7 [===>..........................] - ETA: 0s - loss: 0.00443/7 [===========>..................] - ETA: 0s - loss: 0.00376/7 [========================>.....] - ETA: 0s - loss: 0.00397/7 [==============================] - 0s 24ms/step - loss: 0.0040
1/7 [===>..........................] - ETA: 0s - loss: 0.00223/7 [===========>..................] - ETA: 0s - loss: 0.00385/7 [====================>.........] - ETA: 0s - loss: 0.00447/7 [==============================] - ETA: 0s - loss: 0.00477/7 [==============================] - 0s 24ms/step - loss: 0.0047
1/7 [===>..........................] - ETA: 0s - loss: 0.00833/7 [===========>..................] - ETA: 0s - loss: 0.00535/7 [====================>.........] - ETA: 0s - loss: 0.00486/7 [========================>.....] - ETA: 0s - loss: 0.00527/7 [==============================] - 0s 29ms/step - loss: 0.0051
1/7 [===>..........................] - ETA: 0s - loss: 0.00485/7 [====================>.........] - ETA: 0s - loss: 0.00517/7 [==============================] - 0s 12ms/step - loss: 0.0049
1/7 [===>..........................] - ETA: 0s - loss: 0.00263/7 [===========>..................] - ETA: 0s - loss: 0.00386/7 [========================>.....] - ETA: 0s - loss: 0.00437/7 [==============================] - 0s 16ms/step - loss: 0.0041
1/7 [===>..........................] - ETA: 0s - loss: 0.00386/7 [========================>.....] - ETA: 0s - loss: 0.00367/7 [==============================] - 0s 10ms/step - loss: 0.0035
1/7 [===>..........................] - ETA: 0s - loss: 0.00195/7 [====================>.........] - ETA: 0s - loss: 0.00417/7 [==============================] - 0s 11ms/step - loss: 0.0043
1/7 [===>..........................] - ETA: 0s - loss: 0.00635/7 [====================>.........] - ETA: 0s - loss: 0.00397/7 [==============================] - 0s 13ms/step - loss: 0.0042
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.004104646341875196:
Train Score: 0.00404 MSE 0.06355 RMSE
Test Score: 0.01310 MSE 0.11444 RMSE
Deviation Min [1.98170559e-05], Max [0.53934467]
Deviation 99.5th pctile [0.44265163]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1407,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1402,   13]))
Confusion matrix 
[[1402    0]
 [   5    8]]
precision 1.00000, recall 0.61538, f1 0.76190
Time to train: 208093 ms
Saving model models/A1Benchmark/real_10.csv.h5
Total Time to proces all the selected files : 210100 ms
A1Benchmark : Avg precision 1.00000 recall 0.61538 f1 0.76190 time to train 208093.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_10.csv  --epochs 20 --n_iter 3 --patience 3 :: took 217 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_11.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Sun 29 Nov 2020 11:16:43 PM MST
2020-11-29 23:16:49.172952: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-29 23:16:49.191233: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-29 23:16:49.192771: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55fb7bd47cf0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-29 23:16:49.192825: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-29 23:16:49.193039: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_11.csv
Shapes: time variant data with labels (1439, 2), full data (1439, 3)
Look back data shapes: lookbackX (1415, 24, 1) lookbackY (1415, 2)
Shapes: Xtrain_full (1132, 24, 1), Ytrain_full (1132, 1), Xtest (283, 24, 1), Ytest (283, 1)
Shapes: Xtrain (1019, 24, 1), Ytrain (1019, 1), Xvalid (113, 24, 1), Yvalid (113, 1)
1/7 [===>..........................] - ETA: 0s - loss: 8.9445e-055/7 [====================>.........] - ETA: 0s - loss: 4.2528e-057/7 [==============================] - 0s 12ms/step - loss: 3.5061e-05
1/7 [===>..........................] - ETA: 0s - loss: 4.3769e-064/7 [================>.............] - ETA: 0s - loss: 2.1302e-067/7 [==============================] - ETA: 0s - loss: 2.0553e-067/7 [==============================] - 0s 16ms/step - loss: 2.0553e-06
1/7 [===>..........................] - ETA: 0s - loss: 7.2584e-065/7 [====================>.........] - ETA: 0s - loss: 5.2999e-067/7 [==============================] - 0s 12ms/step - loss: 5.2348e-06
1/7 [===>..........................] - ETA: 0s - loss: 2.4107e-065/7 [====================>.........] - ETA: 0s - loss: 3.8954e-066/7 [========================>.....] - ETA: 0s - loss: 4.0723e-067/7 [==============================] - 0s 21ms/step - loss: 3.9065e-06
1/7 [===>..........................] - ETA: 0s - loss: 3.9371e-065/7 [====================>.........] - ETA: 0s - loss: 6.9861e-067/7 [==============================] - 0s 15ms/step - loss: 8.5315e-06
1/7 [===>..........................] - ETA: 0s - loss: 1.0495e-044/7 [================>.............] - ETA: 0s - loss: 6.0048e-057/7 [==============================] - ETA: 0s - loss: 4.1640e-057/7 [==============================] - 0s 19ms/step - loss: 4.1640e-05
1/7 [===>..........................] - ETA: 0s - loss: 7.9408e-062/7 [=======>......................] - ETA: 0s - loss: 6.9720e-065/7 [====================>.........] - ETA: 0s - loss: 5.3948e-067/7 [==============================] - 0s 26ms/step - loss: 5.5342e-06
1/7 [===>..........................] - ETA: 0s - loss: 2.6779e-053/7 [===========>..................] - ETA: 0s - loss: 2.4941e-056/7 [========================>.....] - ETA: 0s - loss: 1.8858e-057/7 [==============================] - 0s 18ms/step - loss: 1.8340e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.1695e-055/7 [====================>.........] - ETA: 0s - loss: 1.4607e-057/7 [==============================] - 0s 14ms/step - loss: 1.3550e-05
1/7 [===>..........................] - ETA: 0s - loss: 5.4934e-065/7 [====================>.........] - ETA: 0s - loss: 6.9234e-067/7 [==============================] - 0s 14ms/step - loss: 7.1261e-06
1/7 [===>..........................] - ETA: 0s - loss: 1.8294e-043/7 [===========>..................] - ETA: 0s - loss: 1.2643e-045/7 [====================>.........] - ETA: 0s - loss: 8.3454e-057/7 [==============================] - ETA: 0s - loss: 6.9581e-057/7 [==============================] - 0s 35ms/step - loss: 6.9581e-05
1/7 [===>..........................] - ETA: 0s - loss: 6.4298e-063/7 [===========>..................] - ETA: 0s - loss: 4.8143e-065/7 [====================>.........] - ETA: 0s - loss: 3.9803e-067/7 [==============================] - ETA: 0s - loss: 4.1703e-067/7 [==============================] - 0s 33ms/step - loss: 4.1703e-06
1/7 [===>..........................] - ETA: 0s - loss: 2.9579e-053/7 [===========>..................] - ETA: 0s - loss: 2.7886e-055/7 [====================>.........] - ETA: 0s - loss: 2.2049e-057/7 [==============================] - ETA: 0s - loss: 1.9690e-057/7 [==============================] - 0s 25ms/step - loss: 1.9690e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.1937e-053/7 [===========>..................] - ETA: 0s - loss: 1.4950e-055/7 [====================>.........] - ETA: 0s - loss: 1.6881e-057/7 [==============================] - ETA: 0s - loss: 1.5663e-057/7 [==============================] - 0s 32ms/step - loss: 1.5663e-05
1/7 [===>..........................] - ETA: 0s - loss: 5.1367e-063/7 [===========>..................] - ETA: 0s - loss: 3.8885e-065/7 [====================>.........] - ETA: 0s - loss: 6.3381e-067/7 [==============================] - ETA: 0s - loss: 7.0236e-067/7 [==============================] - 0s 26ms/step - loss: 7.0236e-06
Best parameters {'n_units': 48, 'n_hidden': 1} best score 1.0957812583001214e-05:
Train Score: 0.00003 MSE 0.00568 RMSE
Test Score: 0.01163 MSE 0.10786 RMSE
Deviation Min [4.32044794e-06], Max [0.91186193]
Deviation 99.5th pctile [0.18813323]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1407,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,   19]))
Confusion matrix 
[[1396    0]
 [  11    8]]
precision 1.00000, recall 0.42105, f1 0.59259
Time to train: 196972 ms
Saving model models/A1Benchmark/real_11.csv.h5
Total Time to proces all the selected files : 198880 ms
A1Benchmark : Avg precision 1.00000 recall 0.42105 f1 0.59259 time to train 196972.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_11.csv  --epochs 20 --n_iter 3 --patience 3 :: took 205 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_12.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Sun 29 Nov 2020 11:20:13 PM MST
2020-11-29 23:20:19.394525: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-29 23:20:19.413202: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-29 23:20:19.414596: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x563e3714c8c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-29 23:20:19.414643: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-29 23:20:19.414840: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_12.csv
Shapes: time variant data with labels (1439, 2), full data (1439, 3)
Look back data shapes: lookbackX (1415, 24, 1) lookbackY (1415, 2)
Shapes: Xtrain_full (1132, 24, 1), Ytrain_full (1132, 1), Xtest (283, 24, 1), Ytest (283, 1)
Shapes: Xtrain (1019, 24, 1), Ytrain (1019, 1), Xvalid (113, 24, 1), Yvalid (113, 1)
1/7 [===>..........................] - ETA: 0s - loss: 1.5954e-044/7 [================>.............] - ETA: 0s - loss: 2.2092e-047/7 [==============================] - 0s 15ms/step - loss: 2.1674e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.9739e-044/7 [================>.............] - ETA: 0s - loss: 4.6978e-047/7 [==============================] - ETA: 0s - loss: 4.2776e-047/7 [==============================] - 0s 17ms/step - loss: 4.2776e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.6078e-045/7 [====================>.........] - ETA: 0s - loss: 3.0239e-047/7 [==============================] - 0s 16ms/step - loss: 2.7172e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.4086e-044/7 [================>.............] - ETA: 0s - loss: 2.6117e-047/7 [==============================] - ETA: 0s - loss: 2.3097e-047/7 [==============================] - 0s 17ms/step - loss: 2.3097e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.6640e-046/7 [========================>.....] - ETA: 0s - loss: 2.1656e-047/7 [==============================] - 0s 11ms/step - loss: 2.1279e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.5665e-043/7 [===========>..................] - ETA: 0s - loss: 2.4693e-045/7 [====================>.........] - ETA: 0s - loss: 2.2234e-047/7 [==============================] - ETA: 0s - loss: 2.2193e-047/7 [==============================] - 0s 25ms/step - loss: 2.2193e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.4652e-043/7 [===========>..................] - ETA: 0s - loss: 4.2579e-045/7 [====================>.........] - ETA: 0s - loss: 4.1242e-047/7 [==============================] - ETA: 0s - loss: 3.9850e-047/7 [==============================] - 0s 37ms/step - loss: 3.9850e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.3199e-043/7 [===========>..................] - ETA: 0s - loss: 3.1113e-045/7 [====================>.........] - ETA: 0s - loss: 3.0183e-047/7 [==============================] - ETA: 0s - loss: 2.8327e-047/7 [==============================] - 0s 24ms/step - loss: 2.8327e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.4378e-043/7 [===========>..................] - ETA: 0s - loss: 2.9580e-045/7 [====================>.........] - ETA: 0s - loss: 2.9371e-047/7 [==============================] - ETA: 0s - loss: 2.7532e-047/7 [==============================] - 0s 32ms/step - loss: 2.7532e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.7863e-043/7 [===========>..................] - ETA: 0s - loss: 2.5657e-045/7 [====================>.........] - ETA: 0s - loss: 2.6267e-047/7 [==============================] - ETA: 0s - loss: 2.6690e-047/7 [==============================] - 0s 32ms/step - loss: 2.6690e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.4388e-044/7 [================>.............] - ETA: 0s - loss: 2.2215e-046/7 [========================>.....] - ETA: 0s - loss: 2.2249e-047/7 [==============================] - 0s 19ms/step - loss: 2.2051e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.9623e-045/7 [====================>.........] - ETA: 0s - loss: 3.7313e-047/7 [==============================] - 0s 15ms/step - loss: 3.6151e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.1838e-045/7 [====================>.........] - ETA: 0s - loss: 2.8470e-047/7 [==============================] - 0s 14ms/step - loss: 2.6418e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.9477e-044/7 [================>.............] - ETA: 0s - loss: 2.7782e-047/7 [==============================] - ETA: 0s - loss: 2.3746e-047/7 [==============================] - 0s 20ms/step - loss: 2.3746e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.6889e-044/7 [================>.............] - ETA: 0s - loss: 2.0726e-047/7 [==============================] - ETA: 0s - loss: 2.1081e-047/7 [==============================] - 0s 18ms/step - loss: 2.1081e-04
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.00025889259995892644:
Train Score: 0.00030 MSE 0.01726 RMSE
Test Score: 0.00367 MSE 0.06056 RMSE
Deviation Min [6.28074895e-06], Max [0.96782994]
Deviation 99.5th pctile [0.05754967]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1407,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1412,    3]))
Confusion matrix 
[[1407    5]
 [   0    3]]
precision 0.37500, recall 1.00000, f1 0.54545
Time to train: 176001 ms
Saving model models/A1Benchmark/real_12.csv.h5
Total Time to proces all the selected files : 178093 ms
A1Benchmark : Avg precision 0.37500 recall 1.00000 f1 0.54545 time to train 176001.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_12.csv  --epochs 20 --n_iter 3 --patience 3 :: took 184 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_13.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Sun 29 Nov 2020 11:23:22 PM MST
2020-11-29 23:23:28.972181: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-29 23:23:28.992241: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-29 23:23:28.993742: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559ff46338c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-29 23:23:28.993791: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-29 23:23:28.994007: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_13.csv
Shapes: time variant data with labels (1439, 2), full data (1439, 3)
Look back data shapes: lookbackX (1415, 24, 1) lookbackY (1415, 2)
Shapes: Xtrain_full (1132, 24, 1), Ytrain_full (1132, 1), Xtest (283, 24, 1), Ytest (283, 1)
Shapes: Xtrain (1019, 24, 1), Ytrain (1019, 1), Xvalid (113, 24, 1), Yvalid (113, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.01384/7 [================>.............] - ETA: 0s - loss: 0.00407/7 [==============================] - 0s 15ms/step - loss: 0.0027
1/7 [===>..........................] - ETA: 0s - loss: 0.00764/7 [================>.............] - ETA: 0s - loss: 0.00877/7 [==============================] - ETA: 0s - loss: 0.00867/7 [==============================] - 0s 16ms/step - loss: 0.0086
1/7 [===>..........................] - ETA: 0s - loss: 0.00245/7 [====================>.........] - ETA: 0s - loss: 0.00257/7 [==============================] - 0s 12ms/step - loss: 0.0022
1/7 [===>..........................] - ETA: 0s - loss: 4.8595e-045/7 [====================>.........] - ETA: 0s - loss: 8.5167e-047/7 [==============================] - 0s 12ms/step - loss: 9.1913e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.01275/7 [====================>.........] - ETA: 0s - loss: 0.00457/7 [==============================] - 0s 11ms/step - loss: 0.0038
1/7 [===>..........................] - ETA: 0s - loss: 0.01313/7 [===========>..................] - ETA: 0s - loss: 0.00465/7 [====================>.........] - ETA: 0s - loss: 0.00317/7 [==============================] - ETA: 0s - loss: 0.00267/7 [==============================] - 0s 35ms/step - loss: 0.0026
1/7 [===>..........................] - ETA: 0s - loss: 0.00893/7 [===========>..................] - ETA: 0s - loss: 0.01085/7 [====================>.........] - ETA: 0s - loss: 0.00987/7 [==============================] - 0s 26ms/step - loss: 0.0104
1/7 [===>..........................] - ETA: 0s - loss: 0.00173/7 [===========>..................] - ETA: 0s - loss: 0.00225/7 [====================>.........] - ETA: 0s - loss: 0.00187/7 [==============================] - ETA: 0s - loss: 0.00157/7 [==============================] - 0s 24ms/step - loss: 0.0015
1/7 [===>..........................] - ETA: 0s - loss: 5.8881e-043/7 [===========>..................] - ETA: 0s - loss: 0.0015    5/7 [====================>.........] - ETA: 0s - loss: 0.00147/7 [==============================] - ETA: 0s - loss: 0.00157/7 [==============================] - 0s 24ms/step - loss: 0.0015
1/7 [===>..........................] - ETA: 0s - loss: 0.02013/7 [===========>..................] - ETA: 0s - loss: 0.01025/7 [====================>.........] - ETA: 0s - loss: 0.00817/7 [==============================] - ETA: 0s - loss: 0.00687/7 [==============================] - 0s 24ms/step - loss: 0.0068
1/7 [===>..........................] - ETA: 0s - loss: 0.01194/7 [================>.............] - ETA: 0s - loss: 0.00357/7 [==============================] - ETA: 0s - loss: 0.00247/7 [==============================] - 0s 18ms/step - loss: 0.0024
1/7 [===>..........................] - ETA: 0s - loss: 7.0009e-045/7 [====================>.........] - ETA: 0s - loss: 0.0010    7/7 [==============================] - 0s 12ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 0.00125/7 [====================>.........] - ETA: 0s - loss: 0.00117/7 [==============================] - 0s 12ms/step - loss: 0.0010
1/7 [===>..........................] - ETA: 0s - loss: 0.00514/7 [================>.............] - ETA: 0s - loss: 0.00747/7 [==============================] - ETA: 0s - loss: 0.00757/7 [==============================] - 0s 18ms/step - loss: 0.0075
1/7 [===>..........................] - ETA: 0s - loss: 0.01494/7 [================>.............] - ETA: 0s - loss: 0.00647/7 [==============================] - ETA: 0s - loss: 0.00497/7 [==============================] - 0s 17ms/step - loss: 0.0049
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.003374453587457538:
Train Score: 0.00147 MSE 0.03835 RMSE
Test Score: 0.00170 MSE 0.04117 RMSE
Deviation Min [2.46436841e-05], Max [0.38568509]
Deviation 99.5th pctile [0.19705813]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1407,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1403,   12]))
Confusion matrix 
[[1402    1]
 [   5    7]]
precision 0.87500, recall 0.58333, f1 0.70000
Time to train: 522081 ms
Saving model models/A1Benchmark/real_13.csv.h5
Total Time to proces all the selected files : 524567 ms
A1Benchmark : Avg precision 0.87500 recall 0.58333 f1 0.70000 time to train 522081.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_13.csv  --epochs 20 --n_iter 3 --patience 3 :: took 531 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_14.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Sun 29 Nov 2020 11:32:18 PM MST
2020-11-29 23:32:25.057486: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-29 23:32:25.076234: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-29 23:32:25.077594: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559564409270 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-29 23:32:25.077654: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-29 23:32:25.077848: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_14.csv
Shapes: time variant data with labels (1439, 2), full data (1439, 3)
Look back data shapes: lookbackX (1415, 24, 1) lookbackY (1415, 2)
Shapes: Xtrain_full (1132, 24, 1), Ytrain_full (1132, 1), Xtest (283, 24, 1), Ytest (283, 1)
Shapes: Xtrain (1019, 24, 1), Ytrain (1019, 1), Xvalid (113, 24, 1), Yvalid (113, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00145/7 [====================>.........] - ETA: 0s - loss: 0.00147/7 [==============================] - 0s 14ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 0.02994/7 [================>.............] - ETA: 0s - loss: 0.00827/7 [==============================] - ETA: 0s - loss: 0.00547/7 [==============================] - 0s 18ms/step - loss: 0.0054
1/7 [===>..........................] - ETA: 0s - loss: 6.9217e-044/7 [================>.............] - ETA: 0s - loss: 6.2351e-047/7 [==============================] - ETA: 0s - loss: 9.7747e-047/7 [==============================] - 0s 18ms/step - loss: 9.7747e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00174/7 [================>.............] - ETA: 0s - loss: 0.00167/7 [==============================] - 0s 15ms/step - loss: 0.0015
1/7 [===>..........................] - ETA: 0s - loss: 0.00554/7 [================>.............] - ETA: 0s - loss: 0.00257/7 [==============================] - ETA: 0s - loss: 0.00347/7 [==============================] - 0s 18ms/step - loss: 0.0034
1/7 [===>..........................] - ETA: 0s - loss: 0.00193/7 [===========>..................] - ETA: 0s - loss: 0.00145/7 [====================>.........] - ETA: 0s - loss: 0.00166/7 [========================>.....] - ETA: 0s - loss: 0.00157/7 [==============================] - 0s 37ms/step - loss: 0.0015
1/7 [===>..........................] - ETA: 0s - loss: 0.03183/7 [===========>..................] - ETA: 0s - loss: 0.01155/7 [====================>.........] - ETA: 0s - loss: 0.00727/7 [==============================] - ETA: 0s - loss: 0.00587/7 [==============================] - 0s 23ms/step - loss: 0.0058
1/7 [===>..........................] - ETA: 0s - loss: 5.6150e-043/7 [===========>..................] - ETA: 0s - loss: 4.9474e-045/7 [====================>.........] - ETA: 0s - loss: 5.0706e-047/7 [==============================] - 0s 25ms/step - loss: 9.7234e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00223/7 [===========>..................] - ETA: 0s - loss: 0.00165/7 [====================>.........] - ETA: 0s - loss: 0.00197/7 [==============================] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 31ms/step - loss: 0.0018
1/7 [===>..........................] - ETA: 0s - loss: 0.00583/7 [===========>..................] - ETA: 0s - loss: 0.00265/7 [====================>.........] - ETA: 0s - loss: 0.00247/7 [==============================] - ETA: 0s - loss: 0.00437/7 [==============================] - 0s 33ms/step - loss: 0.0043
1/7 [===>..........................] - ETA: 0s - loss: 0.00223/7 [===========>..................] - ETA: 0s - loss: 0.00155/7 [====================>.........] - ETA: 0s - loss: 0.00187/7 [==============================] - ETA: 0s - loss: 0.00177/7 [==============================] - 0s 28ms/step - loss: 0.0017
1/7 [===>..........................] - ETA: 0s - loss: 0.03163/7 [===========>..................] - ETA: 0s - loss: 0.01145/7 [====================>.........] - ETA: 0s - loss: 0.00727/7 [==============================] - ETA: 0s - loss: 0.00587/7 [==============================] - 0s 33ms/step - loss: 0.0058
1/7 [===>..........................] - ETA: 0s - loss: 6.5928e-043/7 [===========>..................] - ETA: 0s - loss: 5.6577e-045/7 [====================>.........] - ETA: 0s - loss: 5.7233e-047/7 [==============================] - ETA: 0s - loss: 0.0010    7/7 [==============================] - 0s 33ms/step - loss: 0.0010
1/7 [===>..........................] - ETA: 0s - loss: 0.00193/7 [===========>..................] - ETA: 0s - loss: 0.00155/7 [====================>.........] - ETA: 0s - loss: 0.00177/7 [==============================] - ETA: 0s - loss: 0.00167/7 [==============================] - 0s 29ms/step - loss: 0.0016
1/7 [===>..........................] - ETA: 0s - loss: 0.00573/7 [===========>..................] - ETA: 0s - loss: 0.00265/7 [====================>.........] - ETA: 0s - loss: 0.00237/7 [==============================] - ETA: 0s - loss: 0.00447/7 [==============================] - 0s 33ms/step - loss: 0.0044
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0025306164752691984:
Train Score: 0.00245 MSE 0.04953 RMSE
Test Score: 0.00507 MSE 0.07121 RMSE
Deviation Min [1.80043972e-05], Max [0.93118239]
Deviation 99.5th pctile [0.2159324]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1407,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1413,    2]))
Confusion matrix 
[[1406    7]
 [   1    1]]
precision 0.12500, recall 0.50000, f1 0.20000
Time to train: 333051 ms
Saving model models/A1Benchmark/real_14.csv.h5
Total Time to proces all the selected files : 335340 ms
A1Benchmark : Avg precision 0.12500 recall 0.50000 f1 0.20000 time to train 333051.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_14.csv  --epochs 20 --n_iter 3 --patience 3 :: took 342 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_15.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Sun 29 Nov 2020 11:38:05 PM MST
2020-11-29 23:38:11.969873: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-29 23:38:11.988285: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-29 23:38:11.989779: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55fb52f8bc60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-29 23:38:11.989832: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-29 23:38:11.990065: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_15.csv
Shapes: time variant data with labels (1439, 2), full data (1439, 3)
Look back data shapes: lookbackX (1415, 24, 1) lookbackY (1415, 2)
Shapes: Xtrain_full (1132, 24, 1), Ytrain_full (1132, 1), Xtest (283, 24, 1), Ytest (283, 1)
Shapes: Xtrain (1019, 24, 1), Ytrain (1019, 1), Xvalid (113, 24, 1), Yvalid (113, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.01993/7 [===========>..................] - ETA: 0s - loss: 0.00725/7 [====================>.........] - ETA: 0s - loss: 0.00527/7 [==============================] - ETA: 0s - loss: 0.00437/7 [==============================] - 0s 34ms/step - loss: 0.0043
1/7 [===>..........................] - ETA: 0s - loss: 4.8430e-043/7 [===========>..................] - ETA: 0s - loss: 0.0011    5/7 [====================>.........] - ETA: 0s - loss: 9.0867e-047/7 [==============================] - ETA: 0s - loss: 9.1123e-047/7 [==============================] - 0s 38ms/step - loss: 9.1123e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00253/7 [===========>..................] - ETA: 0s - loss: 0.00235/7 [====================>.........] - ETA: 0s - loss: 0.00237/7 [==============================] - ETA: 0s - loss: 0.00197/7 [==============================] - 0s 27ms/step - loss: 0.0019
1/7 [===>..........................] - ETA: 0s - loss: 0.00403/7 [===========>..................] - ETA: 0s - loss: 0.00735/7 [====================>.........] - ETA: 0s - loss: 0.00657/7 [==============================] - ETA: 0s - loss: 0.00677/7 [==============================] - 0s 34ms/step - loss: 0.0067
1/7 [===>..........................] - ETA: 0s - loss: 0.02033/7 [===========>..................] - ETA: 0s - loss: 0.01015/7 [====================>.........] - ETA: 0s - loss: 0.00767/7 [==============================] - ETA: 0s - loss: 0.00617/7 [==============================] - 0s 26ms/step - loss: 0.0061
1/7 [===>..........................] - ETA: 0s - loss: 0.01454/7 [================>.............] - ETA: 0s - loss: 0.00407/7 [==============================] - ETA: 0s - loss: 0.00277/7 [==============================] - 0s 16ms/step - loss: 0.0027
1/7 [===>..........................] - ETA: 0s - loss: 0.00134/7 [================>.............] - ETA: 0s - loss: 0.00197/7 [==============================] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 17ms/step - loss: 0.0018
1/7 [===>..........................] - ETA: 0s - loss: 0.00305/7 [====================>.........] - ETA: 0s - loss: 0.00297/7 [==============================] - 0s 14ms/step - loss: 0.0027
1/7 [===>..........................] - ETA: 0s - loss: 0.00204/7 [================>.............] - ETA: 0s - loss: 0.00307/7 [==============================] - ETA: 0s - loss: 0.00307/7 [==============================] - 0s 18ms/step - loss: 0.0030
1/7 [===>..........................] - ETA: 0s - loss: 0.01215/7 [====================>.........] - ETA: 0s - loss: 0.00357/7 [==============================] - 0s 14ms/step - loss: 0.0029
1/7 [===>..........................] - ETA: 0s - loss: 0.01344/7 [================>.............] - ETA: 0s - loss: 0.00417/7 [==============================] - 0s 14ms/step - loss: 0.0029
1/7 [===>..........................] - ETA: 0s - loss: 0.00276/7 [========================>.....] - ETA: 0s - loss: 0.00387/7 [==============================] - 0s 10ms/step - loss: 0.0038
1/7 [===>..........................] - ETA: 0s - loss: 0.00255/7 [====================>.........] - ETA: 0s - loss: 0.00227/7 [==============================] - 0s 13ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 6.5059e-044/7 [================>.............] - ETA: 0s - loss: 0.0014    7/7 [==============================] - ETA: 0s - loss: 0.00157/7 [==============================] - 0s 17ms/step - loss: 0.0015
1/7 [===>..........................] - ETA: 0s - loss: 0.01355/7 [====================>.........] - ETA: 0s - loss: 0.00457/7 [==============================] - 0s 13ms/step - loss: 0.0037
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0026189004769548775:
Train Score: 0.00137 MSE 0.03699 RMSE
Test Score: 0.00160 MSE 0.04005 RMSE
Deviation Min [2.58436216e-05], Max [0.40675829]
Deviation 99.5th pctile [0.14511353]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1407,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1405,   10]))
Confusion matrix 
[[1404    1]
 [   3    7]]
precision 0.87500, recall 0.70000, f1 0.77778
Time to train: 568936 ms
Saving model models/A1Benchmark/real_15.csv.h5
Total Time to proces all the selected files : 571413 ms
A1Benchmark : Avg precision 0.87500 recall 0.70000 f1 0.77778 time to train 568936.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_15.csv  --epochs 20 --n_iter 3 --patience 3 :: took 578 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_16.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Sun 29 Nov 2020 11:47:48 PM MST
2020-11-29 23:47:54.944214: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-29 23:47:54.963244: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-29 23:47:54.964732: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5579949598c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-29 23:47:54.964782: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-29 23:47:54.964997: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_16.csv
Shapes: time variant data with labels (1461, 2), full data (1461, 3)
Look back data shapes: lookbackX (1437, 24, 1) lookbackY (1437, 2)
Shapes: Xtrain_full (1149, 24, 1), Ytrain_full (1149, 1), Xtest (288, 24, 1), Ytest (288, 1)
Shapes: Xtrain (1035, 24, 1), Ytrain (1035, 1), Xvalid (114, 24, 1), Yvalid (114, 1)
1/7 [===>..........................] - ETA: 0s - loss: 3.8681e-055/7 [====================>.........] - ETA: 0s - loss: 4.0078e-057/7 [==============================] - 0s 13ms/step - loss: 3.9391e-05
1/7 [===>..........................] - ETA: 0s - loss: 3.3013e-055/7 [====================>.........] - ETA: 0s - loss: 3.5879e-057/7 [==============================] - 0s 13ms/step - loss: 3.3008e-05
1/7 [===>..........................] - ETA: 0s - loss: 4.3844e-055/7 [====================>.........] - ETA: 0s - loss: 3.7589e-057/7 [==============================] - 0s 12ms/step - loss: 3.6682e-05
1/7 [===>..........................] - ETA: 0s - loss: 2.3278e-057/7 [==============================] - ETA: 0s - loss: 3.3837e-057/7 [==============================] - 0s 9ms/step - loss: 3.3837e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.8095e-055/7 [====================>.........] - ETA: 0s - loss: 3.3422e-057/7 [==============================] - 0s 11ms/step - loss: 3.1269e-05
1/7 [===>..........................] - ETA: 0s - loss: 4.6053e-053/7 [===========>..................] - ETA: 0s - loss: 3.7723e-055/7 [====================>.........] - ETA: 0s - loss: 3.9858e-057/7 [==============================] - ETA: 0s - loss: 4.0421e-057/7 [==============================] - 0s 33ms/step - loss: 4.0421e-05
1/7 [===>..........................] - ETA: 0s - loss: 4.2066e-053/7 [===========>..................] - ETA: 0s - loss: 3.9835e-055/7 [====================>.........] - ETA: 0s - loss: 3.4947e-057/7 [==============================] - ETA: 0s - loss: 3.5396e-057/7 [==============================] - 0s 32ms/step - loss: 3.5396e-05
1/7 [===>..........................] - ETA: 0s - loss: 4.7546e-053/7 [===========>..................] - ETA: 0s - loss: 3.8306e-055/7 [====================>.........] - ETA: 0s - loss: 3.9196e-057/7 [==============================] - ETA: 0s - loss: 3.8728e-057/7 [==============================] - 0s 25ms/step - loss: 3.8728e-05
1/7 [===>..........................] - ETA: 0s - loss: 2.6890e-053/7 [===========>..................] - ETA: 0s - loss: 2.4778e-055/7 [====================>.........] - ETA: 0s - loss: 3.4827e-057/7 [==============================] - ETA: 0s - loss: 3.4711e-057/7 [==============================] - 0s 25ms/step - loss: 3.4711e-05
1/7 [===>..........................] - ETA: 0s - loss: 2.3173e-053/7 [===========>..................] - ETA: 0s - loss: 5.2685e-055/7 [====================>.........] - ETA: 0s - loss: 4.3660e-057/7 [==============================] - ETA: 0s - loss: 4.0532e-057/7 [==============================] - 0s 31ms/step - loss: 4.0532e-05
1/7 [===>..........................] - ETA: 0s - loss: 3.7493e-055/7 [====================>.........] - ETA: 0s - loss: 3.3938e-057/7 [==============================] - 0s 13ms/step - loss: 3.4178e-05
1/7 [===>..........................] - ETA: 0s - loss: 3.6741e-055/7 [====================>.........] - ETA: 0s - loss: 3.0672e-057/7 [==============================] - 0s 12ms/step - loss: 3.0940e-05
1/7 [===>..........................] - ETA: 0s - loss: 3.6313e-056/7 [========================>.....] - ETA: 0s - loss: 3.0221e-057/7 [==============================] - 0s 10ms/step - loss: 2.9720e-05
1/7 [===>..........................] - ETA: 0s - loss: 2.5134e-055/7 [====================>.........] - ETA: 0s - loss: 2.8508e-057/7 [==============================] - 0s 13ms/step - loss: 2.9077e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.7831e-054/7 [================>.............] - ETA: 0s - loss: 3.2855e-057/7 [==============================] - ETA: 0s - loss: 3.0392e-057/7 [==============================] - 0s 16ms/step - loss: 3.0392e-05
Best parameters {'n_units': 72, 'n_hidden': 1} best score 3.0861364939482884e-05:
Train Score: 0.00003 MSE 0.00563 RMSE
Test Score: 0.00355 MSE 0.05958 RMSE
Deviation Min [9.82775388e-06], Max [0.97454285]
Deviation 99.5th pctile [0.01843547]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1429,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1434,    3]))
Confusion matrix 
[[1429    5]
 [   0    3]]
precision 0.37500, recall 1.00000, f1 0.54545
Time to train: 174636 ms
Saving model models/A1Benchmark/real_16.csv.h5
Total Time to proces all the selected files : 177255 ms
A1Benchmark : Avg precision 0.37500 recall 1.00000 f1 0.54545 time to train 174636.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_16.csv  --epochs 20 --n_iter 3 --patience 3 :: took 184 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_17.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Sun 29 Nov 2020 11:50:57 PM MST
2020-11-29 23:51:03.760326: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-29 23:51:03.779212: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-29 23:51:03.780255: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f9cf30ec60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-29 23:51:03.780288: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-29 23:51:03.780428: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_17.csv
Shapes: time variant data with labels (1424, 2), full data (1424, 3)
Look back data shapes: lookbackX (1400, 24, 1) lookbackY (1400, 2)
Shapes: Xtrain_full (1120, 24, 1), Ytrain_full (1120, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1008, 24, 1), Ytrain (1008, 1), Xvalid (112, 24, 1), Yvalid (112, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00203/7 [===========>..................] - ETA: 0s - loss: 0.00175/7 [====================>.........] - ETA: 0s - loss: 0.00177/7 [==============================] - ETA: 0s - loss: 0.00157/7 [==============================] - 0s 23ms/step - loss: 0.0015
1/7 [===>..........................] - ETA: 0s - loss: 8.2544e-043/7 [===========>..................] - ETA: 0s - loss: 0.0010    5/7 [====================>.........] - ETA: 0s - loss: 8.6111e-047/7 [==============================] - ETA: 0s - loss: 8.6527e-047/7 [==============================] - 0s 28ms/step - loss: 8.6527e-04
1/7 [===>..........................] - ETA: 0s - loss: 7.1295e-043/7 [===========>..................] - ETA: 0s - loss: 0.0014    5/7 [====================>.........] - ETA: 0s - loss: 0.00137/7 [==============================] - 0s 27ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 0.05843/7 [===========>..................] - ETA: 0s - loss: 0.08425/7 [====================>.........] - ETA: 0s - loss: 0.08287/7 [==============================] - ETA: 0s - loss: 0.06627/7 [==============================] - 0s 29ms/step - loss: 0.0662
1/7 [===>..........................] - ETA: 0s - loss: 0.00273/7 [===========>..................] - ETA: 0s - loss: 0.03115/7 [====================>.........] - ETA: 0s - loss: 0.02757/7 [==============================] - 0s 27ms/step - loss: 0.0220
1/7 [===>..........................] - ETA: 0s - loss: 0.00184/7 [================>.............] - ETA: 0s - loss: 0.00157/7 [==============================] - ETA: 0s - loss: 0.00137/7 [==============================] - 0s 16ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 6.8571e-044/7 [================>.............] - ETA: 0s - loss: 7.5552e-047/7 [==============================] - ETA: 0s - loss: 6.8897e-047/7 [==============================] - 0s 15ms/step - loss: 6.8897e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.1082e-044/7 [================>.............] - ETA: 0s - loss: 9.6137e-047/7 [==============================] - ETA: 0s - loss: 9.8166e-047/7 [==============================] - 0s 16ms/step - loss: 9.8166e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.04844/7 [================>.............] - ETA: 0s - loss: 0.08187/7 [==============================] - ETA: 0s - loss: 0.05887/7 [==============================] - 0s 19ms/step - loss: 0.0588
1/7 [===>..........................] - ETA: 0s - loss: 0.00115/7 [====================>.........] - ETA: 0s - loss: 0.01957/7 [==============================] - 0s 13ms/step - loss: 0.0156
1/7 [===>..........................] - ETA: 0s - loss: 0.00134/7 [================>.............] - ETA: 0s - loss: 0.00147/7 [==============================] - 0s 17ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 6.0276e-044/7 [================>.............] - ETA: 0s - loss: 6.6495e-047/7 [==============================] - ETA: 0s - loss: 6.0058e-047/7 [==============================] - 0s 17ms/step - loss: 6.0058e-04
1/7 [===>..........................] - ETA: 0s - loss: 7.9683e-044/7 [================>.............] - ETA: 0s - loss: 0.0012    7/7 [==============================] - ETA: 0s - loss: 0.00127/7 [==============================] - 0s 18ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 0.05284/7 [================>.............] - ETA: 0s - loss: 0.08057/7 [==============================] - ETA: 0s - loss: 0.05767/7 [==============================] - 0s 20ms/step - loss: 0.0576
1/7 [===>..........................] - ETA: 0s - loss: 0.00144/7 [================>.............] - ETA: 0s - loss: 0.02647/7 [==============================] - ETA: 0s - loss: 0.01717/7 [==============================] - 0s 18ms/step - loss: 0.0171
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.015479743469040842:
Train Score: 0.00830 MSE 0.09108 RMSE
Test Score: 0.01774 MSE 0.13321 RMSE
Deviation Min [2.11678444e-05], Max [0.65343049]
Deviation 99.5th pctile [0.45783905]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1393,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1173,  227]))
Confusion matrix 
[[1173    0]
 [ 220    7]]
precision 1.00000, recall 0.03084, f1 0.05983
Time to train: 200196 ms
Saving model models/A1Benchmark/real_17.csv.h5
Total Time to proces all the selected files : 202505 ms
A1Benchmark : Avg precision 1.00000 recall 0.03084 f1 0.05983 time to train 200196.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_17.csv  --epochs 20 --n_iter 3 --patience 3 :: took 209 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_18.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Sun 29 Nov 2020 11:54:31 PM MST
2020-11-29 23:54:37.750801: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-29 23:54:37.769223: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-29 23:54:37.770070: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x556c9b03af80 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-29 23:54:37.770098: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-29 23:54:37.770215: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_18.csv
Shapes: time variant data with labels (1461, 2), full data (1461, 3)
Look back data shapes: lookbackX (1437, 24, 1) lookbackY (1437, 2)
Shapes: Xtrain_full (1149, 24, 1), Ytrain_full (1149, 1), Xtest (288, 24, 1), Ytest (288, 1)
Shapes: Xtrain (1035, 24, 1), Ytrain (1035, 1), Xvalid (114, 24, 1), Yvalid (114, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00373/7 [===========>..................] - ETA: 0s - loss: 0.00345/7 [====================>.........] - ETA: 0s - loss: 0.00397/7 [==============================] - 0s 21ms/step - loss: 0.0036
1/7 [===>..........................] - ETA: 0s - loss: 0.00335/7 [====================>.........] - ETA: 0s - loss: 0.00587/7 [==============================] - 0s 12ms/step - loss: 0.0066
1/7 [===>..........................] - ETA: 0s - loss: 0.00335/7 [====================>.........] - ETA: 0s - loss: 0.00327/7 [==============================] - 0s 12ms/step - loss: 0.0032
1/7 [===>..........................] - ETA: 0s - loss: 0.00254/7 [================>.............] - ETA: 0s - loss: 0.00237/7 [==============================] - ETA: 0s - loss: 0.00297/7 [==============================] - 0s 16ms/step - loss: 0.0029
1/7 [===>..........................] - ETA: 0s - loss: 0.00334/7 [================>.............] - ETA: 0s - loss: 0.00347/7 [==============================] - 0s 15ms/step - loss: 0.0032
1/7 [===>..........................] - ETA: 0s - loss: 0.00393/7 [===========>..................] - ETA: 0s - loss: 0.00355/7 [====================>.........] - ETA: 0s - loss: 0.00407/7 [==============================] - ETA: 0s - loss: 0.00387/7 [==============================] - 0s 32ms/step - loss: 0.0038
1/7 [===>..........................] - ETA: 0s - loss: 0.00453/7 [===========>..................] - ETA: 0s - loss: 0.01245/7 [====================>.........] - ETA: 0s - loss: 0.00877/7 [==============================] - ETA: 0s - loss: 0.00947/7 [==============================] - 0s 26ms/step - loss: 0.0094
1/7 [===>..........................] - ETA: 0s - loss: 0.00613/7 [===========>..................] - ETA: 0s - loss: 0.00445/7 [====================>.........] - ETA: 0s - loss: 0.00377/7 [==============================] - ETA: 0s - loss: 0.00367/7 [==============================] - 0s 30ms/step - loss: 0.0036
1/7 [===>..........................] - ETA: 0s - loss: 0.00363/7 [===========>..................] - ETA: 0s - loss: 0.00335/7 [====================>.........] - ETA: 0s - loss: 0.00367/7 [==============================] - ETA: 0s - loss: 0.00377/7 [==============================] - 0s 28ms/step - loss: 0.0037
1/7 [===>..........................] - ETA: 0s - loss: 0.00403/7 [===========>..................] - ETA: 0s - loss: 0.00405/7 [====================>.........] - ETA: 0s - loss: 0.00367/7 [==============================] - ETA: 0s - loss: 0.00377/7 [==============================] - 0s 25ms/step - loss: 0.0037
1/7 [===>..........................] - ETA: 0s - loss: 0.00395/7 [====================>.........] - ETA: 0s - loss: 0.00417/7 [==============================] - 0s 14ms/step - loss: 0.0038
1/7 [===>..........................] - ETA: 0s - loss: 0.00335/7 [====================>.........] - ETA: 0s - loss: 0.00807/7 [==============================] - 0s 16ms/step - loss: 0.0085
1/7 [===>..........................] - ETA: 0s - loss: 0.00494/7 [================>.............] - ETA: 0s - loss: 0.00407/7 [==============================] - ETA: 0s - loss: 0.00377/7 [==============================] - 0s 19ms/step - loss: 0.0037
1/7 [===>..........................] - ETA: 0s - loss: 0.00315/7 [====================>.........] - ETA: 0s - loss: 0.00317/7 [==============================] - 0s 14ms/step - loss: 0.0033
1/7 [===>..........................] - ETA: 0s - loss: 0.00264/7 [================>.............] - ETA: 0s - loss: 0.00307/7 [==============================] - ETA: 0s - loss: 0.00287/7 [==============================] - 0s 18ms/step - loss: 0.0028
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.003886042675003409:
Train Score: 0.00473 MSE 0.06875 RMSE
Test Score: 0.00456 MSE 0.06751 RMSE
Deviation Min [3.51182605e-05], Max [0.45158449]
Deviation 99.5th pctile [0.26001858]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1429,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1434,    3]))
Confusion matrix 
[[1429    5]
 [   0    3]]
precision 0.37500, recall 1.00000, f1 0.54545
Time to train: 435314 ms
Saving model models/A1Benchmark/real_18.csv.h5
Total Time to proces all the selected files : 437698 ms
A1Benchmark : Avg precision 0.37500 recall 1.00000 f1 0.54545 time to train 435314.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_18.csv  --epochs 20 --n_iter 3 --patience 3 :: took 444 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_19.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 12:02:00 AM MST
2020-11-30 00:02:07.233469: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 00:02:07.252224: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 00:02:07.253548: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55e21dfc78c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 00:02:07.253595: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 00:02:07.253776: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_19.csv
Shapes: time variant data with labels (1424, 2), full data (1424, 3)
Look back data shapes: lookbackX (1400, 24, 1) lookbackY (1400, 2)
Shapes: Xtrain_full (1120, 24, 1), Ytrain_full (1120, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1008, 24, 1), Ytrain (1008, 1), Xvalid (112, 24, 1), Yvalid (112, 1)
1/7 [===>..........................] - ETA: 0s - loss: 2.7088e-044/7 [================>.............] - ETA: 0s - loss: 2.5717e-047/7 [==============================] - ETA: 0s - loss: 5.4360e-047/7 [==============================] - 0s 18ms/step - loss: 5.4360e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.4173e-045/7 [====================>.........] - ETA: 0s - loss: 3.1956e-047/7 [==============================] - 0s 13ms/step - loss: 6.6178e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00155/7 [====================>.........] - ETA: 0s - loss: 0.00147/7 [==============================] - 0s 11ms/step - loss: 0.0015
1/7 [===>..........................] - ETA: 0s - loss: 0.01144/7 [================>.............] - ETA: 0s - loss: 0.02587/7 [==============================] - 0s 14ms/step - loss: 0.0227
1/7 [===>..........................] - ETA: 0s - loss: 0.00134/7 [================>.............] - ETA: 0s - loss: 0.04277/7 [==============================] - ETA: 0s - loss: 0.02757/7 [==============================] - 0s 15ms/step - loss: 0.0275
1/7 [===>..........................] - ETA: 0s - loss: 8.0542e-043/7 [===========>..................] - ETA: 0s - loss: 6.6256e-045/7 [====================>.........] - ETA: 0s - loss: 6.9548e-047/7 [==============================] - ETA: 0s - loss: 0.0010    7/7 [==============================] - 0s 25ms/step - loss: 0.0010
1/7 [===>..........................] - ETA: 0s - loss: 6.3582e-043/7 [===========>..................] - ETA: 0s - loss: 6.4095e-045/7 [====================>.........] - ETA: 0s - loss: 5.3322e-047/7 [==============================] - ETA: 0s - loss: 9.9727e-047/7 [==============================] - 0s 29ms/step - loss: 9.9727e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00233/7 [===========>..................] - ETA: 0s - loss: 0.00235/7 [====================>.........] - ETA: 0s - loss: 0.00207/7 [==============================] - ETA: 0s - loss: 0.00217/7 [==============================] - 0s 36ms/step - loss: 0.0021
1/7 [===>..........................] - ETA: 0s - loss: 0.01463/7 [===========>..................] - ETA: 0s - loss: 0.04485/7 [====================>.........] - ETA: 0s - loss: 0.04987/7 [==============================] - ETA: 0s - loss: 0.04027/7 [==============================] - 0s 32ms/step - loss: 0.0402
1/7 [===>..........................] - ETA: 0s - loss: 0.00163/7 [===========>..................] - ETA: 0s - loss: 0.05195/7 [====================>.........] - ETA: 0s - loss: 0.07077/7 [==============================] - ETA: 0s - loss: 0.05677/7 [==============================] - 0s 32ms/step - loss: 0.0567
1/7 [===>..........................] - ETA: 0s - loss: 2.9200e-043/7 [===========>..................] - ETA: 0s - loss: 2.6756e-045/7 [====================>.........] - ETA: 0s - loss: 3.1445e-047/7 [==============================] - ETA: 0s - loss: 7.7323e-047/7 [==============================] - 0s 30ms/step - loss: 7.7323e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.9094e-043/7 [===========>..................] - ETA: 0s - loss: 4.2970e-045/7 [====================>.........] - ETA: 0s - loss: 3.5739e-047/7 [==============================] - ETA: 0s - loss: 8.5109e-047/7 [==============================] - 0s 34ms/step - loss: 8.5109e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00173/7 [===========>..................] - ETA: 0s - loss: 0.00175/7 [====================>.........] - ETA: 0s - loss: 0.00157/7 [==============================] - ETA: 0s - loss: 0.00157/7 [==============================] - 0s 27ms/step - loss: 0.0015
1/7 [===>..........................] - ETA: 0s - loss: 0.01313/7 [===========>..................] - ETA: 0s - loss: 0.03335/7 [====================>.........] - ETA: 0s - loss: 0.03936/7 [========================>.....] - ETA: 0s - loss: 0.03327/7 [==============================] - 0s 46ms/step - loss: 0.0318
1/7 [===>..........................] - ETA: 0s - loss: 0.00153/7 [===========>..................] - ETA: 0s - loss: 0.04735/7 [====================>.........] - ETA: 0s - loss: 0.03817/7 [==============================] - ETA: 0s - loss: 0.03067/7 [==============================] - 0s 37ms/step - loss: 0.0306
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.010582264978438616:
Train Score: 0.01051 MSE 0.10250 RMSE
Test Score: 0.01027 MSE 0.10132 RMSE
Deviation Min [4.59710713e-06], Max [0.70223012]
Deviation 99.5th pctile [0.53277663]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1393,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1173,  227]))
Confusion matrix 
[[1173    0]
 [ 220    7]]
precision 1.00000, recall 0.03084, f1 0.05983
Time to train: 263395 ms
Saving model models/A1Benchmark/real_19.csv.h5
Total Time to proces all the selected files : 266165 ms
A1Benchmark : Avg precision 1.00000 recall 0.03084 f1 0.05983 time to train 263395.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_19.csv  --epochs 20 --n_iter 3 --patience 3 :: took 273 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_1.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 12:06:38 AM MST
2020-11-30 00:06:45.728867: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 00:06:45.747256: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 00:06:45.748145: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d5c37e2cf0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 00:06:45.748172: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 00:06:45.748281: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_1.csv
Shapes: time variant data with labels (1420, 2), full data (1420, 3)
Look back data shapes: lookbackX (1396, 24, 1) lookbackY (1396, 2)
Shapes: Xtrain_full (1116, 24, 1), Ytrain_full (1116, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1005, 24, 1), Ytrain (1005, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00235/7 [====================>.........] - ETA: 0s - loss: 0.00287/7 [==============================] - 0s 12ms/step - loss: 0.0027
1/7 [===>..........................] - ETA: 0s - loss: 0.00385/7 [====================>.........] - ETA: 0s - loss: 0.00277/7 [==============================] - 0s 12ms/step - loss: 0.0027
1/7 [===>..........................] - ETA: 0s - loss: 0.00224/7 [================>.............] - ETA: 0s - loss: 0.00377/7 [==============================] - ETA: 0s - loss: 0.00457/7 [==============================] - 0s 15ms/step - loss: 0.0045
1/7 [===>..........................] - ETA: 0s - loss: 0.00325/7 [====================>.........] - ETA: 0s - loss: 0.00367/7 [==============================] - 0s 11ms/step - loss: 0.0037
1/7 [===>..........................] - ETA: 0s - loss: 0.00355/7 [====================>.........] - ETA: 0s - loss: 0.00367/7 [==============================] - 0s 12ms/step - loss: 0.0038
1/7 [===>..........................] - ETA: 0s - loss: 0.00223/7 [===========>..................] - ETA: 0s - loss: 0.00345/7 [====================>.........] - ETA: 0s - loss: 0.00307/7 [==============================] - ETA: 0s - loss: 0.00297/7 [==============================] - 0s 27ms/step - loss: 0.0029
1/7 [===>..........................] - ETA: 0s - loss: 0.00393/7 [===========>..................] - ETA: 0s - loss: 0.00295/7 [====================>.........] - ETA: 0s - loss: 0.00307/7 [==============================] - 0s 23ms/step - loss: 0.0030
1/7 [===>..........................] - ETA: 0s - loss: 0.00263/7 [===========>..................] - ETA: 0s - loss: 0.00375/7 [====================>.........] - ETA: 0s - loss: 0.00447/7 [==============================] - ETA: 0s - loss: 0.00467/7 [==============================] - 0s 31ms/step - loss: 0.0046
1/7 [===>..........................] - ETA: 0s - loss: 0.00273/7 [===========>..................] - ETA: 0s - loss: 0.00315/7 [====================>.........] - ETA: 0s - loss: 0.00317/7 [==============================] - ETA: 0s - loss: 0.00327/7 [==============================] - 0s 36ms/step - loss: 0.0032
1/7 [===>..........................] - ETA: 0s - loss: 0.00283/7 [===========>..................] - ETA: 0s - loss: 0.00355/7 [====================>.........] - ETA: 0s - loss: 0.00357/7 [==============================] - ETA: 0s - loss: 0.00377/7 [==============================] - 0s 28ms/step - loss: 0.0037
1/7 [===>..........................] - ETA: 0s - loss: 0.00223/7 [===========>..................] - ETA: 0s - loss: 0.00335/7 [====================>.........] - ETA: 0s - loss: 0.00297/7 [==============================] - ETA: 0s - loss: 0.00287/7 [==============================] - 0s 35ms/step - loss: 0.0028
1/7 [===>..........................] - ETA: 0s - loss: 0.00433/7 [===========>..................] - ETA: 0s - loss: 0.00275/7 [====================>.........] - ETA: 0s - loss: 0.00237/7 [==============================] - ETA: 0s - loss: 0.00227/7 [==============================] - 0s 38ms/step - loss: 0.0022
1/7 [===>..........................] - ETA: 0s - loss: 0.00223/7 [===========>..................] - ETA: 0s - loss: 0.00385/7 [====================>.........] - ETA: 0s - loss: 0.00456/7 [========================>.....] - ETA: 0s - loss: 0.00477/7 [==============================] - 0s 34ms/step - loss: 0.0046
1/7 [===>..........................] - ETA: 0s - loss: 0.00293/7 [===========>..................] - ETA: 0s - loss: 0.00345/7 [====================>.........] - ETA: 0s - loss: 0.00347/7 [==============================] - ETA: 0s - loss: 0.00347/7 [==============================] - 0s 34ms/step - loss: 0.0034
1/7 [===>..........................] - ETA: 0s - loss: 0.00283/7 [===========>..................] - ETA: 0s - loss: 0.00355/7 [====================>.........] - ETA: 0s - loss: 0.00357/7 [==============================] - ETA: 0s - loss: 0.00377/7 [==============================] - 0s 31ms/step - loss: 0.0037
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.003355572419241071:
Train Score: 0.00321 MSE 0.05666 RMSE
Test Score: 0.01709 MSE 0.13075 RMSE
Deviation Min [1.70660949e-05], Max [0.89037086]
Deviation 99.5th pctile [0.31352308]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1389,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1394,    2]))
Confusion matrix 
[[1389    5]
 [   0    2]]
precision 0.28571, recall 1.00000, f1 0.44444
Time to train: 234517 ms
Saving model models/A1Benchmark/real_1.csv.h5
Total Time to proces all the selected files : 238531 ms
A1Benchmark : Avg precision 0.28571 recall 1.00000 f1 0.44444 time to train 234517.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_1.csv  --epochs 20 --n_iter 3 --patience 3 :: took 246 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_20.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 12:10:49 AM MST
2020-11-30 00:10:56.079935: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 00:10:56.098212: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 00:10:56.099782: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55909c6d6c60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 00:10:56.099851: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 00:10:56.099970: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_20.csv
Shapes: time variant data with labels (1422, 2), full data (1422, 3)
Look back data shapes: lookbackX (1398, 24, 1) lookbackY (1398, 2)
Shapes: Xtrain_full (1118, 24, 1), Ytrain_full (1118, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1007, 24, 1), Ytrain (1007, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 3.5514e-045/7 [====================>.........] - ETA: 0s - loss: 0.0010    7/7 [==============================] - 0s 12ms/step - loss: 9.6787e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00184/7 [================>.............] - ETA: 0s - loss: 0.00267/7 [==============================] - ETA: 0s - loss: 0.00227/7 [==============================] - 0s 18ms/step - loss: 0.0022
1/7 [===>..........................] - ETA: 0s - loss: 0.00155/7 [====================>.........] - ETA: 0s - loss: 3.7414e-047/7 [==============================] - 0s 13ms/step - loss: 3.2006e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.5304e-055/7 [====================>.........] - ETA: 0s - loss: 3.4527e-057/7 [==============================] - 0s 13ms/step - loss: 3.3775e-05
1/7 [===>..........................] - ETA: 0s - loss: 3.5988e-054/7 [================>.............] - ETA: 0s - loss: 3.0528e-057/7 [==============================] - ETA: 0s - loss: 3.3424e-057/7 [==============================] - 0s 17ms/step - loss: 3.3424e-05
1/7 [===>..........................] - ETA: 0s - loss: 0.00303/7 [===========>..................] - ETA: 0s - loss: 0.00415/7 [====================>.........] - ETA: 0s - loss: 0.00727/7 [==============================] - ETA: 0s - loss: 0.00637/7 [==============================] - 0s 35ms/step - loss: 0.0063
1/7 [===>..........................] - ETA: 0s - loss: 9.1880e-043/7 [===========>..................] - ETA: 0s - loss: 0.0013    5/7 [====================>.........] - ETA: 0s - loss: 0.00147/7 [==============================] - ETA: 0s - loss: 0.00137/7 [==============================] - 0s 25ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 1.5723e-043/7 [===========>..................] - ETA: 0s - loss: 9.8841e-055/7 [====================>.........] - ETA: 0s - loss: 7.6641e-057/7 [==============================] - ETA: 0s - loss: 7.6945e-057/7 [==============================] - 0s 37ms/step - loss: 7.6945e-05
1/7 [===>..........................] - ETA: 0s - loss: 5.8452e-052/7 [=======>......................] - ETA: 0s - loss: 7.1218e-054/7 [================>.............] - ETA: 0s - loss: 6.2633e-056/7 [========================>.....] - ETA: 0s - loss: 6.0827e-057/7 [==============================] - 0s 29ms/step - loss: 6.3961e-05
1/7 [===>..........................] - ETA: 0s - loss: 8.6003e-053/7 [===========>..................] - ETA: 0s - loss: 6.3946e-055/7 [====================>.........] - ETA: 0s - loss: 6.0023e-057/7 [==============================] - ETA: 0s - loss: 6.3191e-057/7 [==============================] - 0s 33ms/step - loss: 6.3191e-05
1/7 [===>..........................] - ETA: 0s - loss: 4.1750e-044/7 [================>.............] - ETA: 0s - loss: 0.0011    7/7 [==============================] - ETA: 0s - loss: 0.00117/7 [==============================] - 0s 17ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 3.9614e-044/7 [================>.............] - ETA: 0s - loss: 9.7684e-047/7 [==============================] - 0s 15ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 0.00105/7 [====================>.........] - ETA: 0s - loss: 2.3334e-047/7 [==============================] - 0s 14ms/step - loss: 1.9433e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.8085e-055/7 [====================>.........] - ETA: 0s - loss: 4.7631e-057/7 [==============================] - 0s 12ms/step - loss: 4.2782e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.1665e-045/7 [====================>.........] - ETA: 0s - loss: 1.7471e-047/7 [==============================] - 0s 13ms/step - loss: 1.8115e-04
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0005234084252151661:
Train Score: 0.00048 MSE 0.02199 RMSE
Test Score: 0.00446 MSE 0.06679 RMSE
Deviation Min [2.09956191e-05], Max [0.96531441]
Deviation 99.5th pctile [0.10437153]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1391,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1365,   33]))
Confusion matrix 
[[1360    5]
 [  31    2]]
precision 0.28571, recall 0.06061, f1 0.10000
Time to train: 427279 ms
Saving model models/A1Benchmark/real_20.csv.h5
Total Time to proces all the selected files : 429963 ms
A1Benchmark : Avg precision 0.28571 recall 0.06061 f1 0.10000 time to train 427279.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_20.csv  --epochs 20 --n_iter 3 --patience 3 :: took 437 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_21.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 12:18:11 AM MST
2020-11-30 00:18:17.577248: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 00:18:17.596251: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 00:18:17.597647: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5647e090f8c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 00:18:17.597697: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 00:18:17.597898: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_21.csv
Shapes: time variant data with labels (1420, 2), full data (1420, 3)
Look back data shapes: lookbackX (1396, 24, 1) lookbackY (1396, 2)
Shapes: Xtrain_full (1116, 24, 1), Ytrain_full (1116, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1005, 24, 1), Ytrain (1005, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 5.3185e-044/7 [================>.............] - ETA: 0s - loss: 5.6986e-047/7 [==============================] - ETA: 0s - loss: 6.3089e-047/7 [==============================] - 0s 15ms/step - loss: 6.3089e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.3257e-045/7 [====================>.........] - ETA: 0s - loss: 7.5934e-047/7 [==============================] - 0s 12ms/step - loss: 7.3041e-04
1/7 [===>..........................] - ETA: 0s - loss: 9.4861e-045/7 [====================>.........] - ETA: 0s - loss: 7.1467e-047/7 [==============================] - 0s 11ms/step - loss: 6.6944e-04
1/7 [===>..........................] - ETA: 0s - loss: 8.0357e-045/7 [====================>.........] - ETA: 0s - loss: 6.9790e-047/7 [==============================] - 0s 12ms/step - loss: 7.9318e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.7445e-044/7 [================>.............] - ETA: 0s - loss: 6.2547e-047/7 [==============================] - ETA: 0s - loss: 7.4762e-047/7 [==============================] - 0s 15ms/step - loss: 7.4762e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.3393e-044/7 [================>.............] - ETA: 0s - loss: 5.5489e-047/7 [==============================] - ETA: 0s - loss: 6.1113e-047/7 [==============================] - 0s 17ms/step - loss: 6.1113e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.8761e-044/7 [================>.............] - ETA: 0s - loss: 7.4369e-047/7 [==============================] - ETA: 0s - loss: 7.8184e-047/7 [==============================] - 0s 15ms/step - loss: 7.8184e-04
1/7 [===>..........................] - ETA: 0s - loss: 9.6285e-045/7 [====================>.........] - ETA: 0s - loss: 7.1195e-047/7 [==============================] - 0s 14ms/step - loss: 6.6767e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.4559e-045/7 [====================>.........] - ETA: 0s - loss: 6.3077e-047/7 [==============================] - 0s 14ms/step - loss: 7.1177e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.9579e-044/7 [================>.............] - ETA: 0s - loss: 6.6963e-047/7 [==============================] - ETA: 0s - loss: 8.0473e-047/7 [==============================] - 0s 19ms/step - loss: 8.0473e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.8849e-043/7 [===========>..................] - ETA: 0s - loss: 6.7911e-045/7 [====================>.........] - ETA: 0s - loss: 5.9460e-047/7 [==============================] - ETA: 0s - loss: 6.8508e-047/7 [==============================] - 0s 36ms/step - loss: 6.8508e-04
1/7 [===>..........................] - ETA: 0s - loss: 6.1764e-043/7 [===========>..................] - ETA: 0s - loss: 7.4583e-045/7 [====================>.........] - ETA: 0s - loss: 8.5424e-047/7 [==============================] - ETA: 0s - loss: 8.2020e-047/7 [==============================] - 0s 31ms/step - loss: 8.2020e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00123/7 [===========>..................] - ETA: 0s - loss: 8.2634e-045/7 [====================>.........] - ETA: 0s - loss: 7.7873e-047/7 [==============================] - ETA: 0s - loss: 7.5150e-047/7 [==============================] - 0s 31ms/step - loss: 7.5150e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.7831e-043/7 [===========>..................] - ETA: 0s - loss: 6.6211e-045/7 [====================>.........] - ETA: 0s - loss: 6.6062e-047/7 [==============================] - ETA: 0s - loss: 7.4441e-047/7 [==============================] - 0s 34ms/step - loss: 7.4441e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.5022e-043/7 [===========>..................] - ETA: 0s - loss: 7.1876e-045/7 [====================>.........] - ETA: 0s - loss: 8.8650e-047/7 [==============================] - ETA: 0s - loss: 9.3740e-047/7 [==============================] - 0s 25ms/step - loss: 9.3740e-04
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.000714308675378561:
Train Score: 0.00069 MSE 0.02632 RMSE
Test Score: 0.00804 MSE 0.08965 RMSE
Deviation Min [8.61759106e-06], Max [0.95459095]
Deviation 99.5th pctile [0.10485433]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1389,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1390,    6]))
Confusion matrix 
[[1389    1]
 [   0    6]]
precision 0.85714, recall 1.00000, f1 0.92308
Time to train: 176191 ms
Saving model models/A1Benchmark/real_21.csv.h5
Total Time to proces all the selected files : 178277 ms
A1Benchmark : Avg precision 0.85714 recall 1.00000 f1 0.92308 time to train 176191.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_21.csv  --epochs 20 --n_iter 3 --patience 3 :: took 185 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_22.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 12:21:21 AM MST
2020-11-30 00:21:27.599412: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 00:21:27.618161: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 00:21:27.619551: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55b71864f270 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 00:21:27.619597: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 00:21:27.619791: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_22.csv
Shapes: time variant data with labels (1420, 2), full data (1420, 3)
Look back data shapes: lookbackX (1396, 24, 1) lookbackY (1396, 2)
Shapes: Xtrain_full (1116, 24, 1), Ytrain_full (1116, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1005, 24, 1), Ytrain (1005, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 8.6339e-045/7 [====================>.........] - ETA: 0s - loss: 8.0444e-047/7 [==============================] - 0s 13ms/step - loss: 6.7604e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.2761e-045/7 [====================>.........] - ETA: 0s - loss: 8.7128e-057/7 [==============================] - 0s 13ms/step - loss: 9.6150e-05
1/7 [===>..........................] - ETA: 0s - loss: 2.5570e-054/7 [================>.............] - ETA: 0s - loss: 2.1968e-057/7 [==============================] - ETA: 0s - loss: 2.3796e-057/7 [==============================] - 0s 16ms/step - loss: 2.3796e-05
1/7 [===>..........................] - ETA: 0s - loss: 6.0938e-055/7 [====================>.........] - ETA: 0s - loss: 4.1270e-057/7 [==============================] - 0s 13ms/step - loss: 4.2004e-05
1/7 [===>..........................] - ETA: 0s - loss: 4.3763e-054/7 [================>.............] - ETA: 0s - loss: 4.5185e-057/7 [==============================] - ETA: 0s - loss: 4.2242e-057/7 [==============================] - 0s 17ms/step - loss: 4.2242e-05
1/7 [===>..........................] - ETA: 0s - loss: 9.2351e-045/7 [====================>.........] - ETA: 0s - loss: 8.4303e-047/7 [==============================] - 0s 14ms/step - loss: 7.1082e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.2035e-045/7 [====================>.........] - ETA: 0s - loss: 8.5995e-057/7 [==============================] - 0s 12ms/step - loss: 9.4940e-05
1/7 [===>..........................] - ETA: 0s - loss: 3.6426e-055/7 [====================>.........] - ETA: 0s - loss: 3.9519e-057/7 [==============================] - 0s 14ms/step - loss: 3.7663e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.5087e-054/7 [================>.............] - ETA: 0s - loss: 1.3479e-057/7 [==============================] - ETA: 0s - loss: 1.8536e-057/7 [==============================] - 0s 18ms/step - loss: 1.8536e-05
1/7 [===>..........................] - ETA: 0s - loss: 5.7813e-054/7 [================>.............] - ETA: 0s - loss: 5.8713e-057/7 [==============================] - ETA: 0s - loss: 5.5083e-057/7 [==============================] - 0s 17ms/step - loss: 5.5083e-05
1/7 [===>..........................] - ETA: 0s - loss: 0.00102/7 [=======>......................] - ETA: 0s - loss: 0.00157/7 [==============================] - ETA: 0s - loss: 7.7861e-047/7 [==============================] - 0s 52ms/step - loss: 7.7861e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.4508e-044/7 [================>.............] - ETA: 0s - loss: 1.0464e-047/7 [==============================] - ETA: 0s - loss: 1.0708e-047/7 [==============================] - 0s 15ms/step - loss: 1.0708e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.9453e-055/7 [====================>.........] - ETA: 0s - loss: 2.9852e-057/7 [==============================] - 0s 12ms/step - loss: 2.8392e-05
1/7 [===>..........................] - ETA: 0s - loss: 4.2802e-055/7 [====================>.........] - ETA: 0s - loss: 2.7500e-057/7 [==============================] - 0s 12ms/step - loss: 2.8764e-05
1/7 [===>..........................] - ETA: 0s - loss: 4.8740e-055/7 [====================>.........] - ETA: 0s - loss: 4.6715e-057/7 [==============================] - 0s 12ms/step - loss: 4.7014e-05
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.00017604728272999637:
Train Score: 0.00017 MSE 0.01317 RMSE
Test Score: 0.04578 MSE 0.21397 RMSE
Deviation Min [5.21849825e-06], Max [0.89957299]
Deviation 99.5th pctile [0.7096997]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1389,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1333,   63]))
Confusion matrix 
[[1333    0]
 [  56    7]]
precision 1.00000, recall 0.11111, f1 0.20000
Time to train: 135559 ms
Saving model models/A1Benchmark/real_22.csv.h5
Total Time to proces all the selected files : 137736 ms
A1Benchmark : Avg precision 1.00000 recall 0.11111 f1 0.20000 time to train 135559.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_22.csv  --epochs 20 --n_iter 3 --patience 3 :: took 144 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_23.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 12:23:50 AM MST
2020-11-30 00:23:57.075544: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 00:23:57.094275: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 00:23:57.095695: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x564c92c68c60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 00:23:57.095730: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 00:23:57.095888: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_23.csv
Shapes: time variant data with labels (1420, 2), full data (1420, 3)
Look back data shapes: lookbackX (1396, 24, 1) lookbackY (1396, 2)
Shapes: Xtrain_full (1116, 24, 1), Ytrain_full (1116, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1005, 24, 1), Ytrain (1005, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00503/7 [===========>..................] - ETA: 0s - loss: 0.00735/7 [====================>.........] - ETA: 0s - loss: 0.00587/7 [==============================] - ETA: 0s - loss: 0.01697/7 [==============================] - 0s 29ms/step - loss: 0.0169
1/7 [===>..........................] - ETA: 0s - loss: 0.05653/7 [===========>..................] - ETA: 0s - loss: 0.02195/7 [====================>.........] - ETA: 0s - loss: 0.01607/7 [==============================] - ETA: 0s - loss: 0.01387/7 [==============================] - 0s 25ms/step - loss: 0.0138
1/7 [===>..........................] - ETA: 0s - loss: 0.00353/7 [===========>..................] - ETA: 0s - loss: 0.00435/7 [====================>.........] - ETA: 0s - loss: 0.01057/7 [==============================] - ETA: 0s - loss: 0.01107/7 [==============================] - 0s 25ms/step - loss: 0.0110
1/7 [===>..........................] - ETA: 0s - loss: 0.00563/7 [===========>..................] - ETA: 0s - loss: 0.01165/7 [====================>.........] - ETA: 0s - loss: 0.00877/7 [==============================] - ETA: 0s - loss: 0.00737/7 [==============================] - 0s 32ms/step - loss: 0.0073
1/7 [===>..........................] - ETA: 0s - loss: 0.00773/7 [===========>..................] - ETA: 0s - loss: 0.00505/7 [====================>.........] - ETA: 0s - loss: 0.00587/7 [==============================] - ETA: 0s - loss: 0.00627/7 [==============================] - 0s 25ms/step - loss: 0.0062
1/7 [===>..........................] - ETA: 0s - loss: 0.00424/7 [================>.............] - ETA: 0s - loss: 0.00647/7 [==============================] - ETA: 0s - loss: 0.01557/7 [==============================] - 0s 15ms/step - loss: 0.0155
1/7 [===>..........................] - ETA: 0s - loss: 0.04035/7 [====================>.........] - ETA: 0s - loss: 0.01267/7 [==============================] - 0s 12ms/step - loss: 0.0109
1/7 [===>..........................] - ETA: 0s - loss: 0.00364/7 [================>.............] - ETA: 0s - loss: 0.00477/7 [==============================] - ETA: 0s - loss: 0.00997/7 [==============================] - 0s 16ms/step - loss: 0.0099
1/7 [===>..........................] - ETA: 0s - loss: 0.00495/7 [====================>.........] - ETA: 0s - loss: 0.00747/7 [==============================] - 0s 12ms/step - loss: 0.0063
1/7 [===>..........................] - ETA: 0s - loss: 0.00756/7 [========================>.....] - ETA: 0s - loss: 0.00597/7 [==============================] - 0s 10ms/step - loss: 0.0057
1/7 [===>..........................] - ETA: 0s - loss: 0.00425/7 [====================>.........] - ETA: 0s - loss: 0.00567/7 [==============================] - 0s 14ms/step - loss: 0.0154
1/7 [===>..........................] - ETA: 0s - loss: 0.04395/7 [====================>.........] - ETA: 0s - loss: 0.01337/7 [==============================] - 0s 13ms/step - loss: 0.0116
1/7 [===>..........................] - ETA: 0s - loss: 0.00314/7 [================>.............] - ETA: 0s - loss: 0.00447/7 [==============================] - ETA: 0s - loss: 0.00977/7 [==============================] - 0s 17ms/step - loss: 0.0097
1/7 [===>..........................] - ETA: 0s - loss: 0.00555/7 [====================>.........] - ETA: 0s - loss: 0.00797/7 [==============================] - 0s 13ms/step - loss: 0.0067
1/7 [===>..........................] - ETA: 0s - loss: 0.00604/7 [================>.............] - ETA: 0s - loss: 0.00437/7 [==============================] - 0s 14ms/step - loss: 0.0055
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.00966235613450408:
Train Score: 0.00939 MSE 0.09689 RMSE
Test Score: 0.00862 MSE 0.09283 RMSE
Deviation Min [4.13556963e-05], Max [0.66681931]
Deviation 99.5th pctile [0.4854162]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1389,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1377,   19]))
Confusion matrix 
[[1377    0]
 [  12    7]]
precision 1.00000, recall 0.36842, f1 0.53846
Time to train: 227435 ms
Saving model models/A1Benchmark/real_23.csv.h5
Total Time to proces all the selected files : 229484 ms
A1Benchmark : Avg precision 1.00000 recall 0.36842 f1 0.53846 time to train 227435.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_23.csv  --epochs 20 --n_iter 3 --patience 3 :: took 236 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_24.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 12:27:51 AM MST
2020-11-30 00:27:57.946572: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 00:27:57.965218: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 00:27:57.966102: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5596e3fa4c60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 00:27:57.966131: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 00:27:57.966247: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_24.csv
Shapes: time variant data with labels (1461, 2), full data (1461, 3)
Look back data shapes: lookbackX (1437, 24, 1) lookbackY (1437, 2)
Shapes: Xtrain_full (1149, 24, 1), Ytrain_full (1149, 1), Xtest (288, 24, 1), Ytest (288, 1)
Shapes: Xtrain (1035, 24, 1), Ytrain (1035, 1), Xvalid (114, 24, 1), Yvalid (114, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00185/7 [====================>.........] - ETA: 0s - loss: 0.00227/7 [==============================] - 0s 14ms/step - loss: 0.0023
1/7 [===>..........................] - ETA: 0s - loss: 0.00434/7 [================>.............] - ETA: 0s - loss: 0.00357/7 [==============================] - ETA: 0s - loss: 0.00307/7 [==============================] - 0s 17ms/step - loss: 0.0030
1/7 [===>..........................] - ETA: 0s - loss: 0.00275/7 [====================>.........] - ETA: 0s - loss: 0.00267/7 [==============================] - 0s 13ms/step - loss: 0.0027
1/7 [===>..........................] - ETA: 0s - loss: 0.00255/7 [====================>.........] - ETA: 0s - loss: 0.00257/7 [==============================] - 0s 14ms/step - loss: 0.0024
1/7 [===>..........................] - ETA: 0s - loss: 0.00184/7 [================>.............] - ETA: 0s - loss: 0.00227/7 [==============================] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 16ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 0.00203/7 [===========>..................] - ETA: 0s - loss: 0.00265/7 [====================>.........] - ETA: 0s - loss: 0.00247/7 [==============================] - ETA: 0s - loss: 0.00267/7 [==============================] - 0s 34ms/step - loss: 0.0026
1/7 [===>..........................] - ETA: 0s - loss: 0.00483/7 [===========>..................] - ETA: 0s - loss: 0.00455/7 [====================>.........] - ETA: 0s - loss: 0.00347/7 [==============================] - ETA: 0s - loss: 0.00327/7 [==============================] - 0s 25ms/step - loss: 0.0032
1/7 [===>..........................] - ETA: 0s - loss: 0.00303/7 [===========>..................] - ETA: 0s - loss: 0.00265/7 [====================>.........] - ETA: 0s - loss: 0.00297/7 [==============================] - ETA: 0s - loss: 0.00307/7 [==============================] - 0s 33ms/step - loss: 0.0030
1/7 [===>..........................] - ETA: 0s - loss: 0.00273/7 [===========>..................] - ETA: 0s - loss: 0.00285/7 [====================>.........] - ETA: 0s - loss: 0.00257/7 [==============================] - ETA: 0s - loss: 0.00247/7 [==============================] - 0s 25ms/step - loss: 0.0024
1/7 [===>..........................] - ETA: 0s - loss: 0.00203/7 [===========>..................] - ETA: 0s - loss: 0.00195/7 [====================>.........] - ETA: 0s - loss: 0.00227/7 [==============================] - ETA: 0s - loss: 0.00227/7 [==============================] - 0s 32ms/step - loss: 0.0022
1/7 [===>..........................] - ETA: 0s - loss: 0.00186/7 [========================>.....] - ETA: 0s - loss: 0.00237/7 [==============================] - 0s 10ms/step - loss: 0.0022
1/7 [===>..........................] - ETA: 0s - loss: 0.00444/7 [================>.............] - ETA: 0s - loss: 0.00357/7 [==============================] - ETA: 0s - loss: 0.00297/7 [==============================] - 0s 17ms/step - loss: 0.0029
1/7 [===>..........................] - ETA: 0s - loss: 0.00275/7 [====================>.........] - ETA: 0s - loss: 0.00267/7 [==============================] - 0s 14ms/step - loss: 0.0027
1/7 [===>..........................] - ETA: 0s - loss: 0.00244/7 [================>.............] - ETA: 0s - loss: 0.00237/7 [==============================] - ETA: 0s - loss: 0.00227/7 [==============================] - 0s 19ms/step - loss: 0.0022
1/7 [===>..........................] - ETA: 0s - loss: 0.00195/7 [====================>.........] - ETA: 0s - loss: 0.00217/7 [==============================] - 0s 14ms/step - loss: 0.0021
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0024221394211053847:
Train Score: 0.00235 MSE 0.04847 RMSE
Test Score: 0.00882 MSE 0.09393 RMSE
Deviation Min [0.00011314], Max [0.54604913]
Deviation 99.5th pctile [0.36004327]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1429,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1421,   16]))
Confusion matrix 
[[1421    0]
 [   8    8]]
precision 1.00000, recall 0.50000, f1 0.66667
Time to train: 230403 ms
Saving model models/A1Benchmark/real_24.csv.h5
Total Time to proces all the selected files : 232948 ms
A1Benchmark : Avg precision 1.00000 recall 0.50000 f1 0.66667 time to train 230403.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_24.csv  --epochs 20 --n_iter 3 --patience 3 :: took 240 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_25.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 12:31:56 AM MST
2020-11-30 00:32:02.672141: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 00:32:02.679057: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 00:32:02.679734: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559dc1e46c60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 00:32:02.679756: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 00:32:02.679863: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_25.csv
Shapes: time variant data with labels (1435, 2), full data (1435, 3)
Look back data shapes: lookbackX (1411, 24, 1) lookbackY (1411, 2)
Shapes: Xtrain_full (1128, 24, 1), Ytrain_full (1128, 1), Xtest (283, 24, 1), Ytest (283, 1)
Shapes: Xtrain (1016, 24, 1), Ytrain (1016, 1), Xvalid (112, 24, 1), Yvalid (112, 1)
1/7 [===>..........................] - ETA: 0s - loss: 6.8618e-053/7 [===========>..................] - ETA: 0s - loss: 1.4951e-045/7 [====================>.........] - ETA: 0s - loss: 1.6198e-047/7 [==============================] - ETA: 0s - loss: 1.8474e-047/7 [==============================] - 0s 31ms/step - loss: 1.8474e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.2613e-043/7 [===========>..................] - ETA: 0s - loss: 3.2266e-045/7 [====================>.........] - ETA: 0s - loss: 2.8118e-047/7 [==============================] - ETA: 0s - loss: 2.2851e-047/7 [==============================] - 0s 33ms/step - loss: 2.2851e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.9175e-053/7 [===========>..................] - ETA: 0s - loss: 7.0271e-055/7 [====================>.........] - ETA: 0s - loss: 1.0785e-047/7 [==============================] - ETA: 0s - loss: 1.2520e-047/7 [==============================] - 0s 37ms/step - loss: 1.2520e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.1089e-053/7 [===========>..................] - ETA: 0s - loss: 6.0983e-055/7 [====================>.........] - ETA: 0s - loss: 6.1995e-057/7 [==============================] - ETA: 0s - loss: 7.2000e-057/7 [==============================] - 0s 26ms/step - loss: 7.2000e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.8664e-052/7 [=======>......................] - ETA: 0s - loss: 1.9451e-054/7 [================>.............] - ETA: 0s - loss: 2.1296e-056/7 [========================>.....] - ETA: 0s - loss: 2.6922e-057/7 [==============================] - 0s 34ms/step - loss: 2.7437e-05
1/7 [===>..........................] - ETA: 0s - loss: 2.0867e-055/7 [====================>.........] - ETA: 0s - loss: 1.5426e-047/7 [==============================] - 0s 16ms/step - loss: 1.8407e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.1026e-046/7 [========================>.....] - ETA: 0s - loss: 2.3001e-047/7 [==============================] - 0s 10ms/step - loss: 2.1980e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.4577e-055/7 [====================>.........] - ETA: 0s - loss: 1.0286e-047/7 [==============================] - 0s 14ms/step - loss: 1.2113e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.0880e-054/7 [================>.............] - ETA: 0s - loss: 4.9950e-057/7 [==============================] - ETA: 0s - loss: 7.0027e-057/7 [==============================] - 0s 15ms/step - loss: 7.0027e-05
1/7 [===>..........................] - ETA: 0s - loss: 6.5642e-055/7 [====================>.........] - ETA: 0s - loss: 8.0232e-057/7 [==============================] - 0s 12ms/step - loss: 8.5240e-05
1/7 [===>..........................] - ETA: 0s - loss: 2.2169e-053/7 [===========>..................] - ETA: 0s - loss: 1.2979e-045/7 [====================>.........] - ETA: 0s - loss: 1.5614e-047/7 [==============================] - ETA: 0s - loss: 1.8500e-047/7 [==============================] - 0s 35ms/step - loss: 1.8500e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.4941e-043/7 [===========>..................] - ETA: 0s - loss: 3.4346e-045/7 [====================>.........] - ETA: 0s - loss: 2.9893e-047/7 [==============================] - ETA: 0s - loss: 2.4218e-047/7 [==============================] - 0s 26ms/step - loss: 2.4218e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.7676e-053/7 [===========>..................] - ETA: 0s - loss: 6.1656e-055/7 [====================>.........] - ETA: 0s - loss: 1.0415e-047/7 [==============================] - ETA: 0s - loss: 1.2441e-047/7 [==============================] - 0s 25ms/step - loss: 1.2441e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.0190e-053/7 [===========>..................] - ETA: 0s - loss: 6.2439e-055/7 [====================>.........] - ETA: 0s - loss: 6.3290e-057/7 [==============================] - ETA: 0s - loss: 7.2447e-057/7 [==============================] - 0s 37ms/step - loss: 7.2447e-05
1/7 [===>..........................] - ETA: 0s - loss: 3.4957e-053/7 [===========>..................] - ETA: 0s - loss: 3.9747e-055/7 [====================>.........] - ETA: 0s - loss: 4.5675e-057/7 [==============================] - ETA: 0s - loss: 5.0002e-057/7 [==============================] - 0s 39ms/step - loss: 5.0002e-05
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.00012757617769239006:
Train Score: 0.00012 MSE 0.01084 RMSE
Test Score: 0.06926 MSE 0.26317 RMSE
Deviation Min [2.22020395e-06], Max [0.94026108]
Deviation 99.5th pctile [0.76873096]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1403,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1368,   43]))
Confusion matrix 
[[1368    0]
 [  35    8]]
precision 1.00000, recall 0.18605, f1 0.31373
Time to train: 218901 ms
Saving model models/A1Benchmark/real_25.csv.h5
Total Time to proces all the selected files : 223295 ms
A1Benchmark : Avg precision 1.00000 recall 0.18605 f1 0.31373 time to train 218901.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_25.csv  --epochs 20 --n_iter 3 --patience 3 :: took 230 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_26.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 12:35:51 AM MST
2020-11-30 00:35:58.841788: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 00:35:58.860208: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 00:35:58.861193: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55fad5dcc8c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 00:35:58.861240: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 00:35:58.861416: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_26.csv
Shapes: time variant data with labels (1435, 2), full data (1435, 3)
Look back data shapes: lookbackX (1411, 24, 1) lookbackY (1411, 2)
Shapes: Xtrain_full (1128, 24, 1), Ytrain_full (1128, 1), Xtest (283, 24, 1), Ytest (283, 1)
Shapes: Xtrain (1016, 24, 1), Ytrain (1016, 1), Xvalid (112, 24, 1), Yvalid (112, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00535/7 [====================>.........] - ETA: 0s - loss: 0.01047/7 [==============================] - 0s 12ms/step - loss: 0.0102
1/7 [===>..........................] - ETA: 0s - loss: 0.02854/7 [================>.............] - ETA: 0s - loss: 0.03117/7 [==============================] - ETA: 0s - loss: 0.02917/7 [==============================] - 0s 16ms/step - loss: 0.0291
1/7 [===>..........................] - ETA: 0s - loss: 0.02095/7 [====================>.........] - ETA: 0s - loss: 0.01407/7 [==============================] - 0s 12ms/step - loss: 0.0124
1/7 [===>..........................] - ETA: 0s - loss: 0.01125/7 [====================>.........] - ETA: 0s - loss: 0.00957/7 [==============================] - 0s 12ms/step - loss: 0.0086
1/7 [===>..........................] - ETA: 0s - loss: 0.00905/7 [====================>.........] - ETA: 0s - loss: 0.00827/7 [==============================] - 0s 13ms/step - loss: 0.0113
1/7 [===>..........................] - ETA: 0s - loss: 0.00402/7 [=======>......................] - ETA: 0s - loss: 0.00284/7 [================>.............] - ETA: 0s - loss: 0.00826/7 [========================>.....] - ETA: 0s - loss: 0.00887/7 [==============================] - 0s 32ms/step - loss: 0.0092
1/7 [===>..........................] - ETA: 0s - loss: 0.02513/7 [===========>..................] - ETA: 0s - loss: 0.02825/7 [====================>.........] - ETA: 0s - loss: 0.02627/7 [==============================] - ETA: 0s - loss: 0.02767/7 [==============================] - 0s 27ms/step - loss: 0.0276
1/7 [===>..........................] - ETA: 0s - loss: 0.01552/7 [=======>......................] - ETA: 0s - loss: 0.01284/7 [================>.............] - ETA: 0s - loss: 0.01276/7 [========================>.....] - ETA: 0s - loss: 0.01067/7 [==============================] - 0s 31ms/step - loss: 0.0102
1/7 [===>..........................] - ETA: 0s - loss: 0.00823/7 [===========>..................] - ETA: 0s - loss: 0.01175/7 [====================>.........] - ETA: 0s - loss: 0.00867/7 [==============================] - ETA: 0s - loss: 0.00757/7 [==============================] - 0s 32ms/step - loss: 0.0075
1/7 [===>..........................] - ETA: 0s - loss: 0.01003/7 [===========>..................] - ETA: 0s - loss: 0.00755/7 [====================>.........] - ETA: 0s - loss: 0.01297/7 [==============================] - ETA: 0s - loss: 0.01747/7 [==============================] - 0s 30ms/step - loss: 0.0174
1/7 [===>..........................] - ETA: 0s - loss: 0.00374/7 [================>.............] - ETA: 0s - loss: 0.00817/7 [==============================] - ETA: 0s - loss: 0.00907/7 [==============================] - 0s 15ms/step - loss: 0.0090
1/7 [===>..........................] - ETA: 0s - loss: 0.02864/7 [================>.............] - ETA: 0s - loss: 0.03077/7 [==============================] - 0s 14ms/step - loss: 0.0281
1/7 [===>..........................] - ETA: 0s - loss: 0.01585/7 [====================>.........] - ETA: 0s - loss: 0.01177/7 [==============================] - 0s 12ms/step - loss: 0.0104
1/7 [===>..........................] - ETA: 0s - loss: 0.01014/7 [================>.............] - ETA: 0s - loss: 0.01047/7 [==============================] - ETA: 0s - loss: 0.00777/7 [==============================] - 0s 16ms/step - loss: 0.0077
1/7 [===>..........................] - ETA: 0s - loss: 0.01105/7 [====================>.........] - ETA: 0s - loss: 0.01187/7 [==============================] - 0s 13ms/step - loss: 0.0147
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.013974909018725157:
Train Score: 0.01148 MSE 0.10715 RMSE
Test Score: 0.01032 MSE 0.10161 RMSE
Deviation Min [7.43413182e-05], Max [0.76466236]
Deviation 99.5th pctile [0.51406544]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1403,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1336,   75]))
Confusion matrix 
[[1328    8]
 [  75    0]]
precision 0.00000, recall 0.00000, f1 0.00000
Time to train: 424657 ms
Saving model models/A1Benchmark/real_26.csv.h5
Total Time to proces all the selected files : 426763 ms
A1Benchmark : Avg precision 0.00000 recall 0.00000 f1 0.00000 time to train 424657.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_26.csv  --epochs 20 --n_iter 3 --patience 3 :: took 434 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_27.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 12:43:10 AM MST
2020-11-30 00:43:17.207801: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 00:43:17.226267: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 00:43:17.227765: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55fa68024cf0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 00:43:17.227818: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 00:43:17.228066: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_27.csv
Shapes: time variant data with labels (1427, 2), full data (1427, 3)
Look back data shapes: lookbackX (1403, 24, 1) lookbackY (1403, 2)
Shapes: Xtrain_full (1122, 24, 1), Ytrain_full (1122, 1), Xtest (281, 24, 1), Ytest (281, 1)
Shapes: Xtrain (1010, 24, 1), Ytrain (1010, 1), Xvalid (112, 24, 1), Yvalid (112, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00165/7 [====================>.........] - ETA: 0s - loss: 0.00177/7 [==============================] - 0s 13ms/step - loss: 0.0016
1/7 [===>..........................] - ETA: 0s - loss: 0.00195/7 [====================>.........] - ETA: 0s - loss: 0.00177/7 [==============================] - 0s 12ms/step - loss: 0.0017
1/7 [===>..........................] - ETA: 0s - loss: 0.00265/7 [====================>.........] - ETA: 0s - loss: 0.00277/7 [==============================] - 0s 12ms/step - loss: 0.0026
1/7 [===>..........................] - ETA: 0s - loss: 0.00124/7 [================>.............] - ETA: 0s - loss: 0.00157/7 [==============================] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 15ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 0.00144/7 [================>.............] - ETA: 0s - loss: 0.00657/7 [==============================] - ETA: 0s - loss: 0.00467/7 [==============================] - 0s 15ms/step - loss: 0.0046
1/7 [===>..........................] - ETA: 0s - loss: 0.00115/7 [====================>.........] - ETA: 0s - loss: 0.00127/7 [==============================] - 0s 13ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 7.2132e-045/7 [====================>.........] - ETA: 0s - loss: 0.0015    7/7 [==============================] - 0s 12ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 0.00215/7 [====================>.........] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 17ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 0.00105/7 [====================>.........] - ETA: 0s - loss: 0.00147/7 [==============================] - 0s 12ms/step - loss: 0.0015
1/7 [===>..........................] - ETA: 0s - loss: 0.00154/7 [================>.............] - ETA: 0s - loss: 0.00727/7 [==============================] - ETA: 0s - loss: 0.00517/7 [==============================] - 0s 18ms/step - loss: 0.0051
1/7 [===>..........................] - ETA: 0s - loss: 0.00163/7 [===========>..................] - ETA: 0s - loss: 0.00295/7 [====================>.........] - ETA: 0s - loss: 0.00237/7 [==============================] - ETA: 0s - loss: 0.00217/7 [==============================] - 0s 27ms/step - loss: 0.0021
1/7 [===>..........................] - ETA: 0s - loss: 0.00213/7 [===========>..................] - ETA: 0s - loss: 0.00205/7 [====================>.........] - ETA: 0s - loss: 0.00167/7 [==============================] - ETA: 0s - loss: 0.00167/7 [==============================] - 0s 27ms/step - loss: 0.0016
1/7 [===>..........................] - ETA: 0s - loss: 0.00123/7 [===========>..................] - ETA: 0s - loss: 0.00175/7 [====================>.........] - ETA: 0s - loss: 0.00157/7 [==============================] - ETA: 0s - loss: 0.00157/7 [==============================] - 0s 28ms/step - loss: 0.0015
1/7 [===>..........................] - ETA: 0s - loss: 0.00143/7 [===========>..................] - ETA: 0s - loss: 0.00135/7 [====================>.........] - ETA: 0s - loss: 0.00197/7 [==============================] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 27ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 0.00153/7 [===========>..................] - ETA: 0s - loss: 0.01075/7 [====================>.........] - ETA: 0s - loss: 0.00777/7 [==============================] - ETA: 0s - loss: 0.00647/7 [==============================] - 0s 31ms/step - loss: 0.0064
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.002213723585009575:
Train Score: 0.00233 MSE 0.04824 RMSE
Test Score: 0.00236 MSE 0.04856 RMSE
Deviation Min [2.81615063e-05], Max [0.73074993]
Deviation 99.5th pctile [0.15283056]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1395,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1401,    2]))
Confusion matrix 
[[1395    6]
 [   0    2]]
precision 0.25000, recall 1.00000, f1 0.40000
Time to train: 476730 ms
Saving model models/A1Benchmark/real_27.csv.h5
Total Time to proces all the selected files : 478790 ms
A1Benchmark : Avg precision 0.25000 recall 1.00000 f1 0.40000 time to train 476730.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_27.csv  --epochs 20 --n_iter 3 --patience 3 :: took 486 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_28.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 12:51:21 AM MST
2020-11-30 00:51:27.310470: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 00:51:27.329307: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 00:51:27.330774: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x560dda635270 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 00:51:27.330822: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 00:51:27.331021: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_28.csv
Shapes: time variant data with labels (1441, 2), full data (1441, 3)
Look back data shapes: lookbackX (1417, 24, 1) lookbackY (1417, 2)
Shapes: Xtrain_full (1133, 24, 1), Ytrain_full (1133, 1), Xtest (284, 24, 1), Ytest (284, 1)
Shapes: Xtrain (1020, 24, 1), Ytrain (1020, 1), Xvalid (113, 24, 1), Yvalid (113, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00183/7 [===========>..................] - ETA: 0s - loss: 0.00175/7 [====================>.........] - ETA: 0s - loss: 0.00157/7 [==============================] - ETA: 0s - loss: 0.00167/7 [==============================] - 0s 28ms/step - loss: 0.0016
1/7 [===>..........................] - ETA: 0s - loss: 0.00493/7 [===========>..................] - ETA: 0s - loss: 0.00285/7 [====================>.........] - ETA: 0s - loss: 0.00237/7 [==============================] - ETA: 0s - loss: 0.00247/7 [==============================] - 0s 25ms/step - loss: 0.0024
1/7 [===>..........................] - ETA: 0s - loss: 0.00283/7 [===========>..................] - ETA: 0s - loss: 0.00195/7 [====================>.........] - ETA: 0s - loss: 0.00197/7 [==============================] - ETA: 0s - loss: 0.00177/7 [==============================] - 0s 33ms/step - loss: 0.0017
1/7 [===>..........................] - ETA: 0s - loss: 0.00253/7 [===========>..................] - ETA: 0s - loss: 0.00125/7 [====================>.........] - ETA: 0s - loss: 0.00357/7 [==============================] - ETA: 0s - loss: 0.00647/7 [==============================] - 0s 37ms/step - loss: 0.0064
1/7 [===>..........................] - ETA: 0s - loss: 0.04003/7 [===========>..................] - ETA: 0s - loss: 0.01495/7 [====================>.........] - ETA: 0s - loss: 0.01107/7 [==============================] - ETA: 0s - loss: 0.00957/7 [==============================] - 0s 27ms/step - loss: 0.0095
1/7 [===>..........................] - ETA: 0s - loss: 0.00133/7 [===========>..................] - ETA: 0s - loss: 0.00165/7 [====================>.........] - ETA: 0s - loss: 0.00137/7 [==============================] - ETA: 0s - loss: 0.00147/7 [==============================] - 0s 24ms/step - loss: 0.0014
1/7 [===>..........................] - ETA: 0s - loss: 0.01563/7 [===========>..................] - ETA: 0s - loss: 0.01195/7 [====================>.........] - ETA: 0s - loss: 0.01157/7 [==============================] - ETA: 0s - loss: 0.01247/7 [==============================] - 0s 34ms/step - loss: 0.0124
1/7 [===>..........................] - ETA: 0s - loss: 0.00653/7 [===========>..................] - ETA: 0s - loss: 0.00685/7 [====================>.........] - ETA: 0s - loss: 0.00587/7 [==============================] - ETA: 0s - loss: 0.00577/7 [==============================] - 0s 30ms/step - loss: 0.0057
1/7 [===>..........................] - ETA: 0s - loss: 0.01203/7 [===========>..................] - ETA: 0s - loss: 0.01065/7 [====================>.........] - ETA: 0s - loss: 0.01707/7 [==============================] - ETA: 0s - loss: 0.02097/7 [==============================] - 0s 23ms/step - loss: 0.0209
1/7 [===>..........................] - ETA: 0s - loss: 0.04043/7 [===========>..................] - ETA: 0s - loss: 0.01545/7 [====================>.........] - ETA: 0s - loss: 0.01157/7 [==============================] - ETA: 0s - loss: 0.00967/7 [==============================] - 0s 25ms/step - loss: 0.0096
1/7 [===>..........................] - ETA: 0s - loss: 0.00114/7 [================>.............] - ETA: 0s - loss: 0.00117/7 [==============================] - 0s 15ms/step - loss: 0.0010
1/7 [===>..........................] - ETA: 0s - loss: 0.00524/7 [================>.............] - ETA: 0s - loss: 0.00227/7 [==============================] - ETA: 0s - loss: 0.00217/7 [==============================] - 0s 17ms/step - loss: 0.0021
1/7 [===>..........................] - ETA: 0s - loss: 0.00114/7 [================>.............] - ETA: 0s - loss: 0.00117/7 [==============================] - ETA: 0s - loss: 0.00117/7 [==============================] - 0s 17ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 0.00374/7 [================>.............] - ETA: 0s - loss: 0.00287/7 [==============================] - ETA: 0s - loss: 0.00627/7 [==============================] - 0s 20ms/step - loss: 0.0062
1/7 [===>..........................] - ETA: 0s - loss: 0.02674/7 [================>.............] - ETA: 0s - loss: 0.01007/7 [==============================] - ETA: 0s - loss: 0.00757/7 [==============================] - 0s 18ms/step - loss: 0.0075
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0035873830784112215:
Train Score: 0.00187 MSE 0.04327 RMSE
Test Score: 0.46810 MSE 0.68418 RMSE
Deviation Min [3.04004021e-05], Max [3.61937014]
Deviation 99.5th pctile [2.46904349]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1409,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1335,   82]))
Confusion matrix 
[[1327    8]
 [  82    0]]
precision 0.00000, recall 0.00000, f1 0.00000
Time to train: 476438 ms
Saving model models/A1Benchmark/real_28.csv.h5
Total Time to proces all the selected files : 478596 ms
A1Benchmark : Avg precision 0.00000 recall 0.00000 f1 0.00000 time to train 476438.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_28.csv  --epochs 20 --n_iter 3 --patience 3 :: took 485 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_29.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 12:59:31 AM MST
2020-11-30 00:59:37.419575: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 00:59:37.438183: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 00:59:37.439558: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55ca45eb98c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 00:59:37.439608: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 00:59:37.439812: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_29.csv
Shapes: time variant data with labels (1441, 2), full data (1441, 3)
Look back data shapes: lookbackX (1417, 24, 1) lookbackY (1417, 2)
Shapes: Xtrain_full (1133, 24, 1), Ytrain_full (1133, 1), Xtest (284, 24, 1), Ytest (284, 1)
Shapes: Xtrain (1020, 24, 1), Ytrain (1020, 1), Xvalid (113, 24, 1), Yvalid (113, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00163/7 [===========>..................] - ETA: 0s - loss: 0.00175/7 [====================>.........] - ETA: 0s - loss: 0.00147/7 [==============================] - ETA: 0s - loss: 0.00147/7 [==============================] - 0s 23ms/step - loss: 0.0014
1/7 [===>..........................] - ETA: 0s - loss: 0.00833/7 [===========>..................] - ETA: 0s - loss: 0.00495/7 [====================>.........] - ETA: 0s - loss: 0.00387/7 [==============================] - ETA: 0s - loss: 0.00367/7 [==============================] - 0s 23ms/step - loss: 0.0036
1/7 [===>..........................] - ETA: 0s - loss: 0.00223/7 [===========>..................] - ETA: 0s - loss: 0.00215/7 [====================>.........] - ETA: 0s - loss: 0.00367/7 [==============================] - ETA: 0s - loss: 0.00347/7 [==============================] - 0s 24ms/step - loss: 0.0034
1/7 [===>..........................] - ETA: 0s - loss: 0.01833/7 [===========>..................] - ETA: 0s - loss: 0.00845/7 [====================>.........] - ETA: 0s - loss: 0.00757/7 [==============================] - ETA: 0s - loss: 0.00777/7 [==============================] - 0s 32ms/step - loss: 0.0077
1/7 [===>..........................] - ETA: 0s - loss: 0.00953/7 [===========>..................] - ETA: 0s - loss: 0.00495/7 [====================>.........] - ETA: 0s - loss: 0.00707/7 [==============================] - ETA: 0s - loss: 0.00587/7 [==============================] - 0s 23ms/step - loss: 0.0058
1/7 [===>..........................] - ETA: 0s - loss: 0.00225/7 [====================>.........] - ETA: 0s - loss: 0.00157/7 [==============================] - 0s 14ms/step - loss: 0.0016
1/7 [===>..........................] - ETA: 0s - loss: 0.00755/7 [====================>.........] - ETA: 0s - loss: 0.00317/7 [==============================] - 0s 13ms/step - loss: 0.0027
1/7 [===>..........................] - ETA: 0s - loss: 0.00185/7 [====================>.........] - ETA: 0s - loss: 0.00307/7 [==============================] - 0s 14ms/step - loss: 0.0028
1/7 [===>..........................] - ETA: 0s - loss: 0.01654/7 [================>.............] - ETA: 0s - loss: 0.00547/7 [==============================] - ETA: 0s - loss: 0.00507/7 [==============================] - 0s 20ms/step - loss: 0.0050
1/7 [===>..........................] - ETA: 0s - loss: 0.00625/7 [====================>.........] - ETA: 0s - loss: 0.01077/7 [==============================] - 0s 15ms/step - loss: 0.0097
1/7 [===>..........................] - ETA: 0s - loss: 0.00193/7 [===========>..................] - ETA: 0s - loss: 0.00185/7 [====================>.........] - ETA: 0s - loss: 0.00147/7 [==============================] - ETA: 0s - loss: 0.00137/7 [==============================] - 0s 28ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 0.00713/7 [===========>..................] - ETA: 0s - loss: 0.00415/7 [====================>.........] - ETA: 0s - loss: 0.00327/7 [==============================] - ETA: 0s - loss: 0.00287/7 [==============================] - 0s 25ms/step - loss: 0.0028
1/7 [===>..........................] - ETA: 0s - loss: 0.00313/7 [===========>..................] - ETA: 0s - loss: 0.00235/7 [====================>.........] - ETA: 0s - loss: 0.00367/7 [==============================] - ETA: 0s - loss: 0.00347/7 [==============================] - 0s 32ms/step - loss: 0.0034
1/7 [===>..........................] - ETA: 0s - loss: 0.02283/7 [===========>..................] - ETA: 0s - loss: 0.01125/7 [====================>.........] - ETA: 0s - loss: 0.00957/7 [==============================] - ETA: 0s - loss: 0.00897/7 [==============================] - 0s 26ms/step - loss: 0.0089
1/7 [===>..........................] - ETA: 0s - loss: 0.00643/7 [===========>..................] - ETA: 0s - loss: 0.00995/7 [====================>.........] - ETA: 0s - loss: 0.01237/7 [==============================] - ETA: 0s - loss: 0.01137/7 [==============================] - 0s 25ms/step - loss: 0.0113
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.00436980549711734:
Train Score: 0.00283 MSE 0.05321 RMSE
Test Score: 0.00401 MSE 0.06329 RMSE
Deviation Min [0.00018775], Max [0.67468332]
Deviation 99.5th pctile [0.17522445]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1409,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1410,    7]))
Confusion matrix 
[[1407    3]
 [   2    5]]
precision 0.62500, recall 0.71429, f1 0.66667
Time to train: 522796 ms
Saving model models/A1Benchmark/real_29.csv.h5
Total Time to proces all the selected files : 525232 ms
A1Benchmark : Avg precision 0.62500 recall 0.71429 f1 0.66667 time to train 522796.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_29.csv  --epochs 20 --n_iter 3 --patience 3 :: took 532 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_2.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 01:08:28 AM MST
2020-11-30 01:08:34.029439: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 01:08:34.048223: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 01:08:34.049183: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55dcec403270 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 01:08:34.049215: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 01:08:34.049345: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_2.csv
Shapes: time variant data with labels (1439, 2), full data (1439, 3)
Look back data shapes: lookbackX (1415, 24, 1) lookbackY (1415, 2)
Shapes: Xtrain_full (1132, 24, 1), Ytrain_full (1132, 1), Xtest (283, 24, 1), Ytest (283, 1)
Shapes: Xtrain (1019, 24, 1), Ytrain (1019, 1), Xvalid (113, 24, 1), Yvalid (113, 1)
1/7 [===>..........................] - ETA: 0s - loss: 1.3503e-045/7 [====================>.........] - ETA: 0s - loss: 1.5808e-047/7 [==============================] - 0s 15ms/step - loss: 1.7795e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.2522e-045/7 [====================>.........] - ETA: 0s - loss: 2.6841e-047/7 [==============================] - 0s 13ms/step - loss: 2.5119e-04
1/7 [===>..........................] - ETA: 0s - loss: 8.4239e-056/7 [========================>.....] - ETA: 0s - loss: 1.2712e-047/7 [==============================] - 0s 12ms/step - loss: 1.2196e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.7504e-044/7 [================>.............] - ETA: 0s - loss: 1.2372e-047/7 [==============================] - ETA: 0s - loss: 1.8060e-047/7 [==============================] - 0s 17ms/step - loss: 1.8060e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.5217e-055/7 [====================>.........] - ETA: 0s - loss: 2.1028e-047/7 [==============================] - 0s 14ms/step - loss: 1.7161e-04
1/7 [===>..........................] - ETA: 0s - loss: 7.6568e-054/7 [================>.............] - ETA: 0s - loss: 7.9253e-057/7 [==============================] - ETA: 0s - loss: 1.0591e-047/7 [==============================] - 0s 17ms/step - loss: 1.0591e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.1334e-044/7 [================>.............] - ETA: 0s - loss: 9.3729e-057/7 [==============================] - 0s 14ms/step - loss: 8.2496e-05
1/7 [===>..........................] - ETA: 0s - loss: 4.0576e-065/7 [====================>.........] - ETA: 0s - loss: 3.5732e-057/7 [==============================] - 0s 12ms/step - loss: 3.8463e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.4078e-044/7 [================>.............] - ETA: 0s - loss: 1.0065e-047/7 [==============================] - ETA: 0s - loss: 1.5056e-047/7 [==============================] - 0s 16ms/step - loss: 1.5056e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.6946e-055/7 [====================>.........] - ETA: 0s - loss: 2.2543e-047/7 [==============================] - 0s 13ms/step - loss: 1.8205e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.6655e-043/7 [===========>..................] - ETA: 0s - loss: 1.6794e-045/7 [====================>.........] - ETA: 0s - loss: 1.9686e-047/7 [==============================] - ETA: 0s - loss: 2.2408e-047/7 [==============================] - 0s 40ms/step - loss: 2.2408e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.2591e-044/7 [================>.............] - ETA: 0s - loss: 2.5843e-046/7 [========================>.....] - ETA: 0s - loss: 2.4910e-047/7 [==============================] - 0s 21ms/step - loss: 2.3790e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.6008e-053/7 [===========>..................] - ETA: 0s - loss: 8.1763e-055/7 [====================>.........] - ETA: 0s - loss: 7.8486e-057/7 [==============================] - ETA: 0s - loss: 6.7435e-057/7 [==============================] - 0s 34ms/step - loss: 6.7435e-05
1/7 [===>..........................] - ETA: 0s - loss: 3.5525e-043/7 [===========>..................] - ETA: 0s - loss: 2.5984e-046/7 [========================>.....] - ETA: 0s - loss: 3.4861e-047/7 [==============================] - 0s 25ms/step - loss: 3.3116e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.2023e-053/7 [===========>..................] - ETA: 0s - loss: 2.4781e-045/7 [====================>.........] - ETA: 0s - loss: 3.5115e-047/7 [==============================] - ETA: 0s - loss: 2.8312e-047/7 [==============================] - 0s 25ms/step - loss: 2.8312e-04
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.00011189685974386521:
Train Score: 0.00010 MSE 0.01018 RMSE
Test Score: 0.00857 MSE 0.09255 RMSE
Deviation Min [3.33242546e-06], Max [0.94163865]
Deviation 99.5th pctile [0.13876405]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1407,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1399,   16]))
Confusion matrix 
[[1399    0]
 [   8    8]]
precision 1.00000, recall 0.50000, f1 0.66667
Time to train: 169186 ms
Saving model models/A1Benchmark/real_2.csv.h5
Total Time to proces all the selected files : 171426 ms
A1Benchmark : Avg precision 1.00000 recall 0.50000 f1 0.66667 time to train 169186.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_2.csv  --epochs 20 --n_iter 3 --patience 3 :: took 177 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_30.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 01:11:30 AM MST
2020-11-30 01:11:37.100235: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 01:11:37.119235: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 01:11:37.120783: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5571bef2f8c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 01:11:37.120839: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 01:11:37.121075: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_30.csv
Shapes: time variant data with labels (1461, 2), full data (1461, 3)
Look back data shapes: lookbackX (1437, 24, 1) lookbackY (1437, 2)
Shapes: Xtrain_full (1149, 24, 1), Ytrain_full (1149, 1), Xtest (288, 24, 1), Ytest (288, 1)
Shapes: Xtrain (1035, 24, 1), Ytrain (1035, 1), Xvalid (114, 24, 1), Yvalid (114, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00153/7 [===========>..................] - ETA: 0s - loss: 8.6867e-045/7 [====================>.........] - ETA: 0s - loss: 8.1414e-047/7 [==============================] - ETA: 0s - loss: 7.1600e-047/7 [==============================] - 0s 33ms/step - loss: 7.1600e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.9576e-043/7 [===========>..................] - ETA: 0s - loss: 3.9617e-045/7 [====================>.........] - ETA: 0s - loss: 4.5698e-047/7 [==============================] - ETA: 0s - loss: 4.8242e-047/7 [==============================] - 0s 27ms/step - loss: 4.8242e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00193/7 [===========>..................] - ETA: 0s - loss: 9.0670e-045/7 [====================>.........] - ETA: 0s - loss: 8.4883e-047/7 [==============================] - ETA: 0s - loss: 7.7972e-047/7 [==============================] - 0s 29ms/step - loss: 7.7972e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.6795e-043/7 [===========>..................] - ETA: 0s - loss: 3.4969e-045/7 [====================>.........] - ETA: 0s - loss: 3.5759e-047/7 [==============================] - ETA: 0s - loss: 3.5715e-047/7 [==============================] - 0s 36ms/step - loss: 3.5715e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.6276e-043/7 [===========>..................] - ETA: 0s - loss: 4.8413e-045/7 [====================>.........] - ETA: 0s - loss: 5.1699e-047/7 [==============================] - ETA: 0s - loss: 5.3300e-047/7 [==============================] - 0s 27ms/step - loss: 5.3300e-04
1/7 [===>..........................] - ETA: 0s - loss: 7.5790e-044/7 [================>.............] - ETA: 0s - loss: 4.7669e-047/7 [==============================] - ETA: 0s - loss: 3.9644e-047/7 [==============================] - 0s 18ms/step - loss: 3.9644e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.6852e-044/7 [================>.............] - ETA: 0s - loss: 3.8968e-047/7 [==============================] - ETA: 0s - loss: 4.7919e-047/7 [==============================] - 0s 19ms/step - loss: 4.7919e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00205/7 [====================>.........] - ETA: 0s - loss: 6.7304e-047/7 [==============================] - 0s 10ms/step - loss: 5.7966e-04
1/7 [===>..........................] - ETA: 0s - loss: 6.6153e-045/7 [====================>.........] - ETA: 0s - loss: 5.7018e-047/7 [==============================] - 0s 13ms/step - loss: 5.5931e-04
1/7 [===>..........................] - ETA: 0s - loss: 6.2363e-045/7 [====================>.........] - ETA: 0s - loss: 6.1064e-047/7 [==============================] - 0s 14ms/step - loss: 6.2355e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00233/7 [===========>..................] - ETA: 0s - loss: 0.00135/7 [====================>.........] - ETA: 0s - loss: 0.00127/7 [==============================] - ETA: 0s - loss: 0.00107/7 [==============================] - 0s 35ms/step - loss: 0.0010
1/7 [===>..........................] - ETA: 0s - loss: 2.2157e-043/7 [===========>..................] - ETA: 0s - loss: 4.0381e-045/7 [====================>.........] - ETA: 0s - loss: 4.9000e-047/7 [==============================] - ETA: 0s - loss: 5.5123e-047/7 [==============================] - 0s 33ms/step - loss: 5.5123e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00193/7 [===========>..................] - ETA: 0s - loss: 8.9388e-045/7 [====================>.........] - ETA: 0s - loss: 0.0012    7/7 [==============================] - ETA: 0s - loss: 0.00127/7 [==============================] - 0s 38ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 4.2034e-043/7 [===========>..................] - ETA: 0s - loss: 3.9003e-045/7 [====================>.........] - ETA: 0s - loss: 3.8717e-047/7 [==============================] - ETA: 0s - loss: 3.7991e-047/7 [==============================] - 0s 34ms/step - loss: 3.7991e-04
1/7 [===>..........................] - ETA: 0s - loss: 6.2685e-043/7 [===========>..................] - ETA: 0s - loss: 6.3408e-045/7 [====================>.........] - ETA: 0s - loss: 6.5577e-047/7 [==============================] - ETA: 0s - loss: 6.7974e-047/7 [==============================] - 0s 25ms/step - loss: 6.7974e-04
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0005276295880321414:
Train Score: 0.00051 MSE 0.02264 RMSE
Test Score: 0.00693 MSE 0.08323 RMSE
Deviation Min [1.51182053e-05], Max [0.65194401]
Deviation 99.5th pctile [0.23830351]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1429,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1428,    9]))
Confusion matrix 
[[1428    0]
 [   1    8]]
precision 1.00000, recall 0.88889, f1 0.94118
Time to train: 410199 ms
Saving model models/A1Benchmark/real_30.csv.h5
Total Time to proces all the selected files : 412699 ms
A1Benchmark : Avg precision 1.00000 recall 0.88889 f1 0.94118 time to train 410199.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_30.csv  --epochs 20 --n_iter 3 --patience 3 :: took 420 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_31.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 01:18:35 AM MST
2020-11-30 01:18:41.636779: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 01:18:41.655271: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 01:18:41.656779: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56545a2d08c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 01:18:41.656834: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 01:18:41.657063: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_31.csv
Shapes: time variant data with labels (1427, 2), full data (1427, 3)
Look back data shapes: lookbackX (1403, 24, 1) lookbackY (1403, 2)
Shapes: Xtrain_full (1122, 24, 1), Ytrain_full (1122, 1), Xtest (281, 24, 1), Ytest (281, 1)
Shapes: Xtrain (1010, 24, 1), Ytrain (1010, 1), Xvalid (112, 24, 1), Yvalid (112, 1)
1/7 [===>..........................] - ETA: 0s - loss: 3.6073e-056/7 [========================>.....] - ETA: 0s - loss: 1.4260e-047/7 [==============================] - 0s 9ms/step - loss: 1.4044e-04
1/7 [===>..........................] - ETA: 0s - loss: 8.2002e-055/7 [====================>.........] - ETA: 0s - loss: 6.5276e-057/7 [==============================] - 0s 11ms/step - loss: 6.0876e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.7239e-045/7 [====================>.........] - ETA: 0s - loss: 6.0029e-057/7 [==============================] - 0s 12ms/step - loss: 5.6349e-05
1/7 [===>..........................] - ETA: 0s - loss: 4.8519e-056/7 [========================>.....] - ETA: 0s - loss: 5.7559e-057/7 [==============================] - 0s 11ms/step - loss: 5.7736e-05
1/7 [===>..........................] - ETA: 0s - loss: 2.5899e-044/7 [================>.............] - ETA: 0s - loss: 2.8111e-047/7 [==============================] - ETA: 0s - loss: 2.8174e-047/7 [==============================] - 0s 16ms/step - loss: 2.8174e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.6263e-053/7 [===========>..................] - ETA: 0s - loss: 3.0151e-055/7 [====================>.........] - ETA: 0s - loss: 1.3463e-047/7 [==============================] - ETA: 0s - loss: 1.7032e-047/7 [==============================] - 0s 26ms/step - loss: 1.7032e-04
1/7 [===>..........................] - ETA: 0s - loss: 7.6071e-053/7 [===========>..................] - ETA: 0s - loss: 8.3871e-055/7 [====================>.........] - ETA: 0s - loss: 6.8780e-057/7 [==============================] - ETA: 0s - loss: 6.5211e-057/7 [==============================] - 0s 26ms/step - loss: 6.5211e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.5751e-043/7 [===========>..................] - ETA: 0s - loss: 1.0040e-045/7 [====================>.........] - ETA: 0s - loss: 7.4438e-057/7 [==============================] - ETA: 0s - loss: 6.9530e-057/7 [==============================] - 0s 34ms/step - loss: 6.9530e-05
1/7 [===>..........................] - ETA: 0s - loss: 7.8705e-053/7 [===========>..................] - ETA: 0s - loss: 6.4480e-055/7 [====================>.........] - ETA: 0s - loss: 7.3310e-057/7 [==============================] - ETA: 0s - loss: 9.2860e-057/7 [==============================] - 0s 28ms/step - loss: 9.2860e-05
1/7 [===>..........................] - ETA: 0s - loss: 5.0576e-043/7 [===========>..................] - ETA: 0s - loss: 5.5301e-045/7 [====================>.........] - ETA: 0s - loss: 5.4602e-047/7 [==============================] - ETA: 0s - loss: 5.4708e-047/7 [==============================] - 0s 36ms/step - loss: 5.4708e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.7656e-054/7 [================>.............] - ETA: 0s - loss: 3.0414e-057/7 [==============================] - 0s 14ms/step - loss: 1.3153e-04
1/7 [===>..........................] - ETA: 0s - loss: 6.8172e-054/7 [================>.............] - ETA: 0s - loss: 6.2522e-057/7 [==============================] - ETA: 0s - loss: 5.3615e-057/7 [==============================] - 0s 16ms/step - loss: 5.3615e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.6212e-044/7 [================>.............] - ETA: 0s - loss: 6.6297e-057/7 [==============================] - ETA: 0s - loss: 5.3880e-057/7 [==============================] - 0s 17ms/step - loss: 5.3880e-05
1/7 [===>..........................] - ETA: 0s - loss: 4.6592e-055/7 [====================>.........] - ETA: 0s - loss: 5.1191e-057/7 [==============================] - 0s 13ms/step - loss: 5.7016e-05
1/7 [===>..........................] - ETA: 0s - loss: 2.4999e-044/7 [================>.............] - ETA: 0s - loss: 2.7044e-047/7 [==============================] - ETA: 0s - loss: 2.7090e-047/7 [==============================] - 0s 17ms/step - loss: 2.7090e-04
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.00011338820695527829:
Train Score: 0.00009 MSE 0.00929 RMSE
Test Score: 0.12932 MSE 0.35962 RMSE
Deviation Min [4.32608346e-05], Max [0.96461833]
Deviation 99.5th pctile [0.65187449]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1395,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1379,   24]))
Confusion matrix 
[[1379    0]
 [  16    8]]
precision 1.00000, recall 0.33333, f1 0.50000
Time to train: 219528 ms
Saving model models/A1Benchmark/real_31.csv.h5
Total Time to proces all the selected files : 221729 ms
A1Benchmark : Avg precision 1.00000 recall 0.33333 f1 0.50000 time to train 219528.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_31.csv  --epochs 20 --n_iter 3 --patience 3 :: took 228 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_32.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 01:22:28 AM MST
2020-11-30 01:22:34.941700: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 01:22:34.960264: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 01:22:34.961878: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d6e20dc8c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 01:22:34.961932: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 01:22:34.962126: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_32.csv
Shapes: time variant data with labels (1427, 2), full data (1427, 3)
Look back data shapes: lookbackX (1403, 24, 1) lookbackY (1403, 2)
Shapes: Xtrain_full (1122, 24, 1), Ytrain_full (1122, 1), Xtest (281, 24, 1), Ytest (281, 1)
Shapes: Xtrain (1010, 24, 1), Ytrain (1010, 1), Xvalid (112, 24, 1), Yvalid (112, 1)
1/7 [===>..........................] - ETA: 0s - loss: 5.8514e-054/7 [================>.............] - ETA: 0s - loss: 5.1795e-057/7 [==============================] - ETA: 0s - loss: 2.9527e-047/7 [==============================] - 0s 15ms/step - loss: 2.9527e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.0925e-045/7 [====================>.........] - ETA: 0s - loss: 9.9746e-057/7 [==============================] - 0s 12ms/step - loss: 9.2596e-05
1/7 [===>..........................] - ETA: 0s - loss: 2.1189e-045/7 [====================>.........] - ETA: 0s - loss: 1.1860e-047/7 [==============================] - 0s 14ms/step - loss: 1.1363e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.0021e-045/7 [====================>.........] - ETA: 0s - loss: 1.2789e-047/7 [==============================] - 0s 11ms/step - loss: 1.4543e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.4648e-044/7 [================>.............] - ETA: 0s - loss: 3.1123e-047/7 [==============================] - ETA: 0s - loss: 2.9920e-047/7 [==============================] - 0s 16ms/step - loss: 2.9920e-04
1/7 [===>..........................] - ETA: 0s - loss: 9.3494e-053/7 [===========>..................] - ETA: 0s - loss: 7.0478e-055/7 [====================>.........] - ETA: 0s - loss: 3.2825e-047/7 [==============================] - ETA: 0s - loss: 3.2572e-047/7 [==============================] - 0s 34ms/step - loss: 3.2572e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.1902e-043/7 [===========>..................] - ETA: 0s - loss: 1.2771e-045/7 [====================>.........] - ETA: 0s - loss: 1.0930e-047/7 [==============================] - ETA: 0s - loss: 1.0161e-047/7 [==============================] - 0s 26ms/step - loss: 1.0161e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.3220e-043/7 [===========>..................] - ETA: 0s - loss: 1.5139e-045/7 [====================>.........] - ETA: 0s - loss: 1.1198e-047/7 [==============================] - ETA: 0s - loss: 1.0590e-047/7 [==============================] - 0s 27ms/step - loss: 1.0590e-04
1/7 [===>..........................] - ETA: 0s - loss: 9.3078e-053/7 [===========>..................] - ETA: 0s - loss: 7.4755e-055/7 [====================>.........] - ETA: 0s - loss: 1.3563e-047/7 [==============================] - ETA: 0s - loss: 1.5570e-047/7 [==============================] - 0s 36ms/step - loss: 1.5570e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.5056e-042/7 [=======>......................] - ETA: 0s - loss: 2.9604e-044/7 [================>.............] - ETA: 0s - loss: 2.8685e-046/7 [========================>.....] - ETA: 0s - loss: 2.8542e-047/7 [==============================] - 0s 31ms/step - loss: 2.7585e-04
1/7 [===>..........................] - ETA: 0s - loss: 6.3883e-053/7 [===========>..................] - ETA: 0s - loss: 5.2583e-055/7 [====================>.........] - ETA: 0s - loss: 3.8286e-047/7 [==============================] - ETA: 0s - loss: 3.7131e-047/7 [==============================] - 0s 22ms/step - loss: 3.7131e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.1914e-043/7 [===========>..................] - ETA: 0s - loss: 1.2682e-045/7 [====================>.........] - ETA: 0s - loss: 1.1227e-047/7 [==============================] - ETA: 0s - loss: 1.0506e-047/7 [==============================] - 0s 29ms/step - loss: 1.0506e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.2659e-043/7 [===========>..................] - ETA: 0s - loss: 1.6552e-045/7 [====================>.........] - ETA: 0s - loss: 1.2862e-047/7 [==============================] - 0s 30ms/step - loss: 1.2247e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.0227e-043/7 [===========>..................] - ETA: 0s - loss: 8.7282e-055/7 [====================>.........] - ETA: 0s - loss: 1.3375e-047/7 [==============================] - 0s 23ms/step - loss: 1.5261e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.6134e-043/7 [===========>..................] - ETA: 0s - loss: 2.7862e-045/7 [====================>.........] - ETA: 0s - loss: 2.7266e-047/7 [==============================] - ETA: 0s - loss: 2.7320e-047/7 [==============================] - 0s 23ms/step - loss: 2.7320e-04
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.000189226315706037:
Train Score: 0.00021 MSE 0.01449 RMSE
Test Score: 0.13920 MSE 0.37309 RMSE
Deviation Min [3.7609798e-05], Max [0.92483936]
Deviation 99.5th pctile [0.60941003]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1395,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1356,   47]))
Confusion matrix 
[[1356    0]
 [  39    8]]
precision 1.00000, recall 0.17021, f1 0.29091
Time to train: 385512 ms
Saving model models/A1Benchmark/real_32.csv.h5
Total Time to proces all the selected files : 387638 ms
A1Benchmark : Avg precision 1.00000 recall 0.17021 f1 0.29091 time to train 385512.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_32.csv  --epochs 20 --n_iter 3 --patience 3 :: took 394 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_33.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 01:29:08 AM MST
2020-11-30 01:29:14.248991: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 01:29:14.267253: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 01:29:14.268518: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5609c90238c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 01:29:14.268559: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 01:29:14.268742: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_33.csv
Shapes: time variant data with labels (1439, 2), full data (1439, 3)
Look back data shapes: lookbackX (1415, 24, 1) lookbackY (1415, 2)
Shapes: Xtrain_full (1132, 24, 1), Ytrain_full (1132, 1), Xtest (283, 24, 1), Ytest (283, 1)
Shapes: Xtrain (1019, 24, 1), Ytrain (1019, 1), Xvalid (113, 24, 1), Yvalid (113, 1)
1/7 [===>..........................] - ETA: 0s - loss: 1.4460e-043/7 [===========>..................] - ETA: 0s - loss: 2.5583e-045/7 [====================>.........] - ETA: 0s - loss: 2.3019e-047/7 [==============================] - ETA: 0s - loss: 2.2937e-047/7 [==============================] - 0s 31ms/step - loss: 2.2937e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.8929e-043/7 [===========>..................] - ETA: 0s - loss: 5.3668e-045/7 [====================>.........] - ETA: 0s - loss: 5.2577e-047/7 [==============================] - ETA: 0s - loss: 5.0312e-047/7 [==============================] - 0s 22ms/step - loss: 5.0312e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.7223e-043/7 [===========>..................] - ETA: 0s - loss: 3.5533e-046/7 [========================>.....] - ETA: 0s - loss: 2.8922e-047/7 [==============================] - 0s 20ms/step - loss: 2.8148e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.5614e-043/7 [===========>..................] - ETA: 0s - loss: 2.8178e-045/7 [====================>.........] - ETA: 0s - loss: 2.7806e-047/7 [==============================] - ETA: 0s - loss: 2.5278e-047/7 [==============================] - 0s 24ms/step - loss: 2.5278e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.7865e-043/7 [===========>..................] - ETA: 0s - loss: 2.1757e-045/7 [====================>.........] - ETA: 0s - loss: 2.0823e-047/7 [==============================] - ETA: 0s - loss: 2.1430e-047/7 [==============================] - 0s 29ms/step - loss: 2.1430e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.5217e-043/7 [===========>..................] - ETA: 0s - loss: 2.4737e-045/7 [====================>.........] - ETA: 0s - loss: 2.2276e-047/7 [==============================] - ETA: 0s - loss: 2.2222e-047/7 [==============================] - 0s 25ms/step - loss: 2.2222e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.3541e-043/7 [===========>..................] - ETA: 0s - loss: 4.1654e-045/7 [====================>.........] - ETA: 0s - loss: 4.0278e-047/7 [==============================] - ETA: 0s - loss: 3.8989e-047/7 [==============================] - 0s 25ms/step - loss: 3.8989e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.0608e-043/7 [===========>..................] - ETA: 0s - loss: 3.9065e-045/7 [====================>.........] - ETA: 0s - loss: 3.3811e-047/7 [==============================] - ETA: 0s - loss: 3.0111e-047/7 [==============================] - 0s 36ms/step - loss: 3.0111e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.6209e-043/7 [===========>..................] - ETA: 0s - loss: 2.8200e-045/7 [====================>.........] - ETA: 0s - loss: 2.7802e-047/7 [==============================] - ETA: 0s - loss: 2.5018e-047/7 [==============================] - 0s 24ms/step - loss: 2.5018e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.6514e-043/7 [===========>..................] - ETA: 0s - loss: 2.2348e-045/7 [====================>.........] - ETA: 0s - loss: 2.2191e-047/7 [==============================] - ETA: 0s - loss: 2.2705e-047/7 [==============================] - 0s 24ms/step - loss: 2.2705e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.4871e-045/7 [====================>.........] - ETA: 0s - loss: 2.3569e-047/7 [==============================] - 0s 12ms/step - loss: 2.3445e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.3661e-045/7 [====================>.........] - ETA: 0s - loss: 4.7983e-047/7 [==============================] - 0s 12ms/step - loss: 4.5932e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.3095e-045/7 [====================>.........] - ETA: 0s - loss: 2.8145e-047/7 [==============================] - 0s 13ms/step - loss: 2.5516e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.8715e-044/7 [================>.............] - ETA: 0s - loss: 2.7457e-047/7 [==============================] - ETA: 0s - loss: 2.3510e-047/7 [==============================] - 0s 16ms/step - loss: 2.3510e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.8266e-044/7 [================>.............] - ETA: 0s - loss: 2.0698e-047/7 [==============================] - ETA: 0s - loss: 2.1207e-047/7 [==============================] - 0s 15ms/step - loss: 2.1207e-04
Best parameters {'n_units': 72, 'n_hidden': 2} best score 0.00027808904997073114:
Train Score: 0.00031 MSE 0.01765 RMSE
Test Score: 0.00367 MSE 0.06060 RMSE
Deviation Min [3.52631153e-06], Max [0.96797262]
Deviation 99.5th pctile [0.05973902]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1407,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1413,    2]))
Confusion matrix 
[[1407    6]
 [   0    2]]
precision 0.25000, recall 1.00000, f1 0.40000
Time to train: 217299 ms
Saving model models/A1Benchmark/real_33.csv.h5
Total Time to proces all the selected files : 221049 ms
A1Benchmark : Avg precision 0.25000 recall 1.00000 f1 0.40000 time to train 217299.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_33.csv  --epochs 20 --n_iter 3 --patience 3 :: took 227 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_34.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 01:33:00 AM MST
2020-11-30 01:33:06.940682: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 01:33:06.959272: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 01:33:06.960891: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5562b591cc60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 01:33:06.960948: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 01:33:06.961092: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_34.csv
Shapes: time variant data with labels (1427, 2), full data (1427, 3)
Look back data shapes: lookbackX (1403, 24, 1) lookbackY (1403, 2)
Shapes: Xtrain_full (1122, 24, 1), Ytrain_full (1122, 1), Xtest (281, 24, 1), Ytest (281, 1)
Shapes: Xtrain (1010, 24, 1), Ytrain (1010, 1), Xvalid (112, 24, 1), Yvalid (112, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00295/7 [====================>.........] - ETA: 0s - loss: 0.00317/7 [==============================] - 0s 13ms/step - loss: 0.0031
1/7 [===>..........................] - ETA: 0s - loss: 0.00574/7 [================>.............] - ETA: 0s - loss: 0.00327/7 [==============================] - ETA: 0s - loss: 0.00307/7 [==============================] - 0s 16ms/step - loss: 0.0030
1/7 [===>..........................] - ETA: 0s - loss: 0.00215/7 [====================>.........] - ETA: 0s - loss: 0.00287/7 [==============================] - 0s 13ms/step - loss: 0.0026
1/7 [===>..........................] - ETA: 0s - loss: 0.00115/7 [====================>.........] - ETA: 0s - loss: 0.00127/7 [==============================] - 0s 13ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 1.0000e-035/7 [====================>.........] - ETA: 0s - loss: 0.0040    7/7 [==============================] - 0s 12ms/step - loss: 0.0034
1/7 [===>..........................] - ETA: 0s - loss: 0.00514/7 [================>.............] - ETA: 0s - loss: 0.00377/7 [==============================] - ETA: 0s - loss: 0.00327/7 [==============================] - 0s 16ms/step - loss: 0.0032
1/7 [===>..........................] - ETA: 0s - loss: 0.00135/7 [====================>.........] - ETA: 0s - loss: 0.00227/7 [==============================] - 0s 11ms/step - loss: 0.0019
1/7 [===>..........................] - ETA: 0s - loss: 0.00155/7 [====================>.........] - ETA: 0s - loss: 0.00177/7 [==============================] - 0s 12ms/step - loss: 0.0016
1/7 [===>..........................] - ETA: 0s - loss: 0.00594/7 [================>.............] - ETA: 0s - loss: 0.00557/7 [==============================] - ETA: 0s - loss: 0.00567/7 [==============================] - 0s 16ms/step - loss: 0.0056
1/7 [===>..........................] - ETA: 0s - loss: 0.00155/7 [====================>.........] - ETA: 0s - loss: 0.00397/7 [==============================] - 0s 12ms/step - loss: 0.0035
1/7 [===>..........................] - ETA: 0s - loss: 0.00233/7 [===========>..................] - ETA: 0s - loss: 0.00295/7 [====================>.........] - ETA: 0s - loss: 0.00307/7 [==============================] - ETA: 0s - loss: 0.00277/7 [==============================] - 0s 32ms/step - loss: 0.0027
1/7 [===>..........................] - ETA: 0s - loss: 0.00533/7 [===========>..................] - ETA: 0s - loss: 0.00335/7 [====================>.........] - ETA: 0s - loss: 0.00237/7 [==============================] - ETA: 0s - loss: 0.00237/7 [==============================] - 0s 25ms/step - loss: 0.0023
1/7 [===>..........................] - ETA: 0s - loss: 0.00453/7 [===========>..................] - ETA: 0s - loss: 0.00465/7 [====================>.........] - ETA: 0s - loss: 0.00447/7 [==============================] - ETA: 0s - loss: 0.00467/7 [==============================] - 0s 24ms/step - loss: 0.0046
1/7 [===>..........................] - ETA: 0s - loss: 0.00953/7 [===========>..................] - ETA: 0s - loss: 0.00855/7 [====================>.........] - ETA: 0s - loss: 0.00657/7 [==============================] - ETA: 0s - loss: 0.00687/7 [==============================] - 0s 31ms/step - loss: 0.0068
1/7 [===>..........................] - ETA: 0s - loss: 0.00312/7 [=======>......................] - ETA: 0s - loss: 0.00473/7 [===========>..................] - ETA: 0s - loss: 0.01025/7 [====================>.........] - ETA: 0s - loss: 0.00937/7 [==============================] - ETA: 0s - loss: 0.00807/7 [==============================] - 0s 41ms/step - loss: 0.0080
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.002658730768598616:
Train Score: 0.00310 MSE 0.05572 RMSE
Test Score: 0.10575 MSE 0.32519 RMSE
Deviation Min [1.5024227e-05], Max [3.58869816]
Deviation 99.5th pctile [0.44253473]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1395,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1396,    7]))
Confusion matrix 
[[1391    5]
 [   4    3]]
precision 0.37500, recall 0.42857, f1 0.40000
Time to train: 498352 ms
Saving model models/A1Benchmark/real_34.csv.h5
Total Time to proces all the selected files : 500569 ms
A1Benchmark : Avg precision 0.37500 recall 0.42857 f1 0.40000 time to train 498352.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_34.csv  --epochs 20 --n_iter 3 --patience 3 :: took 508 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_35.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 01:41:33 AM MST
2020-11-30 01:41:39.571421: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 01:41:39.591205: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 01:41:39.592639: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55c865826c60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 01:41:39.592691: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 01:41:39.592900: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_35.csv
Shapes: time variant data with labels (1427, 2), full data (1427, 3)
Look back data shapes: lookbackX (1403, 24, 1) lookbackY (1403, 2)
Shapes: Xtrain_full (1122, 24, 1), Ytrain_full (1122, 1), Xtest (281, 24, 1), Ytest (281, 1)
Shapes: Xtrain (1010, 24, 1), Ytrain (1010, 1), Xvalid (112, 24, 1), Yvalid (112, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.03023/7 [===========>..................] - ETA: 0s - loss: 0.02925/7 [====================>.........] - ETA: 0s - loss: 0.02937/7 [==============================] - 0s 23ms/step - loss: 0.0289
1/7 [===>..........................] - ETA: 0s - loss: 0.02833/7 [===========>..................] - ETA: 0s - loss: 0.02235/7 [====================>.........] - ETA: 0s - loss: 0.02977/7 [==============================] - ETA: 0s - loss: 0.02887/7 [==============================] - 0s 26ms/step - loss: 0.0288
1/7 [===>..........................] - ETA: 0s - loss: 0.03283/7 [===========>..................] - ETA: 0s - loss: 0.03015/7 [====================>.........] - ETA: 0s - loss: 0.02677/7 [==============================] - ETA: 0s - loss: 0.02617/7 [==============================] - 0s 32ms/step - loss: 0.0261
1/7 [===>..........................] - ETA: 0s - loss: 0.01623/7 [===========>..................] - ETA: 0s - loss: 0.01865/7 [====================>.........] - ETA: 0s - loss: 0.02107/7 [==============================] - ETA: 0s - loss: 0.02927/7 [==============================] - 0s 34ms/step - loss: 0.0292
1/7 [===>..........................] - ETA: 0s - loss: 0.03943/7 [===========>..................] - ETA: 0s - loss: 0.02325/7 [====================>.........] - ETA: 0s - loss: 0.02037/7 [==============================] - ETA: 0s - loss: 0.01917/7 [==============================] - 0s 23ms/step - loss: 0.0191
1/7 [===>..........................] - ETA: 0s - loss: 0.03413/7 [===========>..................] - ETA: 0s - loss: 0.03295/7 [====================>.........] - ETA: 0s - loss: 0.03277/7 [==============================] - ETA: 0s - loss: 0.03197/7 [==============================] - 0s 29ms/step - loss: 0.0319
1/7 [===>..........................] - ETA: 0s - loss: 0.03023/7 [===========>..................] - ETA: 0s - loss: 0.02355/7 [====================>.........] - ETA: 0s - loss: 0.03237/7 [==============================] - ETA: 0s - loss: 0.03147/7 [==============================] - 0s 30ms/step - loss: 0.0314
1/7 [===>..........................] - ETA: 0s - loss: 0.03343/7 [===========>..................] - ETA: 0s - loss: 0.03105/7 [====================>.........] - ETA: 0s - loss: 0.02737/7 [==============================] - ETA: 0s - loss: 0.02677/7 [==============================] - 0s 23ms/step - loss: 0.0267
1/7 [===>..........................] - ETA: 0s - loss: 0.01373/7 [===========>..................] - ETA: 0s - loss: 0.01905/7 [====================>.........] - ETA: 0s - loss: 0.02187/7 [==============================] - ETA: 0s - loss: 0.03057/7 [==============================] - 0s 29ms/step - loss: 0.0305
1/7 [===>..........................] - ETA: 0s - loss: 0.06403/7 [===========>..................] - ETA: 0s - loss: 0.03405/7 [====================>.........] - ETA: 0s - loss: 0.02997/7 [==============================] - ETA: 0s - loss: 0.02767/7 [==============================] - 0s 25ms/step - loss: 0.0276
1/7 [===>..........................] - ETA: 0s - loss: 0.02406/7 [========================>.....] - ETA: 0s - loss: 0.02447/7 [==============================] - 0s 10ms/step - loss: 0.0242
1/7 [===>..........................] - ETA: 0s - loss: 0.01725/7 [====================>.........] - ETA: 0s - loss: 0.01887/7 [==============================] - 0s 12ms/step - loss: 0.0185
1/7 [===>..........................] - ETA: 0s - loss: 0.01924/7 [================>.............] - ETA: 0s - loss: 0.01717/7 [==============================] - 0s 14ms/step - loss: 0.0161
1/7 [===>..........................] - ETA: 0s - loss: 0.01344/7 [================>.............] - ETA: 0s - loss: 0.01617/7 [==============================] - ETA: 0s - loss: 0.02257/7 [==============================] - 0s 15ms/step - loss: 0.0225
1/7 [===>..........................] - ETA: 0s - loss: 0.03234/7 [================>.............] - ETA: 0s - loss: 0.01997/7 [==============================] - ETA: 0s - loss: 0.01737/7 [==============================] - 0s 15ms/step - loss: 0.0173
/s/chopin/k/grad/santanud/.conda/envs/cs533tp/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 due to no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.01970469057559967:
Train Score: 0.01864 MSE 0.13651 RMSE
Test Score: 0.01065 MSE 0.10318 RMSE
Deviation Min [0.0003473], Max [0.66117971]
Deviation 99.5th pctile [0.464957]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1395,    8]))
Actual is_anomaly labels in data (array([0]), array([1403]))
Confusion matrix 
[[1395    8]
 [   0    0]]
precision 0.00000, recall 0.00000, f1 0.00000
Time to train: 363721 ms
Saving model models/A1Benchmark/real_35.csv.h5
Total Time to proces all the selected files : 365963 ms
A1Benchmark : Avg precision 0.00000 recall 0.00000 f1 0.00000 time to train 363721.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_35.csv  --epochs 20 --n_iter 3 --patience 3 :: took 372 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_36.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 01:47:50 AM MST
2020-11-30 01:47:57.232392: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 01:47:57.251339: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 01:47:57.252903: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55c262eab8c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 01:47:57.252957: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 01:47:57.253181: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_36.csv
Shapes: time variant data with labels (1461, 2), full data (1461, 3)
Look back data shapes: lookbackX (1437, 24, 1) lookbackY (1437, 2)
Shapes: Xtrain_full (1149, 24, 1), Ytrain_full (1149, 1), Xtest (288, 24, 1), Ytest (288, 1)
Shapes: Xtrain (1035, 24, 1), Ytrain (1035, 1), Xvalid (114, 24, 1), Yvalid (114, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00115/7 [====================>.........] - ETA: 0s - loss: 8.7212e-047/7 [==============================] - 0s 13ms/step - loss: 8.7531e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00155/7 [====================>.........] - ETA: 0s - loss: 0.01517/7 [==============================] - 0s 13ms/step - loss: 0.0121
1/7 [===>..........................] - ETA: 0s - loss: 0.00125/7 [====================>.........] - ETA: 0s - loss: 0.00297/7 [==============================] - 0s 13ms/step - loss: 0.0026
1/7 [===>..........................] - ETA: 0s - loss: 0.00225/7 [====================>.........] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 13ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 0.00144/7 [================>.............] - ETA: 0s - loss: 0.00167/7 [==============================] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 17ms/step - loss: 0.0018
1/7 [===>..........................] - ETA: 0s - loss: 0.00123/7 [===========>..................] - ETA: 0s - loss: 0.00105/7 [====================>.........] - ETA: 0s - loss: 0.00117/7 [==============================] - ETA: 0s - loss: 0.00117/7 [==============================] - 0s 34ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 0.00213/7 [===========>..................] - ETA: 0s - loss: 0.02715/7 [====================>.........] - ETA: 0s - loss: 0.01727/7 [==============================] - ETA: 0s - loss: 0.01377/7 [==============================] - 0s 30ms/step - loss: 0.0137
1/7 [===>..........................] - ETA: 0s - loss: 0.00153/7 [===========>..................] - ETA: 0s - loss: 0.00485/7 [====================>.........] - ETA: 0s - loss: 0.00347/7 [==============================] - ETA: 0s - loss: 0.00307/7 [==============================] - 0s 32ms/step - loss: 0.0030
1/7 [===>..........................] - ETA: 0s - loss: 0.00123/7 [===========>..................] - ETA: 0s - loss: 0.00125/7 [====================>.........] - ETA: 0s - loss: 0.00137/7 [==============================] - ETA: 0s - loss: 0.00157/7 [==============================] - 0s 30ms/step - loss: 0.0015
1/7 [===>..........................] - ETA: 0s - loss: 0.00203/7 [===========>..................] - ETA: 0s - loss: 0.00205/7 [====================>.........] - ETA: 0s - loss: 0.00217/7 [==============================] - ETA: 0s - loss: 0.00217/7 [==============================] - 0s 29ms/step - loss: 0.0021
1/7 [===>..........................] - ETA: 0s - loss: 0.00164/7 [================>.............] - ETA: 0s - loss: 0.00127/7 [==============================] - ETA: 0s - loss: 0.00137/7 [==============================] - 0s 17ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 0.00144/7 [================>.............] - ETA: 0s - loss: 0.01777/7 [==============================] - ETA: 0s - loss: 0.01157/7 [==============================] - 0s 15ms/step - loss: 0.0115
1/7 [===>..........................] - ETA: 0s - loss: 0.00124/7 [================>.............] - ETA: 0s - loss: 0.00337/7 [==============================] - ETA: 0s - loss: 0.00257/7 [==============================] - 0s 15ms/step - loss: 0.0025
1/7 [===>..........................] - ETA: 0s - loss: 0.00185/7 [====================>.........] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 12ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 0.00174/7 [================>.............] - ETA: 0s - loss: 0.00177/7 [==============================] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 16ms/step - loss: 0.0018
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.003805842390283942:
Train Score: 0.00210 MSE 0.04586 RMSE
Test Score: 0.00071 MSE 0.02660 RMSE
Deviation Min [3.24082642e-05], Max [0.75653738]
Deviation 99.5th pctile [0.21143849]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1429,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1432,    5]))
Confusion matrix 
[[1429    3]
 [   0    5]]
precision 0.62500, recall 1.00000, f1 0.76923
Time to train: 266539 ms
Saving model models/A1Benchmark/real_36.csv.h5
Total Time to proces all the selected files : 269011 ms
A1Benchmark : Avg precision 0.62500 recall 1.00000 f1 0.76923 time to train 266539.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_36.csv  --epochs 20 --n_iter 3 --patience 3 :: took 276 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_37.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 01:52:31 AM MST
2020-11-30 01:52:37.776981: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 01:52:37.795314: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 01:52:37.796809: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55926c710c60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 01:52:37.796875: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 01:52:37.797077: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_37.csv
Shapes: time variant data with labels (1434, 2), full data (1434, 3)
Look back data shapes: lookbackX (1410, 24, 1) lookbackY (1410, 2)
Shapes: Xtrain_full (1128, 24, 1), Ytrain_full (1128, 1), Xtest (282, 24, 1), Ytest (282, 1)
Shapes: Xtrain (1016, 24, 1), Ytrain (1016, 1), Xvalid (112, 24, 1), Yvalid (112, 1)
1/7 [===>..........................] - ETA: 0s - loss: 4.7815e-045/7 [====================>.........] - ETA: 0s - loss: 0.0090    7/7 [==============================] - 0s 13ms/step - loss: 0.0078
1/7 [===>..........................] - ETA: 0s - loss: 0.01304/7 [================>.............] - ETA: 0s - loss: 0.01487/7 [==============================] - ETA: 0s - loss: 0.00997/7 [==============================] - 0s 17ms/step - loss: 0.0099
1/7 [===>..........................] - ETA: 0s - loss: 0.00155/7 [====================>.........] - ETA: 0s - loss: 0.00247/7 [==============================] - 0s 14ms/step - loss: 0.0029
1/7 [===>..........................] - ETA: 0s - loss: 0.00854/7 [================>.............] - ETA: 0s - loss: 0.00637/7 [==============================] - ETA: 0s - loss: 0.00707/7 [==============================] - 0s 18ms/step - loss: 0.0070
1/7 [===>..........................] - ETA: 0s - loss: 0.00544/7 [================>.............] - ETA: 0s - loss: 0.00636/7 [========================>.....] - ETA: 0s - loss: 0.00887/7 [==============================] - 0s 17ms/step - loss: 0.0085
1/7 [===>..........................] - ETA: 0s - loss: 0.00204/7 [================>.............] - ETA: 0s - loss: 0.00897/7 [==============================] - 0s 14ms/step - loss: 0.0086
1/7 [===>..........................] - ETA: 0s - loss: 0.01445/7 [====================>.........] - ETA: 0s - loss: 0.01237/7 [==============================] - 0s 14ms/step - loss: 0.0101
1/7 [===>..........................] - ETA: 0s - loss: 9.2320e-044/7 [================>.............] - ETA: 0s - loss: 0.0018    7/7 [==============================] - ETA: 0s - loss: 0.00247/7 [==============================] - 0s 17ms/step - loss: 0.0024
1/7 [===>..........................] - ETA: 0s - loss: 0.00774/7 [================>.............] - ETA: 0s - loss: 0.00607/7 [==============================] - ETA: 0s - loss: 0.00667/7 [==============================] - 0s 19ms/step - loss: 0.0066
1/7 [===>..........................] - ETA: 0s - loss: 0.00684/7 [================>.............] - ETA: 0s - loss: 0.00787/7 [==============================] - ETA: 0s - loss: 0.01007/7 [==============================] - 0s 18ms/step - loss: 0.0100
1/7 [===>..........................] - ETA: 0s - loss: 0.00126/7 [========================>.....] - ETA: 0s - loss: 0.01047/7 [==============================] - 0s 10ms/step - loss: 0.0099
1/7 [===>..........................] - ETA: 0s - loss: 0.01535/7 [====================>.........] - ETA: 0s - loss: 0.01907/7 [==============================] - 0s 15ms/step - loss: 0.0158
1/7 [===>..........................] - ETA: 0s - loss: 0.00145/7 [====================>.........] - ETA: 0s - loss: 0.00247/7 [==============================] - 0s 12ms/step - loss: 0.0030
1/7 [===>..........................] - ETA: 0s - loss: 0.00776/7 [========================>.....] - ETA: 0s - loss: 0.00647/7 [==============================] - 0s 12ms/step - loss: 0.0067
1/7 [===>..........................] - ETA: 0s - loss: 0.00565/7 [====================>.........] - ETA: 0s - loss: 0.00717/7 [==============================] - 0s 12ms/step - loss: 0.0085
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.007201415579766035:
Train Score: 0.00985 MSE 0.09923 RMSE
Test Score: 0.02274 MSE 0.15078 RMSE
Deviation Min [0.00014813], Max [0.59957817]
Deviation 99.5th pctile [0.40874602]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1402,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1376,   34]))
Confusion matrix 
[[1371    5]
 [  31    3]]
precision 0.37500, recall 0.08824, f1 0.14286
Time to train: 288355 ms
Saving model models/A1Benchmark/real_37.csv.h5
Total Time to proces all the selected files : 290556 ms
A1Benchmark : Avg precision 0.37500 recall 0.08824 f1 0.14286 time to train 288355.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_37.csv  --epochs 20 --n_iter 3 --patience 3 :: took 297 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_38.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 01:57:33 AM MST
2020-11-30 01:57:40.336750: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 01:57:40.355230: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 01:57:40.356692: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5559aa9e08c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 01:57:40.356744: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 01:57:40.356960: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_38.csv
Shapes: time variant data with labels (1427, 2), full data (1427, 3)
Look back data shapes: lookbackX (1403, 24, 1) lookbackY (1403, 2)
Shapes: Xtrain_full (1122, 24, 1), Ytrain_full (1122, 1), Xtest (281, 24, 1), Ytest (281, 1)
Shapes: Xtrain (1010, 24, 1), Ytrain (1010, 1), Xvalid (112, 24, 1), Yvalid (112, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00245/7 [====================>.........] - ETA: 0s - loss: 0.00337/7 [==============================] - 0s 14ms/step - loss: 0.0032
1/7 [===>..........................] - ETA: 0s - loss: 0.00336/7 [========================>.....] - ETA: 0s - loss: 0.00217/7 [==============================] - 0s 11ms/step - loss: 0.0021
1/7 [===>..........................] - ETA: 0s - loss: 0.00375/7 [====================>.........] - ETA: 0s - loss: 0.00987/7 [==============================] - 0s 14ms/step - loss: 0.0083
1/7 [===>..........................] - ETA: 0s - loss: 0.00284/7 [================>.............] - ETA: 0s - loss: 0.00357/7 [==============================] - 0s 15ms/step - loss: 0.0038
1/7 [===>..........................] - ETA: 0s - loss: 0.00334/7 [================>.............] - ETA: 0s - loss: 0.00387/7 [==============================] - ETA: 0s - loss: 0.00377/7 [==============================] - 0s 15ms/step - loss: 0.0037
1/7 [===>..........................] - ETA: 0s - loss: 0.00663/7 [===========>..................] - ETA: 0s - loss: 0.00515/7 [====================>.........] - ETA: 0s - loss: 0.00687/7 [==============================] - ETA: 0s - loss: 0.00697/7 [==============================] - 0s 26ms/step - loss: 0.0069
1/7 [===>..........................] - ETA: 0s - loss: 0.00523/7 [===========>..................] - ETA: 0s - loss: 0.00555/7 [====================>.........] - ETA: 0s - loss: 0.00597/7 [==============================] - ETA: 0s - loss: 0.00567/7 [==============================] - 0s 27ms/step - loss: 0.0056
1/7 [===>..........................] - ETA: 0s - loss: 0.00483/7 [===========>..................] - ETA: 0s - loss: 0.00525/7 [====================>.........] - ETA: 0s - loss: 0.00557/7 [==============================] - ETA: 0s - loss: 0.00517/7 [==============================] - 0s 31ms/step - loss: 0.0051
1/7 [===>..........................] - ETA: 0s - loss: 0.00583/7 [===========>..................] - ETA: 0s - loss: 0.00325/7 [====================>.........] - ETA: 0s - loss: 0.00387/7 [==============================] - ETA: 0s - loss: 0.00397/7 [==============================] - 0s 33ms/step - loss: 0.0039
1/7 [===>..........................] - ETA: 0s - loss: 0.00243/7 [===========>..................] - ETA: 0s - loss: 0.00495/7 [====================>.........] - ETA: 0s - loss: 0.00467/7 [==============================] - ETA: 0s - loss: 0.00397/7 [==============================] - 0s 39ms/step - loss: 0.0039
1/7 [===>..........................] - ETA: 0s - loss: 0.00255/7 [====================>.........] - ETA: 0s - loss: 0.00277/7 [==============================] - 0s 15ms/step - loss: 0.0027
1/7 [===>..........................] - ETA: 0s - loss: 0.00234/7 [================>.............] - ETA: 0s - loss: 0.00437/7 [==============================] - ETA: 0s - loss: 0.00407/7 [==============================] - 0s 15ms/step - loss: 0.0040
1/7 [===>..........................] - ETA: 0s - loss: 0.00345/7 [====================>.........] - ETA: 0s - loss: 0.00417/7 [==============================] - 0s 12ms/step - loss: 0.0038
1/7 [===>..........................] - ETA: 0s - loss: 0.00365/7 [====================>.........] - ETA: 0s - loss: 0.00297/7 [==============================] - 0s 13ms/step - loss: 0.0030
1/7 [===>..........................] - ETA: 0s - loss: 0.00304/7 [================>.............] - ETA: 0s - loss: 0.00427/7 [==============================] - ETA: 0s - loss: 0.00377/7 [==============================] - 0s 16ms/step - loss: 0.0037
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.003441829700022936:
Train Score: 0.00354 MSE 0.05952 RMSE
Test Score: 0.00339 MSE 0.05825 RMSE
Deviation Min [9.48673003e-05], Max [0.38993808]
Deviation 99.5th pctile [0.17250542]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1395,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1394,    9]))
Confusion matrix 
[[1390    4]
 [   5    4]]
precision 0.50000, recall 0.44444, f1 0.47059
Time to train: 488692 ms
Saving model models/A1Benchmark/real_38.csv.h5
Total Time to proces all the selected files : 490560 ms
A1Benchmark : Avg precision 0.50000 recall 0.44444 f1 0.47059 time to train 488692.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_38.csv  --epochs 20 --n_iter 3 --patience 3 :: took 498 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_39.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 02:05:56 AM MST
2020-11-30 02:06:02.613551: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 02:06:02.620393: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 02:06:02.621121: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x560b5408dcf0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 02:06:02.621142: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 02:06:02.621238: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_39.csv
Shapes: time variant data with labels (1427, 2), full data (1427, 3)
Look back data shapes: lookbackX (1403, 24, 1) lookbackY (1403, 2)
Shapes: Xtrain_full (1122, 24, 1), Ytrain_full (1122, 1), Xtest (281, 24, 1), Ytest (281, 1)
Shapes: Xtrain (1010, 24, 1), Ytrain (1010, 1), Xvalid (112, 24, 1), Yvalid (112, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00125/7 [====================>.........] - ETA: 0s - loss: 0.00117/7 [==============================] - 0s 13ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 0.00164/7 [================>.............] - ETA: 0s - loss: 0.00127/7 [==============================] - ETA: 0s - loss: 0.00127/7 [==============================] - 0s 17ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 0.02924/7 [================>.............] - ETA: 0s - loss: 0.01527/7 [==============================] - ETA: 0s - loss: 0.01067/7 [==============================] - 0s 16ms/step - loss: 0.0106
1/7 [===>..........................] - ETA: 0s - loss: 0.00185/7 [====================>.........] - ETA: 0s - loss: 0.00127/7 [==============================] - 0s 14ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 0.00105/7 [====================>.........] - ETA: 0s - loss: 0.00137/7 [==============================] - 0s 13ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 0.00145/7 [====================>.........] - ETA: 0s - loss: 0.00127/7 [==============================] - 0s 12ms/step - loss: 0.0014
1/7 [===>..........................] - ETA: 0s - loss: 7.5779e-045/7 [====================>.........] - ETA: 0s - loss: 9.9787e-047/7 [==============================] - 0s 11ms/step - loss: 9.2272e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.02144/7 [================>.............] - ETA: 0s - loss: 0.02127/7 [==============================] - 0s 14ms/step - loss: 0.0140
1/7 [===>..........................] - ETA: 0s - loss: 0.00144/7 [================>.............] - ETA: 0s - loss: 0.00157/7 [==============================] - ETA: 0s - loss: 0.00157/7 [==============================] - 0s 16ms/step - loss: 0.0015
1/7 [===>..........................] - ETA: 0s - loss: 8.6832e-045/7 [====================>.........] - ETA: 0s - loss: 0.0012    7/7 [==============================] - 0s 11ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 5.3336e-043/7 [===========>..................] - ETA: 0s - loss: 0.0012    5/7 [====================>.........] - ETA: 0s - loss: 9.6795e-047/7 [==============================] - ETA: 0s - loss: 0.0010    7/7 [==============================] - 0s 33ms/step - loss: 0.0010
1/7 [===>..........................] - ETA: 0s - loss: 0.00203/7 [===========>..................] - ETA: 0s - loss: 0.00165/7 [====================>.........] - ETA: 0s - loss: 0.00157/7 [==============================] - ETA: 0s - loss: 0.00157/7 [==============================] - 0s 34ms/step - loss: 0.0015
1/7 [===>..........................] - ETA: 0s - loss: 0.03753/7 [===========>..................] - ETA: 0s - loss: 0.01545/7 [====================>.........] - ETA: 0s - loss: 0.01207/7 [==============================] - ETA: 0s - loss: 0.01017/7 [==============================] - 0s 27ms/step - loss: 0.0101
1/7 [===>..........................] - ETA: 0s - loss: 0.00123/7 [===========>..................] - ETA: 0s - loss: 8.9412e-045/7 [====================>.........] - ETA: 0s - loss: 0.0012    7/7 [==============================] - ETA: 0s - loss: 0.00127/7 [==============================] - 0s 35ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 0.00123/7 [===========>..................] - ETA: 0s - loss: 0.00215/7 [====================>.........] - ETA: 0s - loss: 0.00217/7 [==============================] - ETA: 0s - loss: 0.00197/7 [==============================] - 0s 26ms/step - loss: 0.0019
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.003107524267397821:
Train Score: 0.00281 MSE 0.05300 RMSE
Test Score: 0.00152 MSE 0.03896 RMSE
Deviation Min [0.00015365], Max [0.80233477]
Deviation 99.5th pctile [0.14989622]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1395,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,   10]))
Confusion matrix 
[[1391    2]
 [   4    6]]
precision 0.75000, recall 0.60000, f1 0.66667
Time to train: 428581 ms
Saving model models/A1Benchmark/real_39.csv.h5
Total Time to proces all the selected files : 430794 ms
A1Benchmark : Avg precision 0.75000 recall 0.60000 f1 0.66667 time to train 428581.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_39.csv  --epochs 20 --n_iter 3 --patience 3 :: took 437 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_3.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 02:13:18 AM MST
2020-11-30 02:13:25.119206: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 02:13:25.138216: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 02:13:25.139524: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5588646efc60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 02:13:25.139571: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 02:13:25.139739: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_3.csv
Shapes: time variant data with labels (1461, 2), full data (1461, 3)
Look back data shapes: lookbackX (1437, 24, 1) lookbackY (1437, 2)
Shapes: Xtrain_full (1149, 24, 1), Ytrain_full (1149, 1), Xtest (288, 24, 1), Ytest (288, 1)
Shapes: Xtrain (1035, 24, 1), Ytrain (1035, 1), Xvalid (114, 24, 1), Yvalid (114, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00115/7 [====================>.........] - ETA: 0s - loss: 9.8300e-047/7 [==============================] - 0s 15ms/step - loss: 9.5762e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.4818e-045/7 [====================>.........] - ETA: 0s - loss: 2.0858e-047/7 [==============================] - 0s 13ms/step - loss: 2.4556e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00135/7 [====================>.........] - ETA: 0s - loss: 9.1681e-047/7 [==============================] - 0s 14ms/step - loss: 9.4155e-04
1/7 [===>..........................] - ETA: 0s - loss: 9.9217e-044/7 [================>.............] - ETA: 0s - loss: 9.7020e-047/7 [==============================] - ETA: 0s - loss: 9.7844e-047/7 [==============================] - 0s 17ms/step - loss: 9.7844e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.1167e-045/7 [====================>.........] - ETA: 0s - loss: 1.3937e-047/7 [==============================] - 0s 15ms/step - loss: 1.3600e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00154/7 [================>.............] - ETA: 0s - loss: 0.00136/7 [========================>.....] - ETA: 0s - loss: 0.00127/7 [==============================] - 0s 22ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 1.7600e-043/7 [===========>..................] - ETA: 0s - loss: 2.1483e-045/7 [====================>.........] - ETA: 0s - loss: 2.5452e-047/7 [==============================] - ETA: 0s - loss: 3.3260e-047/7 [==============================] - 0s 29ms/step - loss: 3.3260e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00163/7 [===========>..................] - ETA: 0s - loss: 0.00135/7 [====================>.........] - ETA: 0s - loss: 0.00127/7 [==============================] - ETA: 0s - loss: 0.00127/7 [==============================] - 0s 28ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 0.00113/7 [===========>..................] - ETA: 0s - loss: 0.00115/7 [====================>.........] - ETA: 0s - loss: 0.00117/7 [==============================] - ETA: 0s - loss: 0.00117/7 [==============================] - 0s 31ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 8.8868e-043/7 [===========>..................] - ETA: 0s - loss: 9.4548e-045/7 [====================>.........] - ETA: 0s - loss: 9.7286e-047/7 [==============================] - ETA: 0s - loss: 9.4618e-047/7 [==============================] - 0s 33ms/step - loss: 9.4618e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00115/7 [====================>.........] - ETA: 0s - loss: 9.8997e-047/7 [==============================] - 0s 13ms/step - loss: 9.6416e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.1608e-044/7 [================>.............] - ETA: 0s - loss: 2.0295e-047/7 [==============================] - ETA: 0s - loss: 1.9856e-047/7 [==============================] - 0s 16ms/step - loss: 1.9856e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.8639e-046/7 [========================>.....] - ETA: 0s - loss: 2.6359e-047/7 [==============================] - 0s 11ms/step - loss: 2.5709e-04
1/7 [===>..........................] - ETA: 0s - loss: 9.3955e-046/7 [========================>.....] - ETA: 0s - loss: 9.0111e-047/7 [==============================] - 0s 10ms/step - loss: 9.1457e-04
1/7 [===>..........................] - ETA: 0s - loss: 8.2888e-044/7 [================>.............] - ETA: 0s - loss: 8.8442e-047/7 [==============================] - ETA: 0s - loss: 8.5239e-047/7 [==============================] - 0s 17ms/step - loss: 8.5239e-04
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0006373532669385895:
Train Score: 0.00087 MSE 0.02954 RMSE
Test Score: 0.01378 MSE 0.11737 RMSE
Deviation Min [2.41680113e-05], Max [0.80846585]
Deviation 99.5th pctile [0.43670454]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1429,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1422,   15]))
Confusion matrix 
[[1422    0]
 [   7    8]]
precision 1.00000, recall 0.53333, f1 0.69565
Time to train: 212893 ms
Saving model models/A1Benchmark/real_3.csv.h5
Total Time to proces all the selected files : 215389 ms
A1Benchmark : Avg precision 1.00000 recall 0.53333 f1 0.69565 time to train 212893.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_3.csv  --epochs 20 --n_iter 3 --patience 3 :: took 222 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_40.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 02:17:05 AM MST
2020-11-30 02:17:12.192421: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 02:17:12.211225: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 02:17:12.212790: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x557786ee58c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 02:17:12.212840: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 02:17:12.213062: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_40.csv
Shapes: time variant data with labels (1427, 2), full data (1427, 3)
Look back data shapes: lookbackX (1403, 24, 1) lookbackY (1403, 2)
Shapes: Xtrain_full (1122, 24, 1), Ytrain_full (1122, 1), Xtest (281, 24, 1), Ytest (281, 1)
Shapes: Xtrain (1010, 24, 1), Ytrain (1010, 1), Xvalid (112, 24, 1), Yvalid (112, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00552/7 [=======>......................] - ETA: 0s - loss: 0.00824/7 [================>.............] - ETA: 0s - loss: 0.00606/7 [========================>.....] - ETA: 0s - loss: 0.00847/7 [==============================] - 0s 31ms/step - loss: 0.0083
1/7 [===>..........................] - ETA: 0s - loss: 0.00843/7 [===========>..................] - ETA: 0s - loss: 0.00895/7 [====================>.........] - ETA: 0s - loss: 0.00977/7 [==============================] - ETA: 0s - loss: 0.01187/7 [==============================] - 0s 35ms/step - loss: 0.0118
1/7 [===>..........................] - ETA: 0s - loss: 0.00943/7 [===========>..................] - ETA: 0s - loss: 0.01425/7 [====================>.........] - ETA: 0s - loss: 0.01267/7 [==============================] - ETA: 0s - loss: 0.01107/7 [==============================] - 0s 34ms/step - loss: 0.0110
1/7 [===>..........................] - ETA: 0s - loss: 0.03093/7 [===========>..................] - ETA: 0s - loss: 0.01855/7 [====================>.........] - ETA: 0s - loss: 0.01387/7 [==============================] - ETA: 0s - loss: 0.01237/7 [==============================] - 0s 31ms/step - loss: 0.0123
1/7 [===>..........................] - ETA: 0s - loss: 0.01623/7 [===========>..................] - ETA: 0s - loss: 0.00835/7 [====================>.........] - ETA: 0s - loss: 0.00707/7 [==============================] - ETA: 0s - loss: 0.00877/7 [==============================] - 0s 37ms/step - loss: 0.0087
1/7 [===>..........................] - ETA: 0s - loss: 0.00593/7 [===========>..................] - ETA: 0s - loss: 0.00745/7 [====================>.........] - ETA: 0s - loss: 0.00607/7 [==============================] - ETA: 0s - loss: 0.00887/7 [==============================] - 0s 33ms/step - loss: 0.0088
1/7 [===>..........................] - ETA: 0s - loss: 0.00823/7 [===========>..................] - ETA: 0s - loss: 0.00915/7 [====================>.........] - ETA: 0s - loss: 0.00947/7 [==============================] - ETA: 0s - loss: 0.01147/7 [==============================] - 0s 29ms/step - loss: 0.0114
1/7 [===>..........................] - ETA: 0s - loss: 0.01343/7 [===========>..................] - ETA: 0s - loss: 0.01455/7 [====================>.........] - ETA: 0s - loss: 0.01277/7 [==============================] - ETA: 0s - loss: 0.01097/7 [==============================] - 0s 32ms/step - loss: 0.0109
1/7 [===>..........................] - ETA: 0s - loss: 0.02873/7 [===========>..................] - ETA: 0s - loss: 0.01785/7 [====================>.........] - ETA: 0s - loss: 0.01317/7 [==============================] - ETA: 0s - loss: 0.01157/7 [==============================] - 0s 25ms/step - loss: 0.0115
1/7 [===>..........................] - ETA: 0s - loss: 0.01653/7 [===========>..................] - ETA: 0s - loss: 0.00835/7 [====================>.........] - ETA: 0s - loss: 0.00717/7 [==============================] - ETA: 0s - loss: 0.00867/7 [==============================] - 0s 25ms/step - loss: 0.0086
1/7 [===>..........................] - ETA: 0s - loss: 0.00555/7 [====================>.........] - ETA: 0s - loss: 0.00517/7 [==============================] - 0s 14ms/step - loss: 0.0073
1/7 [===>..........................] - ETA: 0s - loss: 0.00794/7 [================>.............] - ETA: 0s - loss: 0.00737/7 [==============================] - ETA: 0s - loss: 0.01087/7 [==============================] - 0s 18ms/step - loss: 0.0108
1/7 [===>..........................] - ETA: 0s - loss: 0.00775/7 [====================>.........] - ETA: 0s - loss: 0.01017/7 [==============================] - 0s 14ms/step - loss: 0.0087
1/7 [===>..........................] - ETA: 0s - loss: 0.02425/7 [====================>.........] - ETA: 0s - loss: 0.01177/7 [==============================] - 0s 14ms/step - loss: 0.0104
1/7 [===>..........................] - ETA: 0s - loss: 0.01614/7 [================>.............] - ETA: 0s - loss: 0.00747/7 [==============================] - 0s 15ms/step - loss: 0.0083
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.009080094285309315:
Train Score: 0.00821 MSE 0.09059 RMSE
Test Score: 0.01665 MSE 0.12902 RMSE
Deviation Min [5.62682655e-05], Max [0.52476585]
Deviation 99.5th pctile [0.40215337]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1395,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1323,   80]))
Confusion matrix 
[[1316    7]
 [  79    1]]
precision 0.12500, recall 0.01250, f1 0.02273
Time to train: 535059 ms
Saving model models/A1Benchmark/real_40.csv.h5
Total Time to proces all the selected files : 537372 ms
A1Benchmark : Avg precision 0.12500 recall 0.01250 f1 0.02273 time to train 535059.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_40.csv  --epochs 20 --n_iter 3 --patience 3 :: took 545 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_41.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 02:26:15 AM MST
2020-11-30 02:26:21.107265: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 02:26:21.126238: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 02:26:21.127901: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55a9373798c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 02:26:21.127966: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 02:26:21.128171: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_41.csv
Shapes: time variant data with labels (1435, 2), full data (1435, 3)
Look back data shapes: lookbackX (1411, 24, 1) lookbackY (1411, 2)
Shapes: Xtrain_full (1128, 24, 1), Ytrain_full (1128, 1), Xtest (283, 24, 1), Ytest (283, 1)
Shapes: Xtrain (1016, 24, 1), Ytrain (1016, 1), Xvalid (112, 24, 1), Yvalid (112, 1)
1/7 [===>..........................] - ETA: 0s - loss: 6.9717e-043/7 [===========>..................] - ETA: 0s - loss: 0.0048    5/7 [====================>.........] - ETA: 0s - loss: 0.00477/7 [==============================] - ETA: 0s - loss: 0.00387/7 [==============================] - 0s 27ms/step - loss: 0.0038
1/7 [===>..........................] - ETA: 0s - loss: 0.00102/7 [=======>......................] - ETA: 0s - loss: 6.1861e-044/7 [================>.............] - ETA: 0s - loss: 7.0260e-046/7 [========================>.....] - ETA: 0s - loss: 7.3454e-047/7 [==============================] - 0s 38ms/step - loss: 7.7478e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00153/7 [===========>..................] - ETA: 0s - loss: 8.1178e-045/7 [====================>.........] - ETA: 0s - loss: 6.1887e-047/7 [==============================] - ETA: 0s - loss: 5.3598e-047/7 [==============================] - 0s 25ms/step - loss: 5.3598e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.6090e-043/7 [===========>..................] - ETA: 0s - loss: 5.0077e-045/7 [====================>.........] - ETA: 0s - loss: 4.1376e-047/7 [==============================] - ETA: 0s - loss: 4.0702e-047/7 [==============================] - 0s 25ms/step - loss: 4.0702e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.6501e-043/7 [===========>..................] - ETA: 0s - loss: 4.1119e-045/7 [====================>.........] - ETA: 0s - loss: 4.3014e-047/7 [==============================] - ETA: 0s - loss: 0.0012    7/7 [==============================] - 0s 30ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 7.4683e-045/7 [====================>.........] - ETA: 0s - loss: 0.0049    7/7 [==============================] - 0s 11ms/step - loss: 0.0039
1/7 [===>..........................] - ETA: 0s - loss: 0.00115/7 [====================>.........] - ETA: 0s - loss: 8.1306e-047/7 [==============================] - 0s 12ms/step - loss: 8.4367e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00175/7 [====================>.........] - ETA: 0s - loss: 7.3260e-047/7 [==============================] - 0s 12ms/step - loss: 6.2839e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.1926e-045/7 [====================>.........] - ETA: 0s - loss: 3.6346e-047/7 [==============================] - 0s 13ms/step - loss: 3.4760e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.0508e-045/7 [====================>.........] - ETA: 0s - loss: 5.8124e-047/7 [==============================] - 0s 13ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 6.4048e-044/7 [================>.............] - ETA: 0s - loss: 0.0057    7/7 [==============================] - ETA: 0s - loss: 0.00377/7 [==============================] - 0s 19ms/step - loss: 0.0037
1/7 [===>..........................] - ETA: 0s - loss: 9.0484e-044/7 [================>.............] - ETA: 0s - loss: 5.7646e-046/7 [========================>.....] - ETA: 0s - loss: 6.1280e-047/7 [==============================] - 0s 20ms/step - loss: 6.4351e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00165/7 [====================>.........] - ETA: 0s - loss: 6.6155e-047/7 [==============================] - 0s 14ms/step - loss: 5.6622e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.4310e-045/7 [====================>.........] - ETA: 0s - loss: 4.5956e-047/7 [==============================] - 0s 14ms/step - loss: 5.1276e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.4797e-044/7 [================>.............] - ETA: 0s - loss: 3.8631e-047/7 [==============================] - ETA: 0s - loss: 0.0012    7/7 [==============================] - 0s 17ms/step - loss: 0.0012
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0013259661849588157:
Train Score: 0.00123 MSE 0.03512 RMSE
Test Score: 0.00770 MSE 0.08774 RMSE
Deviation Min [2.02607177e-05], Max [0.94441136]
Deviation 99.5th pctile [0.26544509]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1403,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1408,    3]))
Confusion matrix 
[[1403    5]
 [   0    3]]
precision 0.37500, recall 1.00000, f1 0.54545
Time to train: 179347 ms
Saving model models/A1Benchmark/real_41.csv.h5
Total Time to proces all the selected files : 181914 ms
A1Benchmark : Avg precision 0.37500 recall 1.00000 f1 0.54545 time to train 179347.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_41.csv  --epochs 20 --n_iter 3 --patience 3 :: took 188 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_42.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 02:29:28 AM MST
2020-11-30 02:29:34.545880: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 02:29:34.564264: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 02:29:34.565833: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x556e885ee8c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 02:29:34.565898: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 02:29:34.566123: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_42.csv
Shapes: time variant data with labels (1440, 2), full data (1440, 3)
Look back data shapes: lookbackX (1416, 24, 1) lookbackY (1416, 2)
Shapes: Xtrain_full (1132, 24, 1), Ytrain_full (1132, 1), Xtest (284, 24, 1), Ytest (284, 1)
Shapes: Xtrain (1019, 24, 1), Ytrain (1019, 1), Xvalid (113, 24, 1), Yvalid (113, 1)
1/7 [===>..........................] - ETA: 0s - loss: 2.0215e-054/7 [================>.............] - ETA: 0s - loss: 2.1138e-057/7 [==============================] - ETA: 0s - loss: 2.1276e-057/7 [==============================] - 0s 17ms/step - loss: 2.1276e-05
1/7 [===>..........................] - ETA: 0s - loss: 4.9277e-065/7 [====================>.........] - ETA: 0s - loss: 6.0954e-067/7 [==============================] - 0s 12ms/step - loss: 5.8186e-06
1/7 [===>..........................] - ETA: 0s - loss: 1.0931e-055/7 [====================>.........] - ETA: 0s - loss: 1.0757e-057/7 [==============================] - 0s 14ms/step - loss: 1.0980e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.7832e-055/7 [====================>.........] - ETA: 0s - loss: 1.0969e-047/7 [==============================] - 0s 11ms/step - loss: 9.2813e-05
1/7 [===>..........................] - ETA: 0s - loss: 2.7773e-055/7 [====================>.........] - ETA: 0s - loss: 3.2683e-057/7 [==============================] - 0s 12ms/step - loss: 3.6083e-05
1/7 [===>..........................] - ETA: 0s - loss: 4.1552e-063/7 [===========>..................] - ETA: 0s - loss: 4.9358e-065/7 [====================>.........] - ETA: 0s - loss: 5.6882e-067/7 [==============================] - ETA: 0s - loss: 5.3921e-067/7 [==============================] - 0s 33ms/step - loss: 5.3921e-06
1/7 [===>..........................] - ETA: 0s - loss: 5.3389e-063/7 [===========>..................] - ETA: 0s - loss: 9.1360e-065/7 [====================>.........] - ETA: 0s - loss: 7.6852e-067/7 [==============================] - ETA: 0s - loss: 7.2935e-067/7 [==============================] - 0s 34ms/step - loss: 7.2935e-06
1/7 [===>..........................] - ETA: 0s - loss: 4.7393e-063/7 [===========>..................] - ETA: 0s - loss: 4.6783e-065/7 [====================>.........] - ETA: 0s - loss: 4.7002e-067/7 [==============================] - ETA: 0s - loss: 5.9186e-067/7 [==============================] - 0s 25ms/step - loss: 5.9186e-06
1/7 [===>..........................] - ETA: 0s - loss: 1.6513e-053/7 [===========>..................] - ETA: 0s - loss: 6.5403e-055/7 [====================>.........] - ETA: 0s - loss: 1.1889e-047/7 [==============================] - ETA: 0s - loss: 1.0055e-047/7 [==============================] - 0s 25ms/step - loss: 1.0055e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.2061e-053/7 [===========>..................] - ETA: 0s - loss: 3.8928e-055/7 [====================>.........] - ETA: 0s - loss: 3.8491e-057/7 [==============================] - ETA: 0s - loss: 4.2951e-057/7 [==============================] - 0s 29ms/step - loss: 4.2951e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.6613e-055/7 [====================>.........] - ETA: 0s - loss: 1.8111e-057/7 [==============================] - 0s 14ms/step - loss: 1.7601e-05
1/7 [===>..........................] - ETA: 0s - loss: 9.8463e-065/7 [====================>.........] - ETA: 0s - loss: 1.4865e-057/7 [==============================] - 0s 12ms/step - loss: 1.4388e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.0128e-054/7 [================>.............] - ETA: 0s - loss: 1.0223e-057/7 [==============================] - ETA: 0s - loss: 1.0251e-057/7 [==============================] - 0s 15ms/step - loss: 1.0251e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.8625e-054/7 [================>.............] - ETA: 0s - loss: 8.8165e-057/7 [==============================] - ETA: 0s - loss: 9.7415e-057/7 [==============================] - 0s 15ms/step - loss: 9.7415e-05
1/7 [===>..........................] - ETA: 0s - loss: 2.7319e-055/7 [====================>.........] - ETA: 0s - loss: 3.1908e-057/7 [==============================] - 0s 12ms/step - loss: 3.5068e-05
Best parameters {'n_units': 72, 'n_hidden': 2} best score 3.242003849663888e-05:
Train Score: 0.00003 MSE 0.00568 RMSE
Test Score: 0.04174 MSE 0.20432 RMSE
Deviation Min [9.81897172e-06], Max [0.94201964]
Deviation 99.5th pctile [0.6905289]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1408,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1372,   44]))
Confusion matrix 
[[1372    0]
 [  36    8]]
precision 1.00000, recall 0.18182, f1 0.30769
Time to train: 179873 ms
Saving model models/A1Benchmark/real_42.csv.h5
Total Time to proces all the selected files : 183464 ms
A1Benchmark : Avg precision 1.00000 recall 0.18182 f1 0.30769 time to train 179873.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_42.csv  --epochs 20 --n_iter 3 --patience 3 :: took 190 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_43.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 02:32:43 AM MST
2020-11-30 02:32:50.296419: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 02:32:50.315244: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 02:32:50.316684: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x561b3bc5e8c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 02:32:50.316734: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 02:32:50.316947: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_43.csv
Shapes: time variant data with labels (1440, 2), full data (1440, 3)
Look back data shapes: lookbackX (1416, 24, 1) lookbackY (1416, 2)
Shapes: Xtrain_full (1132, 24, 1), Ytrain_full (1132, 1), Xtest (284, 24, 1), Ytest (284, 1)
Shapes: Xtrain (1019, 24, 1), Ytrain (1019, 1), Xvalid (113, 24, 1), Yvalid (113, 1)
1/7 [===>..........................] - ETA: 0s - loss: 4.2381e-044/7 [================>.............] - ETA: 0s - loss: 4.7266e-047/7 [==============================] - 0s 15ms/step - loss: 4.1856e-04
1/7 [===>..........................] - ETA: 0s - loss: 6.5459e-055/7 [====================>.........] - ETA: 0s - loss: 4.7660e-047/7 [==============================] - 0s 13ms/step - loss: 4.0196e-04
1/7 [===>..........................] - ETA: 0s - loss: 7.4257e-044/7 [================>.............] - ETA: 0s - loss: 0.0015    7/7 [==============================] - ETA: 0s - loss: 0.00127/7 [==============================] - 0s 17ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 7.2600e-044/7 [================>.............] - ETA: 0s - loss: 8.7521e-047/7 [==============================] - 0s 15ms/step - loss: 0.0064
1/7 [===>..........................] - ETA: 0s - loss: 0.00735/7 [====================>.........] - ETA: 0s - loss: 0.00997/7 [==============================] - 0s 14ms/step - loss: 0.0097
1/7 [===>..........................] - ETA: 0s - loss: 5.1014e-043/7 [===========>..................] - ETA: 0s - loss: 4.3907e-045/7 [====================>.........] - ETA: 0s - loss: 4.3782e-047/7 [==============================] - ETA: 0s - loss: 4.0634e-047/7 [==============================] - 0s 27ms/step - loss: 4.0634e-04
1/7 [===>..........................] - ETA: 0s - loss: 7.6554e-053/7 [===========>..................] - ETA: 0s - loss: 5.8340e-045/7 [====================>.........] - ETA: 0s - loss: 6.0259e-047/7 [==============================] - ETA: 0s - loss: 5.0999e-047/7 [==============================] - 0s 31ms/step - loss: 5.0999e-04
1/7 [===>..........................] - ETA: 0s - loss: 8.5051e-043/7 [===========>..................] - ETA: 0s - loss: 0.0013    5/7 [====================>.........] - ETA: 0s - loss: 0.00167/7 [==============================] - ETA: 0s - loss: 0.00137/7 [==============================] - 0s 37ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 9.5023e-042/7 [=======>......................] - ETA: 0s - loss: 0.0016    4/7 [================>.............] - ETA: 0s - loss: 0.00146/7 [========================>.....] - ETA: 0s - loss: 0.00197/7 [==============================] - 0s 35ms/step - loss: 0.0082
1/7 [===>..........................] - ETA: 0s - loss: 0.00383/7 [===========>..................] - ETA: 0s - loss: 0.00275/7 [====================>.........] - ETA: 0s - loss: 0.00287/7 [==============================] - ETA: 0s - loss: 0.00267/7 [==============================] - 0s 27ms/step - loss: 0.0026
1/7 [===>..........................] - ETA: 0s - loss: 3.2839e-045/7 [====================>.........] - ETA: 0s - loss: 3.4985e-047/7 [==============================] - 0s 15ms/step - loss: 3.2598e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.9565e-056/7 [========================>.....] - ETA: 0s - loss: 4.6129e-047/7 [==============================] - 0s 10ms/step - loss: 4.4747e-04
1/7 [===>..........................] - ETA: 0s - loss: 6.0524e-044/7 [================>.............] - ETA: 0s - loss: 0.0012    7/7 [==============================] - 0s 14ms/step - loss: 0.0010
1/7 [===>..........................] - ETA: 0s - loss: 9.2575e-044/7 [================>.............] - ETA: 0s - loss: 0.0014    7/7 [==============================] - ETA: 0s - loss: 0.00757/7 [==============================] - 0s 17ms/step - loss: 0.0075
1/7 [===>..........................] - ETA: 0s - loss: 0.00455/7 [====================>.........] - ETA: 0s - loss: 0.00217/7 [==============================] - 0s 12ms/step - loss: 0.0018
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.002221356052905321:
Train Score: 0.00219 MSE 0.04679 RMSE
Test Score: 0.00125 MSE 0.03536 RMSE
Deviation Min [1.53267424e-05], Max [0.58770116]
Deviation 99.5th pctile [0.20564231]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1408,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1384,   32]))
Confusion matrix 
[[1384    0]
 [  24    8]]
precision 1.00000, recall 0.25000, f1 0.40000
Time to train: 219883 ms
Saving model models/A1Benchmark/real_43.csv.h5
Total Time to proces all the selected files : 222071 ms
A1Benchmark : Avg precision 1.00000 recall 0.25000 f1 0.40000 time to train 219883.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_43.csv  --epochs 20 --n_iter 3 --patience 3 :: took 229 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_44.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 02:36:37 AM MST
2020-11-30 02:36:43.431354: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 02:36:43.450337: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 02:36:43.451941: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55bdc0f34c60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 02:36:43.451997: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 02:36:43.452234: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_44.csv
Shapes: time variant data with labels (1461, 2), full data (1461, 3)
Look back data shapes: lookbackX (1437, 24, 1) lookbackY (1437, 2)
Shapes: Xtrain_full (1149, 24, 1), Ytrain_full (1149, 1), Xtest (288, 24, 1), Ytest (288, 1)
Shapes: Xtrain (1035, 24, 1), Ytrain (1035, 1), Xvalid (114, 24, 1), Yvalid (114, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00114/7 [================>.............] - ETA: 0s - loss: 0.00147/7 [==============================] - ETA: 0s - loss: 0.00127/7 [==============================] - 0s 17ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 0.00545/7 [====================>.........] - ETA: 0s - loss: 0.01597/7 [==============================] - 0s 12ms/step - loss: 0.0134
1/7 [===>..........................] - ETA: 0s - loss: 0.00415/7 [====================>.........] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 13ms/step - loss: 0.0016
1/7 [===>..........................] - ETA: 0s - loss: 3.3706e-045/7 [====================>.........] - ETA: 0s - loss: 6.1496e-047/7 [==============================] - 0s 13ms/step - loss: 6.2605e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.5677e-045/7 [====================>.........] - ETA: 0s - loss: 6.2493e-047/7 [==============================] - 0s 14ms/step - loss: 5.8368e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00103/7 [===========>..................] - ETA: 0s - loss: 0.00185/7 [====================>.........] - ETA: 0s - loss: 0.00157/7 [==============================] - ETA: 0s - loss: 0.00137/7 [==============================] - 0s 31ms/step - loss: 0.0013
1/7 [===>..........................] - ETA: 0s - loss: 0.00683/7 [===========>..................] - ETA: 0s - loss: 0.02725/7 [====================>.........] - ETA: 0s - loss: 0.01987/7 [==============================] - ETA: 0s - loss: 0.01667/7 [==============================] - 0s 25ms/step - loss: 0.0166
1/7 [===>..........................] - ETA: 0s - loss: 0.00562/7 [=======>......................] - ETA: 0s - loss: 0.00404/7 [================>.............] - ETA: 0s - loss: 0.00235/7 [====================>.........] - ETA: 0s - loss: 0.00206/7 [========================>.....] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 61ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 0.00123/7 [===========>..................] - ETA: 0s - loss: 9.2954e-045/7 [====================>.........] - ETA: 0s - loss: 0.0014    7/7 [==============================] - ETA: 0s - loss: 0.00147/7 [==============================] - 0s 25ms/step - loss: 0.0014
1/7 [===>..........................] - ETA: 0s - loss: 6.2019e-043/7 [===========>..................] - ETA: 0s - loss: 5.0907e-045/7 [====================>.........] - ETA: 0s - loss: 0.0011    7/7 [==============================] - ETA: 0s - loss: 0.00117/7 [==============================] - 0s 26ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 0.00495/7 [====================>.........] - ETA: 0s - loss: 0.00467/7 [==============================] - 0s 14ms/step - loss: 0.0047
1/7 [===>..........................] - ETA: 0s - loss: 0.00504/7 [================>.............] - ETA: 0s - loss: 0.01677/7 [==============================] - ETA: 0s - loss: 0.01237/7 [==============================] - 0s 17ms/step - loss: 0.0123
1/7 [===>..........................] - ETA: 0s - loss: 0.00375/7 [====================>.........] - ETA: 0s - loss: 0.00237/7 [==============================] - 0s 12ms/step - loss: 0.0019
1/7 [===>..........................] - ETA: 0s - loss: 4.9529e-045/7 [====================>.........] - ETA: 0s - loss: 9.4721e-047/7 [==============================] - 0s 12ms/step - loss: 0.0012
1/7 [===>..........................] - ETA: 0s - loss: 8.3654e-045/7 [====================>.........] - ETA: 0s - loss: 9.8593e-047/7 [==============================] - 0s 13ms/step - loss: 9.5437e-04
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.003473133861552924:
Train Score: 0.00140 MSE 0.03745 RMSE
Test Score: 0.00064 MSE 0.02528 RMSE
Deviation Min [5.21220346e-07], Max [0.45278838]
Deviation 99.5th pctile [0.13765795]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1429,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1428,    9]))
Confusion matrix 
[[1427    1]
 [   2    7]]
precision 0.87500, recall 0.77778, f1 0.82353
Time to train: 405945 ms
Saving model models/A1Benchmark/real_44.csv.h5
Total Time to proces all the selected files : 408711 ms
A1Benchmark : Avg precision 0.87500 recall 0.77778 f1 0.82353 time to train 405945.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_44.csv  --epochs 20 --n_iter 3 --patience 3 :: took 415 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_45.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 02:43:37 AM MST
2020-11-30 02:43:43.971284: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 02:43:43.990258: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 02:43:43.991797: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55b8e7e08c60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 02:43:43.991866: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 02:43:43.992089: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_45.csv
Shapes: time variant data with labels (1440, 2), full data (1440, 3)
Look back data shapes: lookbackX (1416, 24, 1) lookbackY (1416, 2)
Shapes: Xtrain_full (1132, 24, 1), Ytrain_full (1132, 1), Xtest (284, 24, 1), Ytest (284, 1)
Shapes: Xtrain (1019, 24, 1), Ytrain (1019, 1), Xvalid (113, 24, 1), Yvalid (113, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00195/7 [====================>.........] - ETA: 0s - loss: 0.00247/7 [==============================] - 0s 11ms/step - loss: 0.0024
1/7 [===>..........................] - ETA: 0s - loss: 0.00305/7 [====================>.........] - ETA: 0s - loss: 0.00227/7 [==============================] - 0s 13ms/step - loss: 0.0022
1/7 [===>..........................] - ETA: 0s - loss: 0.00224/7 [================>.............] - ETA: 0s - loss: 0.00217/7 [==============================] - ETA: 0s - loss: 0.00197/7 [==============================] - 0s 16ms/step - loss: 0.0019
1/7 [===>..........................] - ETA: 0s - loss: 0.00135/7 [====================>.........] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 13ms/step - loss: 0.0019
1/7 [===>..........................] - ETA: 0s - loss: 9.6849e-045/7 [====================>.........] - ETA: 0s - loss: 0.0018    7/7 [==============================] - 0s 13ms/step - loss: 0.0018
1/7 [===>..........................] - ETA: 0s - loss: 0.00204/7 [================>.............] - ETA: 0s - loss: 0.00237/7 [==============================] - ETA: 0s - loss: 0.00257/7 [==============================] - 0s 18ms/step - loss: 0.0025
1/7 [===>..........................] - ETA: 0s - loss: 0.00304/7 [================>.............] - ETA: 0s - loss: 0.00247/7 [==============================] - ETA: 0s - loss: 0.00227/7 [==============================] - 0s 17ms/step - loss: 0.0022
1/7 [===>..........................] - ETA: 0s - loss: 0.00224/7 [================>.............] - ETA: 0s - loss: 0.00217/7 [==============================] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 17ms/step - loss: 0.0018
1/7 [===>..........................] - ETA: 0s - loss: 0.00134/7 [================>.............] - ETA: 0s - loss: 0.00167/7 [==============================] - ETA: 0s - loss: 0.00197/7 [==============================] - 0s 18ms/step - loss: 0.0019
1/7 [===>..........................] - ETA: 0s - loss: 0.00105/7 [====================>.........] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 14ms/step - loss: 0.0017
1/7 [===>..........................] - ETA: 0s - loss: 0.00183/7 [===========>..................] - ETA: 0s - loss: 0.00235/7 [====================>.........] - ETA: 0s - loss: 0.00247/7 [==============================] - ETA: 0s - loss: 0.00247/7 [==============================] - 0s 24ms/step - loss: 0.0024
1/7 [===>..........................] - ETA: 0s - loss: 0.00303/7 [===========>..................] - ETA: 0s - loss: 0.00225/7 [====================>.........] - ETA: 0s - loss: 0.00227/7 [==============================] - ETA: 0s - loss: 0.00227/7 [==============================] - 0s 26ms/step - loss: 0.0022
1/7 [===>..........................] - ETA: 0s - loss: 0.00213/7 [===========>..................] - ETA: 0s - loss: 0.00195/7 [====================>.........] - ETA: 0s - loss: 0.00197/7 [==============================] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 32ms/step - loss: 0.0018
1/7 [===>..........................] - ETA: 0s - loss: 0.00143/7 [===========>..................] - ETA: 0s - loss: 0.00145/7 [====================>.........] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 29ms/step - loss: 0.0019
1/7 [===>..........................] - ETA: 0s - loss: 9.9475e-043/7 [===========>..................] - ETA: 0s - loss: 0.0014    5/7 [====================>.........] - ETA: 0s - loss: 0.00187/7 [==============================] - ETA: 0s - loss: 0.00177/7 [==============================] - 0s 30ms/step - loss: 0.0017
Best parameters {'n_units': 48, 'n_hidden': 2} best score 0.0020162050612270834:
Train Score: 0.00199 MSE 0.04458 RMSE
Test Score: 0.00482 MSE 0.06945 RMSE
Deviation Min [1.86008215e-05], Max [0.95906426]
Deviation 99.5th pctile [0.12324592]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1408,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1415,    1]))
Confusion matrix 
[[1408    7]
 [   0    1]]
precision 0.12500, recall 1.00000, f1 0.22222
Time to train: 181979 ms
Saving model models/A1Benchmark/real_45.csv.h5
Total Time to proces all the selected files : 185472 ms
A1Benchmark : Avg precision 0.12500 recall 1.00000 f1 0.22222 time to train 181979.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_45.csv  --epochs 20 --n_iter 3 --patience 3 :: took 192 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_46.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 02:46:54 AM MST
2020-11-30 02:47:00.958684: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 02:47:00.977204: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 02:47:00.978582: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x558a27e1c8c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 02:47:00.978633: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 02:47:00.978820: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_46.csv
Shapes: time variant data with labels (1441, 2), full data (1441, 3)
Look back data shapes: lookbackX (1417, 24, 1) lookbackY (1417, 2)
Shapes: Xtrain_full (1133, 24, 1), Ytrain_full (1133, 1), Xtest (284, 24, 1), Ytest (284, 1)
Shapes: Xtrain (1020, 24, 1), Ytrain (1020, 1), Xvalid (113, 24, 1), Yvalid (113, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00605/7 [====================>.........] - ETA: 0s - loss: 0.00657/7 [==============================] - 0s 13ms/step - loss: 0.0062
1/7 [===>..........................] - ETA: 0s - loss: 0.00914/7 [================>.............] - ETA: 0s - loss: 0.00497/7 [==============================] - 0s 14ms/step - loss: 0.0045
1/7 [===>..........................] - ETA: 0s - loss: 0.00324/7 [================>.............] - ETA: 0s - loss: 0.00417/7 [==============================] - ETA: 0s - loss: 0.00507/7 [==============================] - 0s 17ms/step - loss: 0.0050
1/7 [===>..........................] - ETA: 0s - loss: 0.00725/7 [====================>.........] - ETA: 0s - loss: 0.01107/7 [==============================] - 0s 13ms/step - loss: 0.0147
1/7 [===>..........................] - ETA: 0s - loss: 0.06115/7 [====================>.........] - ETA: 0s - loss: 0.02057/7 [==============================] - 0s 12ms/step - loss: 0.0167
1/7 [===>..........................] - ETA: 0s - loss: 0.00433/7 [===========>..................] - ETA: 0s - loss: 0.00455/7 [====================>.........] - ETA: 0s - loss: 0.00427/7 [==============================] - ETA: 0s - loss: 0.00407/7 [==============================] - 0s 35ms/step - loss: 0.0040
1/7 [===>..........................] - ETA: 0s - loss: 0.00833/7 [===========>..................] - ETA: 0s - loss: 0.00565/7 [====================>.........] - ETA: 0s - loss: 0.00457/7 [==============================] - ETA: 0s - loss: 0.00437/7 [==============================] - 0s 26ms/step - loss: 0.0043
1/7 [===>..........................] - ETA: 0s - loss: 0.00573/7 [===========>..................] - ETA: 0s - loss: 0.00825/7 [====================>.........] - ETA: 0s - loss: 0.00647/7 [==============================] - ETA: 0s - loss: 0.00797/7 [==============================] - 0s 34ms/step - loss: 0.0079
1/7 [===>..........................] - ETA: 0s - loss: 0.00803/7 [===========>..................] - ETA: 0s - loss: 0.00815/7 [====================>.........] - ETA: 0s - loss: 0.01447/7 [==============================] - ETA: 0s - loss: 0.01797/7 [==============================] - 0s 32ms/step - loss: 0.0179
1/7 [===>..........................] - ETA: 0s - loss: 0.08333/7 [===========>..................] - ETA: 0s - loss: 0.03275/7 [====================>.........] - ETA: 0s - loss: 0.02387/7 [==============================] - ETA: 0s - loss: 0.01917/7 [==============================] - 0s 32ms/step - loss: 0.0191
1/7 [===>..........................] - ETA: 0s - loss: 0.00443/7 [===========>..................] - ETA: 0s - loss: 0.00445/7 [====================>.........] - ETA: 0s - loss: 0.00457/7 [==============================] - ETA: 0s - loss: 0.00447/7 [==============================] - 0s 30ms/step - loss: 0.0044
1/7 [===>..........................] - ETA: 0s - loss: 0.01463/7 [===========>..................] - ETA: 0s - loss: 0.01235/7 [====================>.........] - ETA: 0s - loss: 0.01057/7 [==============================] - ETA: 0s - loss: 0.01057/7 [==============================] - 0s 29ms/step - loss: 0.0105
1/7 [===>..........................] - ETA: 0s - loss: 0.00513/7 [===========>..................] - ETA: 0s - loss: 0.00585/7 [====================>.........] - ETA: 0s - loss: 0.00527/7 [==============================] - ETA: 0s - loss: 0.00687/7 [==============================] - 0s 30ms/step - loss: 0.0068
1/7 [===>..........................] - ETA: 0s - loss: 0.00893/7 [===========>..................] - ETA: 0s - loss: 0.00855/7 [====================>.........] - ETA: 0s - loss: 0.01487/7 [==============================] - ETA: 0s - loss: 0.01807/7 [==============================] - 0s 25ms/step - loss: 0.0180
1/7 [===>..........................] - ETA: 0s - loss: 0.07043/7 [===========>..................] - ETA: 0s - loss: 0.02755/7 [====================>.........] - ETA: 0s - loss: 0.02117/7 [==============================] - ETA: 0s - loss: 0.01727/7 [==============================] - 0s 33ms/step - loss: 0.0172
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.009435214940458536:
Train Score: 0.00525 MSE 0.07248 RMSE
Test Score: 0.00599 MSE 0.07741 RMSE
Deviation Min [5.66556585e-05], Max [0.66568485]
Deviation 99.5th pctile [0.2794032]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1409,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1308,  109]))
Confusion matrix 
[[1302    6]
 [ 107    2]]
precision 0.25000, recall 0.01835, f1 0.03419
Time to train: 640849 ms
Saving model models/A1Benchmark/real_46.csv.h5
Total Time to proces all the selected files : 643120 ms
A1Benchmark : Avg precision 0.25000 recall 0.01835 f1 0.03419 time to train 640849.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_46.csv  --epochs 20 --n_iter 3 --patience 3 :: took 650 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_47.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 02:57:49 AM MST
2020-11-30 02:57:55.785878: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 02:57:55.804268: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 02:57:55.805928: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x564217563c60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 02:57:55.805963: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 02:57:55.806095: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_47.csv
Shapes: time variant data with labels (1427, 2), full data (1427, 3)
Look back data shapes: lookbackX (1403, 24, 1) lookbackY (1403, 2)
Shapes: Xtrain_full (1122, 24, 1), Ytrain_full (1122, 1), Xtest (281, 24, 1), Ytest (281, 1)
Shapes: Xtrain (1010, 24, 1), Ytrain (1010, 1), Xvalid (112, 24, 1), Yvalid (112, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.01013/7 [===========>..................] - ETA: 0s - loss: 0.00775/7 [====================>.........] - ETA: 0s - loss: 0.00877/7 [==============================] - ETA: 0s - loss: 0.00867/7 [==============================] - 0s 30ms/step - loss: 0.0086
1/7 [===>..........................] - ETA: 0s - loss: 0.00803/7 [===========>..................] - ETA: 0s - loss: 0.00545/7 [====================>.........] - ETA: 0s - loss: 0.00467/7 [==============================] - ETA: 0s - loss: 0.00457/7 [==============================] - 0s 26ms/step - loss: 0.0045
1/7 [===>..........................] - ETA: 0s - loss: 0.00183/7 [===========>..................] - ETA: 0s - loss: 0.00345/7 [====================>.........] - ETA: 0s - loss: 0.00317/7 [==============================] - ETA: 0s - loss: 0.00287/7 [==============================] - 0s 31ms/step - loss: 0.0028
1/7 [===>..........................] - ETA: 0s - loss: 0.00263/7 [===========>..................] - ETA: 0s - loss: 0.00285/7 [====================>.........] - ETA: 0s - loss: 0.00327/7 [==============================] - ETA: 0s - loss: 0.00327/7 [==============================] - 0s 26ms/step - loss: 0.0032
1/7 [===>..........................] - ETA: 0s - loss: 0.00213/7 [===========>..................] - ETA: 0s - loss: 0.01064/7 [================>.............] - ETA: 0s - loss: 0.00915/7 [====================>.........] - ETA: 0s - loss: 0.00776/7 [========================>.....] - ETA: 0s - loss: 0.00677/7 [==============================] - 0s 44ms/step - loss: 0.0064
1/7 [===>..........................] - ETA: 0s - loss: 0.01645/7 [====================>.........] - ETA: 0s - loss: 0.01377/7 [==============================] - 0s 12ms/step - loss: 0.0136
1/7 [===>..........................] - ETA: 0s - loss: 0.00935/7 [====================>.........] - ETA: 0s - loss: 0.00797/7 [==============================] - 0s 12ms/step - loss: 0.0074
1/7 [===>..........................] - ETA: 0s - loss: 8.5866e-044/7 [================>.............] - ETA: 0s - loss: 0.0027    7/7 [==============================] - ETA: 0s - loss: 0.00237/7 [==============================] - 0s 16ms/step - loss: 0.0023
1/7 [===>..........................] - ETA: 0s - loss: 0.00214/7 [================>.............] - ETA: 0s - loss: 0.00277/7 [==============================] - ETA: 0s - loss: 0.00287/7 [==============================] - 0s 15ms/step - loss: 0.0028
1/7 [===>..........................] - ETA: 0s - loss: 0.00185/7 [====================>.........] - ETA: 0s - loss: 0.00597/7 [==============================] - 0s 14ms/step - loss: 0.0050
1/7 [===>..........................] - ETA: 0s - loss: 0.02894/7 [================>.............] - ETA: 0s - loss: 0.02487/7 [==============================] - ETA: 0s - loss: 0.02597/7 [==============================] - 0s 17ms/step - loss: 0.0259
1/7 [===>..........................] - ETA: 0s - loss: 0.00345/7 [====================>.........] - ETA: 0s - loss: 0.00267/7 [==============================] - 0s 14ms/step - loss: 0.0024
1/7 [===>..........................] - ETA: 0s - loss: 0.00724/7 [================>.............] - ETA: 0s - loss: 0.00787/7 [==============================] - ETA: 0s - loss: 0.00747/7 [==============================] - 0s 17ms/step - loss: 0.0074
1/7 [===>..........................] - ETA: 0s - loss: 0.00154/7 [================>.............] - ETA: 0s - loss: 0.00197/7 [==============================] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 18ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 0.00235/7 [====================>.........] - ETA: 0s - loss: 0.00747/7 [==============================] - 0s 13ms/step - loss: 0.0062
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.005111255357041955:
Train Score: 0.00316 MSE 0.05617 RMSE
Test Score: 0.00655 MSE 0.08091 RMSE
Deviation Min [1.55717952e-05], Max [0.9076613]
Deviation 99.5th pctile [0.20665192]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1395,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,   10]))
Confusion matrix 
[[1390    3]
 [   5    5]]
precision 0.62500, recall 0.50000, f1 0.55556
Time to train: 595949 ms
Saving model models/A1Benchmark/real_47.csv.h5
Total Time to proces all the selected files : 600037 ms
A1Benchmark : Avg precision 0.62500 recall 0.50000 f1 0.55556 time to train 595949.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_47.csv  --epochs 20 --n_iter 3 --patience 3 :: took 607 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_48.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 03:08:01 AM MST
2020-11-30 03:08:07.497186: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 03:08:07.516234: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 03:08:07.517820: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5643b2755c60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 03:08:07.517895: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 03:08:07.518139: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_48.csv
Shapes: time variant data with labels (1439, 2), full data (1439, 3)
Look back data shapes: lookbackX (1415, 24, 1) lookbackY (1415, 2)
Shapes: Xtrain_full (1132, 24, 1), Ytrain_full (1132, 1), Xtest (283, 24, 1), Ytest (283, 1)
Shapes: Xtrain (1019, 24, 1), Ytrain (1019, 1), Xvalid (113, 24, 1), Yvalid (113, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.04123/7 [===========>..................] - ETA: 0s - loss: 0.01915/7 [====================>.........] - ETA: 0s - loss: 0.01527/7 [==============================] - ETA: 0s - loss: 0.01637/7 [==============================] - 0s 26ms/step - loss: 0.0163
1/7 [===>..........................] - ETA: 0s - loss: 0.03863/7 [===========>..................] - ETA: 0s - loss: 0.01345/7 [====================>.........] - ETA: 0s - loss: 0.00827/7 [==============================] - ETA: 0s - loss: 0.00657/7 [==============================] - 0s 28ms/step - loss: 0.0065
1/7 [===>..........................] - ETA: 0s - loss: 3.2067e-053/7 [===========>..................] - ETA: 0s - loss: 3.7201e-055/7 [====================>.........] - ETA: 0s - loss: 3.5476e-057/7 [==============================] - ETA: 0s - loss: 3.4010e-057/7 [==============================] - 0s 26ms/step - loss: 3.4010e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.1899e-043/7 [===========>..................] - ETA: 0s - loss: 8.8603e-055/7 [====================>.........] - ETA: 0s - loss: 8.5312e-057/7 [==============================] - ETA: 0s - loss: 8.1322e-057/7 [==============================] - 0s 26ms/step - loss: 8.1322e-05
1/7 [===>..........................] - ETA: 0s - loss: 3.3387e-053/7 [===========>..................] - ETA: 0s - loss: 4.1523e-055/7 [====================>.........] - ETA: 0s - loss: 1.5545e-047/7 [==============================] - ETA: 0s - loss: 1.4782e-047/7 [==============================] - 0s 31ms/step - loss: 1.4782e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.04413/7 [===========>..................] - ETA: 0s - loss: 0.01995/7 [====================>.........] - ETA: 0s - loss: 0.01547/7 [==============================] - ETA: 0s - loss: 0.01667/7 [==============================] - 0s 36ms/step - loss: 0.0166
1/7 [===>..........................] - ETA: 0s - loss: 0.03593/7 [===========>..................] - ETA: 0s - loss: 0.01245/7 [====================>.........] - ETA: 0s - loss: 0.00757/7 [==============================] - ETA: 0s - loss: 0.00597/7 [==============================] - 0s 24ms/step - loss: 0.0059
1/7 [===>..........................] - ETA: 0s - loss: 2.1425e-053/7 [===========>..................] - ETA: 0s - loss: 2.1768e-055/7 [====================>.........] - ETA: 0s - loss: 2.1621e-057/7 [==============================] - ETA: 0s - loss: 2.1950e-057/7 [==============================] - 0s 31ms/step - loss: 2.1950e-05
1/7 [===>..........................] - ETA: 0s - loss: 5.6461e-053/7 [===========>..................] - ETA: 0s - loss: 5.1678e-055/7 [====================>.........] - ETA: 0s - loss: 4.7125e-057/7 [==============================] - ETA: 0s - loss: 4.2183e-057/7 [==============================] - 0s 25ms/step - loss: 4.2183e-05
1/7 [===>..........................] - ETA: 0s - loss: 3.9778e-053/7 [===========>..................] - ETA: 0s - loss: 4.6706e-055/7 [====================>.........] - ETA: 0s - loss: 1.8983e-047/7 [==============================] - ETA: 0s - loss: 1.9818e-047/7 [==============================] - 0s 26ms/step - loss: 1.9818e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.04673/7 [===========>..................] - ETA: 0s - loss: 0.02085/7 [====================>.........] - ETA: 0s - loss: 0.01597/7 [==============================] - ETA: 0s - loss: 0.01727/7 [==============================] - 0s 24ms/step - loss: 0.0172
1/7 [===>..........................] - ETA: 0s - loss: 0.03803/7 [===========>..................] - ETA: 0s - loss: 0.01315/7 [====================>.........] - ETA: 0s - loss: 0.00797/7 [==============================] - ETA: 0s - loss: 0.00627/7 [==============================] - 0s 28ms/step - loss: 0.0062
1/7 [===>..........................] - ETA: 0s - loss: 2.9839e-053/7 [===========>..................] - ETA: 0s - loss: 1.6386e-055/7 [====================>.........] - ETA: 0s - loss: 2.1125e-057/7 [==============================] - ETA: 0s - loss: 2.6694e-057/7 [==============================] - 0s 24ms/step - loss: 2.6694e-05
1/7 [===>..........................] - ETA: 0s - loss: 5.7033e-053/7 [===========>..................] - ETA: 0s - loss: 4.1586e-055/7 [====================>.........] - ETA: 0s - loss: 4.1629e-057/7 [==============================] - ETA: 0s - loss: 3.8249e-057/7 [==============================] - 0s 24ms/step - loss: 3.8249e-05
1/7 [===>..........................] - ETA: 0s - loss: 8.5892e-053/7 [===========>..................] - ETA: 0s - loss: 8.5535e-055/7 [====================>.........] - ETA: 0s - loss: 2.2634e-047/7 [==============================] - 0s 27ms/step - loss: 2.3155e-04
Best parameters {'n_units': 72, 'n_hidden': 2} best score 0.004544022665140801:
Train Score: 0.00478 MSE 0.06916 RMSE
Test Score: 0.00029 MSE 0.01710 RMSE
Deviation Min [4.89425361e-06], Max [0.8475723]
Deviation 99.5th pctile [0.39405255]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1407,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1391,   24]))
Confusion matrix 
[[1383    8]
 [  24    0]]
precision 0.00000, recall 0.00000, f1 0.00000
Time to train: 509188 ms
Saving model models/A1Benchmark/real_48.csv.h5
Total Time to proces all the selected files : 513446 ms
A1Benchmark : Avg precision 0.00000 recall 0.00000 f1 0.00000 time to train 509188.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_48.csv  --epochs 20 --n_iter 3 --patience 3 :: took 520 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_49.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 03:16:46 AM MST
2020-11-30 03:16:52.703331: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 03:16:52.722276: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 03:16:52.723655: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559f089698c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 03:16:52.723690: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 03:16:52.723831: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_49.csv
Shapes: time variant data with labels (1461, 2), full data (1461, 3)
Look back data shapes: lookbackX (1437, 24, 1) lookbackY (1437, 2)
Shapes: Xtrain_full (1149, 24, 1), Ytrain_full (1149, 1), Xtest (288, 24, 1), Ytest (288, 1)
Shapes: Xtrain (1035, 24, 1), Ytrain (1035, 1), Xvalid (114, 24, 1), Yvalid (114, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00365/7 [====================>.........] - ETA: 0s - loss: 0.00397/7 [==============================] - 0s 14ms/step - loss: 0.0036
1/7 [===>..........................] - ETA: 0s - loss: 0.00334/7 [================>.............] - ETA: 0s - loss: 0.00777/7 [==============================] - ETA: 0s - loss: 0.00747/7 [==============================] - 0s 18ms/step - loss: 0.0074
1/7 [===>..........................] - ETA: 0s - loss: 0.00615/7 [====================>.........] - ETA: 0s - loss: 0.00477/7 [==============================] - 0s 11ms/step - loss: 0.0046
1/7 [===>..........................] - ETA: 0s - loss: 0.00384/7 [================>.............] - ETA: 0s - loss: 0.00317/7 [==============================] - ETA: 0s - loss: 0.00377/7 [==============================] - 0s 17ms/step - loss: 0.0037
1/7 [===>..........................] - ETA: 0s - loss: 0.00295/7 [====================>.........] - ETA: 0s - loss: 0.00257/7 [==============================] - 0s 13ms/step - loss: 0.0026
1/7 [===>..........................] - ETA: 0s - loss: 0.00323/7 [===========>..................] - ETA: 0s - loss: 0.00265/7 [====================>.........] - ETA: 0s - loss: 0.00337/7 [==============================] - ETA: 0s - loss: 0.00307/7 [==============================] - 0s 32ms/step - loss: 0.0030
1/7 [===>..........................] - ETA: 0s - loss: 0.00453/7 [===========>..................] - ETA: 0s - loss: 0.01265/7 [====================>.........] - ETA: 0s - loss: 0.00877/7 [==============================] - ETA: 0s - loss: 0.00947/7 [==============================] - 0s 25ms/step - loss: 0.0094
1/7 [===>..........................] - ETA: 0s - loss: 0.00613/7 [===========>..................] - ETA: 0s - loss: 0.00525/7 [====================>.........] - ETA: 0s - loss: 0.00437/7 [==============================] - ETA: 0s - loss: 0.00417/7 [==============================] - 0s 35ms/step - loss: 0.0041
1/7 [===>..........................] - ETA: 0s - loss: 0.00383/7 [===========>..................] - ETA: 0s - loss: 0.00315/7 [====================>.........] - ETA: 0s - loss: 0.00347/7 [==============================] - ETA: 0s - loss: 0.00367/7 [==============================] - 0s 26ms/step - loss: 0.0036
1/7 [===>..........................] - ETA: 0s - loss: 0.00473/7 [===========>..................] - ETA: 0s - loss: 0.00405/7 [====================>.........] - ETA: 0s - loss: 0.00357/7 [==============================] - ETA: 0s - loss: 0.00357/7 [==============================] - 0s 25ms/step - loss: 0.0035
1/7 [===>..........................] - ETA: 0s - loss: 0.00385/7 [====================>.........] - ETA: 0s - loss: 0.00397/7 [==============================] - 0s 14ms/step - loss: 0.0037
1/7 [===>..........................] - ETA: 0s - loss: 0.00235/7 [====================>.........] - ETA: 0s - loss: 0.00637/7 [==============================] - 0s 12ms/step - loss: 0.0068
1/7 [===>..........................] - ETA: 0s - loss: 0.00475/7 [====================>.........] - ETA: 0s - loss: 0.00407/7 [==============================] - 0s 12ms/step - loss: 0.0038
1/7 [===>..........................] - ETA: 0s - loss: 0.00254/7 [================>.............] - ETA: 0s - loss: 0.00237/7 [==============================] - ETA: 0s - loss: 0.00327/7 [==============================] - 0s 16ms/step - loss: 0.0032
1/7 [===>..........................] - ETA: 0s - loss: 0.00366/7 [========================>.....] - ETA: 0s - loss: 0.00347/7 [==============================] - 0s 10ms/step - loss: 0.0034
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.00415420439094305:
Train Score: 0.00561 MSE 0.07490 RMSE
Test Score: 0.00516 MSE 0.07187 RMSE
Deviation Min [9.04053041e-05], Max [0.49070415]
Deviation 99.5th pctile [0.29201533]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1429,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1434,    3]))
Confusion matrix 
[[1429    5]
 [   0    3]]
precision 0.37500, recall 1.00000, f1 0.54545
Time to train: 421959 ms
Saving model models/A1Benchmark/real_49.csv.h5
Total Time to proces all the selected files : 424566 ms
A1Benchmark : Avg precision 0.37500 recall 1.00000 f1 0.54545 time to train 421959.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_49.csv  --epochs 20 --n_iter 3 --patience 3 :: took 431 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_4.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 03:24:02 AM MST
2020-11-30 03:24:09.058545: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 03:24:09.077192: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 03:24:09.078590: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f62fcfb8c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 03:24:09.078635: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 03:24:09.078823: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_4.csv
Shapes: time variant data with labels (1423, 2), full data (1423, 3)
Look back data shapes: lookbackX (1399, 24, 1) lookbackY (1399, 2)
Shapes: Xtrain_full (1119, 24, 1), Ytrain_full (1119, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1008, 24, 1), Ytrain (1008, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 6.5102e-055/7 [====================>.........] - ETA: 0s - loss: 2.1107e-057/7 [==============================] - 0s 14ms/step - loss: 1.8086e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.3987e-055/7 [====================>.........] - ETA: 0s - loss: 1.0048e-057/7 [==============================] - 0s 14ms/step - loss: 9.2659e-06
1/7 [===>..........................] - ETA: 0s - loss: 7.2979e-044/7 [================>.............] - ETA: 0s - loss: 1.8647e-047/7 [==============================] - ETA: 0s - loss: 1.2019e-047/7 [==============================] - 0s 17ms/step - loss: 1.2019e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.6877e-064/7 [================>.............] - ETA: 0s - loss: 8.3720e-067/7 [==============================] - ETA: 0s - loss: 8.9395e-067/7 [==============================] - 0s 15ms/step - loss: 8.9395e-06
1/7 [===>..........................] - ETA: 0s - loss: 5.6172e-065/7 [====================>.........] - ETA: 0s - loss: 1.7918e-047/7 [==============================] - 0s 12ms/step - loss: 1.6839e-04
1/7 [===>..........................] - ETA: 0s - loss: 6.9613e-053/7 [===========>..................] - ETA: 0s - loss: 3.7085e-055/7 [====================>.........] - ETA: 0s - loss: 2.4778e-057/7 [==============================] - ETA: 0s - loss: 2.1429e-057/7 [==============================] - 0s 22ms/step - loss: 2.1429e-05
1/7 [===>..........................] - ETA: 0s - loss: 5.3614e-063/7 [===========>..................] - ETA: 0s - loss: 6.3119e-065/7 [====================>.........] - ETA: 0s - loss: 5.1714e-067/7 [==============================] - ETA: 0s - loss: 4.9498e-067/7 [==============================] - 0s 24ms/step - loss: 4.9498e-06
1/7 [===>..........................] - ETA: 0s - loss: 7.5637e-043/7 [===========>..................] - ETA: 0s - loss: 2.5626e-045/7 [====================>.........] - ETA: 0s - loss: 1.5593e-047/7 [==============================] - 0s 23ms/step - loss: 1.2427e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.0241e-063/7 [===========>..................] - ETA: 0s - loss: 3.6367e-065/7 [====================>.........] - ETA: 0s - loss: 4.7692e-067/7 [==============================] - ETA: 0s - loss: 5.3236e-067/7 [==============================] - 0s 28ms/step - loss: 5.3236e-06
1/7 [===>..........................] - ETA: 0s - loss: 8.5882e-063/7 [===========>..................] - ETA: 0s - loss: 5.7284e-065/7 [====================>.........] - ETA: 0s - loss: 1.7934e-047/7 [==============================] - ETA: 0s - loss: 1.6884e-047/7 [==============================] - 0s 33ms/step - loss: 1.6884e-04
1/7 [===>..........................] - ETA: 0s - loss: 6.1850e-053/7 [===========>..................] - ETA: 0s - loss: 2.8509e-055/7 [====================>.........] - ETA: 0s - loss: 1.8863e-057/7 [==============================] - ETA: 0s - loss: 1.6182e-057/7 [==============================] - 0s 26ms/step - loss: 1.6182e-05
1/7 [===>..........................] - ETA: 0s - loss: 3.4350e-063/7 [===========>..................] - ETA: 0s - loss: 9.2144e-065/7 [====================>.........] - ETA: 0s - loss: 8.5416e-067/7 [==============================] - ETA: 0s - loss: 9.1517e-067/7 [==============================] - 0s 27ms/step - loss: 9.1517e-06
1/7 [===>..........................] - ETA: 0s - loss: 7.6992e-043/7 [===========>..................] - ETA: 0s - loss: 2.6281e-044/7 [================>.............] - ETA: 0s - loss: 1.9878e-045/7 [====================>.........] - ETA: 0s - loss: 1.6125e-047/7 [==============================] - ETA: 0s - loss: 1.2913e-047/7 [==============================] - 0s 35ms/step - loss: 1.2913e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.0482e-063/7 [===========>..................] - ETA: 0s - loss: 4.3994e-065/7 [====================>.........] - ETA: 0s - loss: 5.2124e-067/7 [==============================] - ETA: 0s - loss: 5.7293e-067/7 [==============================] - 0s 33ms/step - loss: 5.7293e-06
1/7 [===>..........................] - ETA: 0s - loss: 3.6980e-063/7 [===========>..................] - ETA: 0s - loss: 4.6121e-065/7 [====================>.........] - ETA: 0s - loss: 1.8506e-047/7 [==============================] - ETA: 0s - loss: 1.7462e-047/7 [==============================] - 0s 33ms/step - loss: 1.7462e-04
Best parameters {'n_units': 48, 'n_hidden': 2} best score 6.496422884083586e-05:
Train Score: 0.00006 MSE 0.00793 RMSE
Test Score: 0.00684 MSE 0.08272 RMSE
Deviation Min [8.02244236e-06], Max [0.99252918]
Deviation 99.5th pctile [0.15188088]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1392,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1394,    5]))
Confusion matrix 
[[1392    2]
 [   0    5]]
precision 0.71429, recall 1.00000, f1 0.83333
Time to train: 218481 ms
Saving model models/A1Benchmark/real_4.csv.h5
Total Time to proces all the selected files : 222000 ms
A1Benchmark : Avg precision 0.71429 recall 1.00000 f1 0.83333 time to train 218481.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_4.csv  --epochs 20 --n_iter 3 --patience 3 :: took 229 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_50.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 03:27:56 AM MST
2020-11-30 03:28:02.832069: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 03:28:02.839056: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 03:28:02.839745: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55bcc4cd28c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 03:28:02.839767: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 03:28:02.839891: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_50.csv
Shapes: time variant data with labels (1439, 2), full data (1439, 3)
Look back data shapes: lookbackX (1415, 24, 1) lookbackY (1415, 2)
Shapes: Xtrain_full (1132, 24, 1), Ytrain_full (1132, 1), Xtest (283, 24, 1), Ytest (283, 1)
Shapes: Xtrain (1019, 24, 1), Ytrain (1019, 1), Xvalid (113, 24, 1), Yvalid (113, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00113/7 [===========>..................] - ETA: 0s - loss: 0.00215/7 [====================>.........] - ETA: 0s - loss: 0.00227/7 [==============================] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 23ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 0.00223/7 [===========>..................] - ETA: 0s - loss: 0.00385/7 [====================>.........] - ETA: 0s - loss: 0.00357/7 [==============================] - ETA: 0s - loss: 0.00347/7 [==============================] - 0s 30ms/step - loss: 0.0034
1/7 [===>..........................] - ETA: 0s - loss: 0.00333/7 [===========>..................] - ETA: 0s - loss: 0.00535/7 [====================>.........] - ETA: 0s - loss: 0.00437/7 [==============================] - ETA: 0s - loss: 0.00447/7 [==============================] - 0s 33ms/step - loss: 0.0044
1/7 [===>..........................] - ETA: 0s - loss: 0.00423/7 [===========>..................] - ETA: 0s - loss: 0.00295/7 [====================>.........] - ETA: 0s - loss: 0.00307/7 [==============================] - ETA: 0s - loss: 0.00307/7 [==============================] - 0s 36ms/step - loss: 0.0030
1/7 [===>..........................] - ETA: 0s - loss: 0.00404/7 [================>.............] - ETA: 0s - loss: 0.00306/7 [========================>.....] - ETA: 0s - loss: 0.00307/7 [==============================] - 0s 27ms/step - loss: 0.0030
1/7 [===>..........................] - ETA: 0s - loss: 0.00153/7 [===========>..................] - ETA: 0s - loss: 0.00225/7 [====================>.........] - ETA: 0s - loss: 0.00237/7 [==============================] - ETA: 0s - loss: 0.00217/7 [==============================] - 0s 34ms/step - loss: 0.0021
1/7 [===>..........................] - ETA: 0s - loss: 0.00233/7 [===========>..................] - ETA: 0s - loss: 0.00425/7 [====================>.........] - ETA: 0s - loss: 0.00417/7 [==============================] - ETA: 0s - loss: 0.00417/7 [==============================] - 0s 25ms/step - loss: 0.0041
1/7 [===>..........................] - ETA: 0s - loss: 0.01693/7 [===========>..................] - ETA: 0s - loss: 0.01344/7 [================>.............] - ETA: 0s - loss: 0.01316/7 [========================>.....] - ETA: 0s - loss: 0.01127/7 [==============================] - 0s 30ms/step - loss: 0.0118
1/7 [===>..........................] - ETA: 0s - loss: 0.00463/7 [===========>..................] - ETA: 0s - loss: 0.00365/7 [====================>.........] - ETA: 0s - loss: 0.00367/7 [==============================] - ETA: 0s - loss: 0.00367/7 [==============================] - 0s 29ms/step - loss: 0.0036
1/7 [===>..........................] - ETA: 0s - loss: 0.00343/7 [===========>..................] - ETA: 0s - loss: 0.00255/7 [====================>.........] - ETA: 0s - loss: 0.00237/7 [==============================] - ETA: 0s - loss: 0.00227/7 [==============================] - 0s 23ms/step - loss: 0.0022
1/7 [===>..........................] - ETA: 0s - loss: 0.00115/7 [====================>.........] - ETA: 0s - loss: 0.00217/7 [==============================] - 0s 12ms/step - loss: 0.0019
1/7 [===>..........................] - ETA: 0s - loss: 0.00484/7 [================>.............] - ETA: 0s - loss: 0.00667/7 [==============================] - ETA: 0s - loss: 0.00637/7 [==============================] - 0s 17ms/step - loss: 0.0063
1/7 [===>..........................] - ETA: 0s - loss: 0.00465/7 [====================>.........] - ETA: 0s - loss: 0.00437/7 [==============================] - 0s 14ms/step - loss: 0.0038
1/7 [===>..........................] - ETA: 0s - loss: 0.00404/7 [================>.............] - ETA: 0s - loss: 0.00297/7 [==============================] - ETA: 0s - loss: 0.00277/7 [==============================] - 0s 16ms/step - loss: 0.0027
1/7 [===>..........................] - ETA: 0s - loss: 0.00235/7 [====================>.........] - ETA: 0s - loss: 0.00227/7 [==============================] - 0s 12ms/step - loss: 0.0021
Best parameters {'n_units': 48, 'n_hidden': 2} best score 0.003137173131108284:
Train Score: 0.00789 MSE 0.08880 RMSE
Test Score: 0.01619 MSE 0.12726 RMSE
Deviation Min [0.00016493], Max [0.62300342]
Deviation 99.5th pctile [0.35294819]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1407,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1408,    7]))
Confusion matrix 
[[1407    1]
 [   0    7]]
precision 0.87500, recall 1.00000, f1 0.93333
Time to train: 495389 ms
Saving model models/A1Benchmark/real_50.csv.h5
Total Time to proces all the selected files : 499097 ms
A1Benchmark : Avg precision 0.87500 recall 1.00000 f1 0.93333 time to train 495389.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_50.csv  --epochs 20 --n_iter 3 --patience 3 :: took 506 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_51.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 03:36:27 AM MST
2020-11-30 03:36:33.599031: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 03:36:33.618194: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 03:36:33.619097: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5605fb8fa8c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 03:36:33.619137: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 03:36:33.619281: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_51.csv
Shapes: time variant data with labels (1427, 2), full data (1427, 3)
Look back data shapes: lookbackX (1403, 24, 1) lookbackY (1403, 2)
Shapes: Xtrain_full (1122, 24, 1), Ytrain_full (1122, 1), Xtest (281, 24, 1), Ytest (281, 1)
Shapes: Xtrain (1010, 24, 1), Ytrain (1010, 1), Xvalid (112, 24, 1), Yvalid (112, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00433/7 [===========>..................] - ETA: 0s - loss: 0.00765/7 [====================>.........] - ETA: 0s - loss: 0.00647/7 [==============================] - ETA: 0s - loss: 0.00597/7 [==============================] - 0s 29ms/step - loss: 0.0059
1/7 [===>..........................] - ETA: 0s - loss: 0.00453/7 [===========>..................] - ETA: 0s - loss: 0.00515/7 [====================>.........] - ETA: 0s - loss: 0.00497/7 [==============================] - ETA: 0s - loss: 0.00467/7 [==============================] - 0s 32ms/step - loss: 0.0046
1/7 [===>..........................] - ETA: 0s - loss: 0.00613/7 [===========>..................] - ETA: 0s - loss: 0.00625/7 [====================>.........] - ETA: 0s - loss: 0.00587/7 [==============================] - ETA: 0s - loss: 0.00617/7 [==============================] - 0s 29ms/step - loss: 0.0061
1/7 [===>..........................] - ETA: 0s - loss: 0.00294/7 [================>.............] - ETA: 0s - loss: 0.00216/7 [========================>.....] - ETA: 0s - loss: 0.00327/7 [==============================] - 0s 22ms/step - loss: 0.0031
1/7 [===>..........................] - ETA: 0s - loss: 0.00643/7 [===========>..................] - ETA: 0s - loss: 0.01595/7 [====================>.........] - ETA: 0s - loss: 0.01617/7 [==============================] - ETA: 0s - loss: 0.01497/7 [==============================] - 0s 32ms/step - loss: 0.0149
1/7 [===>..........................] - ETA: 0s - loss: 0.00133/7 [===========>..................] - ETA: 0s - loss: 0.00305/7 [====================>.........] - ETA: 0s - loss: 0.00257/7 [==============================] - ETA: 0s - loss: 0.00227/7 [==============================] - 0s 34ms/step - loss: 0.0022
1/7 [===>..........................] - ETA: 0s - loss: 0.00573/7 [===========>..................] - ETA: 0s - loss: 0.00585/7 [====================>.........] - ETA: 0s - loss: 0.00457/7 [==============================] - ETA: 0s - loss: 0.00477/7 [==============================] - 0s 29ms/step - loss: 0.0047
1/7 [===>..........................] - ETA: 0s - loss: 0.00273/7 [===========>..................] - ETA: 0s - loss: 0.00335/7 [====================>.........] - ETA: 0s - loss: 0.00297/7 [==============================] - ETA: 0s - loss: 0.00297/7 [==============================] - 0s 31ms/step - loss: 0.0029
1/7 [===>..........................] - ETA: 0s - loss: 0.00373/7 [===========>..................] - ETA: 0s - loss: 0.00265/7 [====================>.........] - ETA: 0s - loss: 0.00347/7 [==============================] - ETA: 0s - loss: 0.00357/7 [==============================] - 0s 31ms/step - loss: 0.0035
1/7 [===>..........................] - ETA: 0s - loss: 0.00673/7 [===========>..................] - ETA: 0s - loss: 0.01625/7 [====================>.........] - ETA: 0s - loss: 0.01527/7 [==============================] - ETA: 0s - loss: 0.01417/7 [==============================] - 0s 28ms/step - loss: 0.0141
1/7 [===>..........................] - ETA: 0s - loss: 0.00115/7 [====================>.........] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 14ms/step - loss: 0.0019
1/7 [===>..........................] - ETA: 0s - loss: 0.00805/7 [====================>.........] - ETA: 0s - loss: 0.00817/7 [==============================] - 0s 14ms/step - loss: 0.0078
1/7 [===>..........................] - ETA: 0s - loss: 0.00394/7 [================>.............] - ETA: 0s - loss: 0.00367/7 [==============================] - ETA: 0s - loss: 0.00407/7 [==============================] - 0s 19ms/step - loss: 0.0040
1/7 [===>..........................] - ETA: 0s - loss: 0.00294/7 [================>.............] - ETA: 0s - loss: 0.00237/7 [==============================] - ETA: 0s - loss: 0.00297/7 [==============================] - 0s 19ms/step - loss: 0.0029
1/7 [===>..........................] - ETA: 0s - loss: 0.02984/7 [================>.............] - ETA: 0s - loss: 0.03157/7 [==============================] - ETA: 0s - loss: 0.03367/7 [==============================] - 0s 19ms/step - loss: 0.0336
Best parameters {'n_units': 72, 'n_hidden': 2} best score 0.0054582673590630295:
Train Score: 0.00461 MSE 0.06792 RMSE
Test Score: 0.00831 MSE 0.09116 RMSE
Deviation Min [6.58031182e-06], Max [0.68924272]
Deviation 99.5th pctile [0.22810111]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1395,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1399,    4]))
Confusion matrix 
[[1394    5]
 [   1    3]]
precision 0.37500, recall 0.75000, f1 0.50000
Time to train: 672496 ms
Saving model models/A1Benchmark/real_51.csv.h5
Total Time to proces all the selected files : 676263 ms
A1Benchmark : Avg precision 0.37500 recall 0.75000 f1 0.50000 time to train 672496.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_51.csv  --epochs 20 --n_iter 3 --patience 3 :: took 683 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_52.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 03:47:55 AM MST
2020-11-30 03:48:01.345983: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 03:48:01.364267: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 03:48:01.365840: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55ae866dacf0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 03:48:01.365907: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 03:48:01.366122: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_52.csv
Shapes: time variant data with labels (1432, 2), full data (1432, 3)
Look back data shapes: lookbackX (1408, 24, 1) lookbackY (1408, 2)
Shapes: Xtrain_full (1126, 24, 1), Ytrain_full (1126, 1), Xtest (282, 24, 1), Ytest (282, 1)
Shapes: Xtrain (1014, 24, 1), Ytrain (1014, 1), Xvalid (112, 24, 1), Yvalid (112, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00315/7 [====================>.........] - ETA: 0s - loss: 0.00307/7 [==============================] - 0s 12ms/step - loss: 0.0030
1/7 [===>..........................] - ETA: 0s - loss: 0.01424/7 [================>.............] - ETA: 0s - loss: 0.00567/7 [==============================] - 0s 13ms/step - loss: 0.0045
1/7 [===>..........................] - ETA: 0s - loss: 0.00555/7 [====================>.........] - ETA: 0s - loss: 0.00547/7 [==============================] - 0s 12ms/step - loss: 0.0055
1/7 [===>..........................] - ETA: 0s - loss: 0.00316/7 [========================>.....] - ETA: 0s - loss: 0.00687/7 [==============================] - 0s 11ms/step - loss: 0.0066
1/7 [===>..........................] - ETA: 0s - loss: 0.00165/7 [====================>.........] - ETA: 0s - loss: 0.00807/7 [==============================] - 0s 12ms/step - loss: 0.0070
1/7 [===>..........................] - ETA: 0s - loss: 0.00135/7 [====================>.........] - ETA: 0s - loss: 0.00147/7 [==============================] - 0s 13ms/step - loss: 0.0016
1/7 [===>..........................] - ETA: 0s - loss: 0.02844/7 [================>.............] - ETA: 0s - loss: 0.01767/7 [==============================] - ETA: 0s - loss: 0.01547/7 [==============================] - 0s 19ms/step - loss: 0.0154
1/7 [===>..........................] - ETA: 0s - loss: 0.00194/7 [================>.............] - ETA: 0s - loss: 0.00207/7 [==============================] - ETA: 0s - loss: 0.00217/7 [==============================] - 0s 20ms/step - loss: 0.0021
1/7 [===>..........................] - ETA: 0s - loss: 0.00425/7 [====================>.........] - ETA: 0s - loss: 0.00807/7 [==============================] - 0s 14ms/step - loss: 0.0072
1/7 [===>..........................] - ETA: 0s - loss: 0.00165/7 [====================>.........] - ETA: 0s - loss: 0.00697/7 [==============================] - 0s 14ms/step - loss: 0.0059
1/7 [===>..........................] - ETA: 0s - loss: 0.00422/7 [=======>......................] - ETA: 0s - loss: 0.00524/7 [================>.............] - ETA: 0s - loss: 0.00466/7 [========================>.....] - ETA: 0s - loss: 0.00467/7 [==============================] - 0s 31ms/step - loss: 0.0046
1/7 [===>..........................] - ETA: 0s - loss: 0.01323/7 [===========>..................] - ETA: 0s - loss: 0.00625/7 [====================>.........] - ETA: 0s - loss: 0.00517/7 [==============================] - ETA: 0s - loss: 0.00467/7 [==============================] - 0s 29ms/step - loss: 0.0046
1/7 [===>..........................] - ETA: 0s - loss: 0.00443/7 [===========>..................] - ETA: 0s - loss: 0.00505/7 [====================>.........] - ETA: 0s - loss: 0.00517/7 [==============================] - ETA: 0s - loss: 0.00517/7 [==============================] - 0s 27ms/step - loss: 0.0051
1/7 [===>..........................] - ETA: 0s - loss: 0.00213/7 [===========>..................] - ETA: 0s - loss: 0.01065/7 [====================>.........] - ETA: 0s - loss: 0.00707/7 [==============================] - ETA: 0s - loss: 0.00587/7 [==============================] - 0s 27ms/step - loss: 0.0058
1/7 [===>..........................] - ETA: 0s - loss: 0.00213/7 [===========>..................] - ETA: 0s - loss: 0.00235/7 [====================>.........] - ETA: 0s - loss: 0.00757/7 [==============================] - ETA: 0s - loss: 0.00647/7 [==============================] - 0s 25ms/step - loss: 0.0064
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.00533658592030406:
Train Score: 0.00352 MSE 0.05935 RMSE
Test Score: 0.00341 MSE 0.05841 RMSE
Deviation Min [2.79359952e-05], Max [0.90117026]
Deviation 99.5th pctile [0.14553516]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1400,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1397,   11]))
Confusion matrix 
[[1395    2]
 [   5    6]]
precision 0.75000, recall 0.54545, f1 0.63158
Time to train: 598487 ms
Saving model models/A1Benchmark/real_52.csv.h5
Total Time to proces all the selected files : 602379 ms
A1Benchmark : Avg precision 0.75000 recall 0.54545 f1 0.63158 time to train 598487.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_52.csv  --epochs 20 --n_iter 3 --patience 3 :: took 609 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_53.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 03:58:09 AM MST
2020-11-30 03:58:15.180079: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 03:58:15.199220: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 03:58:15.200541: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x556172b15cf0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 03:58:15.200590: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 03:58:15.200785: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_53.csv
Shapes: time variant data with labels (1461, 2), full data (1461, 3)
Look back data shapes: lookbackX (1437, 24, 1) lookbackY (1437, 2)
Shapes: Xtrain_full (1149, 24, 1), Ytrain_full (1149, 1), Xtest (288, 24, 1), Ytest (288, 1)
Shapes: Xtrain (1035, 24, 1), Ytrain (1035, 1), Xvalid (114, 24, 1), Yvalid (114, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00233/7 [===========>..................] - ETA: 0s - loss: 0.00275/7 [====================>.........] - ETA: 0s - loss: 0.00267/7 [==============================] - ETA: 0s - loss: 0.00287/7 [==============================] - 0s 29ms/step - loss: 0.0028
1/7 [===>..........................] - ETA: 0s - loss: 0.00513/7 [===========>..................] - ETA: 0s - loss: 0.00465/7 [====================>.........] - ETA: 0s - loss: 0.00357/7 [==============================] - ETA: 0s - loss: 0.00337/7 [==============================] - 0s 33ms/step - loss: 0.0033
1/7 [===>..........................] - ETA: 0s - loss: 0.00293/7 [===========>..................] - ETA: 0s - loss: 0.00235/7 [====================>.........] - ETA: 0s - loss: 0.00257/7 [==============================] - ETA: 0s - loss: 0.00277/7 [==============================] - 0s 33ms/step - loss: 0.0027
1/7 [===>..........................] - ETA: 0s - loss: 0.00293/7 [===========>..................] - ETA: 0s - loss: 0.00295/7 [====================>.........] - ETA: 0s - loss: 0.00257/7 [==============================] - ETA: 0s - loss: 0.00247/7 [==============================] - 0s 24ms/step - loss: 0.0024
1/7 [===>..........................] - ETA: 0s - loss: 0.00243/7 [===========>..................] - ETA: 0s - loss: 0.00225/7 [====================>.........] - ETA: 0s - loss: 0.00267/7 [==============================] - ETA: 0s - loss: 0.00257/7 [==============================] - 0s 31ms/step - loss: 0.0025
1/7 [===>..........................] - ETA: 0s - loss: 0.00214/7 [================>.............] - ETA: 0s - loss: 0.00227/7 [==============================] - 0s 14ms/step - loss: 0.0024
1/7 [===>..........................] - ETA: 0s - loss: 0.00434/7 [================>.............] - ETA: 0s - loss: 0.00357/7 [==============================] - ETA: 0s - loss: 0.00307/7 [==============================] - 0s 18ms/step - loss: 0.0030
1/7 [===>..........................] - ETA: 0s - loss: 0.00265/7 [====================>.........] - ETA: 0s - loss: 0.00247/7 [==============================] - 0s 13ms/step - loss: 0.0025
1/7 [===>..........................] - ETA: 0s - loss: 0.00264/7 [================>.............] - ETA: 0s - loss: 0.00247/7 [==============================] - ETA: 0s - loss: 0.00227/7 [==============================] - 0s 19ms/step - loss: 0.0022
1/7 [===>..........................] - ETA: 0s - loss: 0.00194/7 [================>.............] - ETA: 0s - loss: 0.00227/7 [==============================] - ETA: 0s - loss: 0.00217/7 [==============================] - 0s 17ms/step - loss: 0.0021
1/7 [===>..........................] - ETA: 0s - loss: 0.00223/7 [===========>..................] - ETA: 0s - loss: 0.00265/7 [====================>.........] - ETA: 0s - loss: 0.00257/7 [==============================] - ETA: 0s - loss: 0.00267/7 [==============================] - 0s 24ms/step - loss: 0.0026
1/7 [===>..........................] - ETA: 0s - loss: 0.00513/7 [===========>..................] - ETA: 0s - loss: 0.00475/7 [====================>.........] - ETA: 0s - loss: 0.00357/7 [==============================] - ETA: 0s - loss: 0.00347/7 [==============================] - 0s 32ms/step - loss: 0.0034
1/7 [===>..........................] - ETA: 0s - loss: 0.00283/7 [===========>..................] - ETA: 0s - loss: 0.00235/7 [====================>.........] - ETA: 0s - loss: 0.00267/7 [==============================] - ETA: 0s - loss: 0.00277/7 [==============================] - 0s 26ms/step - loss: 0.0027
1/7 [===>..........................] - ETA: 0s - loss: 0.00273/7 [===========>..................] - ETA: 0s - loss: 0.00285/7 [====================>.........] - ETA: 0s - loss: 0.00257/7 [==============================] - ETA: 0s - loss: 0.00247/7 [==============================] - 0s 29ms/step - loss: 0.0024
1/7 [===>..........................] - ETA: 0s - loss: 0.00223/7 [===========>..................] - ETA: 0s - loss: 0.00205/7 [====================>.........] - ETA: 0s - loss: 0.00247/7 [==============================] - ETA: 0s - loss: 0.00247/7 [==============================] - 0s 36ms/step - loss: 0.0024
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0024280980229377746:
Train Score: 0.00256 MSE 0.05056 RMSE
Test Score: 0.00924 MSE 0.09610 RMSE
Deviation Min [4.99539516e-06], Max [0.55481948]
Deviation 99.5th pctile [0.36868963]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1429,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1420,   17]))
Confusion matrix 
[[1420    0]
 [   9    8]]
precision 1.00000, recall 0.47059, f1 0.64000
Time to train: 287724 ms
Saving model models/A1Benchmark/real_53.csv.h5
Total Time to proces all the selected files : 290361 ms
A1Benchmark : Avg precision 1.00000 recall 0.47059 f1 0.64000 time to train 287724.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_53.csv  --epochs 20 --n_iter 3 --patience 3 :: took 296 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_54.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 04:03:10 AM MST
2020-11-30 04:03:17.077562: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 04:03:17.096211: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 04:03:17.097614: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55ecb06018c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 04:03:17.097664: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 04:03:17.097839: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_54.csv
Shapes: time variant data with labels (741, 2), full data (741, 3)
Look back data shapes: lookbackX (717, 24, 1) lookbackY (717, 2)
Shapes: Xtrain_full (573, 24, 1), Ytrain_full (573, 1), Xtest (144, 24, 1), Ytest (144, 1)
Shapes: Xtrain (516, 24, 1), Ytrain (516, 1), Xvalid (57, 24, 1), Yvalid (57, 1)
1/4 [======>.......................] - ETA: 0s - loss: 0.00594/4 [==============================] - 0s 12ms/step - loss: 0.0086
1/4 [======>.......................] - ETA: 0s - loss: 0.00154/4 [==============================] - ETA: 0s - loss: 0.00174/4 [==============================] - 0s 13ms/step - loss: 0.0017
1/4 [======>.......................] - ETA: 0s - loss: 0.00904/4 [==============================] - 0s 10ms/step - loss: 0.0080
1/4 [======>.......................] - ETA: 0s - loss: 0.00424/4 [==============================] - 0s 11ms/step - loss: 0.0037
1/4 [======>.......................] - ETA: 0s - loss: 0.00634/4 [==============================] - 0s 11ms/step - loss: 0.0056
1/4 [======>.......................] - ETA: 0s - loss: 0.00894/4 [==============================] - 0s 10ms/step - loss: 0.0125
1/4 [======>.......................] - ETA: 0s - loss: 0.00994/4 [==============================] - ETA: 0s - loss: 0.00734/4 [==============================] - 0s 14ms/step - loss: 0.0073
1/4 [======>.......................] - ETA: 0s - loss: 0.00554/4 [==============================] - 0s 8ms/step - loss: 0.0062
1/4 [======>.......................] - ETA: 0s - loss: 0.01154/4 [==============================] - 0s 11ms/step - loss: 0.0095
1/4 [======>.......................] - ETA: 0s - loss: 0.01424/4 [==============================] - 0s 8ms/step - loss: 0.0121
1/4 [======>.......................] - ETA: 0s - loss: 0.00923/4 [=====================>........] - ETA: 0s - loss: 0.01144/4 [==============================] - 0s 20ms/step - loss: 0.0139
1/4 [======>.......................] - ETA: 0s - loss: 0.01693/4 [=====================>........] - ETA: 0s - loss: 0.02014/4 [==============================] - 0s 27ms/step - loss: 0.0194
1/4 [======>.......................] - ETA: 0s - loss: 0.01263/4 [=====================>........] - ETA: 0s - loss: 0.01154/4 [==============================] - 0s 19ms/step - loss: 0.0108
1/4 [======>.......................] - ETA: 0s - loss: 0.00273/4 [=====================>........] - ETA: 0s - loss: 0.00354/4 [==============================] - 0s 19ms/step - loss: 0.0037
1/4 [======>.......................] - ETA: 0s - loss: 0.01393/4 [=====================>........] - ETA: 0s - loss: 0.01154/4 [==============================] - 0s 19ms/step - loss: 0.0114
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.005495698982849717:
Train Score: 0.00480 MSE 0.06926 RMSE
Test Score: 0.00295 MSE 0.05436 RMSE
Deviation Min [8.22704768e-05], Max [0.58844143]
Deviation 99.5th pctile [0.24907949]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([713,   4]))
Actual is_anomaly labels in data (array([0, 1]), array([713,   4]))
Confusion matrix 
[[713   0]
 [  0   4]]
precision 1.00000, recall 1.00000, f1 1.00000
Time to train: 270065 ms
Saving model models/A1Benchmark/real_54.csv.h5
Total Time to proces all the selected files : 271674 ms
A1Benchmark : Avg precision 1.00000 recall 1.00000 f1 1.00000 time to train 270065.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_54.csv  --epochs 20 --n_iter 3 --patience 3 :: took 279 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_55.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 04:07:54 AM MST
2020-11-30 04:08:00.228377: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 04:08:00.247249: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 04:08:00.248737: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x555bc1302c60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 04:08:00.248789: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 04:08:00.249001: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_55.csv
Shapes: time variant data with labels (1427, 2), full data (1427, 3)
Look back data shapes: lookbackX (1403, 24, 1) lookbackY (1403, 2)
Shapes: Xtrain_full (1122, 24, 1), Ytrain_full (1122, 1), Xtest (281, 24, 1), Ytest (281, 1)
Shapes: Xtrain (1010, 24, 1), Ytrain (1010, 1), Xvalid (112, 24, 1), Yvalid (112, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00423/7 [===========>..................] - ETA: 0s - loss: 0.00295/7 [====================>.........] - ETA: 0s - loss: 0.00337/7 [==============================] - ETA: 0s - loss: 0.00317/7 [==============================] - 0s 29ms/step - loss: 0.0031
1/7 [===>..........................] - ETA: 0s - loss: 0.00443/7 [===========>..................] - ETA: 0s - loss: 0.00445/7 [====================>.........] - ETA: 0s - loss: 0.00467/7 [==============================] - ETA: 0s - loss: 0.00437/7 [==============================] - 0s 36ms/step - loss: 0.0043
1/7 [===>..........................] - ETA: 0s - loss: 0.00413/7 [===========>..................] - ETA: 0s - loss: 0.00695/7 [====================>.........] - ETA: 0s - loss: 0.00567/7 [==============================] - ETA: 0s - loss: 0.00537/7 [==============================] - 0s 31ms/step - loss: 0.0053
1/7 [===>..........................] - ETA: 0s - loss: 0.00233/7 [===========>..................] - ETA: 0s - loss: 0.00215/7 [====================>.........] - ETA: 0s - loss: 0.00207/7 [==============================] - ETA: 0s - loss: 0.00277/7 [==============================] - 0s 27ms/step - loss: 0.0027
1/7 [===>..........................] - ETA: 0s - loss: 0.02283/7 [===========>..................] - ETA: 0s - loss: 0.02995/7 [====================>.........] - ETA: 0s - loss: 0.03017/7 [==============================] - ETA: 0s - loss: 0.03147/7 [==============================] - 0s 38ms/step - loss: 0.0314
1/7 [===>..........................] - ETA: 0s - loss: 0.00285/7 [====================>.........] - ETA: 0s - loss: 0.00267/7 [==============================] - 0s 14ms/step - loss: 0.0025
1/7 [===>..........................] - ETA: 0s - loss: 0.00544/7 [================>.............] - ETA: 0s - loss: 0.00627/7 [==============================] - ETA: 0s - loss: 0.00617/7 [==============================] - 0s 17ms/step - loss: 0.0061
1/7 [===>..........................] - ETA: 0s - loss: 0.00454/7 [================>.............] - ETA: 0s - loss: 0.00637/7 [==============================] - 0s 14ms/step - loss: 0.0058
1/7 [===>..........................] - ETA: 0s - loss: 0.00324/7 [================>.............] - ETA: 0s - loss: 0.00277/7 [==============================] - ETA: 0s - loss: 0.00327/7 [==============================] - 0s 16ms/step - loss: 0.0032
1/7 [===>..........................] - ETA: 0s - loss: 0.00825/7 [====================>.........] - ETA: 0s - loss: 0.01127/7 [==============================] - 0s 13ms/step - loss: 0.0117
1/7 [===>..........................] - ETA: 0s - loss: 0.00353/7 [===========>..................] - ETA: 0s - loss: 0.00265/7 [====================>.........] - ETA: 0s - loss: 0.00277/7 [==============================] - ETA: 0s - loss: 0.00267/7 [==============================] - 0s 33ms/step - loss: 0.0026
1/7 [===>..........................] - ETA: 0s - loss: 0.00203/7 [===========>..................] - ETA: 0s - loss: 0.00205/7 [====================>.........] - ETA: 0s - loss: 0.00197/7 [==============================] - ETA: 0s - loss: 0.00197/7 [==============================] - 0s 35ms/step - loss: 0.0019
1/7 [===>..........................] - ETA: 0s - loss: 0.00313/7 [===========>..................] - ETA: 0s - loss: 0.00515/7 [====================>.........] - ETA: 0s - loss: 0.00417/7 [==============================] - ETA: 0s - loss: 0.00387/7 [==============================] - 0s 31ms/step - loss: 0.0038
1/7 [===>..........................] - ETA: 0s - loss: 0.00233/7 [===========>..................] - ETA: 0s - loss: 0.00235/7 [====================>.........] - ETA: 0s - loss: 0.00237/7 [==============================] - ETA: 0s - loss: 0.00317/7 [==============================] - 0s 33ms/step - loss: 0.0031
1/7 [===>..........................] - ETA: 0s - loss: 0.00623/7 [===========>..................] - ETA: 0s - loss: 0.00875/7 [====================>.........] - ETA: 0s - loss: 0.00817/7 [==============================] - ETA: 0s - loss: 0.00857/7 [==============================] - 0s 33ms/step - loss: 0.0085
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.0039632995147258045:
Train Score: 0.00603 MSE 0.07763 RMSE
Test Score: 0.00969 MSE 0.09843 RMSE
Deviation Min [6.69870548e-05], Max [0.647606]
Deviation 99.5th pctile [0.26920748]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1395,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1398,    5]))
Confusion matrix 
[[1394    4]
 [   1    4]]
precision 0.50000, recall 0.80000, f1 0.61538
Time to train: 553307 ms
Saving model models/A1Benchmark/real_55.csv.h5
Total Time to proces all the selected files : 557750 ms
A1Benchmark : Avg precision 0.50000 recall 0.80000 f1 0.61538 time to train 553307.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_55.csv  --epochs 20 --n_iter 3 --patience 3 :: took 564 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_56.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 04:17:23 AM MST
2020-11-30 04:17:29.518392: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 04:17:29.537226: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 04:17:29.538804: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5613b1749c60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 04:17:29.538849: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 04:17:29.539049: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_56.csv
Shapes: time variant data with labels (1427, 2), full data (1427, 3)
Look back data shapes: lookbackX (1403, 24, 1) lookbackY (1403, 2)
Shapes: Xtrain_full (1122, 24, 1), Ytrain_full (1122, 1), Xtest (281, 24, 1), Ytest (281, 1)
Shapes: Xtrain (1010, 24, 1), Ytrain (1010, 1), Xvalid (112, 24, 1), Yvalid (112, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00835/7 [====================>.........] - ETA: 0s - loss: 0.00587/7 [==============================] - 0s 13ms/step - loss: 0.0056
1/7 [===>..........................] - ETA: 0s - loss: 0.00475/7 [====================>.........] - ETA: 0s - loss: 0.00697/7 [==============================] - 0s 13ms/step - loss: 0.0067
1/7 [===>..........................] - ETA: 0s - loss: 0.00865/7 [====================>.........] - ETA: 0s - loss: 0.01157/7 [==============================] - 0s 13ms/step - loss: 0.0110
1/7 [===>..........................] - ETA: 0s - loss: 0.00965/7 [====================>.........] - ETA: 0s - loss: 0.00647/7 [==============================] - 0s 13ms/step - loss: 0.0071
1/7 [===>..........................] - ETA: 0s - loss: 0.00605/7 [====================>.........] - ETA: 0s - loss: 0.01237/7 [==============================] - 0s 12ms/step - loss: 0.0127
1/7 [===>..........................] - ETA: 0s - loss: 0.01013/7 [===========>..................] - ETA: 0s - loss: 0.00795/7 [====================>.........] - ETA: 0s - loss: 0.00867/7 [==============================] - ETA: 0s - loss: 0.00847/7 [==============================] - 0s 28ms/step - loss: 0.0084
1/7 [===>..........................] - ETA: 0s - loss: 0.01093/7 [===========>..................] - ETA: 0s - loss: 0.01435/7 [====================>.........] - ETA: 0s - loss: 0.01257/7 [==============================] - ETA: 0s - loss: 0.01267/7 [==============================] - 0s 33ms/step - loss: 0.0126
1/7 [===>..........................] - ETA: 0s - loss: 0.00523/7 [===========>..................] - ETA: 0s - loss: 0.01325/7 [====================>.........] - ETA: 0s - loss: 0.01057/7 [==============================] - ETA: 0s - loss: 0.01007/7 [==============================] - 0s 23ms/step - loss: 0.0100
1/7 [===>..........................] - ETA: 0s - loss: 0.01193/7 [===========>..................] - ETA: 0s - loss: 0.00865/7 [====================>.........] - ETA: 0s - loss: 0.00777/7 [==============================] - 0s 23ms/step - loss: 0.0086
1/7 [===>..........................] - ETA: 0s - loss: 0.01123/7 [===========>..................] - ETA: 0s - loss: 0.02245/7 [====================>.........] - ETA: 0s - loss: 0.02327/7 [==============================] - ETA: 0s - loss: 0.02417/7 [==============================] - 0s 28ms/step - loss: 0.0241
1/7 [===>..........................] - ETA: 0s - loss: 0.01455/7 [====================>.........] - ETA: 0s - loss: 0.01257/7 [==============================] - 0s 11ms/step - loss: 0.0127
1/7 [===>..........................] - ETA: 0s - loss: 0.00614/7 [================>.............] - ETA: 0s - loss: 0.00867/7 [==============================] - ETA: 0s - loss: 0.00827/7 [==============================] - 0s 16ms/step - loss: 0.0082
1/7 [===>..........................] - ETA: 0s - loss: 0.02085/7 [====================>.........] - ETA: 0s - loss: 0.01887/7 [==============================] - 0s 13ms/step - loss: 0.0189
1/7 [===>..........................] - ETA: 0s - loss: 0.00884/7 [================>.............] - ETA: 0s - loss: 0.00637/7 [==============================] - ETA: 0s - loss: 0.00657/7 [==============================] - 0s 15ms/step - loss: 0.0065
1/7 [===>..........................] - ETA: 0s - loss: 0.00565/7 [====================>.........] - ETA: 0s - loss: 0.01127/7 [==============================] - 0s 12ms/step - loss: 0.0114
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.008614625502377748:
Train Score: 0.01602 MSE 0.12658 RMSE
Test Score: 0.02158 MSE 0.14690 RMSE
Deviation Min [4.70376237e-05], Max [0.79418971]
Deviation 99.5th pctile [0.3209632]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1395,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1398,    5]))
Confusion matrix 
[[1393    5]
 [   2    3]]
precision 0.37500, recall 0.60000, f1 0.46154
Time to train: 396231 ms
Saving model models/A1Benchmark/real_56.csv.h5
Total Time to proces all the selected files : 398296 ms
A1Benchmark : Avg precision 0.37500 recall 0.60000 f1 0.46154 time to train 396231.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_56.csv  --epochs 20 --n_iter 3 --patience 3 :: took 405 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_57.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 04:24:13 AM MST
2020-11-30 04:24:19.519662: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 04:24:19.538230: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 04:24:19.539727: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559cada32cf0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 04:24:19.539781: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 04:24:19.540043: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_57.csv
Shapes: time variant data with labels (1441, 2), full data (1441, 3)
Look back data shapes: lookbackX (1417, 24, 1) lookbackY (1417, 2)
Shapes: Xtrain_full (1133, 24, 1), Ytrain_full (1133, 1), Xtest (284, 24, 1), Ytest (284, 1)
Shapes: Xtrain (1020, 24, 1), Ytrain (1020, 1), Xvalid (113, 24, 1), Yvalid (113, 1)
1/7 [===>..........................] - ETA: 0s - loss: 4.8377e-044/7 [================>.............] - ETA: 0s - loss: 6.2505e-047/7 [==============================] - 0s 14ms/step - loss: 5.6386e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.00115/7 [====================>.........] - ETA: 0s - loss: 0.00177/7 [==============================] - 0s 16ms/step - loss: 0.0019
1/7 [===>..........................] - ETA: 0s - loss: 0.00363/7 [===========>..................] - ETA: 0s - loss: 0.00345/7 [====================>.........] - ETA: 0s - loss: 0.00327/7 [==============================] - ETA: 0s - loss: 0.00287/7 [==============================] - 0s 27ms/step - loss: 0.0028
1/7 [===>..........................] - ETA: 0s - loss: 0.00164/7 [================>.............] - ETA: 0s - loss: 0.00156/7 [========================>.....] - ETA: 0s - loss: 0.00157/7 [==============================] - 0s 19ms/step - loss: 0.0015
1/7 [===>..........................] - ETA: 0s - loss: 0.06924/7 [================>.............] - ETA: 0s - loss: 0.10677/7 [==============================] - ETA: 0s - loss: 0.12587/7 [==============================] - 0s 16ms/step - loss: 0.1258
1/7 [===>..........................] - ETA: 0s - loss: 8.3505e-043/7 [===========>..................] - ETA: 0s - loss: 0.0010    5/7 [====================>.........] - ETA: 0s - loss: 0.00117/7 [==============================] - ETA: 0s - loss: 0.00117/7 [==============================] - 0s 23ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 7.9554e-043/7 [===========>..................] - ETA: 0s - loss: 0.0011    5/7 [====================>.........] - ETA: 0s - loss: 0.00117/7 [==============================] - ETA: 0s - loss: 0.00117/7 [==============================] - 0s 26ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 0.00343/7 [===========>..................] - ETA: 0s - loss: 0.00325/7 [====================>.........] - ETA: 0s - loss: 0.00297/7 [==============================] - ETA: 0s - loss: 0.00267/7 [==============================] - 0s 27ms/step - loss: 0.0026
1/7 [===>..........................] - ETA: 0s - loss: 0.00173/7 [===========>..................] - ETA: 0s - loss: 0.00175/7 [====================>.........] - ETA: 0s - loss: 0.00167/7 [==============================] - ETA: 0s - loss: 0.00167/7 [==============================] - 0s 30ms/step - loss: 0.0016
1/7 [===>..........................] - ETA: 0s - loss: 0.07943/7 [===========>..................] - ETA: 0s - loss: 0.12295/7 [====================>.........] - ETA: 0s - loss: 0.14377/7 [==============================] - ETA: 0s - loss: 0.14977/7 [==============================] - 0s 30ms/step - loss: 0.1497
1/7 [===>..........................] - ETA: 0s - loss: 8.4891e-044/7 [================>.............] - ETA: 0s - loss: 0.0012    7/7 [==============================] - 0s 13ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 0.00134/7 [================>.............] - ETA: 0s - loss: 0.00177/7 [==============================] - ETA: 0s - loss: 0.00197/7 [==============================] - 0s 17ms/step - loss: 0.0019
1/7 [===>..........................] - ETA: 0s - loss: 0.00284/7 [================>.............] - ETA: 0s - loss: 0.00277/7 [==============================] - ETA: 0s - loss: 0.00237/7 [==============================] - 0s 17ms/step - loss: 0.0023
1/7 [===>..........................] - ETA: 0s - loss: 0.00185/7 [====================>.........] - ETA: 0s - loss: 0.00177/7 [==============================] - 0s 12ms/step - loss: 0.0018
1/7 [===>..........................] - ETA: 0s - loss: 0.06735/7 [====================>.........] - ETA: 0s - loss: 0.11857/7 [==============================] - 0s 15ms/step - loss: 0.1236
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.026131193595938386:
Train Score: 0.00627 MSE 0.07919 RMSE
Test Score: 0.01474 MSE 0.12141 RMSE
Deviation Min [7.63866235e-05], Max [0.55405891]
Deviation 99.5th pctile [0.37347997]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1409,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1414,    3]))
Confusion matrix 
[[1407    7]
 [   2    1]]
precision 0.12500, recall 0.33333, f1 0.18182
Time to train: 254901 ms
Saving model models/A1Benchmark/real_57.csv.h5
Total Time to proces all the selected files : 256985 ms
A1Benchmark : Avg precision 0.12500 recall 0.33333 f1 0.18182 time to train 254901.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_57.csv  --epochs 20 --n_iter 3 --patience 3 :: took 263 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_58.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 04:28:41 AM MST
2020-11-30 04:28:48.266265: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 04:28:48.285217: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 04:28:48.286632: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x562d7a3dbc60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 04:28:48.286678: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 04:28:48.286892: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_58.csv
Shapes: time variant data with labels (1435, 2), full data (1435, 3)
Look back data shapes: lookbackX (1411, 24, 1) lookbackY (1411, 2)
Shapes: Xtrain_full (1128, 24, 1), Ytrain_full (1128, 1), Xtest (283, 24, 1), Ytest (283, 1)
Shapes: Xtrain (1016, 24, 1), Ytrain (1016, 1), Xvalid (112, 24, 1), Yvalid (112, 1)
1/7 [===>..........................] - ETA: 0s - loss: 5.9787e-054/7 [================>.............] - ETA: 0s - loss: 7.4473e-057/7 [==============================] - ETA: 0s - loss: 8.3446e-057/7 [==============================] - 0s 17ms/step - loss: 8.3446e-05
1/7 [===>..........................] - ETA: 0s - loss: 3.9614e-055/7 [====================>.........] - ETA: 0s - loss: 4.0842e-057/7 [==============================] - 0s 13ms/step - loss: 3.9639e-05
1/7 [===>..........................] - ETA: 0s - loss: 2.6110e-054/7 [================>.............] - ETA: 0s - loss: 3.5439e-057/7 [==============================] - ETA: 0s - loss: 3.2378e-057/7 [==============================] - 0s 17ms/step - loss: 3.2378e-05
1/7 [===>..........................] - ETA: 0s - loss: 4.8360e-054/7 [================>.............] - ETA: 0s - loss: 4.1850e-057/7 [==============================] - ETA: 0s - loss: 4.0625e-057/7 [==============================] - 0s 17ms/step - loss: 4.0625e-05
1/7 [===>..........................] - ETA: 0s - loss: 3.8142e-055/7 [====================>.........] - ETA: 0s - loss: 2.2524e-057/7 [==============================] - 0s 13ms/step - loss: 1.9886e-05
1/7 [===>..........................] - ETA: 0s - loss: 3.8376e-053/7 [===========>..................] - ETA: 0s - loss: 4.9320e-055/7 [====================>.........] - ETA: 0s - loss: 7.7167e-057/7 [==============================] - ETA: 0s - loss: 6.8659e-057/7 [==============================] - 0s 34ms/step - loss: 6.8659e-05
1/7 [===>..........................] - ETA: 0s - loss: 4.0943e-053/7 [===========>..................] - ETA: 0s - loss: 4.4672e-055/7 [====================>.........] - ETA: 0s - loss: 4.3705e-057/7 [==============================] - ETA: 0s - loss: 4.0842e-057/7 [==============================] - 0s 29ms/step - loss: 4.0842e-05
1/7 [===>..........................] - ETA: 0s - loss: 4.7460e-052/7 [=======>......................] - ETA: 0s - loss: 4.9510e-054/7 [================>.............] - ETA: 0s - loss: 4.9408e-056/7 [========================>.....] - ETA: 0s - loss: 5.2700e-057/7 [==============================] - 0s 40ms/step - loss: 5.3065e-05
1/7 [===>..........................] - ETA: 0s - loss: 8.9786e-053/7 [===========>..................] - ETA: 0s - loss: 6.0852e-054/7 [================>.............] - ETA: 0s - loss: 5.8588e-056/7 [========================>.....] - ETA: 0s - loss: 5.9064e-057/7 [==============================] - 0s 39ms/step - loss: 5.7209e-05
1/7 [===>..........................] - ETA: 0s - loss: 3.8263e-053/7 [===========>..................] - ETA: 0s - loss: 2.8091e-055/7 [====================>.........] - ETA: 0s - loss: 2.7255e-057/7 [==============================] - ETA: 0s - loss: 2.6581e-057/7 [==============================] - 0s 27ms/step - loss: 2.6581e-05
1/7 [===>..........................] - ETA: 0s - loss: 2.6059e-055/7 [====================>.........] - ETA: 0s - loss: 6.0773e-057/7 [==============================] - 0s 13ms/step - loss: 5.7860e-05
1/7 [===>..........................] - ETA: 0s - loss: 3.8791e-055/7 [====================>.........] - ETA: 0s - loss: 4.0917e-057/7 [==============================] - 0s 14ms/step - loss: 3.8924e-05
1/7 [===>..........................] - ETA: 0s - loss: 3.9244e-055/7 [====================>.........] - ETA: 0s - loss: 4.1564e-057/7 [==============================] - 0s 14ms/step - loss: 4.1591e-05
1/7 [===>..........................] - ETA: 0s - loss: 4.8359e-054/7 [================>.............] - ETA: 0s - loss: 4.2034e-057/7 [==============================] - ETA: 0s - loss: 4.0769e-057/7 [==============================] - 0s 18ms/step - loss: 4.0769e-05
1/7 [===>..........................] - ETA: 0s - loss: 5.2277e-054/7 [================>.............] - ETA: 0s - loss: 4.9140e-057/7 [==============================] - ETA: 0s - loss: 5.2871e-057/7 [==============================] - 0s 18ms/step - loss: 5.2871e-05
Best parameters {'n_units': 72, 'n_hidden': 1} best score 4.3194669706281276e-05:
Train Score: 0.00004 MSE 0.00643 RMSE
Test Score: 0.05329 MSE 0.23084 RMSE
Deviation Min [8.71186766e-06], Max [0.75800256]
Deviation 99.5th pctile [0.66474714]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1403,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1368,   43]))
Confusion matrix 
[[1368    0]
 [  35    8]]
precision 1.00000, recall 0.18605, f1 0.31373
Time to train: 179554 ms
Saving model models/A1Benchmark/real_58.csv.h5
Total Time to proces all the selected files : 181591 ms
A1Benchmark : Avg precision 1.00000 recall 0.18605 f1 0.31373 time to train 179554.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_58.csv  --epochs 20 --n_iter 3 --patience 3 :: took 189 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_59.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 04:31:55 AM MST
2020-11-30 04:32:01.560332: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 04:32:01.579192: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 04:32:01.580724: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55a8876a78c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 04:32:01.580778: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 04:32:01.581000: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_59.csv
Shapes: time variant data with labels (1423, 2), full data (1423, 3)
Look back data shapes: lookbackX (1399, 24, 1) lookbackY (1399, 2)
Shapes: Xtrain_full (1119, 24, 1), Ytrain_full (1119, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1008, 24, 1), Ytrain (1008, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.06303/7 [===========>..................] - ETA: 0s - loss: 0.06175/7 [====================>.........] - ETA: 0s - loss: 0.07317/7 [==============================] - ETA: 0s - loss: 0.07397/7 [==============================] - 0s 27ms/step - loss: 0.0739
1/7 [===>..........................] - ETA: 0s - loss: 0.04423/7 [===========>..................] - ETA: 0s - loss: 0.05965/7 [====================>.........] - ETA: 0s - loss: 0.04987/7 [==============================] - ETA: 0s - loss: 0.06097/7 [==============================] - 0s 35ms/step - loss: 0.0609
1/7 [===>..........................] - ETA: 0s - loss: 0.03623/7 [===========>..................] - ETA: 0s - loss: 0.05535/7 [====================>.........] - ETA: 0s - loss: 0.06457/7 [==============================] - ETA: 0s - loss: 0.06077/7 [==============================] - 0s 26ms/step - loss: 0.0607
1/7 [===>..........................] - ETA: 0s - loss: 0.04133/7 [===========>..................] - ETA: 0s - loss: 0.04565/7 [====================>.........] - ETA: 0s - loss: 0.05647/7 [==============================] - ETA: 0s - loss: 0.06187/7 [==============================] - 0s 30ms/step - loss: 0.0618
1/7 [===>..........................] - ETA: 0s - loss: 0.04103/7 [===========>..................] - ETA: 0s - loss: 0.04125/7 [====================>.........] - ETA: 0s - loss: 0.03647/7 [==============================] - ETA: 0s - loss: 0.03547/7 [==============================] - 0s 35ms/step - loss: 0.0354
1/7 [===>..........................] - ETA: 0s - loss: 0.06186/7 [========================>.....] - ETA: 0s - loss: 0.07417/7 [==============================] - 0s 10ms/step - loss: 0.0745
1/7 [===>..........................] - ETA: 0s - loss: 0.04264/7 [================>.............] - ETA: 0s - loss: 0.05417/7 [==============================] - ETA: 0s - loss: 0.05987/7 [==============================] - 0s 18ms/step - loss: 0.0598
1/7 [===>..........................] - ETA: 0s - loss: 0.03564/7 [================>.............] - ETA: 0s - loss: 0.05247/7 [==============================] - ETA: 0s - loss: 0.06007/7 [==============================] - 0s 17ms/step - loss: 0.0600
1/7 [===>..........................] - ETA: 0s - loss: 0.03815/7 [====================>.........] - ETA: 0s - loss: 0.05367/7 [==============================] - 0s 13ms/step - loss: 0.0578
1/7 [===>..........................] - ETA: 0s - loss: 0.04065/7 [====================>.........] - ETA: 0s - loss: 0.03677/7 [==============================] - 0s 13ms/step - loss: 0.0356
1/7 [===>..........................] - ETA: 0s - loss: 0.06325/7 [====================>.........] - ETA: 0s - loss: 0.07547/7 [==============================] - 0s 13ms/step - loss: 0.0763
1/7 [===>..........................] - ETA: 0s - loss: 0.04675/7 [====================>.........] - ETA: 0s - loss: 0.05097/7 [==============================] - 0s 14ms/step - loss: 0.0614
1/7 [===>..........................] - ETA: 0s - loss: 0.03564/7 [================>.............] - ETA: 0s - loss: 0.05307/7 [==============================] - ETA: 0s - loss: 0.06047/7 [==============================] - 0s 17ms/step - loss: 0.0604
1/7 [===>..........................] - ETA: 0s - loss: 0.03845/7 [====================>.........] - ETA: 0s - loss: 0.05347/7 [==============================] - 0s 16ms/step - loss: 0.0572
1/7 [===>..........................] - ETA: 0s - loss: 0.04174/7 [================>.............] - ETA: 0s - loss: 0.03477/7 [==============================] - ETA: 0s - loss: 0.03567/7 [==============================] - 0s 18ms/step - loss: 0.0356
/s/chopin/k/grad/santanud/.conda/envs/cs533tp/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 due to no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0575469970703125:
Train Score: 0.05703 MSE 0.23880 RMSE
Test Score: 0.06158 MSE 0.24816 RMSE
Deviation Min [8.62238698e-05], Max [0.73439258]
Deviation 99.5th pctile [0.70373321]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1392,    7]))
Actual is_anomaly labels in data (array([0]), array([1399]))
Confusion matrix 
[[1392    7]
 [   0    0]]
precision 0.00000, recall 0.00000, f1 0.00000
Time to train: 514198 ms
Saving model models/A1Benchmark/real_59.csv.h5
Total Time to proces all the selected files : 516297 ms
A1Benchmark : Avg precision 0.00000 recall 0.00000 f1 0.00000 time to train 514198.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_59.csv  --epochs 20 --n_iter 3 --patience 3 :: took 523 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_5.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 04:40:43 AM MST
2020-11-30 04:40:49.667274: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 04:40:49.686204: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 04:40:49.687521: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x556e16096c60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 04:40:49.687568: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 04:40:49.687758: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_5.csv
Shapes: time variant data with labels (1439, 2), full data (1439, 3)
Look back data shapes: lookbackX (1415, 24, 1) lookbackY (1415, 2)
Shapes: Xtrain_full (1132, 24, 1), Ytrain_full (1132, 1), Xtest (283, 24, 1), Ytest (283, 1)
Shapes: Xtrain (1019, 24, 1), Ytrain (1019, 1), Xvalid (113, 24, 1), Yvalid (113, 1)
1/7 [===>..........................] - ETA: 0s - loss: 8.4570e-055/7 [====================>.........] - ETA: 0s - loss: 1.1387e-047/7 [==============================] - 0s 14ms/step - loss: 1.1954e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.7142e-055/7 [====================>.........] - ETA: 0s - loss: 1.0297e-047/7 [==============================] - 0s 13ms/step - loss: 0.0049
1/7 [===>..........................] - ETA: 0s - loss: 1.1761e-044/7 [================>.............] - ETA: 0s - loss: 1.0045e-047/7 [==============================] - ETA: 0s - loss: 1.2973e-047/7 [==============================] - 0s 17ms/step - loss: 1.2973e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.5327e-054/7 [================>.............] - ETA: 0s - loss: 5.6486e-057/7 [==============================] - ETA: 0s - loss: 6.3598e-057/7 [==============================] - 0s 16ms/step - loss: 6.3598e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.1833e-044/7 [================>.............] - ETA: 0s - loss: 1.6499e-047/7 [==============================] - ETA: 0s - loss: 1.3746e-047/7 [==============================] - 0s 18ms/step - loss: 1.3746e-04
1/7 [===>..........................] - ETA: 0s - loss: 9.5969e-052/7 [=======>......................] - ETA: 0s - loss: 1.1863e-044/7 [================>.............] - ETA: 0s - loss: 9.7389e-056/7 [========================>.....] - ETA: 0s - loss: 1.2699e-047/7 [==============================] - 0s 30ms/step - loss: 1.2131e-04
1/7 [===>..........................] - ETA: 0s - loss: 6.0122e-054/7 [================>.............] - ETA: 0s - loss: 6.5332e-056/7 [========================>.....] - ETA: 0s - loss: 0.0052    7/7 [==============================] - 0s 22ms/step - loss: 0.0049
1/7 [===>..........................] - ETA: 0s - loss: 1.5716e-043/7 [===========>..................] - ETA: 0s - loss: 1.2606e-045/7 [====================>.........] - ETA: 0s - loss: 1.3168e-047/7 [==============================] - ETA: 0s - loss: 1.6518e-047/7 [==============================] - 0s 32ms/step - loss: 1.6518e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.1893e-043/7 [===========>..................] - ETA: 0s - loss: 9.4250e-055/7 [====================>.........] - ETA: 0s - loss: 9.0161e-057/7 [==============================] - ETA: 0s - loss: 9.6138e-057/7 [==============================] - 0s 23ms/step - loss: 9.6138e-05
1/7 [===>..........................] - ETA: 0s - loss: 6.9886e-053/7 [===========>..................] - ETA: 0s - loss: 6.3539e-055/7 [====================>.........] - ETA: 0s - loss: 7.5704e-057/7 [==============================] - 0s 24ms/step - loss: 8.5494e-05
1/7 [===>..........................] - ETA: 0s - loss: 9.4823e-053/7 [===========>..................] - ETA: 0s - loss: 9.6157e-055/7 [====================>.........] - ETA: 0s - loss: 1.1667e-047/7 [==============================] - ETA: 0s - loss: 1.1977e-047/7 [==============================] - 0s 32ms/step - loss: 1.1977e-04
1/7 [===>..........................] - ETA: 0s - loss: 6.8855e-053/7 [===========>..................] - ETA: 0s - loss: 7.8035e-055/7 [====================>.........] - ETA: 0s - loss: 1.2671e-047/7 [==============================] - ETA: 0s - loss: 0.0050    7/7 [==============================] - 0s 33ms/step - loss: 0.0050
1/7 [===>..........................] - ETA: 0s - loss: 5.3736e-053/7 [===========>..................] - ETA: 0s - loss: 1.3410e-045/7 [====================>.........] - ETA: 0s - loss: 1.2889e-047/7 [==============================] - ETA: 0s - loss: 1.1928e-047/7 [==============================] - 0s 35ms/step - loss: 1.1928e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.4667e-042/7 [=======>......................] - ETA: 0s - loss: 1.7992e-044/7 [================>.............] - ETA: 0s - loss: 1.6167e-046/7 [========================>.....] - ETA: 0s - loss: 1.8332e-047/7 [==============================] - 0s 33ms/step - loss: 1.7592e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.0350e-043/7 [===========>..................] - ETA: 0s - loss: 1.1837e-045/7 [====================>.........] - ETA: 0s - loss: 1.3784e-047/7 [==============================] - ETA: 0s - loss: 1.2723e-047/7 [==============================] - 0s 37ms/step - loss: 1.2723e-04
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0010622179892379791:
Train Score: 0.00094 MSE 0.03065 RMSE
Test Score: 0.00015 MSE 0.01244 RMSE
Deviation Min [6.40787247e-06], Max [0.96984925]
Deviation 99.5th pctile [0.03368]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1407,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1413,    2]))
Confusion matrix 
[[1407    6]
 [   0    2]]
precision 0.25000, recall 1.00000, f1 0.40000
Time to train: 213278 ms
Saving model models/A1Benchmark/real_5.csv.h5
Total Time to proces all the selected files : 215554 ms
A1Benchmark : Avg precision 0.25000 recall 1.00000 f1 0.40000 time to train 213278.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_5.csv  --epochs 20 --n_iter 3 --patience 3 :: took 222 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_60.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 04:44:30 AM MST
2020-11-30 04:44:36.880484: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 04:44:36.899267: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 04:44:36.900809: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x555c61ccac60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 04:44:36.900885: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 04:44:36.901096: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_60.csv
Shapes: time variant data with labels (1461, 2), full data (1461, 3)
Look back data shapes: lookbackX (1437, 24, 1) lookbackY (1437, 2)
Shapes: Xtrain_full (1149, 24, 1), Ytrain_full (1149, 1), Xtest (288, 24, 1), Ytest (288, 1)
Shapes: Xtrain (1035, 24, 1), Ytrain (1035, 1), Xvalid (114, 24, 1), Yvalid (114, 1)
1/7 [===>..........................] - ETA: 0s - loss: 3.1962e-045/7 [====================>.........] - ETA: 0s - loss: 2.2446e-047/7 [==============================] - 0s 14ms/step - loss: 2.1151e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.5547e-045/7 [====================>.........] - ETA: 0s - loss: 0.0025    7/7 [==============================] - 0s 11ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 2.5283e-044/7 [================>.............] - ETA: 0s - loss: 2.0448e-047/7 [==============================] - 0s 15ms/step - loss: 2.1015e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.1235e-044/7 [================>.............] - ETA: 0s - loss: 9.3235e-047/7 [==============================] - ETA: 0s - loss: 6.4699e-047/7 [==============================] - 0s 18ms/step - loss: 6.4699e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.0443e-044/7 [================>.............] - ETA: 0s - loss: 5.8235e-047/7 [==============================] - ETA: 0s - loss: 5.1655e-047/7 [==============================] - 0s 18ms/step - loss: 5.1655e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.7647e-045/7 [====================>.........] - ETA: 0s - loss: 1.9890e-047/7 [==============================] - 0s 13ms/step - loss: 1.8904e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.0654e-044/7 [================>.............] - ETA: 0s - loss: 0.0032    7/7 [==============================] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 17ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 2.6299e-044/7 [================>.............] - ETA: 0s - loss: 2.3120e-047/7 [==============================] - ETA: 0s - loss: 2.3310e-047/7 [==============================] - 0s 17ms/step - loss: 2.3310e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.0186e-044/7 [================>.............] - ETA: 0s - loss: 9.1653e-047/7 [==============================] - ETA: 0s - loss: 6.3246e-047/7 [==============================] - 0s 16ms/step - loss: 6.3246e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.0779e-046/7 [========================>.....] - ETA: 0s - loss: 5.3737e-047/7 [==============================] - 0s 12ms/step - loss: 5.1801e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.7713e-043/7 [===========>..................] - ETA: 0s - loss: 2.0207e-045/7 [====================>.........] - ETA: 0s - loss: 2.1093e-047/7 [==============================] - ETA: 0s - loss: 2.0334e-047/7 [==============================] - 0s 30ms/step - loss: 2.0334e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.8789e-043/7 [===========>..................] - ETA: 0s - loss: 2.5919e-045/7 [====================>.........] - ETA: 0s - loss: 0.0026    7/7 [==============================] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 34ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 2.7556e-043/7 [===========>..................] - ETA: 0s - loss: 2.4606e-045/7 [====================>.........] - ETA: 0s - loss: 2.3776e-047/7 [==============================] - ETA: 0s - loss: 2.4412e-047/7 [==============================] - 0s 26ms/step - loss: 2.4412e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.9216e-043/7 [===========>..................] - ETA: 0s - loss: 0.0012    5/7 [====================>.........] - ETA: 0s - loss: 8.4494e-047/7 [==============================] - ETA: 0s - loss: 7.0619e-047/7 [==============================] - 0s 33ms/step - loss: 7.0619e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.4378e-043/7 [===========>..................] - ETA: 0s - loss: 5.4463e-045/7 [====================>.........] - ETA: 0s - loss: 5.9672e-047/7 [==============================] - ETA: 0s - loss: 5.0591e-047/7 [==============================] - 0s 25ms/step - loss: 5.0591e-04
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0007099002163158729:
Train Score: 0.00063 MSE 0.02517 RMSE
Test Score: 0.00514 MSE 0.07172 RMSE
Deviation Min [2.47492424e-06], Max [0.94377137]
Deviation 99.5th pctile [0.16557224]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1429,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1421,   16]))
Confusion matrix 
[[1421    0]
 [   8    8]]
precision 1.00000, recall 0.50000, f1 0.66667
Time to train: 176564 ms
Saving model models/A1Benchmark/real_60.csv.h5
Total Time to proces all the selected files : 179114 ms
A1Benchmark : Avg precision 1.00000 recall 0.50000 f1 0.66667 time to train 176564.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_60.csv  --epochs 20 --n_iter 3 --patience 3 :: took 186 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_61.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 04:47:41 AM MST
2020-11-30 04:47:47.531471: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 04:47:47.550212: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 04:47:47.551595: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x557a619368c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 04:47:47.551657: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 04:47:47.551835: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_61.csv
Shapes: time variant data with labels (1441, 2), full data (1441, 3)
Look back data shapes: lookbackX (1417, 24, 1) lookbackY (1417, 2)
Shapes: Xtrain_full (1133, 24, 1), Ytrain_full (1133, 1), Xtest (284, 24, 1), Ytest (284, 1)
Shapes: Xtrain (1020, 24, 1), Ytrain (1020, 1), Xvalid (113, 24, 1), Yvalid (113, 1)
1/7 [===>..........................] - ETA: 0s - loss: 2.4450e-043/7 [===========>..................] - ETA: 0s - loss: 2.7259e-045/7 [====================>.........] - ETA: 0s - loss: 2.9273e-047/7 [==============================] - ETA: 0s - loss: 3.1695e-047/7 [==============================] - 0s 31ms/step - loss: 3.1695e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.5440e-043/7 [===========>..................] - ETA: 0s - loss: 5.5625e-045/7 [====================>.........] - ETA: 0s - loss: 5.5824e-047/7 [==============================] - ETA: 0s - loss: 5.6524e-047/7 [==============================] - 0s 25ms/step - loss: 5.6524e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.6167e-043/7 [===========>..................] - ETA: 0s - loss: 0.0073    5/7 [====================>.........] - ETA: 0s - loss: 0.00907/7 [==============================] - ETA: 0s - loss: 0.00887/7 [==============================] - 0s 23ms/step - loss: 0.0088
1/7 [===>..........................] - ETA: 0s - loss: 0.01553/7 [===========>..................] - ETA: 0s - loss: 0.01635/7 [====================>.........] - ETA: 0s - loss: 0.01977/7 [==============================] - ETA: 0s - loss: 0.02527/7 [==============================] - 0s 26ms/step - loss: 0.0252
1/7 [===>..........................] - ETA: 0s - loss: 0.02033/7 [===========>..................] - ETA: 0s - loss: 0.01415/7 [====================>.........] - ETA: 0s - loss: 0.01207/7 [==============================] - ETA: 0s - loss: 0.01497/7 [==============================] - 0s 27ms/step - loss: 0.0149
1/7 [===>..........................] - ETA: 0s - loss: 8.3465e-045/7 [====================>.........] - ETA: 0s - loss: 7.6472e-047/7 [==============================] - 0s 15ms/step - loss: 7.9461e-04
1/7 [===>..........................] - ETA: 0s - loss: 7.0345e-044/7 [================>.............] - ETA: 0s - loss: 6.9160e-047/7 [==============================] - ETA: 0s - loss: 6.7743e-047/7 [==============================] - 0s 14ms/step - loss: 6.7743e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.4848e-045/7 [====================>.........] - ETA: 0s - loss: 0.0079    7/7 [==============================] - 0s 14ms/step - loss: 0.0077
1/7 [===>..........................] - ETA: 0s - loss: 0.01434/7 [================>.............] - ETA: 0s - loss: 0.01557/7 [==============================] - ETA: 0s - loss: 0.02227/7 [==============================] - 0s 18ms/step - loss: 0.0222
1/7 [===>..........................] - ETA: 0s - loss: 0.01084/7 [================>.............] - ETA: 0s - loss: 0.01016/7 [========================>.....] - ETA: 0s - loss: 0.01087/7 [==============================] - 0s 20ms/step - loss: 0.0117
1/7 [===>..........................] - ETA: 0s - loss: 2.5359e-043/7 [===========>..................] - ETA: 0s - loss: 2.9119e-045/7 [====================>.........] - ETA: 0s - loss: 3.1341e-047/7 [==============================] - ETA: 0s - loss: 3.3209e-047/7 [==============================] - 0s 25ms/step - loss: 3.3209e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.9780e-043/7 [===========>..................] - ETA: 0s - loss: 4.4691e-045/7 [====================>.........] - ETA: 0s - loss: 4.6425e-047/7 [==============================] - ETA: 0s - loss: 4.6442e-047/7 [==============================] - 0s 31ms/step - loss: 4.6442e-04
1/7 [===>..........................] - ETA: 0s - loss: 7.5411e-043/7 [===========>..................] - ETA: 0s - loss: 0.0088    5/7 [====================>.........] - ETA: 0s - loss: 0.00977/7 [==============================] - 0s 32ms/step - loss: 0.0097
1/7 [===>..........................] - ETA: 0s - loss: 0.01554/7 [================>.............] - ETA: 0s - loss: 0.01726/7 [========================>.....] - ETA: 0s - loss: 0.02367/7 [==============================] - 0s 22ms/step - loss: 0.0252
1/7 [===>..........................] - ETA: 0s - loss: 0.01683/7 [===========>..................] - ETA: 0s - loss: 0.01365/7 [====================>.........] - ETA: 0s - loss: 0.01207/7 [==============================] - ETA: 0s - loss: 0.01547/7 [==============================] - 0s 28ms/step - loss: 0.0154
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.008611205383203924:
Train Score: 0.00707 MSE 0.08411 RMSE
Test Score: 0.01511 MSE 0.12292 RMSE
Deviation Min [3.65151266e-05], Max [0.66028991]
Deviation 99.5th pctile [0.34550162]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1409,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1393,   24]))
Confusion matrix 
[[1386    7]
 [  23    1]]
precision 0.12500, recall 0.04167, f1 0.06250
Time to train: 260131 ms
Saving model models/A1Benchmark/real_61.csv.h5
Total Time to proces all the selected files : 262367 ms
A1Benchmark : Avg precision 0.12500 recall 0.04167 f1 0.06250 time to train 260131.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_61.csv  --epochs 20 --n_iter 3 --patience 3 :: took 269 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_62.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 04:52:15 AM MST
2020-11-30 04:52:21.565342: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 04:52:21.584268: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 04:52:21.585744: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5649c66c3c60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 04:52:21.585797: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 04:52:21.586014: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_62.csv
Shapes: time variant data with labels (741, 2), full data (741, 3)
Look back data shapes: lookbackX (717, 24, 1) lookbackY (717, 2)
Shapes: Xtrain_full (573, 24, 1), Ytrain_full (573, 1), Xtest (144, 24, 1), Ytest (144, 1)
Shapes: Xtrain (516, 24, 1), Ytrain (516, 1), Xvalid (57, 24, 1), Yvalid (57, 1)
1/4 [======>.......................] - ETA: 0s - loss: 0.00232/4 [==============>...............] - ETA: 0s - loss: 0.00144/4 [==============================] - ETA: 0s - loss: 0.00514/4 [==============================] - 0s 28ms/step - loss: 0.0051
1/4 [======>.......................] - ETA: 0s - loss: 4.0663e-043/4 [=====================>........] - ETA: 0s - loss: 3.7492e-044/4 [==============================] - 0s 26ms/step - loss: 3.5298e-04
1/4 [======>.......................] - ETA: 0s - loss: 2.5827e-043/4 [=====================>........] - ETA: 0s - loss: 2.0420e-044/4 [==============================] - 0s 29ms/step - loss: 3.7711e-04
1/4 [======>.......................] - ETA: 0s - loss: 4.0637e-043/4 [=====================>........] - ETA: 0s - loss: 5.3465e-044/4 [==============================] - 0s 29ms/step - loss: 5.2739e-04
1/4 [======>.......................] - ETA: 0s - loss: 4.8165e-042/4 [==============>...............] - ETA: 0s - loss: 6.3037e-044/4 [==============================] - ETA: 0s - loss: 6.5999e-044/4 [==============================] - 0s 33ms/step - loss: 6.5999e-04
1/4 [======>.......................] - ETA: 0s - loss: 0.00223/4 [=====================>........] - ETA: 0s - loss: 0.00544/4 [==============================] - 0s 25ms/step - loss: 0.0051
1/4 [======>.......................] - ETA: 0s - loss: 6.0426e-043/4 [=====================>........] - ETA: 0s - loss: 5.3901e-044/4 [==============================] - 0s 20ms/step - loss: 5.1633e-04
1/4 [======>.......................] - ETA: 0s - loss: 2.3195e-043/4 [=====================>........] - ETA: 0s - loss: 1.7609e-044/4 [==============================] - 0s 26ms/step - loss: 3.5725e-04
1/4 [======>.......................] - ETA: 0s - loss: 4.1604e-043/4 [=====================>........] - ETA: 0s - loss: 6.3702e-044/4 [==============================] - 0s 18ms/step - loss: 6.4261e-04
1/4 [======>.......................] - ETA: 0s - loss: 5.2005e-043/4 [=====================>........] - ETA: 0s - loss: 6.9743e-044/4 [==============================] - 0s 27ms/step - loss: 6.9467e-04
1/4 [======>.......................] - ETA: 0s - loss: 0.00213/4 [=====================>........] - ETA: 0s - loss: 0.00544/4 [==============================] - 0s 29ms/step - loss: 0.0051
1/4 [======>.......................] - ETA: 0s - loss: 7.5930e-043/4 [=====================>........] - ETA: 0s - loss: 6.7498e-044/4 [==============================] - 0s 26ms/step - loss: 6.5323e-04
1/4 [======>.......................] - ETA: 0s - loss: 2.2858e-043/4 [=====================>........] - ETA: 0s - loss: 1.6681e-044/4 [==============================] - 0s 21ms/step - loss: 3.4946e-04
1/4 [======>.......................] - ETA: 0s - loss: 4.0293e-043/4 [=====================>........] - ETA: 0s - loss: 5.3013e-044/4 [==============================] - 0s 25ms/step - loss: 5.2140e-04
1/4 [======>.......................] - ETA: 0s - loss: 5.0307e-043/4 [=====================>........] - ETA: 0s - loss: 6.8876e-044/4 [==============================] - 0s 29ms/step - loss: 6.8609e-04
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.0014125574845820666:
Train Score: 0.00138 MSE 0.03711 RMSE
Test Score: 0.01167 MSE 0.10803 RMSE
Deviation Min [5.81200429e-05], Max [0.70434121]
Deviation 99.5th pctile [0.41284834]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([713,   4]))
Actual is_anomaly labels in data (array([0, 1]), array([712,   5]))
Confusion matrix 
[[712   0]
 [  1   4]]
precision 1.00000, recall 0.80000, f1 0.88889
Time to train: 166178 ms
Saving model models/A1Benchmark/real_62.csv.h5
Total Time to proces all the selected files : 168672 ms
A1Benchmark : Avg precision 1.00000 recall 0.80000 f1 0.88889 time to train 166178.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_62.csv  --epochs 20 --n_iter 3 --patience 3 :: took 175 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_63.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 04:55:15 AM MST
2020-11-30 04:55:21.817737: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 04:55:21.836300: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 04:55:21.837789: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d160e248c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 04:55:21.837843: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 04:55:21.838068: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_63.csv
Shapes: time variant data with labels (1439, 2), full data (1439, 3)
Look back data shapes: lookbackX (1415, 24, 1) lookbackY (1415, 2)
Shapes: Xtrain_full (1132, 24, 1), Ytrain_full (1132, 1), Xtest (283, 24, 1), Ytest (283, 1)
Shapes: Xtrain (1019, 24, 1), Ytrain (1019, 1), Xvalid (113, 24, 1), Yvalid (113, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.01274/7 [================>.............] - ETA: 0s - loss: 0.01437/7 [==============================] - ETA: 0s - loss: 0.01237/7 [==============================] - 0s 17ms/step - loss: 0.0123
1/7 [===>..........................] - ETA: 0s - loss: 0.01014/7 [================>.............] - ETA: 0s - loss: 0.01277/7 [==============================] - ETA: 0s - loss: 0.01197/7 [==============================] - 0s 17ms/step - loss: 0.0119
1/7 [===>..........................] - ETA: 0s - loss: 0.01024/7 [================>.............] - ETA: 0s - loss: 0.01067/7 [==============================] - ETA: 0s - loss: 0.01127/7 [==============================] - 0s 20ms/step - loss: 0.0112
1/7 [===>..........................] - ETA: 0s - loss: 0.01434/7 [================>.............] - ETA: 0s - loss: 0.01407/7 [==============================] - ETA: 0s - loss: 0.01727/7 [==============================] - 0s 16ms/step - loss: 0.0172
1/7 [===>..........................] - ETA: 0s - loss: 0.01914/7 [================>.............] - ETA: 0s - loss: 0.01547/7 [==============================] - 0s 14ms/step - loss: 0.0139
1/7 [===>..........................] - ETA: 0s - loss: 0.01325/7 [====================>.........] - ETA: 0s - loss: 0.01347/7 [==============================] - 0s 16ms/step - loss: 0.0127
1/7 [===>..........................] - ETA: 0s - loss: 0.01076/7 [========================>.....] - ETA: 0s - loss: 0.01197/7 [==============================] - 0s 11ms/step - loss: 0.0120
1/7 [===>..........................] - ETA: 0s - loss: 0.01025/7 [====================>.........] - ETA: 0s - loss: 0.01047/7 [==============================] - 0s 12ms/step - loss: 0.0112
1/7 [===>..........................] - ETA: 0s - loss: 0.01175/7 [====================>.........] - ETA: 0s - loss: 0.01467/7 [==============================] - 0s 11ms/step - loss: 0.0164
1/7 [===>..........................] - ETA: 0s - loss: 0.02016/7 [========================>.....] - ETA: 0s - loss: 0.01427/7 [==============================] - 0s 9ms/step - loss: 0.0146
1/7 [===>..........................] - ETA: 0s - loss: 0.01274/7 [================>.............] - ETA: 0s - loss: 0.01437/7 [==============================] - ETA: 0s - loss: 0.01227/7 [==============================] - 0s 17ms/step - loss: 0.0122
1/7 [===>..........................] - ETA: 0s - loss: 0.01024/7 [================>.............] - ETA: 0s - loss: 0.01277/7 [==============================] - ETA: 0s - loss: 0.01197/7 [==============================] - 0s 16ms/step - loss: 0.0119
1/7 [===>..........................] - ETA: 0s - loss: 0.01095/7 [====================>.........] - ETA: 0s - loss: 0.01037/7 [==============================] - 0s 14ms/step - loss: 0.0114
1/7 [===>..........................] - ETA: 0s - loss: 0.01204/7 [================>.............] - ETA: 0s - loss: 0.01287/7 [==============================] - ETA: 0s - loss: 0.01637/7 [==============================] - 0s 18ms/step - loss: 0.0163
1/7 [===>..........................] - ETA: 0s - loss: 0.01875/7 [====================>.........] - ETA: 0s - loss: 0.01407/7 [==============================] - 0s 13ms/step - loss: 0.0134
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.013046524114906788:
Train Score: 0.01302 MSE 0.11412 RMSE
Test Score: 0.01860 MSE 0.13639 RMSE
Deviation Min [0.00016226], Max [0.51030002]
Deviation 99.5th pctile [0.35729356]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1407,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1407,    8]))
Confusion matrix 
[[1403    4]
 [   4    4]]
precision 0.50000, recall 0.50000, f1 0.50000
Time to train: 177073 ms
Saving model models/A1Benchmark/real_63.csv.h5
Total Time to proces all the selected files : 179587 ms
A1Benchmark : Avg precision 0.50000 recall 0.50000 f1 0.50000 time to train 177073.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_63.csv  --epochs 20 --n_iter 3 --patience 3 :: took 186 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_64.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 04:58:26 AM MST
2020-11-30 04:58:33.276513: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 04:58:33.295269: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 04:58:33.296144: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5624cf65ac60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 04:58:33.296171: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 04:58:33.296285: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_64.csv
Shapes: time variant data with labels (1441, 2), full data (1441, 3)
Look back data shapes: lookbackX (1417, 24, 1) lookbackY (1417, 2)
Shapes: Xtrain_full (1133, 24, 1), Ytrain_full (1133, 1), Xtest (284, 24, 1), Ytest (284, 1)
Shapes: Xtrain (1020, 24, 1), Ytrain (1020, 1), Xvalid (113, 24, 1), Yvalid (113, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00863/7 [===========>..................] - ETA: 0s - loss: 0.01455/7 [====================>.........] - ETA: 0s - loss: 0.01847/7 [==============================] - ETA: 0s - loss: 0.01977/7 [==============================] - 0s 28ms/step - loss: 0.0197
1/7 [===>..........................] - ETA: 0s - loss: 0.02973/7 [===========>..................] - ETA: 0s - loss: 0.02325/7 [====================>.........] - ETA: 0s - loss: 0.02307/7 [==============================] - ETA: 0s - loss: 0.02527/7 [==============================] - 0s 31ms/step - loss: 0.0252
1/7 [===>..........................] - ETA: 0s - loss: 0.01793/7 [===========>..................] - ETA: 0s - loss: 0.01915/7 [====================>.........] - ETA: 0s - loss: 0.02467/7 [==============================] - ETA: 0s - loss: 0.02417/7 [==============================] - 0s 28ms/step - loss: 0.0241
1/7 [===>..........................] - ETA: 0s - loss: 0.01423/7 [===========>..................] - ETA: 0s - loss: 0.01755/7 [====================>.........] - ETA: 0s - loss: 0.01977/7 [==============================] - ETA: 0s - loss: 0.02257/7 [==============================] - 0s 29ms/step - loss: 0.0225
1/7 [===>..........................] - ETA: 0s - loss: 0.01703/7 [===========>..................] - ETA: 0s - loss: 0.01485/7 [====================>.........] - ETA: 0s - loss: 0.01547/7 [==============================] - ETA: 0s - loss: 0.01477/7 [==============================] - 0s 24ms/step - loss: 0.0147
1/7 [===>..........................] - ETA: 0s - loss: 0.01233/7 [===========>..................] - ETA: 0s - loss: 0.01565/7 [====================>.........] - ETA: 0s - loss: 0.01867/7 [==============================] - ETA: 0s - loss: 0.01967/7 [==============================] - 0s 22ms/step - loss: 0.0196
1/7 [===>..........................] - ETA: 0s - loss: 0.02943/7 [===========>..................] - ETA: 0s - loss: 0.02315/7 [====================>.........] - ETA: 0s - loss: 0.02277/7 [==============================] - ETA: 0s - loss: 0.02507/7 [==============================] - 0s 24ms/step - loss: 0.0250
1/7 [===>..........................] - ETA: 0s - loss: 0.01644/7 [================>.............] - ETA: 0s - loss: 0.02226/7 [========================>.....] - ETA: 0s - loss: 0.02397/7 [==============================] - 0s 20ms/step - loss: 0.0233
1/7 [===>..........................] - ETA: 0s - loss: 0.01113/7 [===========>..................] - ETA: 0s - loss: 0.01545/7 [====================>.........] - ETA: 0s - loss: 0.01707/7 [==============================] - ETA: 0s - loss: 0.01967/7 [==============================] - 0s 29ms/step - loss: 0.0196
1/7 [===>..........................] - ETA: 0s - loss: 0.01913/7 [===========>..................] - ETA: 0s - loss: 0.01555/7 [====================>.........] - ETA: 0s - loss: 0.01577/7 [==============================] - ETA: 0s - loss: 0.01527/7 [==============================] - 0s 25ms/step - loss: 0.0152
1/7 [===>..........................] - ETA: 0s - loss: 0.01224/7 [================>.............] - ETA: 0s - loss: 0.01497/7 [==============================] - ETA: 0s - loss: 0.01947/7 [==============================] - 0s 19ms/step - loss: 0.0194
1/7 [===>..........................] - ETA: 0s - loss: 0.02894/7 [================>.............] - ETA: 0s - loss: 0.02297/7 [==============================] - 0s 14ms/step - loss: 0.0248
1/7 [===>..........................] - ETA: 0s - loss: 0.01634/7 [================>.............] - ETA: 0s - loss: 0.02187/7 [==============================] - ETA: 0s - loss: 0.02287/7 [==============================] - 0s 18ms/step - loss: 0.0228
1/7 [===>..........................] - ETA: 0s - loss: 0.01226/7 [========================>.....] - ETA: 0s - loss: 0.01937/7 [==============================] - 0s 11ms/step - loss: 0.0206
1/7 [===>..........................] - ETA: 0s - loss: 0.01674/7 [================>.............] - ETA: 0s - loss: 0.01647/7 [==============================] - ETA: 0s - loss: 0.01447/7 [==============================] - 0s 17ms/step - loss: 0.0144
/s/chopin/k/grad/santanud/.conda/envs/cs533tp/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 due to no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.02041916586458683:
Train Score: 0.01992 MSE 0.14115 RMSE
Test Score: 0.02386 MSE 0.15448 RMSE
Deviation Min [0.00016343], Max [0.78723162]
Deviation 99.5th pctile [0.49869907]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1409,    8]))
Actual is_anomaly labels in data (array([0]), array([1417]))
Confusion matrix 
[[1409    8]
 [   0    0]]
precision 0.00000, recall 0.00000, f1 0.00000
Time to train: 224202 ms
Saving model models/A1Benchmark/real_64.csv.h5
Total Time to proces all the selected files : 226750 ms
A1Benchmark : Avg precision 0.00000 recall 0.00000 f1 0.00000 time to train 224202.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_64.csv  --epochs 20 --n_iter 3 --patience 3 :: took 234 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_65.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 05:02:25 AM MST
2020-11-30 05:02:31.729973: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 05:02:31.748252: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 05:02:31.749797: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x557858bf6c60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 05:02:31.749848: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 05:02:31.750064: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_65.csv
Shapes: time variant data with labels (1424, 2), full data (1424, 3)
Look back data shapes: lookbackX (1400, 24, 1) lookbackY (1400, 2)
Shapes: Xtrain_full (1120, 24, 1), Ytrain_full (1120, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1008, 24, 1), Ytrain (1008, 1), Xvalid (112, 24, 1), Yvalid (112, 1)
1/7 [===>..........................] - ETA: 0s - loss: 4.9125e-043/7 [===========>..................] - ETA: 0s - loss: 5.6556e-045/7 [====================>.........] - ETA: 0s - loss: 5.7164e-047/7 [==============================] - ETA: 0s - loss: 5.3219e-047/7 [==============================] - 0s 30ms/step - loss: 5.3219e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.4344e-043/7 [===========>..................] - ETA: 0s - loss: 4.5795e-045/7 [====================>.........] - ETA: 0s - loss: 4.3062e-047/7 [==============================] - ETA: 0s - loss: 4.2784e-047/7 [==============================] - 0s 26ms/step - loss: 4.2784e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.6877e-043/7 [===========>..................] - ETA: 0s - loss: 5.2436e-045/7 [====================>.........] - ETA: 0s - loss: 5.2223e-047/7 [==============================] - ETA: 0s - loss: 5.5313e-047/7 [==============================] - 0s 33ms/step - loss: 5.5313e-04
1/7 [===>..........................] - ETA: 0s - loss: 9.2160e-043/7 [===========>..................] - ETA: 0s - loss: 0.0011    5/7 [====================>.........] - ETA: 0s - loss: 0.00127/7 [==============================] - ETA: 0s - loss: 0.00147/7 [==============================] - 0s 40ms/step - loss: 0.0014
1/7 [===>..........................] - ETA: 0s - loss: 0.00273/7 [===========>..................] - ETA: 0s - loss: 0.00245/7 [====================>.........] - ETA: 0s - loss: 0.00377/7 [==============================] - ETA: 0s - loss: 0.00407/7 [==============================] - 0s 26ms/step - loss: 0.0040
1/7 [===>..........................] - ETA: 0s - loss: 3.0114e-045/7 [====================>.........] - ETA: 0s - loss: 3.8183e-047/7 [==============================] - 0s 12ms/step - loss: 3.6258e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.6039e-045/7 [====================>.........] - ETA: 0s - loss: 3.4261e-047/7 [==============================] - 0s 13ms/step - loss: 3.4333e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.6605e-044/7 [================>.............] - ETA: 0s - loss: 3.8191e-047/7 [==============================] - ETA: 0s - loss: 4.3748e-047/7 [==============================] - 0s 16ms/step - loss: 4.3748e-04
1/7 [===>..........................] - ETA: 0s - loss: 7.1492e-045/7 [====================>.........] - ETA: 0s - loss: 0.0010    7/7 [==============================] - 0s 13ms/step - loss: 0.0011
1/7 [===>..........................] - ETA: 0s - loss: 0.00254/7 [================>.............] - ETA: 0s - loss: 0.00297/7 [==============================] - ETA: 0s - loss: 0.00367/7 [==============================] - 0s 19ms/step - loss: 0.0036
1/7 [===>..........................] - ETA: 0s - loss: 4.5253e-043/7 [===========>..................] - ETA: 0s - loss: 5.3052e-045/7 [====================>.........] - ETA: 0s - loss: 5.4175e-047/7 [==============================] - ETA: 0s - loss: 5.0579e-047/7 [==============================] - 0s 25ms/step - loss: 5.0579e-04
1/7 [===>..........................] - ETA: 0s - loss: 8.2324e-043/7 [===========>..................] - ETA: 0s - loss: 7.9191e-045/7 [====================>.........] - ETA: 0s - loss: 7.6938e-047/7 [==============================] - ETA: 0s - loss: 7.7922e-047/7 [==============================] - 0s 25ms/step - loss: 7.7922e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.5352e-043/7 [===========>..................] - ETA: 0s - loss: 4.9379e-045/7 [====================>.........] - ETA: 0s - loss: 4.9069e-047/7 [==============================] - ETA: 0s - loss: 5.4136e-047/7 [==============================] - 0s 33ms/step - loss: 5.4136e-04
1/7 [===>..........................] - ETA: 0s - loss: 9.2972e-043/7 [===========>..................] - ETA: 0s - loss: 0.0011    5/7 [====================>.........] - ETA: 0s - loss: 0.00137/7 [==============================] - ETA: 0s - loss: 0.00147/7 [==============================] - 0s 26ms/step - loss: 0.0014
1/7 [===>..........................] - ETA: 0s - loss: 0.00263/7 [===========>..................] - ETA: 0s - loss: 0.00245/7 [====================>.........] - ETA: 0s - loss: 0.00377/7 [==============================] - ETA: 0s - loss: 0.00397/7 [==============================] - 0s 30ms/step - loss: 0.0039
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.001171172526665032:
Train Score: 0.00093 MSE 0.03046 RMSE
Test Score: 0.01515 MSE 0.12309 RMSE
Deviation Min [1.83927937e-05], Max [0.7962832]
Deviation 99.5th pctile [0.28335517]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1393,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1383,   17]))
Confusion matrix 
[[1380    3]
 [  13    4]]
precision 0.57143, recall 0.23529, f1 0.33333
Time to train: 215544 ms
Saving model models/A1Benchmark/real_65.csv.h5
Total Time to proces all the selected files : 218038 ms
A1Benchmark : Avg precision 0.57143 recall 0.23529 f1 0.33333 time to train 215544.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_65.csv  --epochs 20 --n_iter 3 --patience 3 :: took 225 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_66.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 05:06:15 AM MST
2020-11-30 05:06:21.384543: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 05:06:21.403265: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 05:06:21.404139: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5635e79aa270 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 05:06:21.404165: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 05:06:21.404280: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_66.csv
Shapes: time variant data with labels (1424, 2), full data (1424, 3)
Look back data shapes: lookbackX (1400, 24, 1) lookbackY (1400, 2)
Shapes: Xtrain_full (1120, 24, 1), Ytrain_full (1120, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1008, 24, 1), Ytrain (1008, 1), Xvalid (112, 24, 1), Yvalid (112, 1)
1/7 [===>..........................] - ETA: 0s - loss: 1.1949e-044/7 [================>.............] - ETA: 0s - loss: 4.6630e-057/7 [==============================] - ETA: 0s - loss: 3.3699e-057/7 [==============================] - 0s 17ms/step - loss: 3.3699e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.8345e-054/7 [================>.............] - ETA: 0s - loss: 1.3826e-057/7 [==============================] - ETA: 0s - loss: 2.2132e-057/7 [==============================] - 0s 17ms/step - loss: 2.2132e-05
1/7 [===>..........................] - ETA: 0s - loss: 8.7552e-054/7 [================>.............] - ETA: 0s - loss: 6.4735e-057/7 [==============================] - ETA: 0s - loss: 5.8906e-057/7 [==============================] - 0s 15ms/step - loss: 5.8906e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.6737e-055/7 [====================>.........] - ETA: 0s - loss: 2.3564e-057/7 [==============================] - 0s 15ms/step - loss: 2.1606e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.3615e-056/7 [========================>.....] - ETA: 0s - loss: 5.4835e-057/7 [==============================] - 0s 11ms/step - loss: 6.7993e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.2727e-044/7 [================>.............] - ETA: 0s - loss: 5.0175e-057/7 [==============================] - 0s 15ms/step - loss: 3.6363e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.9042e-054/7 [================>.............] - ETA: 0s - loss: 1.3656e-057/7 [==============================] - ETA: 0s - loss: 2.2075e-057/7 [==============================] - 0s 18ms/step - loss: 2.2075e-05
1/7 [===>..........................] - ETA: 0s - loss: 9.0677e-054/7 [================>.............] - ETA: 0s - loss: 6.6580e-057/7 [==============================] - 0s 14ms/step - loss: 6.0351e-05
1/7 [===>..........................] - ETA: 0s - loss: 2.4140e-054/7 [================>.............] - ETA: 0s - loss: 3.1433e-057/7 [==============================] - ETA: 0s - loss: 2.6952e-057/7 [==============================] - 0s 19ms/step - loss: 2.6952e-05
1/7 [===>..........................] - ETA: 0s - loss: 9.6982e-065/7 [====================>.........] - ETA: 0s - loss: 4.3925e-057/7 [==============================] - 0s 14ms/step - loss: 7.7569e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.2654e-043/7 [===========>..................] - ETA: 0s - loss: 6.4489e-055/7 [====================>.........] - ETA: 0s - loss: 4.3580e-057/7 [==============================] - ETA: 0s - loss: 3.5505e-057/7 [==============================] - 0s 31ms/step - loss: 3.5505e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.8307e-053/7 [===========>..................] - ETA: 0s - loss: 2.1773e-054/7 [================>.............] - ETA: 0s - loss: 2.1017e-055/7 [====================>.........] - ETA: 0s - loss: 2.4042e-056/7 [========================>.....] - ETA: 0s - loss: 2.8951e-057/7 [==============================] - 0s 39ms/step - loss: 2.8490e-05
1/7 [===>..........................] - ETA: 0s - loss: 8.5809e-053/7 [===========>..................] - ETA: 0s - loss: 6.7237e-055/7 [====================>.........] - ETA: 0s - loss: 5.6823e-057/7 [==============================] - ETA: 0s - loss: 5.6616e-057/7 [==============================] - 0s 23ms/step - loss: 5.6616e-05
1/7 [===>..........................] - ETA: 0s - loss: 2.0442e-053/7 [===========>..................] - ETA: 0s - loss: 2.1958e-055/7 [====================>.........] - ETA: 0s - loss: 2.5799e-057/7 [==============================] - ETA: 0s - loss: 2.4039e-057/7 [==============================] - 0s 29ms/step - loss: 2.4039e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.4103e-053/7 [===========>..................] - ETA: 0s - loss: 2.8492e-055/7 [====================>.........] - ETA: 0s - loss: 4.1551e-057/7 [==============================] - ETA: 0s - loss: 7.1137e-057/7 [==============================] - 0s 33ms/step - loss: 7.1137e-05
Best parameters {'n_units': 72, 'n_hidden': 1} best score 4.0867390634957704e-05:
Train Score: 0.00005 MSE 0.00683 RMSE
Test Score: 0.03455 MSE 0.18587 RMSE
Deviation Min [3.85612941e-06], Max [0.97337979]
Deviation 99.5th pctile [0.69438025]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1393,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1379,   21]))
Confusion matrix 
[[1379    0]
 [  14    7]]
precision 1.00000, recall 0.33333, f1 0.50000
Time to train: 173378 ms
Saving model models/A1Benchmark/real_66.csv.h5
Total Time to proces all the selected files : 175654 ms
A1Benchmark : Avg precision 1.00000 recall 0.33333 f1 0.50000 time to train 173378.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_66.csv  --epochs 20 --n_iter 3 --patience 3 :: took 182 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_67.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 05:09:22 AM MST
2020-11-30 05:09:28.654370: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 05:09:28.673155: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 05:09:28.673884: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5643287d08c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 05:09:28.673910: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 05:09:28.674019: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_67.csv
Shapes: time variant data with labels (1423, 2), full data (1423, 3)
Look back data shapes: lookbackX (1399, 24, 1) lookbackY (1399, 2)
Shapes: Xtrain_full (1119, 24, 1), Ytrain_full (1119, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1008, 24, 1), Ytrain (1008, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 2.5371e-054/7 [================>.............] - ETA: 0s - loss: 1.8417e-057/7 [==============================] - 0s 14ms/step - loss: 1.6502e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.1918e-055/7 [====================>.........] - ETA: 0s - loss: 1.5874e-057/7 [==============================] - 0s 15ms/step - loss: 1.4377e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.5354e-054/7 [================>.............] - ETA: 0s - loss: 1.6689e-057/7 [==============================] - ETA: 0s - loss: 1.7375e-057/7 [==============================] - 0s 17ms/step - loss: 1.7375e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.6586e-054/7 [================>.............] - ETA: 0s - loss: 1.9206e-057/7 [==============================] - ETA: 0s - loss: 1.8403e-057/7 [==============================] - 0s 15ms/step - loss: 1.8403e-05
1/7 [===>..........................] - ETA: 0s - loss: 9.2362e-064/7 [================>.............] - ETA: 0s - loss: 1.1101e-057/7 [==============================] - ETA: 0s - loss: 1.1313e-057/7 [==============================] - 0s 17ms/step - loss: 1.1313e-05
1/7 [===>..........................] - ETA: 0s - loss: 3.5687e-053/7 [===========>..................] - ETA: 0s - loss: 2.3226e-055/7 [====================>.........] - ETA: 0s - loss: 1.9670e-057/7 [==============================] - ETA: 0s - loss: 1.9238e-057/7 [==============================] - 0s 37ms/step - loss: 1.9238e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.2697e-053/7 [===========>..................] - ETA: 0s - loss: 1.5937e-055/7 [====================>.........] - ETA: 0s - loss: 1.8153e-057/7 [==============================] - ETA: 0s - loss: 1.6122e-057/7 [==============================] - 0s 31ms/step - loss: 1.6122e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.8257e-053/7 [===========>..................] - ETA: 0s - loss: 2.1905e-055/7 [====================>.........] - ETA: 0s - loss: 1.6728e-057/7 [==============================] - ETA: 0s - loss: 1.5491e-057/7 [==============================] - 0s 32ms/step - loss: 1.5491e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.5935e-053/7 [===========>..................] - ETA: 0s - loss: 1.5936e-054/7 [================>.............] - ETA: 0s - loss: 1.3846e-056/7 [========================>.....] - ETA: 0s - loss: 1.5554e-057/7 [==============================] - 0s 35ms/step - loss: 1.5461e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.0693e-053/7 [===========>..................] - ETA: 0s - loss: 1.4552e-055/7 [====================>.........] - ETA: 0s - loss: 1.4283e-057/7 [==============================] - ETA: 0s - loss: 1.3733e-057/7 [==============================] - 0s 32ms/step - loss: 1.3733e-05
1/7 [===>..........................] - ETA: 0s - loss: 2.5957e-055/7 [====================>.........] - ETA: 0s - loss: 1.7819e-057/7 [==============================] - 0s 13ms/step - loss: 1.7626e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.1495e-054/7 [================>.............] - ETA: 0s - loss: 1.5326e-057/7 [==============================] - ETA: 0s - loss: 1.4202e-057/7 [==============================] - 0s 17ms/step - loss: 1.4202e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.4700e-054/7 [================>.............] - ETA: 0s - loss: 1.5847e-057/7 [==============================] - ETA: 0s - loss: 1.6216e-057/7 [==============================] - 0s 17ms/step - loss: 1.6216e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.3379e-055/7 [====================>.........] - ETA: 0s - loss: 1.2068e-057/7 [==============================] - 0s 14ms/step - loss: 1.3403e-05
1/7 [===>..........................] - ETA: 0s - loss: 8.9619e-064/7 [================>.............] - ETA: 0s - loss: 1.0881e-057/7 [==============================] - ETA: 0s - loss: 1.1066e-057/7 [==============================] - 0s 17ms/step - loss: 1.1066e-05
Best parameters {'n_units': 72, 'n_hidden': 1} best score 1.4502378326142206e-05:
Train Score: 0.00001 MSE 0.00365 RMSE
Test Score: 0.02645 MSE 0.16265 RMSE
Deviation Min [3.45922965e-06], Max [0.98502731]
Deviation 99.5th pctile [0.66654708]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1392,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1376,   23]))
Confusion matrix 
[[1376    0]
 [  16    7]]
precision 1.00000, recall 0.30435, f1 0.46667
Time to train: 178885 ms
Saving model models/A1Benchmark/real_67.csv.h5
Total Time to proces all the selected files : 180984 ms
A1Benchmark : Avg precision 1.00000 recall 0.30435 f1 0.46667 time to train 178885.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_67.csv  --epochs 20 --n_iter 3 --patience 3 :: took 188 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_6.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 05:12:35 AM MST
2020-11-30 05:12:41.236819: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 05:12:41.255259: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 05:12:41.256716: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x560691703cf0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 05:12:41.256770: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 05:12:41.256993: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_6.csv
Shapes: time variant data with labels (1439, 2), full data (1439, 3)
Look back data shapes: lookbackX (1415, 24, 1) lookbackY (1415, 2)
Shapes: Xtrain_full (1132, 24, 1), Ytrain_full (1132, 1), Xtest (283, 24, 1), Ytest (283, 1)
Shapes: Xtrain (1019, 24, 1), Ytrain (1019, 1), Xvalid (113, 24, 1), Yvalid (113, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.00173/7 [===========>..................] - ETA: 0s - loss: 0.00145/7 [====================>.........] - ETA: 0s - loss: 0.00187/7 [==============================] - ETA: 0s - loss: 0.00197/7 [==============================] - 0s 32ms/step - loss: 0.0019
1/7 [===>..........................] - ETA: 0s - loss: 0.00203/7 [===========>..................] - ETA: 0s - loss: 0.00175/7 [====================>.........] - ETA: 0s - loss: 0.00197/7 [==============================] - ETA: 0s - loss: 0.00187/7 [==============================] - 0s 29ms/step - loss: 0.0018
1/7 [===>..........................] - ETA: 0s - loss: 0.00143/7 [===========>..................] - ETA: 0s - loss: 0.00235/7 [====================>.........] - ETA: 0s - loss: 0.00207/7 [==============================] - ETA: 0s - loss: 0.00207/7 [==============================] - 0s 25ms/step - loss: 0.0020
1/7 [===>..........................] - ETA: 0s - loss: 0.00193/7 [===========>..................] - ETA: 0s - loss: 0.00455/7 [====================>.........] - ETA: 0s - loss: 0.00487/7 [==============================] - ETA: 0s - loss: 0.00457/7 [==============================] - 0s 33ms/step - loss: 0.0045
1/7 [===>..........................] - ETA: 0s - loss: 0.00383/7 [===========>..................] - ETA: 0s - loss: 0.00365/7 [====================>.........] - ETA: 0s - loss: 0.00367/7 [==============================] - ETA: 0s - loss: 0.00347/7 [==============================] - 0s 23ms/step - loss: 0.0034
1/7 [===>..........................] - ETA: 0s - loss: 0.00203/7 [===========>..................] - ETA: 0s - loss: 0.00185/7 [====================>.........] - ETA: 0s - loss: 0.00237/7 [==============================] - ETA: 0s - loss: 0.00227/7 [==============================] - 0s 27ms/step - loss: 0.0022
1/7 [===>..........................] - ETA: 0s - loss: 0.00163/7 [===========>..................] - ETA: 0s - loss: 0.00165/7 [====================>.........] - ETA: 0s - loss: 0.00167/7 [==============================] - ETA: 0s - loss: 0.00167/7 [==============================] - 0s 30ms/step - loss: 0.0016
1/7 [===>..........................] - ETA: 0s - loss: 0.00133/7 [===========>..................] - ETA: 0s - loss: 0.00215/7 [====================>.........] - ETA: 0s - loss: 0.00227/7 [==============================] - ETA: 0s - loss: 0.00257/7 [==============================] - 0s 32ms/step - loss: 0.0025
1/7 [===>..........................] - ETA: 0s - loss: 0.00213/7 [===========>..................] - ETA: 0s - loss: 0.00475/7 [====================>.........] - ETA: 0s - loss: 0.00516/7 [========================>.....] - ETA: 0s - loss: 0.00477/7 [==============================] - 0s 36ms/step - loss: 0.0048
1/7 [===>..........................] - ETA: 0s - loss: 0.00383/7 [===========>..................] - ETA: 0s - loss: 0.00355/7 [====================>.........] - ETA: 0s - loss: 0.00357/7 [==============================] - ETA: 0s - loss: 0.00347/7 [==============================] - 0s 27ms/step - loss: 0.0034
1/7 [===>..........................] - ETA: 0s - loss: 0.00114/7 [================>.............] - ETA: 0s - loss: 0.00136/7 [========================>.....] - ETA: 0s - loss: 0.00147/7 [==============================] - 0s 18ms/step - loss: 0.0014
1/7 [===>..........................] - ETA: 0s - loss: 0.00284/7 [================>.............] - ETA: 0s - loss: 0.00267/7 [==============================] - ETA: 0s - loss: 0.00257/7 [==============================] - 0s 18ms/step - loss: 0.0025
1/7 [===>..........................] - ETA: 0s - loss: 0.00215/7 [====================>.........] - ETA: 0s - loss: 0.00257/7 [==============================] - 0s 14ms/step - loss: 0.0023
1/7 [===>..........................] - ETA: 0s - loss: 0.00184/7 [================>.............] - ETA: 0s - loss: 0.00407/7 [==============================] - ETA: 0s - loss: 0.00397/7 [==============================] - 0s 18ms/step - loss: 0.0039
1/7 [===>..........................] - ETA: 0s - loss: 0.00754/7 [================>.............] - ETA: 0s - loss: 0.00717/7 [==============================] - 0s 15ms/step - loss: 0.0067
Best parameters {'n_units': 72, 'n_hidden': 2} best score 0.0027317367726936936:
Train Score: 0.00198 MSE 0.04453 RMSE
Test Score: 0.00792 MSE 0.08901 RMSE
Deviation Min [2.17839575e-05], Max [0.7199837]
Deviation 99.5th pctile [0.25408396]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1407,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1407,    8]))
Confusion matrix 
[[1406    1]
 [   1    7]]
precision 0.87500, recall 0.87500, f1 0.87500
Time to train: 254479 ms
Saving model models/A1Benchmark/real_6.csv.h5
Total Time to proces all the selected files : 257979 ms
A1Benchmark : Avg precision 0.87500 recall 0.87500 f1 0.87500 time to train 254479.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_6.csv  --epochs 20 --n_iter 3 --patience 3 :: took 264 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_7.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 05:17:04 AM MST
2020-11-30 05:17:10.875393: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 05:17:10.894240: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 05:17:10.895102: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55da25ee7c60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 05:17:10.895130: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 05:17:10.895232: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_7.csv
Shapes: time variant data with labels (1423, 2), full data (1423, 3)
Look back data shapes: lookbackX (1399, 24, 1) lookbackY (1399, 2)
Shapes: Xtrain_full (1119, 24, 1), Ytrain_full (1119, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1008, 24, 1), Ytrain (1008, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 0.40403/7 [===========>..................] - ETA: 0s - loss: 0.44005/7 [====================>.........] - ETA: 0s - loss: 0.27447/7 [==============================] - ETA: 0s - loss: 0.21747/7 [==============================] - 0s 30ms/step - loss: 0.2174
1/7 [===>..........................] - ETA: 0s - loss: 1.7640e-043/7 [===========>..................] - ETA: 0s - loss: 1.9122e-045/7 [====================>.........] - ETA: 0s - loss: 1.9397e-047/7 [==============================] - 0s 22ms/step - loss: 2.0050e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.1829e-053/7 [===========>..................] - ETA: 0s - loss: 8.8143e-065/7 [====================>.........] - ETA: 0s - loss: 9.1919e-067/7 [==============================] - ETA: 0s - loss: 1.0093e-057/7 [==============================] - 0s 23ms/step - loss: 1.0093e-05
1/7 [===>..........................] - ETA: 0s - loss: 4.2300e-053/7 [===========>..................] - ETA: 0s - loss: 3.8798e-055/7 [====================>.........] - ETA: 0s - loss: 3.8521e-057/7 [==============================] - 0s 23ms/step - loss: 3.8053e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.0148e-043/7 [===========>..................] - ETA: 0s - loss: 1.1311e-045/7 [====================>.........] - ETA: 0s - loss: 1.0991e-047/7 [==============================] - ETA: 0s - loss: 1.0997e-047/7 [==============================] - 0s 23ms/step - loss: 1.0997e-04
1/7 [===>..........................] - ETA: 0s - loss: 0.37583/7 [===========>..................] - ETA: 0s - loss: 0.41175/7 [====================>.........] - ETA: 0s - loss: 0.25647/7 [==============================] - ETA: 0s - loss: 0.20317/7 [==============================] - 0s 27ms/step - loss: 0.2031
1/7 [===>..........................] - ETA: 0s - loss: 7.3030e-053/7 [===========>..................] - ETA: 0s - loss: 8.3395e-055/7 [====================>.........] - ETA: 0s - loss: 8.5028e-057/7 [==============================] - ETA: 0s - loss: 8.7397e-057/7 [==============================] - 0s 28ms/step - loss: 8.7397e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.6399e-043/7 [===========>..................] - ETA: 0s - loss: 1.7911e-045/7 [====================>.........] - ETA: 0s - loss: 1.7855e-047/7 [==============================] - ETA: 0s - loss: 1.7157e-047/7 [==============================] - 0s 28ms/step - loss: 1.7157e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.6588e-053/7 [===========>..................] - ETA: 0s - loss: 2.4881e-055/7 [====================>.........] - ETA: 0s - loss: 2.6802e-057/7 [==============================] - ETA: 0s - loss: 2.7804e-057/7 [==============================] - 0s 26ms/step - loss: 2.7804e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.6731e-053/7 [===========>..................] - ETA: 0s - loss: 2.0423e-055/7 [====================>.........] - ETA: 0s - loss: 1.8989e-057/7 [==============================] - ETA: 0s - loss: 1.9263e-057/7 [==============================] - 0s 38ms/step - loss: 1.9263e-05
1/7 [===>..........................] - ETA: 0s - loss: 0.39923/7 [===========>..................] - ETA: 0s - loss: 0.43535/7 [====================>.........] - ETA: 0s - loss: 0.27147/7 [==============================] - ETA: 0s - loss: 0.21507/7 [==============================] - 0s 28ms/step - loss: 0.2150
1/7 [===>..........................] - ETA: 0s - loss: 3.5650e-053/7 [===========>..................] - ETA: 0s - loss: 3.4020e-055/7 [====================>.........] - ETA: 0s - loss: 3.4892e-057/7 [==============================] - ETA: 0s - loss: 3.1173e-057/7 [==============================] - 0s 29ms/step - loss: 3.1173e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.4320e-053/7 [===========>..................] - ETA: 0s - loss: 1.5149e-055/7 [====================>.........] - ETA: 0s - loss: 1.5476e-057/7 [==============================] - ETA: 0s - loss: 1.4756e-057/7 [==============================] - 0s 24ms/step - loss: 1.4756e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.1675e-043/7 [===========>..................] - ETA: 0s - loss: 1.1233e-045/7 [====================>.........] - ETA: 0s - loss: 1.1063e-047/7 [==============================] - ETA: 0s - loss: 1.0934e-047/7 [==============================] - 0s 25ms/step - loss: 1.0934e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.9776e-053/7 [===========>..................] - ETA: 0s - loss: 1.6580e-055/7 [====================>.........] - ETA: 0s - loss: 1.4627e-057/7 [==============================] - ETA: 0s - loss: 1.4450e-057/7 [==============================] - 0s 26ms/step - loss: 1.4450e-05
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.04067247788516397:
Train Score: 0.00292 MSE 0.05401 RMSE
Test Score: 0.00656 MSE 0.08101 RMSE
Deviation Min [1.22385476e-06], Max [0.47062436]
Deviation 99.5th pctile [0.33508311]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1392,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1338,   61]))
Confusion matrix 
[[1338    0]
 [  54    7]]
precision 1.00000, recall 0.11475, f1 0.20588
Time to train: 595560 ms
Saving model models/A1Benchmark/real_7.csv.h5
Total Time to proces all the selected files : 599344 ms
A1Benchmark : Avg precision 1.00000 recall 0.11475 f1 0.20588 time to train 595560.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_7.csv  --epochs 20 --n_iter 3 --patience 3 :: took 606 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_8.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 05:27:15 AM MST
2020-11-30 05:27:21.851542: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 05:27:21.870207: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 05:27:21.871097: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x556001f738c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 05:27:21.871127: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 05:27:21.871251: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_8.csv
Shapes: time variant data with labels (1420, 2), full data (1420, 3)
Look back data shapes: lookbackX (1396, 24, 1) lookbackY (1396, 2)
Shapes: Xtrain_full (1116, 24, 1), Ytrain_full (1116, 1), Xtest (280, 24, 1), Ytest (280, 1)
Shapes: Xtrain (1005, 24, 1), Ytrain (1005, 1), Xvalid (111, 24, 1), Yvalid (111, 1)
1/7 [===>..........................] - ETA: 0s - loss: 3.6513e-053/7 [===========>..................] - ETA: 0s - loss: 9.3873e-045/7 [====================>.........] - ETA: 0s - loss: 6.6013e-047/7 [==============================] - ETA: 0s - loss: 5.3401e-047/7 [==============================] - 0s 30ms/step - loss: 5.3401e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.0545e-043/7 [===========>..................] - ETA: 0s - loss: 1.0099e-045/7 [====================>.........] - ETA: 0s - loss: 1.0367e-047/7 [==============================] - ETA: 0s - loss: 1.0833e-047/7 [==============================] - 0s 25ms/step - loss: 1.0833e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.8980e-053/7 [===========>..................] - ETA: 0s - loss: 6.2498e-055/7 [====================>.........] - ETA: 0s - loss: 5.2133e-057/7 [==============================] - ETA: 0s - loss: 4.7958e-057/7 [==============================] - 0s 25ms/step - loss: 4.7958e-05
1/7 [===>..........................] - ETA: 0s - loss: 4.4124e-053/7 [===========>..................] - ETA: 0s - loss: 4.2138e-055/7 [====================>.........] - ETA: 0s - loss: 0.0096    7/7 [==============================] - ETA: 0s - loss: 0.01307/7 [==============================] - 0s 25ms/step - loss: 0.0130
1/7 [===>..........................] - ETA: 0s - loss: 7.8386e-043/7 [===========>..................] - ETA: 0s - loss: 3.9766e-045/7 [====================>.........] - ETA: 0s - loss: 3.8071e-047/7 [==============================] - ETA: 0s - loss: 3.4342e-047/7 [==============================] - 0s 28ms/step - loss: 3.4342e-04
1/7 [===>..........................] - ETA: 0s - loss: 5.6791e-054/7 [================>.............] - ETA: 0s - loss: 7.9564e-047/7 [==============================] - ETA: 0s - loss: 5.3258e-047/7 [==============================] - 0s 15ms/step - loss: 5.3258e-04
1/7 [===>..........................] - ETA: 0s - loss: 3.3380e-054/7 [================>.............] - ETA: 0s - loss: 3.5953e-057/7 [==============================] - ETA: 0s - loss: 3.6749e-057/7 [==============================] - 0s 17ms/step - loss: 3.6749e-05
1/7 [===>..........................] - ETA: 0s - loss: 1.0128e-054/7 [================>.............] - ETA: 0s - loss: 8.5604e-067/7 [==============================] - ETA: 0s - loss: 1.6529e-057/7 [==============================] - 0s 16ms/step - loss: 1.6529e-05
1/7 [===>..........................] - ETA: 0s - loss: 6.4580e-055/7 [====================>.........] - ETA: 0s - loss: 0.0096    7/7 [==============================] - 0s 12ms/step - loss: 0.0129
1/7 [===>..........................] - ETA: 0s - loss: 7.8261e-044/7 [================>.............] - ETA: 0s - loss: 3.5100e-047/7 [==============================] - ETA: 0s - loss: 2.3944e-047/7 [==============================] - 0s 16ms/step - loss: 2.3944e-04
1/7 [===>..........................] - ETA: 0s - loss: 4.9609e-053/7 [===========>..................] - ETA: 0s - loss: 9.4079e-045/7 [====================>.........] - ETA: 0s - loss: 6.6407e-046/7 [========================>.....] - ETA: 0s - loss: 5.6283e-047/7 [==============================] - 0s 36ms/step - loss: 5.4087e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.4853e-043/7 [===========>..................] - ETA: 0s - loss: 1.4284e-045/7 [====================>.........] - ETA: 0s - loss: 1.4402e-047/7 [==============================] - ETA: 0s - loss: 1.5092e-047/7 [==============================] - 0s 27ms/step - loss: 1.5092e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.4706e-053/7 [===========>..................] - ETA: 0s - loss: 2.6474e-055/7 [====================>.........] - ETA: 0s - loss: 2.4057e-057/7 [==============================] - ETA: 0s - loss: 2.5438e-057/7 [==============================] - 0s 27ms/step - loss: 2.5438e-05
1/7 [===>..........................] - ETA: 0s - loss: 4.5787e-053/7 [===========>..................] - ETA: 0s - loss: 4.7573e-055/7 [====================>.........] - ETA: 0s - loss: 0.0098    7/7 [==============================] - 0s 23ms/step - loss: 0.0132
1/7 [===>..........................] - ETA: 0s - loss: 6.9879e-043/7 [===========>..................] - ETA: 0s - loss: 2.7860e-045/7 [====================>.........] - ETA: 0s - loss: 2.7267e-047/7 [==============================] - ETA: 0s - loss: 2.2716e-047/7 [==============================] - 0s 31ms/step - loss: 2.2716e-04
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.002751500510930782:
Train Score: 0.00232 MSE 0.04819 RMSE
Test Score: 0.01413 MSE 0.11886 RMSE
Deviation Min [1.28075286e-05], Max [0.89603473]
Deviation 99.5th pctile [0.66258411]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1389,    7]))
Actual is_anomaly labels in data (array([0, 1]), array([1386,   10]))
Confusion matrix 
[[1386    0]
 [   3    7]]
precision 1.00000, recall 0.70000, f1 0.82353
Time to train: 210157 ms
Saving model models/A1Benchmark/real_8.csv.h5
Total Time to proces all the selected files : 212317 ms
A1Benchmark : Avg precision 1.00000 recall 0.70000 f1 0.82353 time to train 210157.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_8.csv  --epochs 20 --n_iter 3 --patience 3 :: took 219 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_9.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 05:30:59 AM MST
2020-11-30 05:31:05.545396: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 05:31:05.564273: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 05:31:05.565774: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5557eeb89c60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 05:31:05.565829: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 05:31:05.566077: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A1Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A1Benchmark/real_9.csv
Shapes: time variant data with labels (1461, 2), full data (1461, 3)
Look back data shapes: lookbackX (1437, 24, 1) lookbackY (1437, 2)
Shapes: Xtrain_full (1149, 24, 1), Ytrain_full (1149, 1), Xtest (288, 24, 1), Ytest (288, 1)
Shapes: Xtrain (1035, 24, 1), Ytrain (1035, 1), Xvalid (114, 24, 1), Yvalid (114, 1)
1/7 [===>..........................] - ETA: 0s - loss: 2.2026e-044/7 [================>.............] - ETA: 0s - loss: 1.8591e-047/7 [==============================] - ETA: 0s - loss: 2.0021e-047/7 [==============================] - 0s 16ms/step - loss: 2.0021e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.6914e-044/7 [================>.............] - ETA: 0s - loss: 1.6597e-047/7 [==============================] - ETA: 0s - loss: 1.5294e-047/7 [==============================] - 0s 18ms/step - loss: 1.5294e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.6027e-045/7 [====================>.........] - ETA: 0s - loss: 3.7450e-047/7 [==============================] - 0s 14ms/step - loss: 3.3499e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.6570e-045/7 [====================>.........] - ETA: 0s - loss: 0.0061    7/7 [==============================] - 0s 12ms/step - loss: 0.0047
1/7 [===>..........................] - ETA: 0s - loss: 0.00344/7 [================>.............] - ETA: 0s - loss: 9.4707e-047/7 [==============================] - ETA: 0s - loss: 6.3568e-047/7 [==============================] - 0s 16ms/step - loss: 6.3568e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.6709e-043/7 [===========>..................] - ETA: 0s - loss: 1.8441e-045/7 [====================>.........] - ETA: 0s - loss: 1.8423e-047/7 [==============================] - ETA: 0s - loss: 1.8701e-047/7 [==============================] - 0s 32ms/step - loss: 1.8701e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.8402e-043/7 [===========>..................] - ETA: 0s - loss: 1.8156e-045/7 [====================>.........] - ETA: 0s - loss: 1.7984e-047/7 [==============================] - ETA: 0s - loss: 1.7599e-047/7 [==============================] - 0s 28ms/step - loss: 1.7599e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.8418e-043/7 [===========>..................] - ETA: 0s - loss: 2.6125e-045/7 [====================>.........] - ETA: 0s - loss: 4.2444e-047/7 [==============================] - ETA: 0s - loss: 3.8071e-047/7 [==============================] - 0s 32ms/step - loss: 3.8071e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.8775e-042/7 [=======>......................] - ETA: 0s - loss: 1.7984e-044/7 [================>.............] - ETA: 0s - loss: 0.0075    6/7 [========================>.....] - ETA: 0s - loss: 0.00517/7 [==============================] - 0s 35ms/step - loss: 0.0047
1/7 [===>..........................] - ETA: 0s - loss: 0.00343/7 [===========>..................] - ETA: 0s - loss: 0.00125/7 [====================>.........] - ETA: 0s - loss: 8.0649e-047/7 [==============================] - ETA: 0s - loss: 6.5671e-047/7 [==============================] - 0s 37ms/step - loss: 6.5671e-04
1/7 [===>..........................] - ETA: 0s - loss: 2.1712e-042/7 [=======>......................] - ETA: 0s - loss: 1.9841e-043/7 [===========>..................] - ETA: 0s - loss: 1.8061e-045/7 [====================>.........] - ETA: 0s - loss: 2.0469e-047/7 [==============================] - ETA: 0s - loss: 2.0419e-047/7 [==============================] - 0s 31ms/step - loss: 2.0419e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.5544e-043/7 [===========>..................] - ETA: 0s - loss: 1.6811e-045/7 [====================>.........] - ETA: 0s - loss: 1.6873e-047/7 [==============================] - ETA: 0s - loss: 1.6160e-047/7 [==============================] - 0s 33ms/step - loss: 1.6160e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.3832e-043/7 [===========>..................] - ETA: 0s - loss: 2.0038e-045/7 [====================>.........] - ETA: 0s - loss: 4.1836e-047/7 [==============================] - 0s 28ms/step - loss: 3.5754e-04
1/7 [===>..........................] - ETA: 0s - loss: 1.7513e-043/7 [===========>..................] - ETA: 0s - loss: 0.0101    5/7 [====================>.........] - ETA: 0s - loss: 0.00617/7 [==============================] - ETA: 0s - loss: 0.00487/7 [==============================] - 0s 26ms/step - loss: 0.0048
1/7 [===>..........................] - ETA: 0s - loss: 0.00353/7 [===========>..................] - ETA: 0s - loss: 0.00135/7 [====================>.........] - ETA: 0s - loss: 8.2297e-047/7 [==============================] - ETA: 0s - loss: 6.7010e-047/7 [==============================] - 0s 32ms/step - loss: 6.7010e-04
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0012095987825887279:
Train Score: 0.00111 MSE 0.03325 RMSE
Test Score: 0.00024 MSE 0.01553 RMSE
Deviation Min [1.78215915e-05], Max [0.96813462]
Deviation 99.5th pctile [0.05498486]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1429,    8]))
Actual is_anomaly labels in data (array([0, 1]), array([1429,    8]))
Confusion matrix 
[[1428    1]
 [   1    7]]
precision 0.87500, recall 0.87500, f1 0.87500
Time to train: 215920 ms
Saving model models/A1Benchmark/real_9.csv.h5
Total Time to proces all the selected files : 218602 ms
A1Benchmark : Avg precision 0.87500 recall 0.87500 f1 0.87500 time to train 215920.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A1Benchmark --save 1 --file_name real_9.csv  --epochs 20 --n_iter 3 --patience 3 :: took 225 seconds

DATA_FOLDER : ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS100.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 02:42:26 PM MST
2020-11-30 14:42:38.833412: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 14:42:38.882207: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 14:42:38.883569: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559be8af7c00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 14:42:38.883618: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 14:42:38.889800: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS100.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00673/8 [==========>...................] - ETA: 0s - loss: 0.00805/8 [=================>............] - ETA: 0s - loss: 0.00797/8 [=========================>....] - ETA: 0s - loss: 0.00748/8 [==============================] - 0s 26ms/step - loss: 0.0075
1/8 [==>...........................] - ETA: 0s - loss: 0.00543/8 [==========>...................] - ETA: 0s - loss: 0.00705/8 [=================>............] - ETA: 0s - loss: 0.00737/8 [=========================>....] - ETA: 0s - loss: 0.00718/8 [==============================] - 0s 27ms/step - loss: 0.0073
1/8 [==>...........................] - ETA: 0s - loss: 0.00583/8 [==========>...................] - ETA: 0s - loss: 0.00735/8 [=================>............] - ETA: 0s - loss: 0.00747/8 [=========================>....] - ETA: 0s - loss: 0.00728/8 [==============================] - 0s 28ms/step - loss: 0.0075
1/8 [==>...........................] - ETA: 0s - loss: 0.00563/8 [==========>...................] - ETA: 0s - loss: 0.00725/8 [=================>............] - ETA: 0s - loss: 0.00738/8 [==============================] - ETA: 0s - loss: 0.00948/8 [==============================] - 0s 23ms/step - loss: 0.0094
1/8 [==>...........................] - ETA: 0s - loss: 0.01343/8 [==========>...................] - ETA: 0s - loss: 0.01375/8 [=================>............] - ETA: 0s - loss: 0.01457/8 [=========================>....] - ETA: 0s - loss: 0.01558/8 [==============================] - 0s 28ms/step - loss: 0.0158
1/8 [==>...........................] - ETA: 0s - loss: 0.00385/8 [=================>............] - ETA: 0s - loss: 0.00148/8 [==============================] - 0s 12ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 0.00555/8 [=================>............] - ETA: 0s - loss: 0.00628/8 [==============================] - 0s 12ms/step - loss: 0.0063
1/8 [==>...........................] - ETA: 0s - loss: 0.00214/8 [==============>...............] - ETA: 0s - loss: 0.00217/8 [=========================>....] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 17ms/step - loss: 0.0022
1/8 [==>...........................] - ETA: 0s - loss: 0.00154/8 [==============>...............] - ETA: 0s - loss: 0.00198/8 [==============================] - ETA: 0s - loss: 0.00248/8 [==============================] - 0s 15ms/step - loss: 0.0024
1/8 [==>...........................] - ETA: 0s - loss: 0.00405/8 [=================>............] - ETA: 0s - loss: 0.00408/8 [==============================] - 0s 13ms/step - loss: 0.0046
1/8 [==>...........................] - ETA: 0s - loss: 0.00366/8 [=====================>........] - ETA: 0s - loss: 0.00208/8 [==============================] - 0s 11ms/step - loss: 0.0019
1/8 [==>...........................] - ETA: 0s - loss: 5.5631e-046/8 [=====================>........] - ETA: 0s - loss: 0.0012    8/8 [==============================] - 0s 9ms/step - loss: 0.0011
1/8 [==>...........................] - ETA: 0s - loss: 0.00276/8 [=====================>........] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 11ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.00235/8 [=================>............] - ETA: 0s - loss: 0.00238/8 [==============================] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 14ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00776/8 [=====================>........] - ETA: 0s - loss: 0.00968/8 [==============================] - 0s 11ms/step - loss: 0.0096
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0034078408731147646:
Train Score: 0.00150 MSE 0.03872 RMSE
Test Score: 0.00742 MSE 0.08617 RMSE
Deviation Min [0.00011745], Max [0.2291623]
Deviation 99.5th pctile [0.19853255]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1649,    7]))
Confusion matrix 
[[1642    7]
 [   5    2]]
precision 0.22222, recall 0.28571, f1 0.25000
Time to train: 396171 ms
Saving model models/A4Benchmark/A4Benchmark-TS100.csv.h5
Total Time to proces all the selected files : 398372 ms
A4Benchmark : Avg precision 0.22222 recall 0.28571 f1 0.25000 time to train 396171.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS100.csv  --epochs 20 --n_iter 3 --patience 3 :: took 411 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS10.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 02:49:22 PM MST
2020-11-30 14:49:29.644875: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 14:49:29.663241: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 14:49:29.664118: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x560cf8b70c00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 14:49:29.664143: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 14:49:29.664258: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS10.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00363/8 [==========>...................] - ETA: 0s - loss: 0.00455/8 [=================>............] - ETA: 0s - loss: 0.00407/8 [=========================>....] - ETA: 0s - loss: 0.00398/8 [==============================] - 0s 26ms/step - loss: 0.0040
1/8 [==>...........................] - ETA: 0s - loss: 0.00473/8 [==========>...................] - ETA: 0s - loss: 0.02165/8 [=================>............] - ETA: 0s - loss: 0.02327/8 [=========================>....] - ETA: 0s - loss: 0.02608/8 [==============================] - 0s 31ms/step - loss: 0.0266
1/8 [==>...........................] - ETA: 0s - loss: 0.00813/8 [==========>...................] - ETA: 0s - loss: 0.00815/8 [=================>............] - ETA: 0s - loss: 0.00727/8 [=========================>....] - ETA: 0s - loss: 0.00778/8 [==============================] - 0s 31ms/step - loss: 0.0079
1/8 [==>...........................] - ETA: 0s - loss: 0.02173/8 [==========>...................] - ETA: 0s - loss: 0.02695/8 [=================>............] - ETA: 0s - loss: 0.02657/8 [=========================>....] - ETA: 0s - loss: 0.02528/8 [==============================] - 0s 35ms/step - loss: 0.0262
1/8 [==>...........................] - ETA: 0s - loss: 0.00833/8 [==========>...................] - ETA: 0s - loss: 0.00705/8 [=================>............] - ETA: 0s - loss: 0.00687/8 [=========================>....] - ETA: 0s - loss: 0.00698/8 [==============================] - 0s 26ms/step - loss: 0.0070
1/8 [==>...........................] - ETA: 0s - loss: 0.00233/8 [==========>...................] - ETA: 0s - loss: 0.00175/8 [=================>............] - ETA: 0s - loss: 0.00117/8 [=========================>....] - ETA: 0s - loss: 0.00108/8 [==============================] - 0s 24ms/step - loss: 9.9247e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00463/8 [==========>...................] - ETA: 0s - loss: 0.02165/8 [=================>............] - ETA: 0s - loss: 0.02347/8 [=========================>....] - ETA: 0s - loss: 0.02628/8 [==============================] - 0s 31ms/step - loss: 0.0268
1/8 [==>...........................] - ETA: 0s - loss: 0.02543/8 [==========>...................] - ETA: 0s - loss: 0.02865/8 [=================>............] - ETA: 0s - loss: 0.02537/8 [=========================>....] - ETA: 0s - loss: 0.02598/8 [==============================] - 0s 24ms/step - loss: 0.0273
1/8 [==>...........................] - ETA: 0s - loss: 0.00843/8 [==========>...................] - ETA: 0s - loss: 0.01615/8 [=================>............] - ETA: 0s - loss: 0.01307/8 [=========================>....] - ETA: 0s - loss: 0.01168/8 [==============================] - 0s 33ms/step - loss: 0.0128
1/8 [==>...........................] - ETA: 0s - loss: 0.02293/8 [==========>...................] - ETA: 0s - loss: 0.02735/8 [=================>............] - ETA: 0s - loss: 0.02647/8 [=========================>....] - ETA: 0s - loss: 0.02648/8 [==============================] - 0s 29ms/step - loss: 0.0266
1/8 [==>...........................] - ETA: 0s - loss: 9.2198e-045/8 [=================>............] - ETA: 0s - loss: 9.7182e-048/8 [==============================] - 0s 14ms/step - loss: 0.0010
1/8 [==>...........................] - ETA: 0s - loss: 0.00394/8 [==============>...............] - ETA: 0s - loss: 0.01647/8 [=========================>....] - ETA: 0s - loss: 0.02008/8 [==============================] - 0s 18ms/step - loss: 0.0204
1/8 [==>...........................] - ETA: 0s - loss: 0.00824/8 [==============>...............] - ETA: 0s - loss: 0.00677/8 [=========================>....] - ETA: 0s - loss: 0.00778/8 [==============================] - 0s 18ms/step - loss: 0.0079
1/8 [==>...........................] - ETA: 0s - loss: 0.00674/8 [==============>...............] - ETA: 0s - loss: 0.00987/8 [=========================>....] - ETA: 0s - loss: 0.00948/8 [==============================] - 0s 18ms/step - loss: 0.0097
1/8 [==>...........................] - ETA: 0s - loss: 0.00615/8 [=================>............] - ETA: 0s - loss: 0.00568/8 [==============================] - 0s 14ms/step - loss: 0.0055
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.008915608609095215:
Train Score: 0.00541 MSE 0.07355 RMSE
Test Score: 0.00639 MSE 0.07991 RMSE
Deviation Min [8.97416896e-05], Max [0.48089346]
Deviation 99.5th pctile [0.2157639]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1652,    4]))
Confusion matrix 
[[1647    5]
 [   0    4]]
precision 0.44444, recall 1.00000, f1 0.61538
Time to train: 406072 ms
Saving model models/A4Benchmark/A4Benchmark-TS10.csv.h5
Total Time to proces all the selected files : 408486 ms
A4Benchmark : Avg precision 0.44444 recall 1.00000 f1 0.61538 time to train 406072.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS10.csv  --epochs 20 --n_iter 3 --patience 3 :: took 416 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS11.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 02:56:23 PM MST
2020-11-30 14:56:29.820028: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 14:56:29.838241: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 14:56:29.839663: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55a53ee5cc00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 14:56:29.839713: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 14:56:29.839927: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS11.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00383/8 [==========>...................] - ETA: 0s - loss: 0.00405/8 [=================>............] - ETA: 0s - loss: 0.00407/8 [=========================>....] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 26ms/step - loss: 0.0038
1/8 [==>...........................] - ETA: 0s - loss: 0.00263/8 [==========>...................] - ETA: 0s - loss: 0.00315/8 [=================>............] - ETA: 0s - loss: 0.00317/8 [=========================>....] - ETA: 0s - loss: 0.00418/8 [==============================] - 0s 25ms/step - loss: 0.0044
1/8 [==>...........................] - ETA: 0s - loss: 0.00573/8 [==========>...................] - ETA: 0s - loss: 0.00675/8 [=================>............] - ETA: 0s - loss: 0.00687/8 [=========================>....] - ETA: 0s - loss: 0.00718/8 [==============================] - 0s 36ms/step - loss: 0.0073
1/8 [==>...........................] - ETA: 0s - loss: 0.00833/8 [==========>...................] - ETA: 0s - loss: 0.00855/8 [=================>............] - ETA: 0s - loss: 0.00847/8 [=========================>....] - ETA: 0s - loss: 0.00868/8 [==============================] - 0s 34ms/step - loss: 0.0088
1/8 [==>...........................] - ETA: 0s - loss: 0.00733/8 [==========>...................] - ETA: 0s - loss: 0.00765/8 [=================>............] - ETA: 0s - loss: 0.00827/8 [=========================>....] - ETA: 0s - loss: 0.00828/8 [==============================] - 0s 36ms/step - loss: 0.0084
1/8 [==>...........................] - ETA: 0s - loss: 0.00465/8 [=================>............] - ETA: 0s - loss: 0.00428/8 [==============================] - 0s 12ms/step - loss: 0.0038
1/8 [==>...........................] - ETA: 0s - loss: 0.00224/8 [==============>...............] - ETA: 0s - loss: 0.00268/8 [==============================] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 14ms/step - loss: 0.0038
1/8 [==>...........................] - ETA: 0s - loss: 0.00465/8 [=================>............] - ETA: 0s - loss: 0.00558/8 [==============================] - 0s 14ms/step - loss: 0.0063
1/8 [==>...........................] - ETA: 0s - loss: 0.00525/8 [=================>............] - ETA: 0s - loss: 0.00538/8 [==============================] - 0s 13ms/step - loss: 0.0054
1/8 [==>...........................] - ETA: 0s - loss: 0.00545/8 [=================>............] - ETA: 0s - loss: 0.00658/8 [==============================] - 0s 13ms/step - loss: 0.0066
1/8 [==>...........................] - ETA: 0s - loss: 0.00633/8 [==========>...................] - ETA: 0s - loss: 0.00595/8 [=================>............] - ETA: 0s - loss: 0.00587/8 [=========================>....] - ETA: 0s - loss: 0.00528/8 [==============================] - 0s 30ms/step - loss: 0.0051
1/8 [==>...........................] - ETA: 0s - loss: 0.00243/8 [==========>...................] - ETA: 0s - loss: 0.00295/8 [=================>............] - ETA: 0s - loss: 0.00307/8 [=========================>....] - ETA: 0s - loss: 0.00398/8 [==============================] - 0s 30ms/step - loss: 0.0042
1/8 [==>...........................] - ETA: 0s - loss: 0.00613/8 [==========>...................] - ETA: 0s - loss: 0.00745/8 [=================>............] - ETA: 0s - loss: 0.00747/8 [=========================>....] - ETA: 0s - loss: 0.00798/8 [==============================] - 0s 25ms/step - loss: 0.0082
1/8 [==>...........................] - ETA: 0s - loss: 0.00624/8 [==============>...............] - ETA: 0s - loss: 0.00656/8 [=====================>........] - ETA: 0s - loss: 0.00678/8 [==============================] - ETA: 0s - loss: 0.00678/8 [==============================] - 0s 23ms/step - loss: 0.0067
1/8 [==>...........................] - ETA: 0s - loss: 0.00713/8 [==========>...................] - ETA: 0s - loss: 0.00915/8 [=================>............] - ETA: 0s - loss: 0.00817/8 [=========================>....] - ETA: 0s - loss: 0.00818/8 [==============================] - 0s 30ms/step - loss: 0.0082
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.00517679862678051:
Train Score: 0.00330 MSE 0.05745 RMSE
Test Score: 0.00269 MSE 0.05183 RMSE
Deviation Min [2.16890368e-05], Max [0.29481814]
Deviation 99.5th pctile [0.12670288]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1651,    5]))
Confusion matrix 
[[1645    6]
 [   2    3]]
precision 0.33333, recall 0.60000, f1 0.42857
Time to train: 526811 ms
Saving model models/A4Benchmark/A4Benchmark-TS11.csv.h5
Total Time to proces all the selected files : 529544 ms
A4Benchmark : Avg precision 0.33333 recall 0.60000 f1 0.42857 time to train 526811.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS11.csv  --epochs 20 --n_iter 3 --patience 3 :: took 536 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS12.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 03:05:24 PM MST
2020-11-30 15:05:31.236229: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 15:05:31.255224: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 15:05:31.256573: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56198764c0b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 15:05:31.256619: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 15:05:31.256803: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS12.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00443/8 [==========>...................] - ETA: 0s - loss: 0.00485/8 [=================>............] - ETA: 0s - loss: 0.00477/8 [=========================>....] - ETA: 0s - loss: 0.00468/8 [==============================] - 0s 24ms/step - loss: 0.0047
1/8 [==>...........................] - ETA: 0s - loss: 0.00343/8 [==========>...................] - ETA: 0s - loss: 0.00425/8 [=================>............] - ETA: 0s - loss: 0.00447/8 [=========================>....] - ETA: 0s - loss: 0.00348/8 [==============================] - 0s 22ms/step - loss: 0.0032
1/8 [==>...........................] - ETA: 0s - loss: 4.1002e-043/8 [==========>...................] - ETA: 0s - loss: 4.1726e-045/8 [=================>............] - ETA: 0s - loss: 4.5615e-047/8 [=========================>....] - ETA: 0s - loss: 4.3072e-048/8 [==============================] - 0s 24ms/step - loss: 4.3791e-04
1/8 [==>...........................] - ETA: 0s - loss: 2.2251e-043/8 [==========>...................] - ETA: 0s - loss: 3.0577e-045/8 [=================>............] - ETA: 0s - loss: 3.2436e-047/8 [=========================>....] - ETA: 0s - loss: 3.5923e-048/8 [==============================] - 0s 24ms/step - loss: 3.8742e-04
1/8 [==>...........................] - ETA: 0s - loss: 8.1876e-043/8 [==========>...................] - ETA: 0s - loss: 9.1337e-045/8 [=================>............] - ETA: 0s - loss: 0.0013    7/8 [=========================>....] - ETA: 0s - loss: 0.00178/8 [==============================] - 0s 29ms/step - loss: 0.0018
1/8 [==>...........................] - ETA: 0s - loss: 0.00305/8 [=================>............] - ETA: 0s - loss: 0.00378/8 [==============================] - 0s 13ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.00305/8 [=================>............] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 13ms/step - loss: 0.0031
1/8 [==>...........................] - ETA: 0s - loss: 4.2193e-046/8 [=====================>........] - ETA: 0s - loss: 3.2501e-048/8 [==============================] - 0s 10ms/step - loss: 3.1349e-04
1/8 [==>...........................] - ETA: 0s - loss: 2.7491e-045/8 [=================>............] - ETA: 0s - loss: 4.0348e-048/8 [==============================] - 0s 13ms/step - loss: 4.9966e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00208/8 [==============================] - ETA: 0s - loss: 0.00258/8 [==============================] - 0s 16ms/step - loss: 0.0025
1/8 [==>...........................] - ETA: 0s - loss: 0.00355/8 [=================>............] - ETA: 0s - loss: 0.00398/8 [==============================] - ETA: 0s - loss: 0.00398/8 [==============================] - 0s 16ms/step - loss: 0.0039
1/8 [==>...........................] - ETA: 0s - loss: 0.00314/8 [==============>...............] - ETA: 0s - loss: 0.00377/8 [=========================>....] - ETA: 0s - loss: 0.00318/8 [==============================] - 0s 17ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 2.0588e-044/8 [==============>...............] - ETA: 0s - loss: 2.2485e-047/8 [=========================>....] - ETA: 0s - loss: 2.4776e-048/8 [==============================] - 0s 17ms/step - loss: 2.6382e-04
1/8 [==>...........................] - ETA: 0s - loss: 2.0031e-045/8 [=================>............] - ETA: 0s - loss: 2.8810e-048/8 [==============================] - 0s 12ms/step - loss: 3.3890e-04
1/8 [==>...........................] - ETA: 0s - loss: 4.2481e-044/8 [==============>...............] - ETA: 0s - loss: 5.5977e-047/8 [=========================>....] - ETA: 0s - loss: 9.9149e-048/8 [==============================] - 0s 17ms/step - loss: 0.0011
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0016835342103149742:
Train Score: 0.00231 MSE 0.04802 RMSE
Test Score: 0.01634 MSE 0.12785 RMSE
Deviation Min [8.0412304e-05], Max [0.28553643]
Deviation 99.5th pctile [0.25101617]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1651,    5]))
Confusion matrix 
[[1643    8]
 [   4    1]]
precision 0.11111, recall 0.20000, f1 0.14286
Time to train: 248616 ms
Saving model models/A4Benchmark/A4Benchmark-TS12.csv.h5
Total Time to proces all the selected files : 250951 ms
A4Benchmark : Avg precision 0.11111 recall 0.20000 f1 0.14286 time to train 248616.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS12.csv  --epochs 20 --n_iter 3 --patience 3 :: took 258 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS13.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 03:09:47 PM MST
2020-11-30 15:09:55.862056: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 15:09:55.880226: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 15:09:55.881768: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55cbea26ad30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 15:09:55.881817: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 15:09:55.882014: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS13.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00573/8 [==========>...................] - ETA: 0s - loss: 0.00675/8 [=================>............] - ETA: 0s - loss: 0.00747/8 [=========================>....] - ETA: 0s - loss: 0.00728/8 [==============================] - 0s 25ms/step - loss: 0.0073
1/8 [==>...........................] - ETA: 0s - loss: 0.00613/8 [==========>...................] - ETA: 0s - loss: 0.00745/8 [=================>............] - ETA: 0s - loss: 0.00747/8 [=========================>....] - ETA: 0s - loss: 0.00758/8 [==============================] - 0s 29ms/step - loss: 0.0078
1/8 [==>...........................] - ETA: 0s - loss: 0.00623/8 [==========>...................] - ETA: 0s - loss: 0.00835/8 [=================>............] - ETA: 0s - loss: 0.00817/8 [=========================>....] - ETA: 0s - loss: 0.00788/8 [==============================] - 0s 28ms/step - loss: 0.0077
1/8 [==>...........................] - ETA: 0s - loss: 0.00473/8 [==========>...................] - ETA: 0s - loss: 0.00535/8 [=================>............] - ETA: 0s - loss: 0.00527/8 [=========================>....] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 32ms/step - loss: 0.0058
1/8 [==>...........................] - ETA: 0s - loss: 0.01093/8 [==========>...................] - ETA: 0s - loss: 0.01395/8 [=================>............] - ETA: 0s - loss: 0.01477/8 [=========================>....] - ETA: 0s - loss: 0.01788/8 [==============================] - 0s 30ms/step - loss: 0.0186
1/8 [==>...........................] - ETA: 0s - loss: 0.00585/8 [=================>............] - ETA: 0s - loss: 0.00738/8 [==============================] - 0s 13ms/step - loss: 0.0071
1/8 [==>...........................] - ETA: 0s - loss: 4.6505e-044/8 [==============>...............] - ETA: 0s - loss: 0.0012    7/8 [=========================>....] - ETA: 0s - loss: 0.00128/8 [==============================] - 0s 19ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 0.00564/8 [==============>...............] - ETA: 0s - loss: 0.00797/8 [=========================>....] - ETA: 0s - loss: 0.00798/8 [==============================] - 0s 16ms/step - loss: 0.0079
1/8 [==>...........................] - ETA: 0s - loss: 0.00105/8 [=================>............] - ETA: 0s - loss: 9.2050e-048/8 [==============================] - 0s 14ms/step - loss: 8.5344e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.01355/8 [=================>............] - ETA: 0s - loss: 0.01818/8 [==============================] - 0s 14ms/step - loss: 0.0218
1/8 [==>...........................] - ETA: 0s - loss: 0.00773/8 [==========>...................] - ETA: 0s - loss: 0.00865/8 [=================>............] - ETA: 0s - loss: 0.00967/8 [=========================>....] - ETA: 0s - loss: 0.00908/8 [==============================] - 0s 29ms/step - loss: 0.0091
1/8 [==>...........................] - ETA: 0s - loss: 7.4707e-043/8 [==========>...................] - ETA: 0s - loss: 0.0013    5/8 [=================>............] - ETA: 0s - loss: 9.4918e-047/8 [=========================>....] - ETA: 0s - loss: 0.0011    8/8 [==============================] - 0s 40ms/step - loss: 0.0013
1/8 [==>...........................] - ETA: 0s - loss: 0.00653/8 [==========>...................] - ETA: 0s - loss: 0.00885/8 [=================>............] - ETA: 0s - loss: 0.00847/8 [=========================>....] - ETA: 0s - loss: 0.00838/8 [==============================] - 0s 27ms/step - loss: 0.0082
1/8 [==>...........................] - ETA: 0s - loss: 0.00323/8 [==========>...................] - ETA: 0s - loss: 0.00385/8 [=================>............] - ETA: 0s - loss: 0.00377/8 [=========================>....] - ETA: 0s - loss: 0.00398/8 [==============================] - 0s 27ms/step - loss: 0.0040
1/8 [==>...........................] - ETA: 0s - loss: 0.00103/8 [==========>...................] - ETA: 0s - loss: 0.00115/8 [=================>............] - ETA: 0s - loss: 0.00167/8 [=========================>....] - ETA: 0s - loss: 0.00288/8 [==============================] - 0s 27ms/step - loss: 0.0034
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.005190218333154917:
Train Score: 0.00168 MSE 0.04103 RMSE
Test Score: 0.00468 MSE 0.06842 RMSE
Deviation Min [4.21651025e-06], Max [0.33949172]
Deviation 99.5th pctile [0.22060012]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1643,   13]))
Confusion matrix 
[[1641    2]
 [   6    7]]
precision 0.77778, recall 0.53846, f1 0.63636
Time to train: 472998 ms
Saving model models/A4Benchmark/A4Benchmark-TS13.csv.h5
Total Time to proces all the selected files : 477927 ms
A4Benchmark : Avg precision 0.77778 recall 0.53846 f1 0.63636 time to train 472998.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS13.csv  --epochs 20 --n_iter 3 --patience 3 :: took 487 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS14.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 03:17:59 PM MST
2020-11-30 15:18:05.436212: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 15:18:05.454128: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 15:18:05.455546: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5610bc64fc00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 15:18:05.455594: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 15:18:05.455759: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS14.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00373/8 [==========>...................] - ETA: 0s - loss: 0.00465/8 [=================>............] - ETA: 0s - loss: 0.00487/8 [=========================>....] - ETA: 0s - loss: 0.00468/8 [==============================] - 0s 32ms/step - loss: 0.0047
1/8 [==>...........................] - ETA: 0s - loss: 0.00503/8 [==========>...................] - ETA: 0s - loss: 0.00605/8 [=================>............] - ETA: 0s - loss: 0.00557/8 [=========================>....] - ETA: 0s - loss: 0.00438/8 [==============================] - 0s 25ms/step - loss: 0.0040
1/8 [==>...........................] - ETA: 0s - loss: 0.00133/8 [==========>...................] - ETA: 0s - loss: 0.00145/8 [=================>............] - ETA: 0s - loss: 0.00137/8 [=========================>....] - ETA: 0s - loss: 0.00148/8 [==============================] - 0s 35ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 5.2123e-043/8 [==========>...................] - ETA: 0s - loss: 0.0083    5/8 [=================>............] - ETA: 0s - loss: 0.01287/8 [=========================>....] - ETA: 0s - loss: 0.01488/8 [==============================] - 0s 26ms/step - loss: 0.0155
1/8 [==>...........................] - ETA: 0s - loss: 0.00634/8 [==============>...............] - ETA: 0s - loss: 0.00876/8 [=====================>........] - ETA: 0s - loss: 0.00888/8 [==============================] - ETA: 0s - loss: 0.00878/8 [==============================] - 0s 25ms/step - loss: 0.0087
1/8 [==>...........................] - ETA: 0s - loss: 0.00373/8 [==========>...................] - ETA: 0s - loss: 0.00465/8 [=================>............] - ETA: 0s - loss: 0.00477/8 [=========================>....] - ETA: 0s - loss: 0.00468/8 [==============================] - 0s 24ms/step - loss: 0.0047
1/8 [==>...........................] - ETA: 0s - loss: 0.00493/8 [==========>...................] - ETA: 0s - loss: 0.00585/8 [=================>............] - ETA: 0s - loss: 0.00557/8 [=========================>....] - ETA: 0s - loss: 0.00438/8 [==============================] - 0s 24ms/step - loss: 0.0041
1/8 [==>...........................] - ETA: 0s - loss: 3.0593e-043/8 [==========>...................] - ETA: 0s - loss: 3.5269e-045/8 [=================>............] - ETA: 0s - loss: 3.1902e-047/8 [=========================>....] - ETA: 0s - loss: 3.2390e-048/8 [==============================] - 0s 28ms/step - loss: 3.3404e-04
1/8 [==>...........................] - ETA: 0s - loss: 5.8776e-043/8 [==========>...................] - ETA: 0s - loss: 0.0083    5/8 [=================>............] - ETA: 0s - loss: 0.01297/8 [=========================>....] - ETA: 0s - loss: 0.01498/8 [==============================] - 0s 27ms/step - loss: 0.0156
1/8 [==>...........................] - ETA: 0s - loss: 0.01453/8 [==========>...................] - ETA: 0s - loss: 0.02345/8 [=================>............] - ETA: 0s - loss: 0.02047/8 [=========================>....] - ETA: 0s - loss: 0.01998/8 [==============================] - 0s 28ms/step - loss: 0.0199
1/8 [==>...........................] - ETA: 0s - loss: 0.00324/8 [==============>...............] - ETA: 0s - loss: 0.00377/8 [=========================>....] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 20ms/step - loss: 0.0039
1/8 [==>...........................] - ETA: 0s - loss: 0.00444/8 [==============>...............] - ETA: 0s - loss: 0.00488/8 [==============================] - ETA: 0s - loss: 0.00358/8 [==============================] - 0s 14ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 3.3819e-044/8 [==============>...............] - ETA: 0s - loss: 3.5299e-047/8 [=========================>....] - ETA: 0s - loss: 3.4498e-048/8 [==============================] - 0s 18ms/step - loss: 3.5461e-04
1/8 [==>...........................] - ETA: 0s - loss: 3.3720e-044/8 [==============>...............] - ETA: 0s - loss: 0.0085    6/8 [=====================>........] - ETA: 0s - loss: 0.01268/8 [==============================] - 0s 20ms/step - loss: 0.0132
1/8 [==>...........................] - ETA: 0s - loss: 0.01205/8 [=================>............] - ETA: 0s - loss: 0.01738/8 [==============================] - 0s 14ms/step - loss: 0.0170
Best parameters {'n_units': 72, 'n_hidden': 2} best score 0.006865149177610874:
Train Score: 0.00862 MSE 0.09283 RMSE
Test Score: 0.01679 MSE 0.12957 RMSE
Deviation Min [6.50599012e-05], Max [0.6772849]
Deviation 99.5th pctile [0.28308773]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1645,   11]))
Confusion matrix 
[[1642    3]
 [   5    6]]
precision 0.66667, recall 0.54545, f1 0.60000
Time to train: 334100 ms
Saving model models/A4Benchmark/A4Benchmark-TS14.csv.h5
Total Time to proces all the selected files : 338727 ms
A4Benchmark : Avg precision 0.66667 recall 0.54545 f1 0.60000 time to train 334100.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS14.csv  --epochs 20 --n_iter 3 --patience 3 :: took 345 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS15.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 03:23:49 PM MST
2020-11-30 15:23:55.896377: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 15:23:55.916216: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 15:23:55.917350: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55961676d8e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 15:23:55.917406: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 15:23:55.917611: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS15.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.01164/8 [==============>...............] - ETA: 0s - loss: 0.01207/8 [=========================>....] - ETA: 0s - loss: 0.01228/8 [==============================] - 0s 18ms/step - loss: 0.0122
1/8 [==>...........................] - ETA: 0s - loss: 0.00344/8 [==============>...............] - ETA: 0s - loss: 0.00538/8 [==============================] - ETA: 0s - loss: 0.00668/8 [==============================] - 0s 15ms/step - loss: 0.0066
1/8 [==>...........................] - ETA: 0s - loss: 0.00774/8 [==============>...............] - ETA: 0s - loss: 0.00838/8 [==============================] - ETA: 0s - loss: 0.01028/8 [==============================] - 0s 15ms/step - loss: 0.0102
1/8 [==>...........................] - ETA: 0s - loss: 0.00215/8 [=================>............] - ETA: 0s - loss: 0.00398/8 [==============================] - 0s 13ms/step - loss: 0.0038
1/8 [==>...........................] - ETA: 0s - loss: 0.01205/8 [=================>............] - ETA: 0s - loss: 0.00538/8 [==============================] - ETA: 0s - loss: 0.00478/8 [==============================] - 0s 15ms/step - loss: 0.0047
1/8 [==>...........................] - ETA: 0s - loss: 0.00614/8 [==============>...............] - ETA: 0s - loss: 0.00627/8 [=========================>....] - ETA: 0s - loss: 0.00608/8 [==============================] - 0s 15ms/step - loss: 0.0059
1/8 [==>...........................] - ETA: 0s - loss: 0.00414/8 [==============>...............] - ETA: 0s - loss: 0.00607/8 [=========================>....] - ETA: 0s - loss: 0.00738/8 [==============================] - 0s 16ms/step - loss: 0.0071
1/8 [==>...........................] - ETA: 0s - loss: 0.00585/8 [=================>............] - ETA: 0s - loss: 0.00678/8 [==============================] - 0s 13ms/step - loss: 0.0070
1/8 [==>...........................] - ETA: 0s - loss: 0.00315/8 [=================>............] - ETA: 0s - loss: 0.00438/8 [==============================] - 0s 13ms/step - loss: 0.0043
1/8 [==>...........................] - ETA: 0s - loss: 0.01045/8 [=================>............] - ETA: 0s - loss: 0.00478/8 [==============================] - 0s 12ms/step - loss: 0.0041
1/8 [==>...........................] - ETA: 0s - loss: 0.00353/8 [==========>...................] - ETA: 0s - loss: 0.00525/8 [=================>............] - ETA: 0s - loss: 0.00527/8 [=========================>....] - ETA: 0s - loss: 0.00498/8 [==============================] - 0s 25ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00343/8 [==========>...................] - ETA: 0s - loss: 0.00575/8 [=================>............] - ETA: 0s - loss: 0.00647/8 [=========================>....] - ETA: 0s - loss: 0.02048/8 [==============================] - 0s 25ms/step - loss: 0.0195
1/8 [==>...........................] - ETA: 0s - loss: 0.00553/8 [==========>...................] - ETA: 0s - loss: 0.00784/8 [==============>...............] - ETA: 0s - loss: 0.00766/8 [=====================>........] - ETA: 0s - loss: 0.00718/8 [==============================] - ETA: 0s - loss: 0.00728/8 [==============================] - 0s 32ms/step - loss: 0.0072
1/8 [==>...........................] - ETA: 0s - loss: 0.00344/8 [==============>...............] - ETA: 0s - loss: 0.00596/8 [=====================>........] - ETA: 0s - loss: 0.00588/8 [==============================] - ETA: 0s - loss: 0.00588/8 [==============================] - 0s 25ms/step - loss: 0.0058
1/8 [==>...........................] - ETA: 0s - loss: 0.01053/8 [==========>...................] - ETA: 0s - loss: 0.00685/8 [=================>............] - ETA: 0s - loss: 0.00597/8 [=========================>....] - ETA: 0s - loss: 0.00528/8 [==============================] - 0s 25ms/step - loss: 0.0051
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.005679115653038025:
Train Score: 0.00423 MSE 0.06501 RMSE
Test Score: 0.00529 MSE 0.07274 RMSE
Deviation Min [3.40825823e-05], Max [0.40736946]
Deviation 99.5th pctile [0.26258131]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Confusion matrix 
[[1647    0]
 [   0    9]]
precision 1.00000, recall 1.00000, f1 1.00000
Time to train: 603313 ms
Saving model models/A4Benchmark/A4Benchmark-TS15.csv.h5
Total Time to proces all the selected files : 605906 ms
A4Benchmark : Avg precision 1.00000 recall 1.00000 f1 1.00000 time to train 603313.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS15.csv  --epochs 20 --n_iter 3 --patience 3 :: took 613 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS16.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 03:34:07 PM MST
2020-11-30 15:34:14.342518: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 15:34:14.361260: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 15:34:14.362738: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x563fb5de3d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 15:34:14.362792: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 15:34:14.363006: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS16.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00423/8 [==========>...................] - ETA: 0s - loss: 0.00295/8 [=================>............] - ETA: 0s - loss: 0.00287/8 [=========================>....] - ETA: 0s - loss: 0.00338/8 [==============================] - 0s 39ms/step - loss: 0.0032
1/8 [==>...........................] - ETA: 0s - loss: 0.01183/8 [==========>...................] - ETA: 0s - loss: 0.00605/8 [=================>............] - ETA: 0s - loss: 0.00677/8 [=========================>....] - ETA: 0s - loss: 0.00588/8 [==============================] - 0s 36ms/step - loss: 0.0056
1/8 [==>...........................] - ETA: 0s - loss: 0.00233/8 [==========>...................] - ETA: 0s - loss: 0.00465/8 [=================>............] - ETA: 0s - loss: 0.00437/8 [=========================>....] - ETA: 0s - loss: 0.00458/8 [==============================] - 0s 27ms/step - loss: 0.0046
1/8 [==>...........................] - ETA: 0s - loss: 0.00443/8 [==========>...................] - ETA: 0s - loss: 0.00325/8 [=================>............] - ETA: 0s - loss: 0.00417/8 [=========================>....] - ETA: 0s - loss: 0.00428/8 [==============================] - 0s 27ms/step - loss: 0.0041
1/8 [==>...........................] - ETA: 0s - loss: 0.04653/8 [==========>...................] - ETA: 0s - loss: 0.05515/8 [=================>............] - ETA: 0s - loss: 0.05267/8 [=========================>....] - ETA: 0s - loss: 0.05238/8 [==============================] - 0s 30ms/step - loss: 0.0530
1/8 [==>...........................] - ETA: 0s - loss: 0.00235/8 [=================>............] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 13ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 0.01175/8 [=================>............] - ETA: 0s - loss: 0.00598/8 [==============================] - 0s 13ms/step - loss: 0.0051
1/8 [==>...........................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 13ms/step - loss: 0.0024
1/8 [==>...........................] - ETA: 0s - loss: 0.00224/8 [==============>...............] - ETA: 0s - loss: 0.00467/8 [=========================>....] - ETA: 0s - loss: 0.00408/8 [==============================] - 0s 18ms/step - loss: 0.0042
1/8 [==>...........................] - ETA: 0s - loss: 0.00885/8 [=================>............] - ETA: 0s - loss: 0.00658/8 [==============================] - 0s 12ms/step - loss: 0.0071
1/8 [==>...........................] - ETA: 0s - loss: 0.01523/8 [==========>...................] - ETA: 0s - loss: 0.01875/8 [=================>............] - ETA: 0s - loss: 0.02307/8 [=========================>....] - ETA: 0s - loss: 0.02738/8 [==============================] - 0s 24ms/step - loss: 0.0294
1/8 [==>...........................] - ETA: 0s - loss: 0.01193/8 [==========>...................] - ETA: 0s - loss: 0.00625/8 [=================>............] - ETA: 0s - loss: 0.00617/8 [=========================>....] - ETA: 0s - loss: 0.00548/8 [==============================] - 0s 31ms/step - loss: 0.0052
1/8 [==>...........................] - ETA: 0s - loss: 0.00593/8 [==========>...................] - ETA: 0s - loss: 0.00525/8 [=================>............] - ETA: 0s - loss: 0.00667/8 [=========================>....] - ETA: 0s - loss: 0.00688/8 [==============================] - 0s 31ms/step - loss: 0.0066
1/8 [==>...........................] - ETA: 0s - loss: 0.00243/8 [==========>...................] - ETA: 0s - loss: 0.00535/8 [=================>............] - ETA: 0s - loss: 0.00486/8 [=====================>........] - ETA: 0s - loss: 0.00448/8 [==============================] - ETA: 0s - loss: 0.00478/8 [==============================] - 0s 34ms/step - loss: 0.0047
1/8 [==>...........................] - ETA: 0s - loss: 0.00533/8 [==========>...................] - ETA: 0s - loss: 0.00495/8 [=================>............] - ETA: 0s - loss: 0.00457/8 [=========================>....] - ETA: 0s - loss: 0.00458/8 [==============================] - 0s 26ms/step - loss: 0.0045
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0040632298216223715:
Train Score: 0.00141 MSE 0.03757 RMSE
Test Score: 0.00137 MSE 0.03707 RMSE
Deviation Min [2.51806898e-05], Max [0.50470582]
Deviation 99.5th pctile [0.09482099]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1655,    1]))
Confusion matrix 
[[1647    8]
 [   0    1]]
precision 0.11111, recall 1.00000, f1 0.20000
Time to train: 648640 ms
Saving model models/A4Benchmark/A4Benchmark-TS16.csv.h5
Total Time to proces all the selected files : 650884 ms
A4Benchmark : Avg precision 0.11111 recall 1.00000 f1 0.20000 time to train 648640.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS16.csv  --epochs 20 --n_iter 3 --patience 3 :: took 658 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS17.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 03:45:10 PM MST
2020-11-30 15:45:17.831358: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 15:45:17.850220: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 15:45:17.851419: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d8d963ac00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 15:45:17.851463: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 15:45:17.851633: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS17.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.01753/8 [==========>...................] - ETA: 0s - loss: 0.02325/8 [=================>............] - ETA: 0s - loss: 0.02267/8 [=========================>....] - ETA: 0s - loss: 0.02268/8 [==============================] - 0s 30ms/step - loss: 0.0231
1/8 [==>...........................] - ETA: 0s - loss: 0.02012/8 [======>.......................] - ETA: 0s - loss: 0.02174/8 [==============>...............] - ETA: 0s - loss: 0.02396/8 [=====================>........] - ETA: 0s - loss: 0.02528/8 [==============================] - ETA: 0s - loss: 0.02478/8 [==============================] - 0s 33ms/step - loss: 0.0247
1/8 [==>...........................] - ETA: 0s - loss: 0.00233/8 [==========>...................] - ETA: 0s - loss: 0.00395/8 [=================>............] - ETA: 0s - loss: 0.00297/8 [=========================>....] - ETA: 0s - loss: 0.00288/8 [==============================] - 0s 29ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00443/8 [==========>...................] - ETA: 0s - loss: 0.00335/8 [=================>............] - ETA: 0s - loss: 0.00387/8 [=========================>....] - ETA: 0s - loss: 0.00378/8 [==============================] - 0s 36ms/step - loss: 0.0038
1/8 [==>...........................] - ETA: 0s - loss: 0.00813/8 [==========>...................] - ETA: 0s - loss: 0.01065/8 [=================>............] - ETA: 0s - loss: 0.01007/8 [=========================>....] - ETA: 0s - loss: 0.00998/8 [==============================] - 0s 36ms/step - loss: 0.0099
1/8 [==>...........................] - ETA: 0s - loss: 0.00385/8 [=================>............] - ETA: 0s - loss: 0.00458/8 [==============================] - 0s 12ms/step - loss: 0.0047
1/8 [==>...........................] - ETA: 0s - loss: 0.00635/8 [=================>............] - ETA: 0s - loss: 0.00378/8 [==============================] - 0s 13ms/step - loss: 0.0032
1/8 [==>...........................] - ETA: 0s - loss: 0.00255/8 [=================>............] - ETA: 0s - loss: 0.00328/8 [==============================] - 0s 14ms/step - loss: 0.0031
1/8 [==>...........................] - ETA: 0s - loss: 6.0281e-045/8 [=================>............] - ETA: 0s - loss: 5.4765e-048/8 [==============================] - 0s 13ms/step - loss: 7.0648e-04
1/8 [==>...........................] - ETA: 0s - loss: 6.1740e-045/8 [=================>............] - ETA: 0s - loss: 3.2614e-048/8 [==============================] - 0s 12ms/step - loss: 5.5030e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00154/8 [==============>...............] - ETA: 0s - loss: 0.00247/8 [=========================>....] - ETA: 0s - loss: 0.00278/8 [==============================] - 0s 19ms/step - loss: 0.0026
1/8 [==>...........................] - ETA: 0s - loss: 0.00504/8 [==============>...............] - ETA: 0s - loss: 0.00417/8 [=========================>....] - ETA: 0s - loss: 0.00308/8 [==============================] - 0s 19ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00234/8 [==============>...............] - ETA: 0s - loss: 0.00408/8 [==============================] - ETA: 0s - loss: 0.00358/8 [==============================] - 0s 16ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.00325/8 [=================>............] - ETA: 0s - loss: 0.00248/8 [==============================] - 0s 12ms/step - loss: 0.0025
1/8 [==>...........................] - ETA: 0s - loss: 3.8579e-044/8 [==============>...............] - ETA: 0s - loss: 9.4238e-047/8 [=========================>....] - ETA: 0s - loss: 9.3653e-048/8 [==============================] - 0s 19ms/step - loss: 9.8820e-04
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0024395537562668323:
Train Score: 0.00131 MSE 0.03616 RMSE
Test Score: 0.00067 MSE 0.02584 RMSE
Deviation Min [8.0728435e-06], Max [0.39993117]
Deviation 99.5th pctile [0.18979882]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Confusion matrix 
[[1647    0]
 [   0    9]]
precision 1.00000, recall 1.00000, f1 1.00000
Time to train: 542080 ms
Saving model models/A4Benchmark/A4Benchmark-TS17.csv.h5
Total Time to proces all the selected files : 544549 ms
A4Benchmark : Avg precision 1.00000 recall 1.00000 f1 1.00000 time to train 542080.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS17.csv  --epochs 20 --n_iter 3 --patience 3 :: took 552 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS18.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 03:54:27 PM MST
2020-11-30 15:54:34.122124: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 15:54:34.140143: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 15:54:34.141511: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x555d5a78ec00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 15:54:34.141555: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 15:54:34.141731: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS18.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.01453/8 [==========>...................] - ETA: 0s - loss: 0.01535/8 [=================>............] - ETA: 0s - loss: 0.01487/8 [=========================>....] - ETA: 0s - loss: 0.01508/8 [==============================] - 0s 37ms/step - loss: 0.0154
1/8 [==>...........................] - ETA: 0s - loss: 0.00913/8 [==========>...................] - ETA: 0s - loss: 0.00695/8 [=================>............] - ETA: 0s - loss: 0.00627/8 [=========================>....] - ETA: 0s - loss: 0.00588/8 [==============================] - 0s 35ms/step - loss: 0.0058
1/8 [==>...........................] - ETA: 0s - loss: 0.00503/8 [==========>...................] - ETA: 0s - loss: 0.00535/8 [=================>............] - ETA: 0s - loss: 0.00547/8 [=========================>....] - ETA: 0s - loss: 0.00528/8 [==============================] - 0s 27ms/step - loss: 0.0053
1/8 [==>...........................] - ETA: 0s - loss: 0.00413/8 [==========>...................] - ETA: 0s - loss: 0.00515/8 [=================>............] - ETA: 0s - loss: 0.00507/8 [=========================>....] - ETA: 0s - loss: 0.00458/8 [==============================] - 0s 28ms/step - loss: 0.0045
1/8 [==>...........................] - ETA: 0s - loss: 0.00212/8 [======>.......................] - ETA: 0s - loss: 0.00224/8 [==============>...............] - ETA: 0s - loss: 0.00226/8 [=====================>........] - ETA: 0s - loss: 0.00268/8 [==============================] - ETA: 0s - loss: 0.00288/8 [==============================] - 0s 31ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 0.01174/8 [==============>...............] - ETA: 0s - loss: 0.01197/8 [=========================>....] - ETA: 0s - loss: 0.01248/8 [==============================] - 0s 20ms/step - loss: 0.0127
1/8 [==>...........................] - ETA: 0s - loss: 0.00365/8 [=================>............] - ETA: 0s - loss: 0.00308/8 [==============================] - 0s 14ms/step - loss: 0.0027
1/8 [==>...........................] - ETA: 0s - loss: 0.00275/8 [=================>............] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 14ms/step - loss: 0.0025
1/8 [==>...........................] - ETA: 0s - loss: 9.0759e-045/8 [=================>............] - ETA: 0s - loss: 0.0012    8/8 [==============================] - 0s 13ms/step - loss: 0.0010
1/8 [==>...........................] - ETA: 0s - loss: 0.00244/8 [==============>...............] - ETA: 0s - loss: 0.00197/8 [=========================>....] - ETA: 0s - loss: 0.00308/8 [==============================] - 0s 19ms/step - loss: 0.0031
1/8 [==>...........................] - ETA: 0s - loss: 0.01453/8 [==========>...................] - ETA: 0s - loss: 0.01525/8 [=================>............] - ETA: 0s - loss: 0.01487/8 [=========================>....] - ETA: 0s - loss: 0.01508/8 [==============================] - 0s 29ms/step - loss: 0.0154
1/8 [==>...........................] - ETA: 0s - loss: 0.00903/8 [==========>...................] - ETA: 0s - loss: 0.00695/8 [=================>............] - ETA: 0s - loss: 0.00627/8 [=========================>....] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 24ms/step - loss: 0.0058
1/8 [==>...........................] - ETA: 0s - loss: 0.00482/8 [======>.......................] - ETA: 0s - loss: 0.00524/8 [==============>...............] - ETA: 0s - loss: 0.00506/8 [=====================>........] - ETA: 0s - loss: 0.00538/8 [==============================] - ETA: 0s - loss: 0.00538/8 [==============================] - 0s 37ms/step - loss: 0.0053
1/8 [==>...........................] - ETA: 0s - loss: 0.00203/8 [==========>...................] - ETA: 0s - loss: 0.00145/8 [=================>............] - ETA: 0s - loss: 0.00207/8 [=========================>....] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 27ms/step - loss: 0.0017
1/8 [==>...........................] - ETA: 0s - loss: 0.00253/8 [==========>...................] - ETA: 0s - loss: 0.00245/8 [=================>............] - ETA: 0s - loss: 0.00297/8 [=========================>....] - ETA: 0s - loss: 0.00358/8 [==============================] - 0s 31ms/step - loss: 0.0036
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.004389041592366994:
Train Score: 0.00203 MSE 0.04503 RMSE
Test Score: 0.01203 MSE 0.10970 RMSE
Deviation Min [5.02361705e-06], Max [0.28520644]
Deviation 99.5th pctile [0.23115314]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1655,    1]))
Confusion matrix 
[[1646    9]
 [   1    0]]
precision 0.00000, recall 0.00000, f1 0.00000
Time to train: 447332 ms
Saving model models/A4Benchmark/A4Benchmark-TS18.csv.h5
Total Time to proces all the selected files : 449973 ms
A4Benchmark : Avg precision 0.00000 recall 0.00000 f1 0.00000 time to train 447332.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS18.csv  --epochs 20 --n_iter 3 --patience 3 :: took 457 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS19.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 04:02:09 PM MST
2020-11-30 16:02:16.221355: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 16:02:16.240264: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 16:02:16.241788: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5568bc98b310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 16:02:16.241838: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 16:02:16.242034: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS19.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00544/8 [==============>...............] - ETA: 0s - loss: 0.00657/8 [=========================>....] - ETA: 0s - loss: 0.00678/8 [==============================] - 0s 18ms/step - loss: 0.0071
1/8 [==>...........................] - ETA: 0s - loss: 0.00544/8 [==============>...............] - ETA: 0s - loss: 0.00607/8 [=========================>....] - ETA: 0s - loss: 0.00478/8 [==============================] - 0s 18ms/step - loss: 0.0047
1/8 [==>...........................] - ETA: 0s - loss: 8.2828e-045/8 [=================>............] - ETA: 0s - loss: 6.8281e-048/8 [==============================] - 0s 14ms/step - loss: 7.9746e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.01044/8 [==============>...............] - ETA: 0s - loss: 0.01017/8 [=========================>....] - ETA: 0s - loss: 0.01188/8 [==============================] - 0s 17ms/step - loss: 0.0119
1/8 [==>...........................] - ETA: 0s - loss: 0.01614/8 [==============>...............] - ETA: 0s - loss: 0.02477/8 [=========================>....] - ETA: 0s - loss: 0.02448/8 [==============================] - 0s 20ms/step - loss: 0.0246
1/8 [==>...........................] - ETA: 0s - loss: 0.00554/8 [==============>...............] - ETA: 0s - loss: 0.00657/8 [=========================>....] - ETA: 0s - loss: 0.00648/8 [==============================] - 0s 17ms/step - loss: 0.0066
1/8 [==>...........................] - ETA: 0s - loss: 0.00634/8 [==============>...............] - ETA: 0s - loss: 0.00718/8 [==============================] - ETA: 0s - loss: 0.00588/8 [==============================] - 0s 14ms/step - loss: 0.0058
1/8 [==>...........................] - ETA: 0s - loss: 3.9726e-045/8 [=================>............] - ETA: 0s - loss: 5.7855e-048/8 [==============================] - 0s 13ms/step - loss: 4.6479e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00494/8 [==============>...............] - ETA: 0s - loss: 0.00496/8 [=====================>........] - ETA: 0s - loss: 0.00608/8 [==============================] - 0s 22ms/step - loss: 0.0060
1/8 [==>...........................] - ETA: 0s - loss: 0.00885/8 [=================>............] - ETA: 0s - loss: 0.01508/8 [==============================] - ETA: 0s - loss: 0.01628/8 [==============================] - 0s 14ms/step - loss: 0.0162
1/8 [==>...........................] - ETA: 0s - loss: 0.00653/8 [==========>...................] - ETA: 0s - loss: 0.00765/8 [=================>............] - ETA: 0s - loss: 0.00827/8 [=========================>....] - ETA: 0s - loss: 0.00778/8 [==============================] - 0s 35ms/step - loss: 0.0078
1/8 [==>...........................] - ETA: 0s - loss: 0.00503/8 [==========>...................] - ETA: 0s - loss: 0.00635/8 [=================>............] - ETA: 0s - loss: 0.00457/8 [=========================>....] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 35ms/step - loss: 0.0034
1/8 [==>...........................] - ETA: 0s - loss: 0.00183/8 [==========>...................] - ETA: 0s - loss: 0.00255/8 [=================>............] - ETA: 0s - loss: 0.00217/8 [=========================>....] - ETA: 0s - loss: 0.00248/8 [==============================] - 0s 33ms/step - loss: 0.0027
1/8 [==>...........................] - ETA: 0s - loss: 0.00513/8 [==========>...................] - ETA: 0s - loss: 0.00505/8 [=================>............] - ETA: 0s - loss: 0.00527/8 [=========================>....] - ETA: 0s - loss: 0.00618/8 [==============================] - 0s 34ms/step - loss: 0.0062
1/8 [==>...........................] - ETA: 0s - loss: 0.00533/8 [==========>...................] - ETA: 0s - loss: 0.01135/8 [=================>............] - ETA: 0s - loss: 0.01217/8 [=========================>....] - ETA: 0s - loss: 0.01318/8 [==============================] - 0s 37ms/step - loss: 0.0133
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.006669847946614027:
Train Score: 0.00577 MSE 0.07594 RMSE
Test Score: 0.01166 MSE 0.10799 RMSE
Deviation Min [2.74371702e-06], Max [0.34251162]
Deviation 99.5th pctile [0.23507918]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1644,   12]))
Confusion matrix 
[[1638    6]
 [   9    3]]
precision 0.33333, recall 0.25000, f1 0.28571
Time to train: 325331 ms
Saving model models/A4Benchmark/A4Benchmark-TS19.csv.h5
Total Time to proces all the selected files : 330205 ms
A4Benchmark : Avg precision 0.33333 recall 0.25000 f1 0.28571 time to train 325331.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS19.csv  --epochs 20 --n_iter 3 --patience 3 :: took 337 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS1.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 04:07:51 PM MST
2020-11-30 16:07:58.546096: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 16:07:58.564205: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 16:07:58.565625: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5612d04c8310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 16:07:58.565675: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 16:07:58.565874: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS1.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00473/8 [==========>...................] - ETA: 0s - loss: 0.00325/8 [=================>............] - ETA: 0s - loss: 0.00257/8 [=========================>....] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 33ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 6.6754e-043/8 [==========>...................] - ETA: 0s - loss: 8.1165e-045/8 [=================>............] - ETA: 0s - loss: 8.3359e-047/8 [=========================>....] - ETA: 0s - loss: 7.9651e-048/8 [==============================] - 0s 25ms/step - loss: 8.2478e-04
1/8 [==>...........................] - ETA: 0s - loss: 8.1796e-043/8 [==========>...................] - ETA: 0s - loss: 0.0020    5/8 [=================>............] - ETA: 0s - loss: 0.00387/8 [=========================>....] - ETA: 0s - loss: 0.00498/8 [==============================] - 0s 26ms/step - loss: 0.0052
1/8 [==>...........................] - ETA: 0s - loss: 0.00573/8 [==========>...................] - ETA: 0s - loss: 0.00715/8 [=================>............] - ETA: 0s - loss: 0.00567/8 [=========================>....] - ETA: 0s - loss: 0.00508/8 [==============================] - 0s 37ms/step - loss: 0.0049
1/8 [==>...........................] - ETA: 0s - loss: 0.00303/8 [==========>...................] - ETA: 0s - loss: 0.00415/8 [=================>............] - ETA: 0s - loss: 0.00377/8 [=========================>....] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 27ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.00635/8 [=================>............] - ETA: 0s - loss: 0.00428/8 [==============================] - 0s 13ms/step - loss: 0.0031
1/8 [==>...........................] - ETA: 0s - loss: 8.8525e-045/8 [=================>............] - ETA: 0s - loss: 0.0014    8/8 [==============================] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 14ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 6.5886e-045/8 [=================>............] - ETA: 0s - loss: 0.0032    8/8 [==============================] - 0s 13ms/step - loss: 0.0043
1/8 [==>...........................] - ETA: 0s - loss: 0.00534/8 [==============>...............] - ETA: 0s - loss: 0.00568/8 [==============================] - ETA: 0s - loss: 0.00448/8 [==============================] - 0s 20ms/step - loss: 0.0044
1/8 [==>...........................] - ETA: 0s - loss: 0.00225/8 [=================>............] - ETA: 0s - loss: 0.00258/8 [==============================] - 0s 14ms/step - loss: 0.0024
1/8 [==>...........................] - ETA: 0s - loss: 9.3336e-043/8 [==========>...................] - ETA: 0s - loss: 9.0027e-045/8 [=================>............] - ETA: 0s - loss: 0.0011    7/8 [=========================>....] - ETA: 0s - loss: 0.00198/8 [==============================] - 0s 27ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 6.2290e-043/8 [==========>...................] - ETA: 0s - loss: 7.5195e-045/8 [=================>............] - ETA: 0s - loss: 7.8550e-047/8 [=========================>....] - ETA: 0s - loss: 7.7522e-048/8 [==============================] - 0s 24ms/step - loss: 8.0804e-04
1/8 [==>...........................] - ETA: 0s - loss: 6.4863e-043/8 [==========>...................] - ETA: 0s - loss: 0.0016    5/8 [=================>............] - ETA: 0s - loss: 0.00386/8 [=====================>........] - ETA: 0s - loss: 0.00448/8 [==============================] - ETA: 0s - loss: 0.00518/8 [==============================] - 0s 27ms/step - loss: 0.0051
1/8 [==>...........................] - ETA: 0s - loss: 0.00563/8 [==========>...................] - ETA: 0s - loss: 0.00705/8 [=================>............] - ETA: 0s - loss: 0.00557/8 [=========================>....] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 34ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.01653/8 [==========>...................] - ETA: 0s - loss: 0.01985/8 [=================>............] - ETA: 0s - loss: 0.01927/8 [=========================>....] - ETA: 0s - loss: 0.01898/8 [==============================] - 0s 30ms/step - loss: 0.0189
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.003133130678907037:
Train Score: 0.00313 MSE 0.05595 RMSE
Test Score: 0.00336 MSE 0.05799 RMSE
Deviation Min [4.6096478e-05], Max [0.33537799]
Deviation 99.5th pctile [0.17173422]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1643,   13]))
Confusion matrix 
[[1639    4]
 [   8    5]]
precision 0.55556, recall 0.38462, f1 0.45455
Time to train: 489234 ms
Saving model models/A4Benchmark/A4Benchmark-TS1.csv.h5
Total Time to proces all the selected files : 491467 ms
A4Benchmark : Avg precision 0.55556 recall 0.38462 f1 0.45455 time to train 489234.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS1.csv  --epochs 20 --n_iter 3 --patience 3 :: took 499 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS20.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 04:16:15 PM MST
2020-11-30 16:16:21.811475: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 16:16:21.830232: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 16:16:21.831682: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d95d9f1d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 16:16:21.831731: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 16:16:21.831935: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS20.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00373/8 [==========>...................] - ETA: 0s - loss: 0.00285/8 [=================>............] - ETA: 0s - loss: 0.00277/8 [=========================>....] - ETA: 0s - loss: 0.00328/8 [==============================] - 0s 29ms/step - loss: 0.0039
1/8 [==>...........................] - ETA: 0s - loss: 0.00623/8 [==========>...................] - ETA: 0s - loss: 0.00495/8 [=================>............] - ETA: 0s - loss: 0.00487/8 [=========================>....] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 25ms/step - loss: 0.0071
1/8 [==>...........................] - ETA: 0s - loss: 0.00613/8 [==========>...................] - ETA: 0s - loss: 0.00485/8 [=================>............] - ETA: 0s - loss: 0.00447/8 [=========================>....] - ETA: 0s - loss: 0.00428/8 [==============================] - 0s 37ms/step - loss: 0.0043
1/8 [==>...........................] - ETA: 0s - loss: 0.00213/8 [==========>...................] - ETA: 0s - loss: 0.00275/8 [=================>............] - ETA: 0s - loss: 0.00387/8 [=========================>....] - ETA: 0s - loss: 0.00418/8 [==============================] - 0s 26ms/step - loss: 0.0040
1/8 [==>...........................] - ETA: 0s - loss: 0.00673/8 [==========>...................] - ETA: 0s - loss: 0.00735/8 [=================>............] - ETA: 0s - loss: 0.00607/8 [=========================>....] - ETA: 0s - loss: 0.00598/8 [==============================] - 0s 32ms/step - loss: 0.0061
1/8 [==>...........................] - ETA: 0s - loss: 0.00795/8 [=================>............] - ETA: 0s - loss: 0.00918/8 [==============================] - ETA: 0s - loss: 0.01038/8 [==============================] - 0s 17ms/step - loss: 0.0103
1/8 [==>...........................] - ETA: 0s - loss: 0.00224/8 [==============>...............] - ETA: 0s - loss: 0.00336/8 [=====================>........] - ETA: 0s - loss: 0.00328/8 [==============================] - 0s 19ms/step - loss: 0.0047
1/8 [==>...........................] - ETA: 0s - loss: 0.00584/8 [==============>...............] - ETA: 0s - loss: 0.00357/8 [=========================>....] - ETA: 0s - loss: 0.00378/8 [==============================] - 0s 16ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.00214/8 [==============>...............] - ETA: 0s - loss: 0.00177/8 [=========================>....] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 18ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 0.00834/8 [==============>...............] - ETA: 0s - loss: 0.00517/8 [=========================>....] - ETA: 0s - loss: 0.00518/8 [==============================] - 0s 21ms/step - loss: 0.0050
1/8 [==>...........................] - ETA: 0s - loss: 0.00294/8 [==============>...............] - ETA: 0s - loss: 0.00277/8 [=========================>....] - ETA: 0s - loss: 0.00338/8 [==============================] - 0s 16ms/step - loss: 0.0042
1/8 [==>...........................] - ETA: 0s - loss: 0.00315/8 [=================>............] - ETA: 0s - loss: 0.00448/8 [==============================] - ETA: 0s - loss: 0.00618/8 [==============================] - 0s 15ms/step - loss: 0.0061
1/8 [==>...........................] - ETA: 0s - loss: 0.00424/8 [==============>...............] - ETA: 0s - loss: 0.00307/8 [=========================>....] - ETA: 0s - loss: 0.00308/8 [==============================] - 0s 17ms/step - loss: 0.0030
1/8 [==>...........................] - ETA: 0s - loss: 0.00385/8 [=================>............] - ETA: 0s - loss: 0.00408/8 [==============================] - 0s 13ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.00725/8 [=================>............] - ETA: 0s - loss: 0.00538/8 [==============================] - ETA: 0s - loss: 0.00548/8 [==============================] - 0s 15ms/step - loss: 0.0054
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.004448218084871769:
Train Score: 0.00414 MSE 0.06433 RMSE
Test Score: 0.00295 MSE 0.05436 RMSE
Deviation Min [0.00016075], Max [0.45972583]
Deviation 99.5th pctile [0.28461578]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1643,   13]))
Confusion matrix 
[[1643    0]
 [   4    9]]
precision 1.00000, recall 0.69231, f1 0.81818
Time to train: 547877 ms
Saving model models/A4Benchmark/A4Benchmark-TS20.csv.h5
Total Time to proces all the selected files : 550135 ms
A4Benchmark : Avg precision 1.00000 recall 0.69231 f1 0.81818 time to train 547877.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS20.csv  --epochs 20 --n_iter 3 --patience 3 :: took 557 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS21.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 04:25:37 PM MST
2020-11-30 16:25:43.810407: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 16:25:43.829256: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 16:25:43.830741: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55b0f0d268e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 16:25:43.830791: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 16:25:43.831008: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS21.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00673/8 [==========>...................] - ETA: 0s - loss: 0.00595/8 [=================>............] - ETA: 0s - loss: 0.00557/8 [=========================>....] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 24ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00213/8 [==========>...................] - ETA: 0s - loss: 0.00275/8 [=================>............] - ETA: 0s - loss: 0.00277/8 [=========================>....] - ETA: 0s - loss: 0.00278/8 [==============================] - 0s 26ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 0.00253/8 [==========>...................] - ETA: 0s - loss: 0.00325/8 [=================>............] - ETA: 0s - loss: 0.00307/8 [=========================>....] - ETA: 0s - loss: 0.00328/8 [==============================] - 0s 33ms/step - loss: 0.0034
1/8 [==>...........................] - ETA: 0s - loss: 0.00233/8 [==========>...................] - ETA: 0s - loss: 0.00325/8 [=================>............] - ETA: 0s - loss: 0.00327/8 [=========================>....] - ETA: 0s - loss: 0.00338/8 [==============================] - 0s 26ms/step - loss: 0.0034
1/8 [==>...........................] - ETA: 0s - loss: 0.00243/8 [==========>...................] - ETA: 0s - loss: 0.00335/8 [=================>............] - ETA: 0s - loss: 0.00357/8 [=========================>....] - ETA: 0s - loss: 0.00358/8 [==============================] - 0s 29ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.00335/8 [=================>............] - ETA: 0s - loss: 0.00338/8 [==============================] - 0s 14ms/step - loss: 0.0031
1/8 [==>...........................] - ETA: 0s - loss: 0.00204/8 [==============>...............] - ETA: 0s - loss: 0.00237/8 [=========================>....] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 17ms/step - loss: 0.0024
1/8 [==>...........................] - ETA: 0s - loss: 0.00195/8 [=================>............] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 14ms/step - loss: 0.0026
1/8 [==>...........................] - ETA: 0s - loss: 0.00154/8 [==============>...............] - ETA: 0s - loss: 0.00228/8 [==============================] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 15ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.00274/8 [==============>...............] - ETA: 0s - loss: 0.00357/8 [=========================>....] - ETA: 0s - loss: 0.00438/8 [==============================] - 0s 19ms/step - loss: 0.0044
1/8 [==>...........................] - ETA: 0s - loss: 0.00473/8 [==========>...................] - ETA: 0s - loss: 0.00465/8 [=================>............] - ETA: 0s - loss: 0.00437/8 [=========================>....] - ETA: 0s - loss: 0.00408/8 [==============================] - 0s 34ms/step - loss: 0.0039
1/8 [==>...........................] - ETA: 0s - loss: 0.00253/8 [==========>...................] - ETA: 0s - loss: 0.00294/8 [==============>...............] - ETA: 0s - loss: 0.00286/8 [=====================>........] - ETA: 0s - loss: 0.00298/8 [==============================] - ETA: 0s - loss: 0.00308/8 [==============================] - 0s 31ms/step - loss: 0.0030
1/8 [==>...........................] - ETA: 0s - loss: 0.00253/8 [==========>...................] - ETA: 0s - loss: 0.00325/8 [=================>............] - ETA: 0s - loss: 0.00297/8 [=========================>....] - ETA: 0s - loss: 0.00318/8 [==============================] - 0s 25ms/step - loss: 0.0032
1/8 [==>...........................] - ETA: 0s - loss: 0.00303/8 [==========>...................] - ETA: 0s - loss: 0.00395/8 [=================>............] - ETA: 0s - loss: 0.00397/8 [=========================>....] - ETA: 0s - loss: 0.00418/8 [==============================] - 0s 33ms/step - loss: 0.0042
1/8 [==>...........................] - ETA: 0s - loss: 0.00252/8 [======>.......................] - ETA: 0s - loss: 0.00324/8 [==============>...............] - ETA: 0s - loss: 0.00326/8 [=====================>........] - ETA: 0s - loss: 0.00368/8 [==============================] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 35ms/step - loss: 0.0036
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.002964070485904813:
Train Score: 0.00301 MSE 0.05485 RMSE
Test Score: 0.00260 MSE 0.05097 RMSE
Deviation Min [1.66719213e-05], Max [0.1774275]
Deviation 99.5th pctile [0.13285915]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1643,   13]))
Confusion matrix 
[[1638    5]
 [   9    4]]
precision 0.44444, recall 0.30769, f1 0.36364
Time to train: 454758 ms
Saving model models/A4Benchmark/A4Benchmark-TS21.csv.h5
Total Time to proces all the selected files : 457381 ms
A4Benchmark : Avg precision 0.44444 recall 0.30769 f1 0.36364 time to train 454758.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS21.csv  --epochs 20 --n_iter 3 --patience 3 :: took 464 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS22.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 04:33:26 PM MST
2020-11-30 16:33:32.617440: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 16:33:32.636000: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 16:33:32.636755: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5635c62d6c00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 16:33:32.636782: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 16:33:32.636925: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS22.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.01173/8 [==========>...................] - ETA: 0s - loss: 0.01165/8 [=================>............] - ETA: 0s - loss: 0.00727/8 [=========================>....] - ETA: 0s - loss: 0.00548/8 [==============================] - 0s 27ms/step - loss: 0.0051
1/8 [==>...........................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00105/8 [=================>............] - ETA: 0s - loss: 9.4435e-047/8 [=========================>....] - ETA: 0s - loss: 8.3545e-048/8 [==============================] - 0s 23ms/step - loss: 8.3712e-04
1/8 [==>...........................] - ETA: 0s - loss: 4.9384e-043/8 [==========>...................] - ETA: 0s - loss: 4.7361e-045/8 [=================>............] - ETA: 0s - loss: 5.6493e-047/8 [=========================>....] - ETA: 0s - loss: 5.9264e-048/8 [==============================] - 0s 30ms/step - loss: 6.1030e-04
1/8 [==>...........................] - ETA: 0s - loss: 8.0942e-043/8 [==========>...................] - ETA: 0s - loss: 0.0024    6/8 [=====================>........] - ETA: 0s - loss: 0.01878/8 [==============================] - ETA: 0s - loss: 0.02218/8 [==============================] - 0s 24ms/step - loss: 0.0221
1/8 [==>...........................] - ETA: 0s - loss: 0.03043/8 [==========>...................] - ETA: 0s - loss: 0.03385/8 [=================>............] - ETA: 0s - loss: 0.03337/8 [=========================>....] - ETA: 0s - loss: 0.03358/8 [==============================] - 0s 29ms/step - loss: 0.0341
1/8 [==>...........................] - ETA: 0s - loss: 0.01263/8 [==========>...................] - ETA: 0s - loss: 0.01255/8 [=================>............] - ETA: 0s - loss: 0.00827/8 [=========================>....] - ETA: 0s - loss: 0.00628/8 [==============================] - 0s 26ms/step - loss: 0.0059
1/8 [==>...........................] - ETA: 0s - loss: 3.8106e-043/8 [==========>...................] - ETA: 0s - loss: 3.7835e-045/8 [=================>............] - ETA: 0s - loss: 3.6009e-047/8 [=========================>....] - ETA: 0s - loss: 3.6364e-048/8 [==============================] - 0s 32ms/step - loss: 3.9913e-04
1/8 [==>...........................] - ETA: 0s - loss: 5.3409e-043/8 [==========>...................] - ETA: 0s - loss: 5.2900e-045/8 [=================>............] - ETA: 0s - loss: 6.6664e-047/8 [=========================>....] - ETA: 0s - loss: 7.3464e-048/8 [==============================] - 0s 28ms/step - loss: 7.5970e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00285/8 [=================>............] - ETA: 0s - loss: 0.01567/8 [=========================>....] - ETA: 0s - loss: 0.02038/8 [==============================] - 0s 29ms/step - loss: 0.0223
1/8 [==>...........................] - ETA: 0s - loss: 0.03262/8 [======>.......................] - ETA: 0s - loss: 0.03484/8 [==============>...............] - ETA: 0s - loss: 0.03356/8 [=====================>........] - ETA: 0s - loss: 0.03568/8 [==============================] - ETA: 0s - loss: 0.03578/8 [==============================] - 0s 34ms/step - loss: 0.0357
1/8 [==>...........................] - ETA: 0s - loss: 0.01112/8 [======>.......................] - ETA: 0s - loss: 0.01314/8 [==============>...............] - ETA: 0s - loss: 0.00856/8 [=====================>........] - ETA: 0s - loss: 0.00588/8 [==============================] - ETA: 0s - loss: 0.00478/8 [==============================] - 0s 38ms/step - loss: 0.0047
1/8 [==>...........................] - ETA: 0s - loss: 3.8879e-043/8 [==========>...................] - ETA: 0s - loss: 3.8705e-045/8 [=================>............] - ETA: 0s - loss: 3.6668e-047/8 [=========================>....] - ETA: 0s - loss: 3.5715e-048/8 [==============================] - 0s 29ms/step - loss: 3.8769e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00133/8 [==========>...................] - ETA: 0s - loss: 0.00145/8 [=================>............] - ETA: 0s - loss: 0.00166/8 [=====================>........] - ETA: 0s - loss: 0.00168/8 [==============================] - ETA: 0s - loss: 0.00178/8 [==============================] - 0s 36ms/step - loss: 0.0017
1/8 [==>...........................] - ETA: 0s - loss: 0.00163/8 [==========>...................] - ETA: 0s - loss: 0.00315/8 [=================>............] - ETA: 0s - loss: 0.01617/8 [=========================>....] - ETA: 0s - loss: 0.02088/8 [==============================] - 0s 30ms/step - loss: 0.0227
1/8 [==>...........................] - ETA: 0s - loss: 0.03253/8 [==========>...................] - ETA: 0s - loss: 0.03555/8 [=================>............] - ETA: 0s - loss: 0.03507/8 [=========================>....] - ETA: 0s - loss: 0.03528/8 [==============================] - 0s 33ms/step - loss: 0.0357
Best parameters {'n_units': 48, 'n_hidden': 2} best score 0.012529529898893088:
Train Score: 0.01035 MSE 0.10172 RMSE
Test Score: 0.02916 MSE 0.17076 RMSE
Deviation Min [3.89858208e-05], Max [0.50642869]
Deviation 99.5th pctile [0.32222182]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1646,   10]))
Confusion matrix 
[[1638    8]
 [   9    1]]
precision 0.11111, recall 0.10000, f1 0.10526
Time to train: 432378 ms
Saving model models/A4Benchmark/A4Benchmark-TS22.csv.h5
Total Time to proces all the selected files : 436192 ms
A4Benchmark : Avg precision 0.11111 recall 0.10000 f1 0.10526 time to train 432378.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS22.csv  --epochs 20 --n_iter 3 --patience 3 :: took 443 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS23.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 04:40:54 PM MST
2020-11-30 16:41:00.459674: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 16:41:00.478201: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 16:41:00.479105: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55e610174c00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 16:41:00.479135: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 16:41:00.479257: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS23.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00293/8 [==========>...................] - ETA: 0s - loss: 0.00205/8 [=================>............] - ETA: 0s - loss: 0.00207/8 [=========================>....] - ETA: 0s - loss: 0.00208/8 [==============================] - 0s 31ms/step - loss: 0.0019
1/8 [==>...........................] - ETA: 0s - loss: 0.01353/8 [==========>...................] - ETA: 0s - loss: 0.01335/8 [=================>............] - ETA: 0s - loss: 0.01287/8 [=========================>....] - ETA: 0s - loss: 0.01238/8 [==============================] - 0s 28ms/step - loss: 0.0126
1/8 [==>...........................] - ETA: 0s - loss: 0.00393/8 [==========>...................] - ETA: 0s - loss: 0.00255/8 [=================>............] - ETA: 0s - loss: 0.00197/8 [=========================>....] - ETA: 0s - loss: 0.00198/8 [==============================] - 0s 30ms/step - loss: 0.0019
1/8 [==>...........................] - ETA: 0s - loss: 0.00373/8 [==========>...................] - ETA: 0s - loss: 0.00545/8 [=================>............] - ETA: 0s - loss: 0.00587/8 [=========================>....] - ETA: 0s - loss: 0.00618/8 [==============================] - 0s 34ms/step - loss: 0.0066
1/8 [==>...........................] - ETA: 0s - loss: 0.00853/8 [==========>...................] - ETA: 0s - loss: 0.00615/8 [=================>............] - ETA: 0s - loss: 0.00577/8 [=========================>....] - ETA: 0s - loss: 0.00778/8 [==============================] - 0s 24ms/step - loss: 0.0079
1/8 [==>...........................] - ETA: 0s - loss: 0.00375/8 [=================>............] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 14ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.00325/8 [=================>............] - ETA: 0s - loss: 0.00318/8 [==============================] - 0s 13ms/step - loss: 0.0024
1/8 [==>...........................] - ETA: 0s - loss: 0.00454/8 [==============>...............] - ETA: 0s - loss: 0.00257/8 [=========================>....] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 17ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.00104/8 [==============>...............] - ETA: 0s - loss: 0.00147/8 [=========================>....] - ETA: 0s - loss: 0.00208/8 [==============================] - 0s 18ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.00615/8 [=================>............] - ETA: 0s - loss: 0.00408/8 [==============================] - 0s 12ms/step - loss: 0.0058
1/8 [==>...........................] - ETA: 0s - loss: 0.00973/8 [==========>...................] - ETA: 0s - loss: 0.01175/8 [=================>............] - ETA: 0s - loss: 0.01277/8 [=========================>....] - ETA: 0s - loss: 0.01228/8 [==============================] - 0s 31ms/step - loss: 0.0124
1/8 [==>...........................] - ETA: 0s - loss: 0.01313/8 [==========>...................] - ETA: 0s - loss: 0.01325/8 [=================>............] - ETA: 0s - loss: 0.01257/8 [=========================>....] - ETA: 0s - loss: 0.01218/8 [==============================] - 0s 27ms/step - loss: 0.0124
1/8 [==>...........................] - ETA: 0s - loss: 0.00453/8 [==========>...................] - ETA: 0s - loss: 0.00335/8 [=================>............] - ETA: 0s - loss: 0.00297/8 [=========================>....] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 29ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 0.00113/8 [==========>...................] - ETA: 0s - loss: 0.00205/8 [=================>............] - ETA: 0s - loss: 0.00237/8 [=========================>....] - ETA: 0s - loss: 0.00248/8 [==============================] - 0s 34ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 0.00693/8 [==========>...................] - ETA: 0s - loss: 0.00505/8 [=================>............] - ETA: 0s - loss: 0.00437/8 [=========================>....] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 27ms/step - loss: 0.0060
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.00299934484064579:
Train Score: 0.00165 MSE 0.04058 RMSE
Test Score: 0.00593 MSE 0.07702 RMSE
Deviation Min [2.48685758e-05], Max [0.2806468]
Deviation 99.5th pctile [0.18701877]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1652,    4]))
Confusion matrix 
[[1647    5]
 [   0    4]]
precision 0.44444, recall 1.00000, f1 0.61538
Time to train: 682687 ms
Saving model models/A4Benchmark/A4Benchmark-TS23.csv.h5
Total Time to proces all the selected files : 685036 ms
A4Benchmark : Avg precision 0.44444 recall 1.00000 f1 0.61538 time to train 682687.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS23.csv  --epochs 20 --n_iter 3 --patience 3 :: took 691 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS24.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 04:52:31 PM MST
2020-11-30 16:52:40.290608: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 16:52:40.309264: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 16:52:40.310139: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55cf389108e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 16:52:40.310166: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 16:52:40.310286: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS24.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.01695/8 [=================>............] - ETA: 0s - loss: 0.01398/8 [==============================] - 0s 14ms/step - loss: 0.0149
1/8 [==>...........................] - ETA: 0s - loss: 0.00665/8 [=================>............] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 14ms/step - loss: 0.0022
1/8 [==>...........................] - ETA: 0s - loss: 0.00154/8 [==============>...............] - ETA: 0s - loss: 0.00177/8 [=========================>....] - ETA: 0s - loss: 0.00278/8 [==============================] - 0s 19ms/step - loss: 0.0027
1/8 [==>...........................] - ETA: 0s - loss: 0.00534/8 [==============>...............] - ETA: 0s - loss: 0.00657/8 [=========================>....] - ETA: 0s - loss: 0.00588/8 [==============================] - 0s 16ms/step - loss: 0.0057
1/8 [==>...........................] - ETA: 0s - loss: 0.00225/8 [=================>............] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 13ms/step - loss: 0.0024
1/8 [==>...........................] - ETA: 0s - loss: 0.03613/8 [==========>...................] - ETA: 0s - loss: 0.03945/8 [=================>............] - ETA: 0s - loss: 0.04027/8 [=========================>....] - ETA: 0s - loss: 0.04068/8 [==============================] - 0s 27ms/step - loss: 0.0413
1/8 [==>...........................] - ETA: 0s - loss: 0.00463/8 [==========>...................] - ETA: 0s - loss: 0.00345/8 [=================>............] - ETA: 0s - loss: 0.00237/8 [=========================>....] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 40ms/step - loss: 0.0018
1/8 [==>...........................] - ETA: 0s - loss: 0.00112/8 [======>.......................] - ETA: 0s - loss: 0.00144/8 [==============>...............] - ETA: 0s - loss: 0.00106/8 [=====================>........] - ETA: 0s - loss: 0.00118/8 [==============================] - ETA: 0s - loss: 0.00278/8 [==============================] - 0s 36ms/step - loss: 0.0027
1/8 [==>...........................] - ETA: 0s - loss: 0.03123/8 [==========>...................] - ETA: 0s - loss: 0.03815/8 [=================>............] - ETA: 0s - loss: 0.03757/8 [=========================>....] - ETA: 0s - loss: 0.03758/8 [==============================] - 0s 27ms/step - loss: 0.0385
1/8 [==>...........................] - ETA: 0s - loss: 0.00443/8 [==========>...................] - ETA: 0s - loss: 0.00795/8 [=================>............] - ETA: 0s - loss: 0.00757/8 [=========================>....] - ETA: 0s - loss: 0.00668/8 [==============================] - 0s 31ms/step - loss: 0.0065
1/8 [==>...........................] - ETA: 0s - loss: 0.01643/8 [==========>...................] - ETA: 0s - loss: 0.00935/8 [=================>............] - ETA: 0s - loss: 0.00727/8 [=========================>....] - ETA: 0s - loss: 0.00868/8 [==============================] - 0s 32ms/step - loss: 0.0084
1/8 [==>...........................] - ETA: 0s - loss: 0.04093/8 [==========>...................] - ETA: 0s - loss: 0.02415/8 [=================>............] - ETA: 0s - loss: 0.01907/8 [=========================>....] - ETA: 0s - loss: 0.01658/8 [==============================] - 0s 34ms/step - loss: 0.0164
1/8 [==>...........................] - ETA: 0s - loss: 0.00113/8 [==========>...................] - ETA: 0s - loss: 8.8126e-045/8 [=================>............] - ETA: 0s - loss: 8.4991e-047/8 [=========================>....] - ETA: 0s - loss: 0.0018    8/8 [==============================] - 0s 27ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.00603/8 [==========>...................] - ETA: 0s - loss: 0.00525/8 [=================>............] - ETA: 0s - loss: 0.00687/8 [=========================>....] - ETA: 0s - loss: 0.00618/8 [==============================] - 0s 26ms/step - loss: 0.0059
1/8 [==>...........................] - ETA: 0s - loss: 0.03293/8 [==========>...................] - ETA: 0s - loss: 0.04055/8 [=================>............] - ETA: 0s - loss: 0.03577/8 [=========================>....] - ETA: 0s - loss: 0.02718/8 [==============================] - 0s 27ms/step - loss: 0.0259
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0055568631738424305:
Train Score: 0.00335 MSE 0.05788 RMSE
Test Score: 0.00184 MSE 0.04292 RMSE
Deviation Min [8.13213182e-05], Max [0.47232458]
Deviation 99.5th pctile [0.20312818]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Confusion matrix 
[[1644    3]
 [   3    6]]
precision 0.66667, recall 0.66667, f1 0.66667
Time to train: 588366 ms
Saving model models/A4Benchmark/A4Benchmark-TS24.csv.h5
Total Time to proces all the selected files : 590774 ms
A4Benchmark : Avg precision 0.66667 recall 0.66667 f1 0.66667 time to train 588366.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS24.csv  --epochs 20 --n_iter 3 --patience 3 :: took 600 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS25.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 05:02:36 PM MST
2020-11-30 17:02:59.165423: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 17:02:59.184214: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 17:02:59.185096: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x556d83bd70b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 17:02:59.185121: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 17:02:59.185236: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS25.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00634/8 [==============>...............] - ETA: 0s - loss: 0.00707/8 [=========================>....] - ETA: 0s - loss: 0.00758/8 [==============================] - 0s 18ms/step - loss: 0.0077
1/8 [==>...........................] - ETA: 0s - loss: 0.00124/8 [==============>...............] - ETA: 0s - loss: 0.00158/8 [==============================] - ETA: 0s - loss: 8.8208e-048/8 [==============================] - 0s 16ms/step - loss: 8.8208e-04
1/8 [==>...........................] - ETA: 0s - loss: 7.2810e-044/8 [==============>...............] - ETA: 0s - loss: 0.0010    7/8 [=========================>....] - ETA: 0s - loss: 9.2235e-048/8 [==============================] - 0s 20ms/step - loss: 9.5943e-04
1/8 [==>...........................] - ETA: 0s - loss: 8.2431e-045/8 [=================>............] - ETA: 0s - loss: 0.0027    8/8 [==============================] - 0s 14ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00875/8 [=================>............] - ETA: 0s - loss: 0.01648/8 [==============================] - 0s 14ms/step - loss: 0.0183
1/8 [==>...........................] - ETA: 0s - loss: 0.00634/8 [==============>...............] - ETA: 0s - loss: 0.00708/8 [==============================] - ETA: 0s - loss: 0.00778/8 [==============================] - 0s 14ms/step - loss: 0.0077
1/8 [==>...........................] - ETA: 0s - loss: 0.00585/8 [=================>............] - ETA: 0s - loss: 0.00448/8 [==============================] - 0s 12ms/step - loss: 0.0032
1/8 [==>...........................] - ETA: 0s - loss: 4.6784e-045/8 [=================>............] - ETA: 0s - loss: 4.9578e-048/8 [==============================] - 0s 13ms/step - loss: 5.0441e-04
1/8 [==>...........................] - ETA: 0s - loss: 1.0975e-045/8 [=================>............] - ETA: 0s - loss: 6.7831e-048/8 [==============================] - 0s 13ms/step - loss: 7.2263e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00534/8 [==============>...............] - ETA: 0s - loss: 0.00937/8 [=========================>....] - ETA: 0s - loss: 0.01018/8 [==============================] - 0s 18ms/step - loss: 0.0105
1/8 [==>...........................] - ETA: 0s - loss: 0.00733/8 [==========>...................] - ETA: 0s - loss: 0.00785/8 [=================>............] - ETA: 0s - loss: 0.00897/8 [=========================>....] - ETA: 0s - loss: 0.00868/8 [==============================] - 0s 36ms/step - loss: 0.0088
1/8 [==>...........................] - ETA: 0s - loss: 0.00643/8 [==========>...................] - ETA: 0s - loss: 0.00755/8 [=================>............] - ETA: 0s - loss: 0.00497/8 [=========================>....] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 26ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00157/8 [=========================>....] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 33ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 0.00193/8 [==========>...................] - ETA: 0s - loss: 0.00205/8 [=================>............] - ETA: 0s - loss: 0.00387/8 [=========================>....] - ETA: 0s - loss: 0.00628/8 [==============================] - 0s 32ms/step - loss: 0.0065
1/8 [==>...........................] - ETA: 0s - loss: 0.00813/8 [==========>...................] - ETA: 0s - loss: 0.01345/8 [=================>............] - ETA: 0s - loss: 0.01547/8 [=========================>....] - ETA: 0s - loss: 0.01688/8 [==============================] - 0s 29ms/step - loss: 0.0172
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.00453559635207057:
Train Score: 0.00099 MSE 0.03153 RMSE
Test Score: 0.04036 MSE 0.20089 RMSE
Deviation Min [8.12016501e-06], Max [1.09853584]
Deviation 99.5th pctile [0.67703467]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1646,   10]))
Confusion matrix 
[[1637    9]
 [  10    0]]
precision 0.00000, recall 0.00000, f1 0.00000
Time to train: 302439 ms
Saving model models/A4Benchmark/A4Benchmark-TS25.csv.h5
Total Time to proces all the selected files : 304878 ms
A4Benchmark : Avg precision 0.00000 recall 0.00000 f1 0.00000 time to train 302439.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS25.csv  --epochs 20 --n_iter 3 --patience 3 :: took 328 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS26.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 05:08:09 PM MST
2020-11-30 17:08:15.647848: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 17:08:15.666261: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 17:08:15.667757: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x561f9ecfc0b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 17:08:15.667810: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 17:08:15.668032: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS26.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00213/8 [==========>...................] - ETA: 0s - loss: 0.00275/8 [=================>............] - ETA: 0s - loss: 0.00257/8 [=========================>....] - ETA: 0s - loss: 0.00958/8 [==============================] - 0s 30ms/step - loss: 0.0127
1/8 [==>...........................] - ETA: 0s - loss: 0.02623/8 [==========>...................] - ETA: 0s - loss: 0.03465/8 [=================>............] - ETA: 0s - loss: 0.03577/8 [=========================>....] - ETA: 0s - loss: 0.03548/8 [==============================] - 0s 32ms/step - loss: 0.0364
1/8 [==>...........................] - ETA: 0s - loss: 0.03023/8 [==========>...................] - ETA: 0s - loss: 0.03965/8 [=================>............] - ETA: 0s - loss: 0.03757/8 [=========================>....] - ETA: 0s - loss: 0.03618/8 [==============================] - 0s 36ms/step - loss: 0.0376
1/8 [==>...........................] - ETA: 0s - loss: 0.00623/8 [==========>...................] - ETA: 0s - loss: 0.01265/8 [=================>............] - ETA: 0s - loss: 0.01297/8 [=========================>....] - ETA: 0s - loss: 0.00958/8 [==============================] - 0s 27ms/step - loss: 0.0090
1/8 [==>...........................] - ETA: 0s - loss: 0.00153/8 [==========>...................] - ETA: 0s - loss: 0.00415/8 [=================>............] - ETA: 0s - loss: 0.00407/8 [=========================>....] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 32ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.00173/8 [==========>...................] - ETA: 0s - loss: 0.00235/8 [=================>............] - ETA: 0s - loss: 0.00217/8 [=========================>....] - ETA: 0s - loss: 0.00918/8 [==============================] - 0s 24ms/step - loss: 0.0123
1/8 [==>...........................] - ETA: 0s - loss: 0.02743/8 [==========>...................] - ETA: 0s - loss: 0.03595/8 [=================>............] - ETA: 0s - loss: 0.03697/8 [=========================>....] - ETA: 0s - loss: 0.03688/8 [==============================] - 0s 28ms/step - loss: 0.0378
1/8 [==>...........................] - ETA: 0s - loss: 0.02663/8 [==========>...................] - ETA: 0s - loss: 0.03575/8 [=================>............] - ETA: 0s - loss: 0.03397/8 [=========================>....] - ETA: 0s - loss: 0.03228/8 [==============================] - 0s 30ms/step - loss: 0.0334
1/8 [==>...........................] - ETA: 0s - loss: 0.00593/8 [==========>...................] - ETA: 0s - loss: 0.00945/8 [=================>............] - ETA: 0s - loss: 0.00947/8 [=========================>....] - ETA: 0s - loss: 0.00698/8 [==============================] - 0s 23ms/step - loss: 0.0065
1/8 [==>...........................] - ETA: 0s - loss: 0.00193/8 [==========>...................] - ETA: 0s - loss: 0.00485/8 [=================>............] - ETA: 0s - loss: 0.00557/8 [=========================>....] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 22ms/step - loss: 0.0057
1/8 [==>...........................] - ETA: 0s - loss: 8.0545e-045/8 [=================>............] - ETA: 0s - loss: 9.2611e-048/8 [==============================] - 0s 13ms/step - loss: 0.0058
1/8 [==>...........................] - ETA: 0s - loss: 0.02555/8 [=================>............] - ETA: 0s - loss: 0.03388/8 [==============================] - 0s 16ms/step - loss: 0.0344
1/8 [==>...........................] - ETA: 0s - loss: 0.01315/8 [=================>............] - ETA: 0s - loss: 0.01278/8 [==============================] - 0s 13ms/step - loss: 0.0136
1/8 [==>...........................] - ETA: 0s - loss: 0.01615/8 [=================>............] - ETA: 0s - loss: 0.01988/8 [==============================] - 0s 13ms/step - loss: 0.0136
1/8 [==>...........................] - ETA: 0s - loss: 8.5007e-045/8 [=================>............] - ETA: 0s - loss: 0.0024    8/8 [==============================] - 0s 13ms/step - loss: 0.0024
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.013960592029616237:
Train Score: 0.00509 MSE 0.07132 RMSE
Test Score: 0.00200 MSE 0.04473 RMSE
Deviation Min [2.32670917e-05], Max [0.29997995]
Deviation 99.5th pctile [0.2268935]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1654,    2]))
Confusion matrix 
[[1645    9]
 [   2    0]]
precision 0.00000, recall 0.00000, f1 0.00000
Time to train: 377816 ms
Saving model models/A4Benchmark/A4Benchmark-TS26.csv.h5
Total Time to proces all the selected files : 380437 ms
A4Benchmark : Avg precision 0.00000 recall 0.00000 f1 0.00000 time to train 377816.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS26.csv  --epochs 20 --n_iter 3 --patience 3 :: took 387 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS27.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 05:14:41 PM MST
2020-11-30 17:14:48.636519: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 17:14:48.655235: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 17:14:48.656722: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x558e1e54a8e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 17:14:48.656773: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 17:14:48.656967: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS27.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.01913/8 [==========>...................] - ETA: 0s - loss: 0.02215/8 [=================>............] - ETA: 0s - loss: 0.02207/8 [=========================>....] - ETA: 0s - loss: 0.01738/8 [==============================] - 0s 26ms/step - loss: 0.0168
1/8 [==>...........................] - ETA: 0s - loss: 0.00273/8 [==========>...................] - ETA: 0s - loss: 0.00205/8 [=================>............] - ETA: 0s - loss: 0.00277/8 [=========================>....] - ETA: 0s - loss: 0.00278/8 [==============================] - 0s 28ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 0.00783/8 [==========>...................] - ETA: 0s - loss: 0.00475/8 [=================>............] - ETA: 0s - loss: 0.00527/8 [=========================>....] - ETA: 0s - loss: 0.00588/8 [==============================] - 0s 33ms/step - loss: 0.0056
1/8 [==>...........................] - ETA: 0s - loss: 0.02884/8 [==============>...............] - ETA: 0s - loss: 0.03316/8 [=====================>........] - ETA: 0s - loss: 0.03418/8 [==============================] - ETA: 0s - loss: 0.02818/8 [==============================] - 0s 24ms/step - loss: 0.0281
1/8 [==>...........................] - ETA: 0s - loss: 1.2232e-043/8 [==========>...................] - ETA: 0s - loss: 1.3208e-045/8 [=================>............] - ETA: 0s - loss: 1.6641e-047/8 [=========================>....] - ETA: 0s - loss: 3.2170e-048/8 [==============================] - 0s 30ms/step - loss: 3.6614e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00885/8 [=================>............] - ETA: 0s - loss: 0.00898/8 [==============================] - ETA: 0s - loss: 0.00688/8 [==============================] - 0s 16ms/step - loss: 0.0068
1/8 [==>...........................] - ETA: 0s - loss: 0.00305/8 [=================>............] - ETA: 0s - loss: 0.00268/8 [==============================] - 0s 12ms/step - loss: 0.0025
1/8 [==>...........................] - ETA: 0s - loss: 0.01205/8 [=================>............] - ETA: 0s - loss: 0.02508/8 [==============================] - ETA: 0s - loss: 0.01978/8 [==============================] - 0s 14ms/step - loss: 0.0197
1/8 [==>...........................] - ETA: 0s - loss: 0.00555/8 [=================>............] - ETA: 0s - loss: 0.00698/8 [==============================] - 0s 13ms/step - loss: 0.0058
1/8 [==>...........................] - ETA: 0s - loss: 1.2596e-044/8 [==============>...............] - ETA: 0s - loss: 1.6321e-047/8 [=========================>....] - ETA: 0s - loss: 5.1346e-048/8 [==============================] - 0s 14ms/step - loss: 5.7575e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00813/8 [==========>...................] - ETA: 0s - loss: 0.00745/8 [=================>............] - ETA: 0s - loss: 0.00857/8 [=========================>....] - ETA: 0s - loss: 0.00728/8 [==============================] - 0s 35ms/step - loss: 0.0069
1/8 [==>...........................] - ETA: 0s - loss: 0.00282/8 [======>.......................] - ETA: 0s - loss: 0.00214/8 [==============>...............] - ETA: 0s - loss: 0.00296/8 [=====================>........] - ETA: 0s - loss: 0.00328/8 [==============================] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 35ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.00923/8 [==========>...................] - ETA: 0s - loss: 0.01745/8 [=================>............] - ETA: 0s - loss: 0.02107/8 [=========================>....] - ETA: 0s - loss: 0.01828/8 [==============================] - 0s 27ms/step - loss: 0.0176
1/8 [==>...........................] - ETA: 0s - loss: 0.00283/8 [==========>...................] - ETA: 0s - loss: 0.00375/8 [=================>............] - ETA: 0s - loss: 0.00357/8 [=========================>....] - ETA: 0s - loss: 0.00528/8 [==============================] - 0s 27ms/step - loss: 0.0049
1/8 [==>...........................] - ETA: 0s - loss: 7.3697e-042/8 [======>.......................] - ETA: 0s - loss: 6.5695e-043/8 [==========>...................] - ETA: 0s - loss: 6.5691e-045/8 [=================>............] - ETA: 0s - loss: 7.8815e-046/8 [=====================>........] - ETA: 0s - loss: 9.5488e-048/8 [==============================] - ETA: 0s - loss: 0.0012    8/8 [==============================] - 0s 53ms/step - loss: 0.0012
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.0068457158980891105:
Train Score: 0.00212 MSE 0.04609 RMSE
Test Score: 0.00475 MSE 0.06895 RMSE
Deviation Min [1.62752431e-05], Max [0.45715693]
Deviation 99.5th pctile [0.19354448]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1641,   15]))
Confusion matrix 
[[1638    3]
 [   9    6]]
precision 0.66667, recall 0.40000, f1 0.50000
Time to train: 764361 ms
Saving model models/A4Benchmark/A4Benchmark-TS27.csv.h5
Total Time to proces all the selected files : 769274 ms
A4Benchmark : Avg precision 0.66667 recall 0.40000 f1 0.50000 time to train 764361.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS27.csv  --epochs 20 --n_iter 3 --patience 3 :: took 777 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS28.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 05:27:43 PM MST
2020-11-30 17:27:52.782961: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 17:27:52.801260: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 17:27:52.802736: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x563d21be18e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 17:27:52.802790: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 17:27:52.803014: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS28.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.01223/8 [==========>...................] - ETA: 0s - loss: 0.01285/8 [=================>............] - ETA: 0s - loss: 0.01267/8 [=========================>....] - ETA: 0s - loss: 0.01388/8 [==============================] - 0s 30ms/step - loss: 0.0135
1/8 [==>...........................] - ETA: 0s - loss: 0.01613/8 [==========>...................] - ETA: 0s - loss: 0.02175/8 [=================>............] - ETA: 0s - loss: 0.02067/8 [=========================>....] - ETA: 0s - loss: 0.02198/8 [==============================] - 0s 27ms/step - loss: 0.0220
1/8 [==>...........................] - ETA: 0s - loss: 0.02353/8 [==========>...................] - ETA: 0s - loss: 0.02385/8 [=================>............] - ETA: 0s - loss: 0.02327/8 [=========================>....] - ETA: 0s - loss: 0.02218/8 [==============================] - 0s 25ms/step - loss: 0.0230
1/8 [==>...........................] - ETA: 0s - loss: 0.00512/8 [======>.......................] - ETA: 0s - loss: 0.00604/8 [==============>...............] - ETA: 0s - loss: 0.00546/8 [=====================>........] - ETA: 0s - loss: 0.00558/8 [==============================] - ETA: 0s - loss: 0.00678/8 [==============================] - 0s 37ms/step - loss: 0.0067
1/8 [==>...........................] - ETA: 0s - loss: 0.00923/8 [==========>...................] - ETA: 0s - loss: 0.00975/8 [=================>............] - ETA: 0s - loss: 0.00817/8 [=========================>....] - ETA: 0s - loss: 0.00648/8 [==============================] - 0s 33ms/step - loss: 0.0061
1/8 [==>...........................] - ETA: 0s - loss: 0.00593/8 [==========>...................] - ETA: 0s - loss: 0.00705/8 [=================>............] - ETA: 0s - loss: 0.00647/8 [=========================>....] - ETA: 0s - loss: 0.00818/8 [==============================] - 0s 27ms/step - loss: 0.0085
1/8 [==>...........................] - ETA: 0s - loss: 0.00303/8 [==========>...................] - ETA: 0s - loss: 0.00425/8 [=================>............] - ETA: 0s - loss: 0.00477/8 [=========================>....] - ETA: 0s - loss: 0.00588/8 [==============================] - 0s 27ms/step - loss: 0.0057
1/8 [==>...........................] - ETA: 0s - loss: 0.00883/8 [==========>...................] - ETA: 0s - loss: 0.00815/8 [=================>............] - ETA: 0s - loss: 0.00737/8 [=========================>....] - ETA: 0s - loss: 0.00718/8 [==============================] - 0s 30ms/step - loss: 0.0072
1/8 [==>...........................] - ETA: 0s - loss: 0.00713/8 [==========>...................] - ETA: 0s - loss: 0.00495/8 [=================>............] - ETA: 0s - loss: 0.00557/8 [=========================>....] - ETA: 0s - loss: 0.00668/8 [==============================] - 0s 23ms/step - loss: 0.0067
1/8 [==>...........................] - ETA: 0s - loss: 0.02643/8 [==========>...................] - ETA: 0s - loss: 0.02555/8 [=================>............] - ETA: 0s - loss: 0.02217/8 [=========================>....] - ETA: 0s - loss: 0.01758/8 [==============================] - 0s 34ms/step - loss: 0.0169
1/8 [==>...........................] - ETA: 0s - loss: 0.00594/8 [==============>...............] - ETA: 0s - loss: 0.00567/8 [=========================>....] - ETA: 0s - loss: 0.00658/8 [==============================] - 0s 19ms/step - loss: 0.0064
1/8 [==>...........................] - ETA: 0s - loss: 0.00355/8 [=================>............] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 14ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00695/8 [=================>............] - ETA: 0s - loss: 0.00518/8 [==============================] - ETA: 0s - loss: 0.00538/8 [==============================] - 0s 16ms/step - loss: 0.0053
1/8 [==>...........................] - ETA: 0s - loss: 0.00584/8 [==============>...............] - ETA: 0s - loss: 0.00547/8 [=========================>....] - ETA: 0s - loss: 0.00728/8 [==============================] - 0s 19ms/step - loss: 0.0072
1/8 [==>...........................] - ETA: 0s - loss: 0.00854/8 [==============>...............] - ETA: 0s - loss: 0.00837/8 [=========================>....] - ETA: 0s - loss: 0.00588/8 [==============================] - 0s 17ms/step - loss: 0.0056
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.005842000897973776:
Train Score: 0.00455 MSE 0.06747 RMSE
Test Score: 0.00648 MSE 0.08053 RMSE
Deviation Min [1.8732943e-05], Max [0.37370166]
Deviation 99.5th pctile [0.26470782]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1644,   12]))
Confusion matrix 
[[1644    0]
 [   3    9]]
precision 1.00000, recall 0.75000, f1 0.85714
Time to train: 698311 ms
Saving model models/A4Benchmark/A4Benchmark-TS28.csv.h5
Total Time to proces all the selected files : 700957 ms
A4Benchmark : Avg precision 1.00000 recall 0.75000 f1 0.85714 time to train 698311.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS28.csv  --epochs 20 --n_iter 3 --patience 3 :: took 711 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS29.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 05:39:39 PM MST
2020-11-30 17:39:46.060884: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 17:39:46.079222: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 17:39:46.080101: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55cf4a813d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 17:39:46.080129: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 17:39:46.080248: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS29.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00983/8 [==========>...................] - ETA: 0s - loss: 0.01085/8 [=================>............] - ETA: 0s - loss: 0.01157/8 [=========================>....] - ETA: 0s - loss: 0.01108/8 [==============================] - 0s 30ms/step - loss: 0.0115
1/8 [==>...........................] - ETA: 0s - loss: 0.00863/8 [==========>...................] - ETA: 0s - loss: 0.01135/8 [=================>............] - ETA: 0s - loss: 0.01137/8 [=========================>....] - ETA: 0s - loss: 0.01118/8 [==============================] - 0s 25ms/step - loss: 0.0116
1/8 [==>...........................] - ETA: 0s - loss: 0.01173/8 [==========>...................] - ETA: 0s - loss: 0.01835/8 [=================>............] - ETA: 0s - loss: 0.01607/8 [=========================>....] - ETA: 0s - loss: 0.01768/8 [==============================] - 0s 31ms/step - loss: 0.0195
1/8 [==>...........................] - ETA: 0s - loss: 0.01973/8 [==========>...................] - ETA: 0s - loss: 0.01795/8 [=================>............] - ETA: 0s - loss: 0.01827/8 [=========================>....] - ETA: 0s - loss: 0.02118/8 [==============================] - 0s 30ms/step - loss: 0.0213
1/8 [==>...........................] - ETA: 0s - loss: 0.01753/8 [==========>...................] - ETA: 0s - loss: 0.02705/8 [=================>............] - ETA: 0s - loss: 0.02787/8 [=========================>....] - ETA: 0s - loss: 0.02748/8 [==============================] - 0s 24ms/step - loss: 0.0275
1/8 [==>...........................] - ETA: 0s - loss: 0.00464/8 [==============>...............] - ETA: 0s - loss: 0.00486/8 [=====================>........] - ETA: 0s - loss: 0.00508/8 [==============================] - ETA: 0s - loss: 0.00478/8 [==============================] - 0s 26ms/step - loss: 0.0047
1/8 [==>...........................] - ETA: 0s - loss: 0.00204/8 [==============>...............] - ETA: 0s - loss: 0.00237/8 [=========================>....] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 16ms/step - loss: 0.0019
1/8 [==>...........................] - ETA: 0s - loss: 0.00306/8 [=====================>........] - ETA: 0s - loss: 0.00358/8 [==============================] - 0s 11ms/step - loss: 0.0043
1/8 [==>...........................] - ETA: 0s - loss: 0.00164/8 [==============>...............] - ETA: 0s - loss: 0.00137/8 [=========================>....] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 17ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 0.00155/8 [=================>............] - ETA: 0s - loss: 0.00468/8 [==============================] - 0s 13ms/step - loss: 0.0041
1/8 [==>...........................] - ETA: 0s - loss: 0.00844/8 [==============>...............] - ETA: 0s - loss: 0.00967/8 [=========================>....] - ETA: 0s - loss: 0.00958/8 [==============================] - 0s 18ms/step - loss: 0.0098
1/8 [==>...........................] - ETA: 0s - loss: 0.00774/8 [==============>...............] - ETA: 0s - loss: 0.01007/8 [=========================>....] - ETA: 0s - loss: 0.01028/8 [==============================] - 0s 16ms/step - loss: 0.0105
1/8 [==>...........................] - ETA: 0s - loss: 0.00134/8 [==============>...............] - ETA: 0s - loss: 0.00167/8 [=========================>....] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 16ms/step - loss: 0.0025
1/8 [==>...........................] - ETA: 0s - loss: 0.00166/8 [=====================>........] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 11ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 0.00415/8 [=================>............] - ETA: 0s - loss: 0.00658/8 [==============================] - 0s 13ms/step - loss: 0.0065
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.0032975721172988416:
Train Score: 0.00657 MSE 0.08103 RMSE
Test Score: 0.00733 MSE 0.08561 RMSE
Deviation Min [3.21952964e-05], Max [0.35199132]
Deviation 99.5th pctile [0.28897026]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1643,   13]))
Confusion matrix 
[[1638    5]
 [   9    4]]
precision 0.44444, recall 0.30769, f1 0.36364
Time to train: 396098 ms
Saving model models/A4Benchmark/A4Benchmark-TS29.csv.h5
Total Time to proces all the selected files : 398621 ms
A4Benchmark : Avg precision 0.44444 recall 0.30769 f1 0.36364 time to train 396098.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS29.csv  --epochs 20 --n_iter 3 --patience 3 :: took 406 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS2.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 05:46:30 PM MST
2020-11-30 17:46:59.988237: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 17:47:00.007294: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 17:47:00.008868: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55651f042d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 17:47:00.008916: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 17:47:00.009095: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS2.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00633/8 [==========>...................] - ETA: 0s - loss: 0.00524/8 [==============>...............] - ETA: 0s - loss: 0.00505/8 [=================>............] - ETA: 0s - loss: 0.00486/8 [=====================>........] - ETA: 0s - loss: 0.00448/8 [==============================] - ETA: 0s - loss: 0.00398/8 [==============================] - 0s 36ms/step - loss: 0.0039
1/8 [==>...........................] - ETA: 0s - loss: 0.00143/8 [==========>...................] - ETA: 0s - loss: 0.00195/8 [=================>............] - ETA: 0s - loss: 0.00197/8 [=========================>....] - ETA: 0s - loss: 0.00198/8 [==============================] - 0s 26ms/step - loss: 0.0019
1/8 [==>...........................] - ETA: 0s - loss: 0.00183/8 [==========>...................] - ETA: 0s - loss: 0.00245/8 [=================>............] - ETA: 0s - loss: 0.00227/8 [=========================>....] - ETA: 0s - loss: 0.00248/8 [==============================] - 0s 30ms/step - loss: 0.0025
1/8 [==>...........................] - ETA: 0s - loss: 0.00133/8 [==========>...................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00157/8 [=========================>....] - ETA: 0s - loss: 0.00168/8 [==============================] - 0s 29ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00155/8 [=================>............] - ETA: 0s - loss: 0.00187/8 [=========================>....] - ETA: 0s - loss: 0.00198/8 [==============================] - 0s 29ms/step - loss: 0.0019
1/8 [==>...........................] - ETA: 0s - loss: 0.00153/8 [==========>...................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00167/8 [=========================>....] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 23ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00157/8 [=========================>....] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 26ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 0.00122/8 [======>.......................] - ETA: 0s - loss: 0.00153/8 [==========>...................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00157/8 [=========================>....] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 36ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00155/8 [=================>............] - ETA: 0s - loss: 0.00157/8 [=========================>....] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 35ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00155/8 [=================>............] - ETA: 0s - loss: 0.00187/8 [=========================>....] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 27ms/step - loss: 0.0018
1/8 [==>...........................] - ETA: 0s - loss: 0.00152/8 [======>.......................] - ETA: 0s - loss: 0.00174/8 [==============>...............] - ETA: 0s - loss: 0.00166/8 [=====================>........] - ETA: 0s - loss: 0.00167/8 [=========================>....] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 38ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00157/8 [=========================>....] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 34ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 0.00133/8 [==========>...................] - ETA: 0s - loss: 0.00175/8 [=================>............] - ETA: 0s - loss: 0.00167/8 [=========================>....] - ETA: 0s - loss: 0.00168/8 [==============================] - 0s 30ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00155/8 [=================>............] - ETA: 0s - loss: 0.00157/8 [=========================>....] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 38ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 0.00223/8 [==========>...................] - ETA: 0s - loss: 0.00245/8 [=================>............] - ETA: 0s - loss: 0.00327/8 [=========================>....] - ETA: 0s - loss: 0.00348/8 [==============================] - 0s 28ms/step - loss: 0.0035
Best parameters {'n_units': 72, 'n_hidden': 2} best score 0.0016177597921341659:
Train Score: 0.00159 MSE 0.03982 RMSE
Test Score: 0.00247 MSE 0.04967 RMSE
Deviation Min [1.46825308e-05], Max [0.17295199]
Deviation 99.5th pctile [0.10130082]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1651,    5]))
Confusion matrix 
[[1645    6]
 [   2    3]]
precision 0.33333, recall 0.60000, f1 0.42857
Time to train: 576629 ms
Saving model models/A4Benchmark/A4Benchmark-TS2.csv.h5
Total Time to proces all the selected files : 581332 ms
A4Benchmark : Avg precision 0.33333 recall 0.60000 f1 0.42857 time to train 576629.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS2.csv  --epochs 20 --n_iter 3 --patience 3 :: took 611 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS30.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 05:56:46 PM MST
2020-11-30 17:56:54.347609: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 17:56:54.366246: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 17:56:54.367620: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55fd546808e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 17:56:54.367663: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 17:56:54.367850: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS30.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00803/8 [==========>...................] - ETA: 0s - loss: 0.00875/8 [=================>............] - ETA: 0s - loss: 0.00937/8 [=========================>....] - ETA: 0s - loss: 0.00918/8 [==============================] - 0s 26ms/step - loss: 0.0093
1/8 [==>...........................] - ETA: 0s - loss: 9.1131e-043/8 [==========>...................] - ETA: 0s - loss: 0.0012    5/8 [=================>............] - ETA: 0s - loss: 0.00267/8 [=========================>....] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 34ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00295/8 [=================>............] - ETA: 0s - loss: 0.00247/8 [=========================>....] - ETA: 0s - loss: 0.00248/8 [==============================] - 0s 36ms/step - loss: 0.0024
1/8 [==>...........................] - ETA: 0s - loss: 9.3414e-042/8 [======>.......................] - ETA: 0s - loss: 0.0012    4/8 [==============>...............] - ETA: 0s - loss: 0.00166/8 [=====================>........] - ETA: 0s - loss: 0.00178/8 [==============================] - ETA: 0s - loss: 0.00178/8 [==============================] - 0s 33ms/step - loss: 0.0017
1/8 [==>...........................] - ETA: 0s - loss: 0.00263/8 [==========>...................] - ETA: 0s - loss: 0.00185/8 [=================>............] - ETA: 0s - loss: 0.00227/8 [=========================>....] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 27ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.00665/8 [=================>............] - ETA: 0s - loss: 0.00798/8 [==============================] - 0s 13ms/step - loss: 0.0079
1/8 [==>...........................] - ETA: 0s - loss: 0.00494/8 [==============>...............] - ETA: 0s - loss: 0.00678/8 [==============================] - 0s 21ms/step - loss: 0.0071
1/8 [==>...........................] - ETA: 0s - loss: 0.00414/8 [==============>...............] - ETA: 0s - loss: 0.00516/8 [=====================>........] - ETA: 0s - loss: 0.00518/8 [==============================] - 0s 17ms/step - loss: 0.0053
1/8 [==>...........................] - ETA: 0s - loss: 9.6982e-045/8 [=================>............] - ETA: 0s - loss: 0.0018    8/8 [==============================] - 0s 13ms/step - loss: 0.0019
1/8 [==>...........................] - ETA: 0s - loss: 0.08355/8 [=================>............] - ETA: 0s - loss: 0.12178/8 [==============================] - 0s 14ms/step - loss: 0.1239
1/8 [==>...........................] - ETA: 0s - loss: 0.00705/8 [=================>............] - ETA: 0s - loss: 0.00828/8 [==============================] - ETA: 0s - loss: 0.00848/8 [==============================] - 0s 14ms/step - loss: 0.0084
1/8 [==>...........................] - ETA: 0s - loss: 0.00185/8 [=================>............] - ETA: 0s - loss: 0.00318/8 [==============================] - 0s 13ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 0.00834/8 [==============>...............] - ETA: 0s - loss: 0.01307/8 [=========================>....] - ETA: 0s - loss: 0.01338/8 [==============================] - 0s 17ms/step - loss: 0.0142
1/8 [==>...........................] - ETA: 0s - loss: 9.6830e-043/8 [==========>...................] - ETA: 0s - loss: 0.0017    5/8 [=================>............] - ETA: 0s - loss: 0.00168/8 [==============================] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 31ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 0.00265/8 [=================>............] - ETA: 0s - loss: 0.00358/8 [==============================] - 0s 12ms/step - loss: 0.0033
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.0035245453473180532:
Train Score: 0.00327 MSE 0.05716 RMSE
Test Score: 0.00308 MSE 0.05550 RMSE
Deviation Min [7.21629346e-05], Max [0.29261242]
Deviation 99.5th pctile [0.15889089]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1651,    5]))
Confusion matrix 
[[1647    4]
 [   0    5]]
precision 0.55556, recall 1.00000, f1 0.71429
Time to train: 540052 ms
Saving model models/A4Benchmark/A4Benchmark-TS30.csv.h5
Total Time to proces all the selected files : 544841 ms
A4Benchmark : Avg precision 0.55556 recall 1.00000 f1 0.71429 time to train 540052.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS30.csv  --epochs 20 --n_iter 3 --patience 3 :: took 553 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS31.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 06:06:04 PM MST
2020-11-30 18:06:25.348662: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 18:06:25.367244: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 18:06:25.368109: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55df98697c00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 18:06:25.368137: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 18:06:25.368253: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS31.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00193/8 [==========>...................] - ETA: 0s - loss: 0.00305/8 [=================>............] - ETA: 0s - loss: 0.00297/8 [=========================>....] - ETA: 0s - loss: 0.00258/8 [==============================] - 0s 28ms/step - loss: 0.0025
1/8 [==>...........................] - ETA: 0s - loss: 9.8746e-043/8 [==========>...................] - ETA: 0s - loss: 0.0014    5/8 [=================>............] - ETA: 0s - loss: 0.00227/8 [=========================>....] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 28ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 3.8805e-043/8 [==========>...................] - ETA: 0s - loss: 3.5433e-045/8 [=================>............] - ETA: 0s - loss: 2.2910e-047/8 [=========================>....] - ETA: 0s - loss: 1.8133e-048/8 [==============================] - 0s 39ms/step - loss: 1.7325e-04
1/8 [==>...........................] - ETA: 0s - loss: 7.2293e-053/8 [==========>...................] - ETA: 0s - loss: 7.9572e-055/8 [=================>............] - ETA: 0s - loss: 8.2643e-057/8 [=========================>....] - ETA: 0s - loss: 8.8994e-058/8 [==============================] - 0s 28ms/step - loss: 9.3926e-05
1/8 [==>...........................] - ETA: 0s - loss: 0.02473/8 [==========>...................] - ETA: 0s - loss: 0.02865/8 [=================>............] - ETA: 0s - loss: 0.03167/8 [=========================>....] - ETA: 0s - loss: 0.03458/8 [==============================] - 0s 27ms/step - loss: 0.0351
1/8 [==>...........................] - ETA: 0s - loss: 0.01206/8 [=====================>........] - ETA: 0s - loss: 0.01478/8 [==============================] - 0s 11ms/step - loss: 0.0146
1/8 [==>...........................] - ETA: 0s - loss: 0.00144/8 [==============>...............] - ETA: 0s - loss: 0.00168/8 [==============================] - ETA: 0s - loss: 0.00168/8 [==============================] - 0s 14ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 1.4243e-045/8 [=================>............] - ETA: 0s - loss: 3.4906e-048/8 [==============================] - 0s 13ms/step - loss: 5.4336e-04
1/8 [==>...........................] - ETA: 0s - loss: 1.1802e-044/8 [==============>...............] - ETA: 0s - loss: 1.2670e-047/8 [=========================>....] - ETA: 0s - loss: 1.2390e-048/8 [==============================] - 0s 15ms/step - loss: 1.2244e-04
1/8 [==>...........................] - ETA: 0s - loss: 2.9963e-054/8 [==============>...............] - ETA: 0s - loss: 5.4628e-057/8 [=========================>....] - ETA: 0s - loss: 2.6149e-048/8 [==============================] - 0s 16ms/step - loss: 3.0938e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00365/8 [=================>............] - ETA: 0s - loss: 0.00348/8 [==============================] - 0s 14ms/step - loss: 0.0031
1/8 [==>...........................] - ETA: 0s - loss: 0.00184/8 [==============>...............] - ETA: 0s - loss: 0.00317/8 [=========================>....] - ETA: 0s - loss: 0.00378/8 [==============================] - 0s 18ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.00124/8 [==============>...............] - ETA: 0s - loss: 6.0373e-048/8 [==============================] - ETA: 0s - loss: 3.4223e-048/8 [==============================] - 0s 15ms/step - loss: 3.4223e-04
1/8 [==>...........................] - ETA: 0s - loss: 2.8111e-054/8 [==============>...............] - ETA: 0s - loss: 2.7758e-057/8 [=========================>....] - ETA: 0s - loss: 3.7267e-058/8 [==============================] - 0s 18ms/step - loss: 4.1396e-05
1/8 [==>...........................] - ETA: 0s - loss: 3.1147e-055/8 [=================>............] - ETA: 0s - loss: 0.0017    8/8 [==============================] - 0s 14ms/step - loss: 0.0074
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0029002326926274693:
Train Score: 0.00072 MSE 0.02684 RMSE
Test Score: 0.00295 MSE 0.05431 RMSE
Deviation Min [5.71148034e-05], Max [0.3212122]
Deviation 99.5th pctile [0.09091498]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1652,    4]))
Confusion matrix 
[[1645    7]
 [   2    2]]
precision 0.22222, recall 0.50000, f1 0.30769
Time to train: 563898 ms
Saving model models/A4Benchmark/A4Benchmark-TS31.csv.h5
Total Time to proces all the selected files : 566690 ms
A4Benchmark : Avg precision 0.22222 recall 0.50000 f1 0.30769 time to train 563898.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS31.csv  --epochs 20 --n_iter 3 --patience 3 :: took 588 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS32.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 06:15:57 PM MST
2020-11-30 18:16:19.106143: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 18:16:19.124224: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 18:16:19.125693: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d06a5b1d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 18:16:19.125761: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 18:16:19.125998: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS32.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 5.6480e-045/8 [=================>............] - ETA: 0s - loss: 7.3568e-048/8 [==============================] - ETA: 0s - loss: 7.4599e-048/8 [==============================] - 0s 15ms/step - loss: 7.4599e-04
1/8 [==>...........................] - ETA: 0s - loss: 4.9257e-045/8 [=================>............] - ETA: 0s - loss: 7.0954e-048/8 [==============================] - 0s 13ms/step - loss: 0.0056
1/8 [==>...........................] - ETA: 0s - loss: 0.01575/8 [=================>............] - ETA: 0s - loss: 0.01788/8 [==============================] - ETA: 0s - loss: 0.01778/8 [==============================] - 0s 15ms/step - loss: 0.0177
1/8 [==>...........................] - ETA: 0s - loss: 0.01295/8 [=================>............] - ETA: 0s - loss: 0.01708/8 [==============================] - 0s 13ms/step - loss: 0.0172
1/8 [==>...........................] - ETA: 0s - loss: 0.00765/8 [=================>............] - ETA: 0s - loss: 0.00908/8 [==============================] - ETA: 0s - loss: 0.00938/8 [==============================] - 0s 16ms/step - loss: 0.0093
1/8 [==>...........................] - ETA: 0s - loss: 5.7683e-045/8 [=================>............] - ETA: 0s - loss: 7.8365e-048/8 [==============================] - 0s 14ms/step - loss: 8.6538e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00175/8 [=================>............] - ETA: 0s - loss: 0.00318/8 [==============================] - 0s 13ms/step - loss: 0.0214
1/8 [==>...........................] - ETA: 0s - loss: 0.01484/8 [==============>...............] - ETA: 0s - loss: 0.01657/8 [=========================>....] - ETA: 0s - loss: 0.01638/8 [==============================] - 0s 16ms/step - loss: 0.0169
1/8 [==>...........................] - ETA: 0s - loss: 0.01315/8 [=================>............] - ETA: 0s - loss: 0.01748/8 [==============================] - 0s 12ms/step - loss: 0.0176
1/8 [==>...........................] - ETA: 0s - loss: 0.00874/8 [==============>...............] - ETA: 0s - loss: 0.00947/8 [=========================>....] - ETA: 0s - loss: 0.01018/8 [==============================] - 0s 20ms/step - loss: 0.0103
1/8 [==>...........................] - ETA: 0s - loss: 7.1737e-043/8 [==========>...................] - ETA: 0s - loss: 9.9413e-045/8 [=================>............] - ETA: 0s - loss: 9.9431e-047/8 [=========================>....] - ETA: 0s - loss: 0.0011    8/8 [==============================] - 0s 38ms/step - loss: 0.0011
1/8 [==>...........................] - ETA: 0s - loss: 6.8668e-043/8 [==========>...................] - ETA: 0s - loss: 9.9687e-045/8 [=================>............] - ETA: 0s - loss: 0.0012    7/8 [=========================>....] - ETA: 0s - loss: 0.00598/8 [==============================] - 0s 26ms/step - loss: 0.0072
1/8 [==>...........................] - ETA: 0s - loss: 0.01803/8 [==========>...................] - ETA: 0s - loss: 0.02215/8 [=================>............] - ETA: 0s - loss: 0.02067/8 [=========================>....] - ETA: 0s - loss: 0.02018/8 [==============================] - 0s 25ms/step - loss: 0.0208
1/8 [==>...........................] - ETA: 0s - loss: 0.01553/8 [==========>...................] - ETA: 0s - loss: 0.02155/8 [=================>............] - ETA: 0s - loss: 0.02147/8 [=========================>....] - ETA: 0s - loss: 0.02088/8 [==============================] - 0s 36ms/step - loss: 0.0215
1/8 [==>...........................] - ETA: 0s - loss: 0.01332/8 [======>.......................] - ETA: 0s - loss: 0.01734/8 [==============>...............] - ETA: 0s - loss: 0.01486/8 [=====================>........] - ETA: 0s - loss: 0.01598/8 [==============================] - ETA: 0s - loss: 0.01588/8 [==============================] - 0s 33ms/step - loss: 0.0158
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.010093584249261767:
Train Score: 0.00868 MSE 0.09315 RMSE
Test Score: 0.01230 MSE 0.11092 RMSE
Deviation Min [0.00010644], Max [0.39996609]
Deviation 99.5th pctile [0.26642437]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1645,   11]))
Confusion matrix 
[[1639    6]
 [   8    3]]
precision 0.33333, recall 0.27273, f1 0.30000
Time to train: 263135 ms
Saving model models/A4Benchmark/A4Benchmark-TS32.csv.h5
Total Time to proces all the selected files : 265645 ms
A4Benchmark : Avg precision 0.33333 recall 0.27273 f1 0.30000 time to train 263135.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS32.csv  --epochs 20 --n_iter 3 --patience 3 :: took 288 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS33.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 06:20:50 PM MST
2020-11-30 18:21:07.135757: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 18:21:07.154223: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 18:21:07.155113: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55ab815c3d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 18:21:07.155141: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 18:21:07.155258: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS33.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00653/8 [==========>...................] - ETA: 0s - loss: 0.00575/8 [=================>............] - ETA: 0s - loss: 0.00637/8 [=========================>....] - ETA: 0s - loss: 0.00588/8 [==============================] - 0s 25ms/step - loss: 0.0059
1/8 [==>...........................] - ETA: 0s - loss: 5.9542e-043/8 [==========>...................] - ETA: 0s - loss: 7.8641e-045/8 [=================>............] - ETA: 0s - loss: 0.0015    7/8 [=========================>....] - ETA: 0s - loss: 0.00128/8 [==============================] - 0s 36ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00145/8 [=================>............] - ETA: 0s - loss: 0.00127/8 [=========================>....] - ETA: 0s - loss: 0.00198/8 [==============================] - 0s 26ms/step - loss: 0.0031
1/8 [==>...........................] - ETA: 0s - loss: 0.01153/8 [==========>...................] - ETA: 0s - loss: 0.01295/8 [=================>............] - ETA: 0s - loss: 0.01337/8 [=========================>....] - ETA: 0s - loss: 0.01398/8 [==============================] - 0s 25ms/step - loss: 0.0144
1/8 [==>...........................] - ETA: 0s - loss: 0.00383/8 [==========>...................] - ETA: 0s - loss: 0.00495/8 [=================>............] - ETA: 0s - loss: 0.00617/8 [=========================>....] - ETA: 0s - loss: 0.00708/8 [==============================] - ETA: 0s - loss: 0.00778/8 [==============================] - 0s 39ms/step - loss: 0.0077
1/8 [==>...........................] - ETA: 0s - loss: 0.00863/8 [==========>...................] - ETA: 0s - loss: 0.00755/8 [=================>............] - ETA: 0s - loss: 0.00847/8 [=========================>....] - ETA: 0s - loss: 0.00758/8 [==============================] - 0s 30ms/step - loss: 0.0074
1/8 [==>...........................] - ETA: 0s - loss: 7.6738e-043/8 [==========>...................] - ETA: 0s - loss: 8.9183e-045/8 [=================>............] - ETA: 0s - loss: 0.0015    7/8 [=========================>....] - ETA: 0s - loss: 0.00128/8 [==============================] - 0s 27ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 6.5387e-043/8 [==========>...................] - ETA: 0s - loss: 3.3650e-045/8 [=================>............] - ETA: 0s - loss: 3.5755e-047/8 [=========================>....] - ETA: 0s - loss: 9.5762e-048/8 [==============================] - 0s 32ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 0.00203/8 [==========>...................] - ETA: 0s - loss: 0.00225/8 [=================>............] - ETA: 0s - loss: 0.00317/8 [=========================>....] - ETA: 0s - loss: 0.00338/8 [==============================] - 0s 33ms/step - loss: 0.0033
1/8 [==>...........................] - ETA: 0s - loss: 0.01903/8 [==========>...................] - ETA: 0s - loss: 0.02985/8 [=================>............] - ETA: 0s - loss: 0.03347/8 [=========================>....] - ETA: 0s - loss: 0.03618/8 [==============================] - 0s 28ms/step - loss: 0.0367
1/8 [==>...........................] - ETA: 0s - loss: 0.00424/8 [==============>...............] - ETA: 0s - loss: 0.00367/8 [=========================>....] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 19ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.00224/8 [==============>...............] - ETA: 0s - loss: 0.00278/8 [==============================] - ETA: 0s - loss: 0.00268/8 [==============================] - 0s 14ms/step - loss: 0.0026
1/8 [==>...........................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00148/8 [==============================] - 0s 13ms/step - loss: 0.0030
1/8 [==>...........................] - ETA: 0s - loss: 0.00804/8 [==============>...............] - ETA: 0s - loss: 0.00837/8 [=========================>....] - ETA: 0s - loss: 0.00978/8 [==============================] - 0s 17ms/step - loss: 0.0099
1/8 [==>...........................] - ETA: 0s - loss: 0.03884/8 [==============>...............] - ETA: 0s - loss: 0.06707/8 [=========================>....] - ETA: 0s - loss: 0.07258/8 [==============================] - 0s 17ms/step - loss: 0.0739
Best parameters {'n_units': 72, 'n_hidden': 2} best score 0.006470444588921964:
Train Score: 0.00185 MSE 0.04305 RMSE
Test Score: 0.00362 MSE 0.06015 RMSE
Deviation Min [1.27454731e-05], Max [0.3304838]
Deviation 99.5th pctile [0.15373078]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1652,    4]))
Confusion matrix 
[[1647    5]
 [   0    4]]
precision 0.44444, recall 1.00000, f1 0.61538
Time to train: 604270 ms
Saving model models/A4Benchmark/A4Benchmark-TS33.csv.h5
Total Time to proces all the selected files : 608410 ms
A4Benchmark : Avg precision 0.44444 recall 1.00000 f1 0.61538 time to train 604270.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS33.csv  --epochs 20 --n_iter 3 --patience 3 :: took 625 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS34.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 06:31:20 PM MST
2020-11-30 18:31:35.828591: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 18:31:35.847192: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 18:31:35.848607: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x564eb2e8cd30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 18:31:35.848657: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 18:31:35.848868: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS34.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00786/8 [=====================>........] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 10ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.00125/8 [=================>............] - ETA: 0s - loss: 0.00178/8 [==============================] - 0s 13ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 0.00194/8 [==============>...............] - ETA: 0s - loss: 0.00447/8 [=========================>....] - ETA: 0s - loss: 0.00348/8 [==============================] - 0s 18ms/step - loss: 0.0033
1/8 [==>...........................] - ETA: 0s - loss: 9.1133e-045/8 [=================>............] - ETA: 0s - loss: 0.0010    8/8 [==============================] - 0s 13ms/step - loss: 9.9000e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00184/8 [==============>...............] - ETA: 0s - loss: 0.00167/8 [=========================>....] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 18ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 0.00814/8 [==============>...............] - ETA: 0s - loss: 0.00527/8 [=========================>....] - ETA: 0s - loss: 0.00398/8 [==============================] - 0s 18ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 11ms/step - loss: 0.0017
1/8 [==>...........................] - ETA: 0s - loss: 0.00255/8 [=================>............] - ETA: 0s - loss: 0.00408/8 [==============================] - 0s 12ms/step - loss: 0.0033
1/8 [==>...........................] - ETA: 0s - loss: 0.00303/8 [==========>...................] - ETA: 0s - loss: 0.00416/8 [=====================>........] - ETA: 0s - loss: 0.00408/8 [==============================] - 0s 19ms/step - loss: 0.0040
1/8 [==>...........................] - ETA: 0s - loss: 0.00205/8 [=================>............] - ETA: 0s - loss: 0.00198/8 [==============================] - 0s 13ms/step - loss: 0.0019
1/8 [==>...........................] - ETA: 0s - loss: 0.00793/8 [==========>...................] - ETA: 0s - loss: 0.00535/8 [=================>............] - ETA: 0s - loss: 0.00487/8 [=========================>....] - ETA: 0s - loss: 0.00408/8 [==============================] - 0s 32ms/step - loss: 0.0039
1/8 [==>...........................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00145/8 [=================>............] - ETA: 0s - loss: 0.00137/8 [=========================>....] - ETA: 0s - loss: 0.00138/8 [==============================] - 0s 34ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 0.01163/8 [==========>...................] - ETA: 0s - loss: 0.01695/8 [=================>............] - ETA: 0s - loss: 0.01517/8 [=========================>....] - ETA: 0s - loss: 0.01448/8 [==============================] - 0s 29ms/step - loss: 0.0147
1/8 [==>...........................] - ETA: 0s - loss: 0.01163/8 [==========>...................] - ETA: 0s - loss: 0.01315/8 [=================>............] - ETA: 0s - loss: 0.01277/8 [=========================>....] - ETA: 0s - loss: 0.01288/8 [==============================] - 0s 29ms/step - loss: 0.0131
1/8 [==>...........................] - ETA: 0s - loss: 0.01173/8 [==========>...................] - ETA: 0s - loss: 0.01335/8 [=================>............] - ETA: 0s - loss: 0.01277/8 [=========================>....] - ETA: 0s - loss: 0.01278/8 [==============================] - 0s 24ms/step - loss: 0.0129
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0021808390039950607:
Train Score: 0.00252 MSE 0.05019 RMSE
Test Score: 0.00271 MSE 0.05204 RMSE
Deviation Min [5.00520096e-05], Max [0.42221452]
Deviation 99.5th pctile [0.17571277]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1649,    7]))
Confusion matrix 
[[1647    2]
 [   0    7]]
precision 0.77778, recall 1.00000, f1 0.87500
Time to train: 512242 ms
Saving model models/A4Benchmark/A4Benchmark-TS34.csv.h5
Total Time to proces all the selected files : 514974 ms
A4Benchmark : Avg precision 0.77778 recall 1.00000 f1 0.87500 time to train 512242.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS34.csv  --epochs 20 --n_iter 3 --patience 3 :: took 531 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS35.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 06:40:16 PM MST
2020-11-30 18:40:28.407238: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 18:40:28.425309: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 18:40:28.426797: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56157b2ebd30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 18:40:28.426847: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 18:40:28.427049: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS35.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00493/8 [==========>...................] - ETA: 0s - loss: 0.02215/8 [=================>............] - ETA: 0s - loss: 0.03017/8 [=========================>....] - ETA: 0s - loss: 0.03188/8 [==============================] - 0s 31ms/step - loss: 0.0334
1/8 [==>...........................] - ETA: 0s - loss: 0.01153/8 [==========>...................] - ETA: 0s - loss: 0.00825/8 [=================>............] - ETA: 0s - loss: 0.00547/8 [=========================>....] - ETA: 0s - loss: 0.00408/8 [==============================] - 0s 26ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.00173/8 [==========>...................] - ETA: 0s - loss: 0.00235/8 [=================>............] - ETA: 0s - loss: 0.00217/8 [=========================>....] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 25ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.00263/8 [==========>...................] - ETA: 0s - loss: 0.00235/8 [=================>............] - ETA: 0s - loss: 0.00197/8 [=========================>....] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 25ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.00983/8 [==========>...................] - ETA: 0s - loss: 0.01045/8 [=================>............] - ETA: 0s - loss: 0.01207/8 [=========================>....] - ETA: 0s - loss: 0.01568/8 [==============================] - 0s 34ms/step - loss: 0.0167
1/8 [==>...........................] - ETA: 0s - loss: 0.00493/8 [==========>...................] - ETA: 0s - loss: 0.02195/8 [=================>............] - ETA: 0s - loss: 0.02947/8 [=========================>....] - ETA: 0s - loss: 0.03128/8 [==============================] - 0s 32ms/step - loss: 0.0328
1/8 [==>...........................] - ETA: 0s - loss: 0.01053/8 [==========>...................] - ETA: 0s - loss: 0.00575/8 [=================>............] - ETA: 0s - loss: 0.00367/8 [=========================>....] - ETA: 0s - loss: 0.00278/8 [==============================] - 0s 24ms/step - loss: 0.0026
1/8 [==>...........................] - ETA: 0s - loss: 0.00233/8 [==========>...................] - ETA: 0s - loss: 0.00335/8 [=================>............] - ETA: 0s - loss: 0.00327/8 [=========================>....] - ETA: 0s - loss: 0.00438/8 [==============================] - 0s 24ms/step - loss: 0.0053
1/8 [==>...........................] - ETA: 0s - loss: 0.00993/8 [==========>...................] - ETA: 0s - loss: 0.01095/8 [=================>............] - ETA: 0s - loss: 0.00987/8 [=========================>....] - ETA: 0s - loss: 0.00988/8 [==============================] - 0s 33ms/step - loss: 0.0102
1/8 [==>...........................] - ETA: 0s - loss: 0.00863/8 [==========>...................] - ETA: 0s - loss: 0.00955/8 [=================>............] - ETA: 0s - loss: 0.01108/8 [==============================] - ETA: 0s - loss: 0.01578/8 [==============================] - 0s 25ms/step - loss: 0.0157
1/8 [==>...........................] - ETA: 0s - loss: 0.00284/8 [==============>...............] - ETA: 0s - loss: 0.01357/8 [=========================>....] - ETA: 0s - loss: 0.01548/8 [==============================] - 0s 19ms/step - loss: 0.0158
1/8 [==>...........................] - ETA: 0s - loss: 0.00695/8 [=================>............] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 13ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 0.00124/8 [==============>...............] - ETA: 0s - loss: 0.00117/8 [=========================>....] - ETA: 0s - loss: 0.00128/8 [==============================] - 0s 17ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 0.00354/8 [==============>...............] - ETA: 0s - loss: 0.00267/8 [=========================>....] - ETA: 0s - loss: 0.00248/8 [==============================] - 0s 18ms/step - loss: 0.0025
1/8 [==>...........................] - ETA: 0s - loss: 0.00375/8 [=================>............] - ETA: 0s - loss: 0.00448/8 [==============================] - 0s 14ms/step - loss: 0.0075
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.005738810333423316:
Train Score: 0.00300 MSE 0.05482 RMSE
Test Score: 0.00842 MSE 0.09176 RMSE
Deviation Min [2.18971032e-05], Max [0.35575953]
Deviation 99.5th pctile [0.21872008]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1644,   12]))
Confusion matrix 
[[1638    6]
 [   9    3]]
precision 0.33333, recall 0.25000, f1 0.28571
Time to train: 445892 ms
Saving model models/A4Benchmark/A4Benchmark-TS35.csv.h5
Total Time to proces all the selected files : 448576 ms
A4Benchmark : Avg precision 0.33333 recall 0.25000 f1 0.28571 time to train 445892.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS35.csv  --epochs 20 --n_iter 3 --patience 3 :: took 461 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS36.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 06:48:02 PM MST
2020-11-30 18:48:42.239665: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 18:48:42.258060: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 18:48:42.258767: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55650fc258e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 18:48:42.258792: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 18:48:42.258918: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS36.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.01245/8 [=================>............] - ETA: 0s - loss: 0.01188/8 [==============================] - 0s 12ms/step - loss: 0.0116
1/8 [==>...........................] - ETA: 0s - loss: 0.00755/8 [=================>............] - ETA: 0s - loss: 0.00538/8 [==============================] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 16ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.01146/8 [=====================>........] - ETA: 0s - loss: 0.01678/8 [==============================] - 0s 11ms/step - loss: 0.0157
1/8 [==>...........................] - ETA: 0s - loss: 0.00685/8 [=================>............] - ETA: 0s - loss: 0.00868/8 [==============================] - 0s 13ms/step - loss: 0.0084
1/8 [==>...........................] - ETA: 0s - loss: 0.00875/8 [=================>............] - ETA: 0s - loss: 0.01198/8 [==============================] - 0s 13ms/step - loss: 0.0107
1/8 [==>...........................] - ETA: 0s - loss: 0.00693/8 [==========>...................] - ETA: 0s - loss: 0.00625/8 [=================>............] - ETA: 0s - loss: 0.00587/8 [=========================>....] - ETA: 0s - loss: 0.00718/8 [==============================] - 0s 32ms/step - loss: 0.0069
1/8 [==>...........................] - ETA: 0s - loss: 0.01343/8 [==========>...................] - ETA: 0s - loss: 0.01335/8 [=================>............] - ETA: 0s - loss: 0.01277/8 [=========================>....] - ETA: 0s - loss: 0.01288/8 [==============================] - 0s 27ms/step - loss: 0.0133
1/8 [==>...........................] - ETA: 0s - loss: 0.01123/8 [==========>...................] - ETA: 0s - loss: 0.01325/8 [=================>............] - ETA: 0s - loss: 0.01657/8 [=========================>....] - ETA: 0s - loss: 0.01528/8 [==============================] - 0s 28ms/step - loss: 0.0152
1/8 [==>...........................] - ETA: 0s - loss: 0.01333/8 [==========>...................] - ETA: 0s - loss: 0.01565/8 [=================>............] - ETA: 0s - loss: 0.01667/8 [=========================>....] - ETA: 0s - loss: 0.01588/8 [==============================] - 0s 29ms/step - loss: 0.0163
1/8 [==>...........................] - ETA: 0s - loss: 0.01793/8 [==========>...................] - ETA: 0s - loss: 0.01755/8 [=================>............] - ETA: 0s - loss: 0.02047/8 [=========================>....] - ETA: 0s - loss: 0.01968/8 [==============================] - 0s 24ms/step - loss: 0.0194
1/8 [==>...........................] - ETA: 0s - loss: 0.00343/8 [==========>...................] - ETA: 0s - loss: 0.00395/8 [=================>............] - ETA: 0s - loss: 0.00387/8 [=========================>....] - ETA: 0s - loss: 0.00408/8 [==============================] - 0s 32ms/step - loss: 0.0039
1/8 [==>...........................] - ETA: 0s - loss: 0.01383/8 [==========>...................] - ETA: 0s - loss: 0.01385/8 [=================>............] - ETA: 0s - loss: 0.01317/8 [=========================>....] - ETA: 0s - loss: 0.01338/8 [==============================] - 0s 35ms/step - loss: 0.0138
1/8 [==>...........................] - ETA: 0s - loss: 0.01153/8 [==========>...................] - ETA: 0s - loss: 0.01355/8 [=================>............] - ETA: 0s - loss: 0.01657/8 [=========================>....] - ETA: 0s - loss: 0.01528/8 [==============================] - 0s 30ms/step - loss: 0.0153
1/8 [==>...........................] - ETA: 0s - loss: 0.00223/8 [==========>...................] - ETA: 0s - loss: 0.00295/8 [=================>............] - ETA: 0s - loss: 0.00467/8 [=========================>....] - ETA: 0s - loss: 0.00438/8 [==============================] - 0s 32ms/step - loss: 0.0045
1/8 [==>...........................] - ETA: 0s - loss: 0.01613/8 [==========>...................] - ETA: 0s - loss: 0.01635/8 [=================>............] - ETA: 0s - loss: 0.01927/8 [=========================>....] - ETA: 0s - loss: 0.01848/8 [==============================] - 0s 27ms/step - loss: 0.0182
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.01026168055832386:
Train Score: 0.00672 MSE 0.08195 RMSE
Test Score: 0.00498 MSE 0.07054 RMSE
Deviation Min [0.00033827], Max [0.53534672]
Deviation 99.5th pctile [0.29384506]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1641,   15]))
Confusion matrix 
[[1641    0]
 [   6    9]]
precision 1.00000, recall 0.60000, f1 0.75000
Time to train: 476411 ms
Saving model models/A4Benchmark/A4Benchmark-TS36.csv.h5
Total Time to proces all the selected files : 478853 ms
A4Benchmark : Avg precision 1.00000 recall 0.60000 f1 0.75000 time to train 476411.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS36.csv  --epochs 20 --n_iter 3 --patience 3 :: took 519 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS37.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 06:56:46 PM MST
2020-11-30 18:57:14.237710: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 18:57:14.256252: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 18:57:14.257702: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x556ada9ffc00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 18:57:14.257753: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 18:57:14.257959: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS37.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 6.7388e-044/8 [==============>...............] - ETA: 0s - loss: 7.7870e-047/8 [=========================>....] - ETA: 0s - loss: 7.8664e-048/8 [==============================] - 0s 17ms/step - loss: 7.9228e-04
1/8 [==>...........................] - ETA: 0s - loss: 6.3884e-045/8 [=================>............] - ETA: 0s - loss: 0.0066    8/8 [==============================] - ETA: 0s - loss: 0.01078/8 [==============================] - 0s 16ms/step - loss: 0.0107
1/8 [==>...........................] - ETA: 0s - loss: 0.01165/8 [=================>............] - ETA: 0s - loss: 0.01087/8 [=========================>....] - ETA: 0s - loss: 0.01088/8 [==============================] - 0s 16ms/step - loss: 0.0110
1/8 [==>...........................] - ETA: 0s - loss: 0.02015/8 [=================>............] - ETA: 0s - loss: 0.01858/8 [==============================] - ETA: 0s - loss: 0.01978/8 [==============================] - 0s 15ms/step - loss: 0.0197
1/8 [==>...........................] - ETA: 0s - loss: 0.01955/8 [=================>............] - ETA: 0s - loss: 0.01788/8 [==============================] - 0s 14ms/step - loss: 0.0161
1/8 [==>...........................] - ETA: 0s - loss: 0.00174/8 [==============>...............] - ETA: 0s - loss: 0.00187/8 [=========================>....] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 16ms/step - loss: 0.0018
1/8 [==>...........................] - ETA: 0s - loss: 3.5297e-044/8 [==============>...............] - ETA: 0s - loss: 0.0019    7/8 [=========================>....] - ETA: 0s - loss: 0.00428/8 [==============================] - 0s 16ms/step - loss: 0.0047
1/8 [==>...........................] - ETA: 0s - loss: 0.01955/8 [=================>............] - ETA: 0s - loss: 0.02238/8 [==============================] - 0s 13ms/step - loss: 0.0241
1/8 [==>...........................] - ETA: 0s - loss: 0.00555/8 [=================>............] - ETA: 0s - loss: 0.00378/8 [==============================] - 0s 14ms/step - loss: 0.0039
1/8 [==>...........................] - ETA: 0s - loss: 0.02064/8 [==============>...............] - ETA: 0s - loss: 0.02127/8 [=========================>....] - ETA: 0s - loss: 0.01758/8 [==============================] - 0s 19ms/step - loss: 0.0174
1/8 [==>...........................] - ETA: 0s - loss: 0.00153/8 [==========>...................] - ETA: 0s - loss: 0.00155/8 [=================>............] - ETA: 0s - loss: 0.00177/8 [=========================>....] - ETA: 0s - loss: 0.00168/8 [==============================] - 0s 25ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 9.8065e-043/8 [==========>...................] - ETA: 0s - loss: 0.0013    5/8 [=================>............] - ETA: 0s - loss: 0.00987/8 [=========================>....] - ETA: 0s - loss: 0.01498/8 [==============================] - 0s 25ms/step - loss: 0.0166
1/8 [==>...........................] - ETA: 0s - loss: 0.02364/8 [==============>...............] - ETA: 0s - loss: 0.02617/8 [=========================>....] - ETA: 0s - loss: 0.02668/8 [==============================] - 0s 21ms/step - loss: 0.0281
1/8 [==>...........................] - ETA: 0s - loss: 0.03553/8 [==========>...................] - ETA: 0s - loss: 0.03195/8 [=================>............] - ETA: 0s - loss: 0.03087/8 [=========================>....] - ETA: 0s - loss: 0.03598/8 [==============================] - 0s 28ms/step - loss: 0.0366
1/8 [==>...........................] - ETA: 0s - loss: 0.02233/8 [==========>...................] - ETA: 0s - loss: 0.02395/8 [=================>............] - ETA: 0s - loss: 0.01837/8 [=========================>....] - ETA: 0s - loss: 0.01658/8 [==============================] - 0s 30ms/step - loss: 0.0163
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.010376632725819946:
Train Score: 0.00687 MSE 0.08288 RMSE
Test Score: 0.00497 MSE 0.07049 RMSE
Deviation Min [1.75494379e-05], Max [0.47258908]
Deviation 99.5th pctile [0.2250585]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1653,    3]))
Confusion matrix 
[[1646    7]
 [   1    2]]
precision 0.22222, recall 0.66667, f1 0.33333
Time to train: 283650 ms
Saving model models/A4Benchmark/A4Benchmark-TS37.csv.h5
Total Time to proces all the selected files : 285990 ms
A4Benchmark : Avg precision 0.22222 recall 0.66667 f1 0.33333 time to train 283650.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS37.csv  --epochs 20 --n_iter 3 --patience 3 :: took 314 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS38.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 07:02:05 PM MST
2020-11-30 19:02:13.389244: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 19:02:13.408300: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 19:02:13.409673: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55cae97e8c00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 19:02:13.409720: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 19:02:13.409924: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS38.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00363/8 [==========>...................] - ETA: 0s - loss: 0.00295/8 [=================>............] - ETA: 0s - loss: 0.00227/8 [=========================>....] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 28ms/step - loss: 0.0017
1/8 [==>...........................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00255/8 [=================>............] - ETA: 0s - loss: 0.00797/8 [=========================>....] - ETA: 0s - loss: 0.01088/8 [==============================] - 0s 30ms/step - loss: 0.0117
1/8 [==>...........................] - ETA: 0s - loss: 0.01513/8 [==========>...................] - ETA: 0s - loss: 0.01975/8 [=================>............] - ETA: 0s - loss: 0.01956/8 [=====================>........] - ETA: 0s - loss: 0.01898/8 [==============================] - ETA: 0s - loss: 0.01988/8 [==============================] - 0s 37ms/step - loss: 0.0198
1/8 [==>...........................] - ETA: 0s - loss: 0.01413/8 [==========>...................] - ETA: 0s - loss: 0.01645/8 [=================>............] - ETA: 0s - loss: 0.01647/8 [=========================>....] - ETA: 0s - loss: 0.01678/8 [==============================] - 0s 35ms/step - loss: 0.0183
1/8 [==>...........................] - ETA: 0s - loss: 0.01703/8 [==========>...................] - ETA: 0s - loss: 0.01776/8 [=====================>........] - ETA: 0s - loss: 0.01218/8 [==============================] - ETA: 0s - loss: 0.01118/8 [==============================] - 0s 24ms/step - loss: 0.0111
1/8 [==>...........................] - ETA: 0s - loss: 0.00395/8 [=================>............] - ETA: 0s - loss: 0.00248/8 [==============================] - 0s 14ms/step - loss: 0.0018
1/8 [==>...........................] - ETA: 0s - loss: 2.8016e-045/8 [=================>............] - ETA: 0s - loss: 0.0060    8/8 [==============================] - 0s 14ms/step - loss: 0.0091
1/8 [==>...........................] - ETA: 0s - loss: 0.00854/8 [==============>...............] - ETA: 0s - loss: 0.01177/8 [=========================>....] - ETA: 0s - loss: 0.01268/8 [==============================] - 0s 17ms/step - loss: 0.0127
1/8 [==>...........................] - ETA: 0s - loss: 0.01044/8 [==============>...............] - ETA: 0s - loss: 0.01157/8 [=========================>....] - ETA: 0s - loss: 0.01198/8 [==============================] - 0s 15ms/step - loss: 0.0132
1/8 [==>...........................] - ETA: 0s - loss: 0.03535/8 [=================>............] - ETA: 0s - loss: 0.02638/8 [==============================] - 0s 13ms/step - loss: 0.0251
1/8 [==>...........................] - ETA: 0s - loss: 8.0152e-045/8 [=================>............] - ETA: 0s - loss: 0.0012    8/8 [==============================] - 0s 13ms/step - loss: 0.0013
1/8 [==>...........................] - ETA: 0s - loss: 4.1881e-046/8 [=====================>........] - ETA: 0s - loss: 0.0077    8/8 [==============================] - 0s 12ms/step - loss: 0.0095
1/8 [==>...........................] - ETA: 0s - loss: 0.01194/8 [==============>...............] - ETA: 0s - loss: 0.01587/8 [=========================>....] - ETA: 0s - loss: 0.01678/8 [==============================] - 0s 16ms/step - loss: 0.0169
1/8 [==>...........................] - ETA: 0s - loss: 0.01195/8 [=================>............] - ETA: 0s - loss: 0.01358/8 [==============================] - ETA: 0s - loss: 0.01528/8 [==============================] - 0s 17ms/step - loss: 0.0152
1/8 [==>...........................] - ETA: 0s - loss: 0.01424/8 [==============>...............] - ETA: 0s - loss: 0.01177/8 [=========================>....] - ETA: 0s - loss: 0.00898/8 [==============================] - 0s 18ms/step - loss: 0.0086
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.010307598998770118:
Train Score: 0.00719 MSE 0.08482 RMSE
Test Score: 0.00394 MSE 0.06278 RMSE
Deviation Min [5.35900368e-06], Max [0.53808534]
Deviation 99.5th pctile [0.25009118]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Confusion matrix 
[[1643    4]
 [   4    5]]
precision 0.55556, recall 0.55556, f1 0.55556
Time to train: 259478 ms
Saving model models/A4Benchmark/A4Benchmark-TS38.csv.h5
Total Time to proces all the selected files : 261867 ms
A4Benchmark : Avg precision 0.55556 recall 0.55556 f1 0.55556 time to train 259478.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS38.csv  --epochs 20 --n_iter 3 --patience 3 :: took 270 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS39.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 07:06:40 PM MST
2020-11-30 19:07:12.389264: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 19:07:12.408198: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 19:07:12.409056: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x562c6c817d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 19:07:12.409084: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 19:07:12.409200: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS39.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00534/8 [==============>...............] - ETA: 0s - loss: 0.00667/8 [=========================>....] - ETA: 0s - loss: 0.00678/8 [==============================] - 0s 17ms/step - loss: 0.0070
1/8 [==>...........................] - ETA: 0s - loss: 0.00533/8 [==========>...................] - ETA: 0s - loss: 0.00676/8 [=====================>........] - ETA: 0s - loss: 0.00868/8 [==============================] - 0s 24ms/step - loss: 0.0086
1/8 [==>...........................] - ETA: 0s - loss: 0.00915/8 [=================>............] - ETA: 0s - loss: 0.01348/8 [==============================] - ETA: 0s - loss: 0.01518/8 [==============================] - 0s 15ms/step - loss: 0.0151
1/8 [==>...........................] - ETA: 0s - loss: 0.01924/8 [==============>...............] - ETA: 0s - loss: 0.01667/8 [=========================>....] - ETA: 0s - loss: 0.01988/8 [==============================] - 0s 20ms/step - loss: 0.0200
1/8 [==>...........................] - ETA: 0s - loss: 0.02245/8 [=================>............] - ETA: 0s - loss: 0.02878/8 [==============================] - 0s 14ms/step - loss: 0.0294
1/8 [==>...........................] - ETA: 0s - loss: 0.00615/8 [=================>............] - ETA: 0s - loss: 0.00748/8 [==============================] - ETA: 0s - loss: 0.00688/8 [==============================] - 0s 16ms/step - loss: 0.0068
1/8 [==>...........................] - ETA: 0s - loss: 0.00454/8 [==============>...............] - ETA: 0s - loss: 0.00667/8 [=========================>....] - ETA: 0s - loss: 0.00668/8 [==============================] - 0s 16ms/step - loss: 0.0067
1/8 [==>...........................] - ETA: 0s - loss: 0.00414/8 [==============>...............] - ETA: 0s - loss: 0.00558/8 [==============================] - ETA: 0s - loss: 0.00598/8 [==============================] - 0s 14ms/step - loss: 0.0059
1/8 [==>...........................] - ETA: 0s - loss: 0.00445/8 [=================>............] - ETA: 0s - loss: 0.00558/8 [==============================] - 0s 12ms/step - loss: 0.0059
1/8 [==>...........................] - ETA: 0s - loss: 0.00534/8 [==============>...............] - ETA: 0s - loss: 0.00207/8 [=========================>....] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 16ms/step - loss: 0.0022
1/8 [==>...........................] - ETA: 0s - loss: 0.00613/8 [==========>...................] - ETA: 0s - loss: 0.00715/8 [=================>............] - ETA: 0s - loss: 0.00777/8 [=========================>....] - ETA: 0s - loss: 0.00758/8 [==============================] - 0s 32ms/step - loss: 0.0077
1/8 [==>...........................] - ETA: 0s - loss: 0.00503/8 [==========>...................] - ETA: 0s - loss: 0.00725/8 [=================>............] - ETA: 0s - loss: 0.00767/8 [=========================>....] - ETA: 0s - loss: 0.00768/8 [==============================] - 0s 26ms/step - loss: 0.0078
1/8 [==>...........................] - ETA: 0s - loss: 0.00903/8 [==========>...................] - ETA: 0s - loss: 0.01485/8 [=================>............] - ETA: 0s - loss: 0.01427/8 [=========================>....] - ETA: 0s - loss: 0.01538/8 [==============================] - 0s 29ms/step - loss: 0.0163
1/8 [==>...........................] - ETA: 0s - loss: 0.02913/8 [==========>...................] - ETA: 0s - loss: 0.02515/8 [=================>............] - ETA: 0s - loss: 0.02567/8 [=========================>....] - ETA: 0s - loss: 0.02938/8 [==============================] - 0s 35ms/step - loss: 0.0295
1/8 [==>...........................] - ETA: 0s - loss: 0.01683/8 [==========>...................] - ETA: 0s - loss: 0.02035/8 [=================>............] - ETA: 0s - loss: 0.01987/8 [=========================>....] - ETA: 0s - loss: 0.02048/8 [==============================] - 0s 29ms/step - loss: 0.0207
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.005490995803847909:
Train Score: 0.02672 MSE 0.16347 RMSE
Test Score: 0.05054 MSE 0.22481 RMSE
Deviation Min [9.78705297e-05], Max [0.56948075]
Deviation 99.5th pctile [0.4173198]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1640,   16]))
Confusion matrix 
[[1635    5]
 [  12    4]]
precision 0.44444, recall 0.25000, f1 0.32000
Time to train: 255721 ms
Saving model models/A4Benchmark/A4Benchmark-TS39.csv.h5
Total Time to proces all the selected files : 257855 ms
A4Benchmark : Avg precision 0.44444 recall 0.25000 f1 0.32000 time to train 255721.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS39.csv  --epochs 20 --n_iter 3 --patience 3 :: took 290 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS3.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 07:11:35 PM MST
2020-11-30 19:11:56.054029: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 19:11:56.072225: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 19:11:56.073875: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d91c40f8e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 19:11:56.073943: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 19:11:56.074148: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS3.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00134/8 [==============>...............] - ETA: 0s - loss: 5.6179e-048/8 [==============================] - ETA: 0s - loss: 3.5546e-048/8 [==============================] - 0s 14ms/step - loss: 3.5546e-04
1/8 [==>...........................] - ETA: 0s - loss: 6.7515e-045/8 [=================>............] - ETA: 0s - loss: 8.0231e-048/8 [==============================] - 0s 13ms/step - loss: 7.8760e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00308/8 [==============================] - 0s 13ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.01174/8 [==============>...............] - ETA: 0s - loss: 0.01487/8 [=========================>....] - ETA: 0s - loss: 0.01478/8 [==============================] - 0s 16ms/step - loss: 0.0153
1/8 [==>...........................] - ETA: 0s - loss: 0.00894/8 [==============>...............] - ETA: 0s - loss: 0.00587/8 [=========================>....] - ETA: 0s - loss: 0.00558/8 [==============================] - 0s 17ms/step - loss: 0.0055
1/8 [==>...........................] - ETA: 0s - loss: 0.00463/8 [==========>...................] - ETA: 0s - loss: 0.00225/8 [=================>............] - ETA: 0s - loss: 0.00177/8 [=========================>....] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 28ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 0.00193/8 [==========>...................] - ETA: 0s - loss: 0.00215/8 [=================>............] - ETA: 0s - loss: 0.00167/8 [=========================>....] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 29ms/step - loss: 0.0017
1/8 [==>...........................] - ETA: 0s - loss: 9.0906e-043/8 [==========>...................] - ETA: 0s - loss: 0.0112    5/8 [=================>............] - ETA: 0s - loss: 0.01287/8 [=========================>....] - ETA: 0s - loss: 0.01398/8 [==============================] - 0s 33ms/step - loss: 0.0145
1/8 [==>...........................] - ETA: 0s - loss: 0.00203/8 [==========>...................] - ETA: 0s - loss: 0.00285/8 [=================>............] - ETA: 0s - loss: 0.00227/8 [=========================>....] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 35ms/step - loss: 0.0022
1/8 [==>...........................] - ETA: 0s - loss: 0.03643/8 [==========>...................] - ETA: 0s - loss: 0.02915/8 [=================>............] - ETA: 0s - loss: 0.02647/8 [=========================>....] - ETA: 0s - loss: 0.02588/8 [==============================] - 0s 28ms/step - loss: 0.0257
1/8 [==>...........................] - ETA: 0s - loss: 0.00503/8 [==========>...................] - ETA: 0s - loss: 0.00255/8 [=================>............] - ETA: 0s - loss: 0.00207/8 [=========================>....] - ETA: 0s - loss: 0.00178/8 [==============================] - 0s 25ms/step - loss: 0.0017
1/8 [==>...........................] - ETA: 0s - loss: 2.2567e-043/8 [==========>...................] - ETA: 0s - loss: 3.1190e-045/8 [=================>............] - ETA: 0s - loss: 4.1267e-047/8 [=========================>....] - ETA: 0s - loss: 3.6610e-048/8 [==============================] - 0s 26ms/step - loss: 3.6153e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00293/8 [==========>...................] - ETA: 0s - loss: 0.00785/8 [=================>............] - ETA: 0s - loss: 0.00797/8 [=========================>....] - ETA: 0s - loss: 0.00818/8 [==============================] - 0s 24ms/step - loss: 0.0087
1/8 [==>...........................] - ETA: 0s - loss: 0.01324/8 [==============>...............] - ETA: 0s - loss: 0.01576/8 [=====================>........] - ETA: 0s - loss: 0.01678/8 [==============================] - ETA: 0s - loss: 0.01668/8 [==============================] - 0s 22ms/step - loss: 0.0166
1/8 [==>...........................] - ETA: 0s - loss: 0.02023/8 [==========>...................] - ETA: 0s - loss: 0.01605/8 [=================>............] - ETA: 0s - loss: 0.01307/8 [=========================>....] - ETA: 0s - loss: 0.01238/8 [==============================] - 0s 33ms/step - loss: 0.0122
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.0051089512126054615:
Train Score: 0.00132 MSE 0.03628 RMSE
Test Score: 0.00131 MSE 0.03614 RMSE
Deviation Min [2.29353928e-05], Max [0.26415007]
Deviation 99.5th pctile [0.12254473]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1650,    6]))
Confusion matrix 
[[1645    5]
 [   2    4]]
precision 0.44444, recall 0.66667, f1 0.53333
Time to train: 532258 ms
Saving model models/A4Benchmark/A4Benchmark-TS3.csv.h5
Total Time to proces all the selected files : 534648 ms
A4Benchmark : Avg precision 0.44444 recall 0.66667 f1 0.53333 time to train 532258.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS3.csv  --epochs 20 --n_iter 3 --patience 3 :: took 556 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS40.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 07:20:56 PM MST
2020-11-30 19:21:03.364620: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 19:21:03.383221: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 19:21:03.384539: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5638152f2c00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 19:21:03.384577: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 19:21:03.384730: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS40.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 7.2085e-044/8 [==============>...............] - ETA: 0s - loss: 0.0014    7/8 [=========================>....] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 16ms/step - loss: 0.0025
1/8 [==>...........................] - ETA: 0s - loss: 0.00464/8 [==============>...............] - ETA: 0s - loss: 0.00648/8 [==============================] - ETA: 0s - loss: 0.00668/8 [==============================] - 0s 16ms/step - loss: 0.0066
1/8 [==>...........................] - ETA: 0s - loss: 0.00384/8 [==============>...............] - ETA: 0s - loss: 0.00478/8 [==============================] - ETA: 0s - loss: 0.00458/8 [==============================] - 0s 15ms/step - loss: 0.0045
1/8 [==>...........................] - ETA: 0s - loss: 0.00486/8 [=====================>........] - ETA: 0s - loss: 0.00648/8 [==============================] - 0s 12ms/step - loss: 0.0091
1/8 [==>...........................] - ETA: 0s - loss: 0.01764/8 [==============>...............] - ETA: 0s - loss: 0.02027/8 [=========================>....] - ETA: 0s - loss: 0.01948/8 [==============================] - 0s 19ms/step - loss: 0.0200
1/8 [==>...........................] - ETA: 0s - loss: 2.1786e-045/8 [=================>............] - ETA: 0s - loss: 2.5374e-048/8 [==============================] - 0s 13ms/step - loss: 3.5106e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00154/8 [==============>...............] - ETA: 0s - loss: 0.00347/8 [=========================>....] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 17ms/step - loss: 0.0039
1/8 [==>...........................] - ETA: 0s - loss: 0.00346/8 [=====================>........] - ETA: 0s - loss: 0.00358/8 [==============================] - 0s 11ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.00345/8 [=================>............] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 13ms/step - loss: 0.0079
1/8 [==>...........................] - ETA: 0s - loss: 0.01754/8 [==============>...............] - ETA: 0s - loss: 0.02007/8 [=========================>....] - ETA: 0s - loss: 0.01938/8 [==============================] - 0s 16ms/step - loss: 0.0199
1/8 [==>...........................] - ETA: 0s - loss: 2.5452e-043/8 [==========>...................] - ETA: 0s - loss: 2.6799e-045/8 [=================>............] - ETA: 0s - loss: 2.9133e-047/8 [=========================>....] - ETA: 0s - loss: 4.0060e-048/8 [==============================] - 0s 27ms/step - loss: 4.3644e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00373/8 [==========>...................] - ETA: 0s - loss: 0.00565/8 [=================>............] - ETA: 0s - loss: 0.00597/8 [=========================>....] - ETA: 0s - loss: 0.00618/8 [==============================] - 0s 38ms/step - loss: 0.0062
1/8 [==>...........................] - ETA: 0s - loss: 0.00373/8 [==========>...................] - ETA: 0s - loss: 0.00485/8 [=================>............] - ETA: 0s - loss: 0.00467/8 [=========================>....] - ETA: 0s - loss: 0.00448/8 [==============================] - 0s 35ms/step - loss: 0.0046
1/8 [==>...........................] - ETA: 0s - loss: 0.00383/8 [==========>...................] - ETA: 0s - loss: 0.00415/8 [=================>............] - ETA: 0s - loss: 0.00407/8 [=========================>....] - ETA: 0s - loss: 0.00768/8 [==============================] - 0s 28ms/step - loss: 0.0089
1/8 [==>...........................] - ETA: 0s - loss: 0.01843/8 [==========>...................] - ETA: 0s - loss: 0.02315/8 [=================>............] - ETA: 0s - loss: 0.02157/8 [=========================>....] - ETA: 0s - loss: 0.02088/8 [==============================] - 0s 27ms/step - loss: 0.0214
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.007117710076272488:
Train Score: 0.00879 MSE 0.09376 RMSE
Test Score: 0.01927 MSE 0.13880 RMSE
Deviation Min [6.05262374e-05], Max [0.52269423]
Deviation 99.5th pctile [0.30492643]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1650,    6]))
Confusion matrix 
[[1644    6]
 [   3    3]]
precision 0.33333, recall 0.50000, f1 0.40000
Time to train: 236382 ms
Saving model models/A4Benchmark/A4Benchmark-TS40.csv.h5
Total Time to proces all the selected files : 238689 ms
A4Benchmark : Avg precision 0.33333 recall 0.50000 f1 0.40000 time to train 236382.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS40.csv  --epochs 20 --n_iter 3 --patience 3 :: took 246 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS41.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 07:25:07 PM MST
2020-11-30 19:25:18.772148: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 19:25:18.790260: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 19:25:18.791754: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55cdcc9b9310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 19:25:18.791808: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 19:25:18.792026: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS41.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.01243/8 [==========>...................] - ETA: 0s - loss: 0.01365/8 [=================>............] - ETA: 0s - loss: 0.01357/8 [=========================>....] - ETA: 0s - loss: 0.01488/8 [==============================] - 0s 25ms/step - loss: 0.0152
1/8 [==>...........................] - ETA: 0s - loss: 0.01533/8 [==========>...................] - ETA: 0s - loss: 0.01595/8 [=================>............] - ETA: 0s - loss: 0.01657/8 [=========================>....] - ETA: 0s - loss: 0.01728/8 [==============================] - 0s 33ms/step - loss: 0.0176
1/8 [==>...........................] - ETA: 0s - loss: 0.00913/8 [==========>...................] - ETA: 0s - loss: 0.01005/8 [=================>............] - ETA: 0s - loss: 0.01007/8 [=========================>....] - ETA: 0s - loss: 0.01048/8 [==============================] - 0s 27ms/step - loss: 0.0106
1/8 [==>...........................] - ETA: 0s - loss: 0.03003/8 [==========>...................] - ETA: 0s - loss: 0.02935/8 [=================>............] - ETA: 0s - loss: 0.02907/8 [=========================>....] - ETA: 0s - loss: 0.03128/8 [==============================] - 0s 36ms/step - loss: 0.0314
1/8 [==>...........................] - ETA: 0s - loss: 0.00713/8 [==========>...................] - ETA: 0s - loss: 0.01095/8 [=================>............] - ETA: 0s - loss: 0.01057/8 [=========================>....] - ETA: 0s - loss: 0.01138/8 [==============================] - 0s 24ms/step - loss: 0.0118
1/8 [==>...........................] - ETA: 0s - loss: 0.01165/8 [=================>............] - ETA: 0s - loss: 0.01158/8 [==============================] - ETA: 0s - loss: 0.01178/8 [==============================] - 0s 15ms/step - loss: 0.0117
1/8 [==>...........................] - ETA: 0s - loss: 0.01374/8 [==============>...............] - ETA: 0s - loss: 0.01447/8 [=========================>....] - ETA: 0s - loss: 0.01528/8 [==============================] - 0s 16ms/step - loss: 0.0155
1/8 [==>...........................] - ETA: 0s - loss: 0.03485/8 [=================>............] - ETA: 0s - loss: 0.04118/8 [==============================] - 0s 12ms/step - loss: 0.0444
1/8 [==>...........................] - ETA: 0s - loss: 0.00784/8 [==============>...............] - ETA: 0s - loss: 0.00877/8 [=========================>....] - ETA: 0s - loss: 0.00858/8 [==============================] - 0s 16ms/step - loss: 0.0086
1/8 [==>...........................] - ETA: 0s - loss: 0.00225/8 [=================>............] - ETA: 0s - loss: 0.00328/8 [==============================] - 0s 14ms/step - loss: 0.0031
1/8 [==>...........................] - ETA: 0s - loss: 0.01143/8 [==========>...................] - ETA: 0s - loss: 0.01174/8 [==============>...............] - ETA: 0s - loss: 0.01166/8 [=====================>........] - ETA: 0s - loss: 0.01228/8 [==============================] - ETA: 0s - loss: 0.01288/8 [==============================] - 0s 33ms/step - loss: 0.0128
1/8 [==>...........................] - ETA: 0s - loss: 0.00513/8 [==========>...................] - ETA: 0s - loss: 0.00565/8 [=================>............] - ETA: 0s - loss: 0.00617/8 [=========================>....] - ETA: 0s - loss: 0.00588/8 [==============================] - 0s 27ms/step - loss: 0.0059
1/8 [==>...........................] - ETA: 0s - loss: 0.00993/8 [==========>...................] - ETA: 0s - loss: 0.01115/8 [=================>............] - ETA: 0s - loss: 0.01087/8 [=========================>....] - ETA: 0s - loss: 0.01148/8 [==============================] - 0s 26ms/step - loss: 0.0117
1/8 [==>...........................] - ETA: 0s - loss: 0.00243/8 [==========>...................] - ETA: 0s - loss: 0.00305/8 [=================>............] - ETA: 0s - loss: 0.00297/8 [=========================>....] - ETA: 0s - loss: 0.00338/8 [==============================] - 0s 38ms/step - loss: 0.0034
1/8 [==>...........................] - ETA: 0s - loss: 0.00293/8 [==========>...................] - ETA: 0s - loss: 0.00295/8 [=================>............] - ETA: 0s - loss: 0.00457/8 [=========================>....] - ETA: 0s - loss: 0.00478/8 [==============================] - 0s 28ms/step - loss: 0.0048
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.007715002680197358:
Train Score: 0.01187 MSE 0.10893 RMSE
Test Score: 0.01432 MSE 0.11967 RMSE
Deviation Min [2.02868855e-05], Max [0.38138297]
Deviation 99.5th pctile [0.26945505]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1643,   13]))
Confusion matrix 
[[1636    7]
 [  11    2]]
precision 0.22222, recall 0.15385, f1 0.18182
Time to train: 482649 ms
Saving model models/A4Benchmark/A4Benchmark-TS41.csv.h5
Total Time to proces all the selected files : 487385 ms
A4Benchmark : Avg precision 0.22222 recall 0.15385 f1 0.18182 time to train 482649.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS41.csv  --epochs 20 --n_iter 3 --patience 3 :: took 499 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS42.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 07:33:31 PM MST
2020-11-30 19:33:37.895507: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 19:33:37.914219: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 19:33:37.915717: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x555886d05310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 19:33:37.915770: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 19:33:37.916010: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS42.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00515/8 [=================>............] - ETA: 0s - loss: 0.00378/8 [==============================] - 0s 13ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 3.9141e-045/8 [=================>............] - ETA: 0s - loss: 4.4053e-048/8 [==============================] - 0s 13ms/step - loss: 4.5789e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00245/8 [=================>............] - ETA: 0s - loss: 0.00208/8 [==============================] - 0s 14ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.00105/8 [=================>............] - ETA: 0s - loss: 0.00128/8 [==============================] - ETA: 0s - loss: 0.00128/8 [==============================] - 0s 15ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 0.00174/8 [==============>...............] - ETA: 0s - loss: 0.00207/8 [=========================>....] - ETA: 0s - loss: 0.00588/8 [==============================] - 0s 16ms/step - loss: 0.0061
1/8 [==>...........................] - ETA: 0s - loss: 6.4170e-045/8 [=================>............] - ETA: 0s - loss: 0.0028    8/8 [==============================] - 0s 13ms/step - loss: 0.0059
1/8 [==>...........................] - ETA: 0s - loss: 5.4342e-045/8 [=================>............] - ETA: 0s - loss: 7.3040e-048/8 [==============================] - 0s 13ms/step - loss: 7.8618e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00184/8 [==============>...............] - ETA: 0s - loss: 0.00147/8 [=========================>....] - ETA: 0s - loss: 0.00148/8 [==============================] - 0s 16ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 8.0711e-045/8 [=================>............] - ETA: 0s - loss: 8.9611e-048/8 [==============================] - 0s 13ms/step - loss: 9.3307e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00134/8 [==============>...............] - ETA: 0s - loss: 0.00167/8 [=========================>....] - ETA: 0s - loss: 0.00538/8 [==============================] - 0s 18ms/step - loss: 0.0057
1/8 [==>...........................] - ETA: 0s - loss: 0.00393/8 [==========>...................] - ETA: 0s - loss: 0.00355/8 [=================>............] - ETA: 0s - loss: 0.00307/8 [=========================>....] - ETA: 0s - loss: 0.00248/8 [==============================] - 0s 34ms/step - loss: 0.0024
1/8 [==>...........................] - ETA: 0s - loss: 8.4979e-043/8 [==========>...................] - ETA: 0s - loss: 9.3937e-045/8 [=================>............] - ETA: 0s - loss: 9.3786e-047/8 [=========================>....] - ETA: 0s - loss: 9.0078e-048/8 [==============================] - 0s 38ms/step - loss: 9.1123e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00183/8 [==========>...................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00147/8 [=========================>....] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 31ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 9.4598e-043/8 [==========>...................] - ETA: 0s - loss: 0.0011    5/8 [=================>............] - ETA: 0s - loss: 0.00117/8 [=========================>....] - ETA: 0s - loss: 0.00118/8 [==============================] - 0s 27ms/step - loss: 0.0011
1/8 [==>...........................] - ETA: 0s - loss: 0.00103/8 [==========>...................] - ETA: 0s - loss: 0.00125/8 [=================>............] - ETA: 0s - loss: 0.00187/8 [=========================>....] - ETA: 0s - loss: 0.00498/8 [==============================] - 0s 28ms/step - loss: 0.0053
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.002241090498864651:
Train Score: 0.00166 MSE 0.04075 RMSE
Test Score: 0.01166 MSE 0.10799 RMSE
Deviation Min [4.53472435e-05], Max [0.41303514]
Deviation 99.5th pctile [0.20765251]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1652,    4]))
Confusion matrix 
[[1644    8]
 [   3    1]]
precision 0.11111, recall 0.25000, f1 0.15385
Time to train: 376875 ms
Saving model models/A4Benchmark/A4Benchmark-TS42.csv.h5
Total Time to proces all the selected files : 381345 ms
A4Benchmark : Avg precision 0.11111 recall 0.25000 f1 0.15385 time to train 376875.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS42.csv  --epochs 20 --n_iter 3 --patience 3 :: took 388 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS43.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 07:40:04 PM MST
2020-11-30 19:40:25.304762: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 19:40:25.323227: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 19:40:25.324814: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5642e582c8e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 19:40:25.324883: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 19:40:25.325078: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS43.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00313/8 [==========>...................] - ETA: 0s - loss: 0.00595/8 [=================>............] - ETA: 0s - loss: 0.00637/8 [=========================>....] - ETA: 0s - loss: 0.00528/8 [==============================] - 0s 24ms/step - loss: 0.0049
1/8 [==>...........................] - ETA: 0s - loss: 0.00133/8 [==========>...................] - ETA: 0s - loss: 0.00565/8 [=================>............] - ETA: 0s - loss: 0.00467/8 [=========================>....] - ETA: 0s - loss: 0.00378/8 [==============================] - 0s 26ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.02403/8 [==========>...................] - ETA: 0s - loss: 0.02755/8 [=================>............] - ETA: 0s - loss: 0.02837/8 [=========================>....] - ETA: 0s - loss: 0.02648/8 [==============================] - 0s 26ms/step - loss: 0.0250
1/8 [==>...........................] - ETA: 0s - loss: 1.2366e-043/8 [==========>...................] - ETA: 0s - loss: 1.9637e-045/8 [=================>............] - ETA: 0s - loss: 1.4867e-047/8 [=========================>....] - ETA: 0s - loss: 1.6775e-048/8 [==============================] - 0s 33ms/step - loss: 1.6871e-04
1/8 [==>...........................] - ETA: 0s - loss: 4.6075e-043/8 [==========>...................] - ETA: 0s - loss: 4.0093e-045/8 [=================>............] - ETA: 0s - loss: 0.0018    7/8 [=========================>....] - ETA: 0s - loss: 0.00828/8 [==============================] - 0s 36ms/step - loss: 0.0095
1/8 [==>...........................] - ETA: 0s - loss: 0.02574/8 [==============>...............] - ETA: 0s - loss: 0.02257/8 [=========================>....] - ETA: 0s - loss: 0.02178/8 [==============================] - 0s 18ms/step - loss: 0.0215
1/8 [==>...........................] - ETA: 0s - loss: 0.00125/8 [=================>............] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 14ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.00355/8 [=================>............] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 14ms/step - loss: 0.0041
1/8 [==>...........................] - ETA: 0s - loss: 9.5830e-044/8 [==============>...............] - ETA: 0s - loss: 8.1246e-048/8 [==============================] - ETA: 0s - loss: 9.1010e-048/8 [==============================] - 0s 16ms/step - loss: 9.1010e-04
1/8 [==>...........................] - ETA: 0s - loss: 2.6618e-045/8 [=================>............] - ETA: 0s - loss: 9.6992e-048/8 [==============================] - 0s 14ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 0.00825/8 [=================>............] - ETA: 0s - loss: 0.00938/8 [==============================] - 0s 13ms/step - loss: 0.0086
1/8 [==>...........................] - ETA: 0s - loss: 0.00264/8 [==============>...............] - ETA: 0s - loss: 0.00687/8 [=========================>....] - ETA: 0s - loss: 0.00498/8 [==============================] - 0s 15ms/step - loss: 0.0050
1/8 [==>...........................] - ETA: 0s - loss: 0.00474/8 [==============>...............] - ETA: 0s - loss: 0.00587/8 [=========================>....] - ETA: 0s - loss: 0.00538/8 [==============================] - 0s 17ms/step - loss: 0.0050
1/8 [==>...........................] - ETA: 0s - loss: 1.2754e-045/8 [=================>............] - ETA: 0s - loss: 1.4349e-048/8 [==============================] - 0s 12ms/step - loss: 2.3225e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00125/8 [=================>............] - ETA: 0s - loss: 0.00258/8 [==============================] - 0s 12ms/step - loss: 0.0038
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.004527375483303331:
Train Score: 0.00285 MSE 0.05336 RMSE
Test Score: 0.00377 MSE 0.06143 RMSE
Deviation Min [2.40289413e-05], Max [0.4970661]
Deviation 99.5th pctile [0.19030709]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1645,   11]))
Confusion matrix 
[[1644    1]
 [   3    8]]
precision 0.88889, recall 0.72727, f1 0.80000
Time to train: 552633 ms
Saving model models/A4Benchmark/A4Benchmark-TS43.csv.h5
Total Time to proces all the selected files : 555248 ms
A4Benchmark : Avg precision 0.88889 recall 0.72727 f1 0.80000 time to train 552633.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS43.csv  --epochs 20 --n_iter 3 --patience 3 :: took 576 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS44.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 07:49:45 PM MST
2020-11-30 19:50:06.235498: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 19:50:06.254260: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 19:50:06.255138: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55ed80144c00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 19:50:06.255165: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 19:50:06.255278: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS44.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00113/8 [==========>...................] - ETA: 0s - loss: 0.00125/8 [=================>............] - ETA: 0s - loss: 0.00117/8 [=========================>....] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 24ms/step - loss: 0.0043
1/8 [==>...........................] - ETA: 0s - loss: 0.02623/8 [==========>...................] - ETA: 0s - loss: 0.03145/8 [=================>............] - ETA: 0s - loss: 0.03087/8 [=========================>....] - ETA: 0s - loss: 0.03288/8 [==============================] - 0s 24ms/step - loss: 0.0335
1/8 [==>...........................] - ETA: 0s - loss: 0.02513/8 [==========>...................] - ETA: 0s - loss: 0.03075/8 [=================>............] - ETA: 0s - loss: 0.02387/8 [=========================>....] - ETA: 0s - loss: 0.01918/8 [==============================] - 0s 28ms/step - loss: 0.0188
1/8 [==>...........................] - ETA: 0s - loss: 0.00733/8 [==========>...................] - ETA: 0s - loss: 0.00975/8 [=================>............] - ETA: 0s - loss: 0.00897/8 [=========================>....] - ETA: 0s - loss: 0.00858/8 [==============================] - 0s 23ms/step - loss: 0.0087
1/8 [==>...........................] - ETA: 0s - loss: 0.00653/8 [==========>...................] - ETA: 0s - loss: 0.00845/8 [=================>............] - ETA: 0s - loss: 0.00837/8 [=========================>....] - ETA: 0s - loss: 0.00818/8 [==============================] - 0s 29ms/step - loss: 0.0081
1/8 [==>...........................] - ETA: 0s - loss: 6.7769e-043/8 [==========>...................] - ETA: 0s - loss: 7.7372e-045/8 [=================>............] - ETA: 0s - loss: 8.7564e-047/8 [=========================>....] - ETA: 0s - loss: 0.0013    8/8 [==============================] - 0s 37ms/step - loss: 0.0038
1/8 [==>...........................] - ETA: 0s - loss: 0.02543/8 [==========>...................] - ETA: 0s - loss: 0.03075/8 [=================>............] - ETA: 0s - loss: 0.02987/8 [=========================>....] - ETA: 0s - loss: 0.03188/8 [==============================] - 0s 34ms/step - loss: 0.0325
1/8 [==>...........................] - ETA: 0s - loss: 0.02433/8 [==========>...................] - ETA: 0s - loss: 0.02805/8 [=================>............] - ETA: 0s - loss: 0.02207/8 [=========================>....] - ETA: 0s - loss: 0.01768/8 [==============================] - 0s 27ms/step - loss: 0.0172
1/8 [==>...........................] - ETA: 0s - loss: 0.00853/8 [==========>...................] - ETA: 0s - loss: 0.01135/8 [=================>............] - ETA: 0s - loss: 0.01047/8 [=========================>....] - ETA: 0s - loss: 0.00988/8 [==============================] - 0s 38ms/step - loss: 0.0100
1/8 [==>...........................] - ETA: 0s - loss: 0.00593/8 [==========>...................] - ETA: 0s - loss: 0.00755/8 [=================>............] - ETA: 0s - loss: 0.00747/8 [=========================>....] - ETA: 0s - loss: 0.00728/8 [==============================] - 0s 27ms/step - loss: 0.0073
1/8 [==>...........................] - ETA: 0s - loss: 7.5663e-044/8 [==============>...............] - ETA: 0s - loss: 9.5248e-047/8 [=========================>....] - ETA: 0s - loss: 0.0014    8/8 [==============================] - 0s 18ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.01975/8 [=================>............] - ETA: 0s - loss: 0.02338/8 [==============================] - 0s 13ms/step - loss: 0.0258
1/8 [==>...........................] - ETA: 0s - loss: 0.02054/8 [==============>...............] - ETA: 0s - loss: 0.02167/8 [=========================>....] - ETA: 0s - loss: 0.01558/8 [==============================] - 0s 19ms/step - loss: 0.0151
1/8 [==>...........................] - ETA: 0s - loss: 0.00695/8 [=================>............] - ETA: 0s - loss: 0.00778/8 [==============================] - 0s 14ms/step - loss: 0.0076
1/8 [==>...........................] - ETA: 0s - loss: 0.00595/8 [=================>............] - ETA: 0s - loss: 0.00738/8 [==============================] - 0s 12ms/step - loss: 0.0071
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.01182777383364737:
Train Score: 0.01124 MSE 0.10602 RMSE
Test Score: 0.00681 MSE 0.08250 RMSE
Deviation Min [2.31811288e-06], Max [0.59069306]
Deviation 99.5th pctile [0.29614207]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1640,   16]))
Confusion matrix 
[[1636    4]
 [  11    5]]
precision 0.55556, recall 0.31250, f1 0.40000
Time to train: 314151 ms
Saving model models/A4Benchmark/A4Benchmark-TS44.csv.h5
Total Time to proces all the selected files : 316951 ms
A4Benchmark : Avg precision 0.55556 recall 0.31250 f1 0.40000 time to train 314151.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS44.csv  --epochs 20 --n_iter 3 --patience 3 :: took 338 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS45.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 07:55:28 PM MST
2020-11-30 19:55:35.887237: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 19:55:35.905251: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 19:55:35.906731: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x558ee1d0f310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 19:55:35.906786: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 19:55:35.907021: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS45.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00513/8 [==========>...................] - ETA: 0s - loss: 0.00605/8 [=================>............] - ETA: 0s - loss: 0.00597/8 [=========================>....] - ETA: 0s - loss: 0.00588/8 [==============================] - 0s 28ms/step - loss: 0.0060
1/8 [==>...........................] - ETA: 0s - loss: 0.00443/8 [==========>...................] - ETA: 0s - loss: 0.00605/8 [=================>............] - ETA: 0s - loss: 0.00627/8 [=========================>....] - ETA: 0s - loss: 0.00948/8 [==============================] - 0s 38ms/step - loss: 0.0108
1/8 [==>...........................] - ETA: 0s - loss: 0.01853/8 [==========>...................] - ETA: 0s - loss: 0.02445/8 [=================>............] - ETA: 0s - loss: 0.02257/8 [=========================>....] - ETA: 0s - loss: 0.02248/8 [==============================] - 0s 31ms/step - loss: 0.0234
1/8 [==>...........................] - ETA: 0s - loss: 0.02343/8 [==========>...................] - ETA: 0s - loss: 0.02335/8 [=================>............] - ETA: 0s - loss: 0.02216/8 [=====================>........] - ETA: 0s - loss: 0.02307/8 [=========================>....] - ETA: 0s - loss: 0.02198/8 [==============================] - 0s 43ms/step - loss: 0.0227
1/8 [==>...........................] - ETA: 0s - loss: 0.02153/8 [==========>...................] - ETA: 0s - loss: 0.02385/8 [=================>............] - ETA: 0s - loss: 0.02507/8 [=========================>....] - ETA: 0s - loss: 0.02488/8 [==============================] - 0s 25ms/step - loss: 0.0250
1/8 [==>...........................] - ETA: 0s - loss: 0.00254/8 [==============>...............] - ETA: 0s - loss: 0.00177/8 [=========================>....] - ETA: 0s - loss: 0.00178/8 [==============================] - 0s 16ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 0.00375/8 [=================>............] - ETA: 0s - loss: 0.00518/8 [==============================] - 0s 12ms/step - loss: 0.0090
1/8 [==>...........................] - ETA: 0s - loss: 0.00285/8 [=================>............] - ETA: 0s - loss: 0.00708/8 [==============================] - 0s 13ms/step - loss: 0.0056
1/8 [==>...........................] - ETA: 0s - loss: 0.01464/8 [==============>...............] - ETA: 0s - loss: 0.00708/8 [==============================] - ETA: 0s - loss: 0.00558/8 [==============================] - 0s 14ms/step - loss: 0.0055
1/8 [==>...........................] - ETA: 0s - loss: 0.00715/8 [=================>............] - ETA: 0s - loss: 0.00908/8 [==============================] - 0s 13ms/step - loss: 0.0097
1/8 [==>...........................] - ETA: 0s - loss: 0.00503/8 [==========>...................] - ETA: 0s - loss: 0.00595/8 [=================>............] - ETA: 0s - loss: 0.00587/8 [=========================>....] - ETA: 0s - loss: 0.00588/8 [==============================] - 0s 24ms/step - loss: 0.0060
1/8 [==>...........................] - ETA: 0s - loss: 0.00463/8 [==========>...................] - ETA: 0s - loss: 0.00625/8 [=================>............] - ETA: 0s - loss: 0.00657/8 [=========================>....] - ETA: 0s - loss: 0.00988/8 [==============================] - 0s 30ms/step - loss: 0.0111
1/8 [==>...........................] - ETA: 0s - loss: 0.00293/8 [==========>...................] - ETA: 0s - loss: 0.00465/8 [=================>............] - ETA: 0s - loss: 0.00727/8 [=========================>....] - ETA: 0s - loss: 0.00598/8 [==============================] - 0s 24ms/step - loss: 0.0057
1/8 [==>...........................] - ETA: 0s - loss: 0.02323/8 [==========>...................] - ETA: 0s - loss: 0.02305/8 [=================>............] - ETA: 0s - loss: 0.02197/8 [=========================>....] - ETA: 0s - loss: 0.02168/8 [==============================] - 0s 26ms/step - loss: 0.0224
1/8 [==>...........................] - ETA: 0s - loss: 0.02283/8 [==========>...................] - ETA: 0s - loss: 0.02445/8 [=================>............] - ETA: 0s - loss: 0.02577/8 [=========================>....] - ETA: 0s - loss: 0.02578/8 [==============================] - 0s 31ms/step - loss: 0.0260
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.006274047587066889:
Train Score: 0.00435 MSE 0.06596 RMSE
Test Score: 0.00970 MSE 0.09849 RMSE
Deviation Min [0.00015642], Max [0.47855274]
Deviation 99.5th pctile [0.24157566]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1649,    7]))
Confusion matrix 
[[1647    2]
 [   0    7]]
precision 0.77778, recall 1.00000, f1 0.87500
Time to train: 368831 ms
Saving model models/A4Benchmark/A4Benchmark-TS45.csv.h5
Total Time to proces all the selected files : 371308 ms
A4Benchmark : Avg precision 0.77778 recall 1.00000 f1 0.87500 time to train 368831.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS45.csv  --epochs 20 --n_iter 3 --patience 3 :: took 379 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS46.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 08:01:52 PM MST
2020-11-30 20:02:03.862935: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 20:02:03.881268: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 20:02:03.882109: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559c90db4c00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 20:02:03.882136: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 20:02:03.882245: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS46.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00595/8 [=================>............] - ETA: 0s - loss: 0.00318/8 [==============================] - 0s 14ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00194/8 [==============>...............] - ETA: 0s - loss: 0.00277/8 [=========================>....] - ETA: 0s - loss: 0.00288/8 [==============================] - 0s 16ms/step - loss: 0.0027
1/8 [==>...........................] - ETA: 0s - loss: 0.00325/8 [=================>............] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 14ms/step - loss: 0.0046
1/8 [==>...........................] - ETA: 0s - loss: 0.00505/8 [=================>............] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 13ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00884/8 [==============>...............] - ETA: 0s - loss: 0.00697/8 [=========================>....] - ETA: 0s - loss: 0.00768/8 [==============================] - 0s 20ms/step - loss: 0.0076
1/8 [==>...........................] - ETA: 0s - loss: 0.00853/8 [==========>...................] - ETA: 0s - loss: 0.00615/8 [=================>............] - ETA: 0s - loss: 0.00467/8 [=========================>....] - ETA: 0s - loss: 0.00498/8 [==============================] - 0s 33ms/step - loss: 0.0049
1/8 [==>...........................] - ETA: 0s - loss: 0.00363/8 [==========>...................] - ETA: 0s - loss: 0.00515/8 [=================>............] - ETA: 0s - loss: 0.00587/8 [=========================>....] - ETA: 0s - loss: 0.00568/8 [==============================] - 0s 29ms/step - loss: 0.0056
1/8 [==>...........................] - ETA: 0s - loss: 0.00443/8 [==========>...................] - ETA: 0s - loss: 0.00555/8 [=================>............] - ETA: 0s - loss: 0.00637/8 [=========================>....] - ETA: 0s - loss: 0.00608/8 [==============================] - ETA: 0s - loss: 0.00608/8 [==============================] - 0s 36ms/step - loss: 0.0060
1/8 [==>...........................] - ETA: 0s - loss: 0.01603/8 [==========>...................] - ETA: 0s - loss: 0.01955/8 [=================>............] - ETA: 0s - loss: 0.01847/8 [=========================>....] - ETA: 0s - loss: 0.01838/8 [==============================] - 0s 29ms/step - loss: 0.0192
1/8 [==>...........................] - ETA: 0s - loss: 0.01003/8 [==========>...................] - ETA: 0s - loss: 0.00595/8 [=================>............] - ETA: 0s - loss: 0.00607/8 [=========================>....] - ETA: 0s - loss: 0.00738/8 [==============================] - 0s 37ms/step - loss: 0.0072
1/8 [==>...........................] - ETA: 0s - loss: 0.00556/8 [=====================>........] - ETA: 0s - loss: 0.00448/8 [==============================] - 0s 10ms/step - loss: 0.0041
1/8 [==>...........................] - ETA: 0s - loss: 0.00305/8 [=================>............] - ETA: 0s - loss: 0.00428/8 [==============================] - 0s 13ms/step - loss: 0.0041
1/8 [==>...........................] - ETA: 0s - loss: 0.00494/8 [==============>...............] - ETA: 0s - loss: 0.00507/8 [=========================>....] - ETA: 0s - loss: 0.00598/8 [==============================] - 0s 16ms/step - loss: 0.0059
1/8 [==>...........................] - ETA: 0s - loss: 0.00585/8 [=================>............] - ETA: 0s - loss: 0.00478/8 [==============================] - 0s 12ms/step - loss: 0.0047
1/8 [==>...........................] - ETA: 0s - loss: 0.01025/8 [=================>............] - ETA: 0s - loss: 0.00918/8 [==============================] - 0s 12ms/step - loss: 0.0099
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.004518296150490641:
Train Score: 0.00439 MSE 0.06624 RMSE
Test Score: 0.00555 MSE 0.07448 RMSE
Deviation Min [5.80159672e-06], Max [0.47055161]
Deviation 99.5th pctile [0.21295882]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Confusion matrix 
[[1647    0]
 [   0    9]]
precision 1.00000, recall 1.00000, f1 1.00000
Time to train: 495787 ms
Saving model models/A4Benchmark/A4Benchmark-TS46.csv.h5
Total Time to proces all the selected files : 498425 ms
A4Benchmark : Avg precision 1.00000 recall 1.00000 f1 1.00000 time to train 495787.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS46.csv  --epochs 20 --n_iter 3 --patience 3 :: took 510 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS47.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 08:10:27 PM MST
2020-11-30 20:10:33.948870: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 20:10:33.967244: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 20:10:33.968877: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x556204fc4d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 20:10:33.968936: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 20:10:33.969169: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS47.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00255/8 [=================>............] - ETA: 0s - loss: 0.00168/8 [==============================] - 0s 13ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 0.00255/8 [=================>............] - ETA: 0s - loss: 0.00258/8 [==============================] - 0s 14ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.00175/8 [=================>............] - ETA: 0s - loss: 0.00178/8 [==============================] - 0s 13ms/step - loss: 0.0020
1/8 [==>...........................] - ETA: 0s - loss: 0.00304/8 [==============>...............] - ETA: 0s - loss: 0.00287/8 [=========================>....] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 18ms/step - loss: 0.0038
1/8 [==>...........................] - ETA: 0s - loss: 0.00785/8 [=================>............] - ETA: 0s - loss: 0.00748/8 [==============================] - 0s 14ms/step - loss: 0.0102
1/8 [==>...........................] - ETA: 0s - loss: 0.00223/8 [==========>...................] - ETA: 0s - loss: 0.00185/8 [=================>............] - ETA: 0s - loss: 0.00177/8 [=========================>....] - ETA: 0s - loss: 0.00178/8 [==============================] - 0s 27ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 0.01373/8 [==========>...................] - ETA: 0s - loss: 0.01895/8 [=================>............] - ETA: 0s - loss: 0.01767/8 [=========================>....] - ETA: 0s - loss: 0.01708/8 [==============================] - 0s 32ms/step - loss: 0.0176
1/8 [==>...........................] - ETA: 0s - loss: 0.00113/8 [==========>...................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00177/8 [=========================>....] - ETA: 0s - loss: 0.00168/8 [==============================] - 0s 29ms/step - loss: 0.0017
1/8 [==>...........................] - ETA: 0s - loss: 0.00153/8 [==========>...................] - ETA: 0s - loss: 0.00155/8 [=================>............] - ETA: 0s - loss: 0.00257/8 [=========================>....] - ETA: 0s - loss: 0.00318/8 [==============================] - 0s 27ms/step - loss: 0.0032
1/8 [==>...........................] - ETA: 0s - loss: 0.00873/8 [==========>...................] - ETA: 0s - loss: 0.00845/8 [=================>............] - ETA: 0s - loss: 0.00907/8 [=========================>....] - ETA: 0s - loss: 0.01178/8 [==============================] - 0s 32ms/step - loss: 0.0122
1/8 [==>...........................] - ETA: 0s - loss: 0.00203/8 [==========>...................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00157/8 [=========================>....] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 28ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 0.01413/8 [==========>...................] - ETA: 0s - loss: 0.01915/8 [=================>............] - ETA: 0s - loss: 0.01787/8 [=========================>....] - ETA: 0s - loss: 0.01738/8 [==============================] - 0s 30ms/step - loss: 0.0178
1/8 [==>...........................] - ETA: 0s - loss: 0.00273/8 [==========>...................] - ETA: 0s - loss: 0.00275/8 [=================>............] - ETA: 0s - loss: 0.00347/8 [=========================>....] - ETA: 0s - loss: 0.00348/8 [==============================] - 0s 29ms/step - loss: 0.0033
1/8 [==>...........................] - ETA: 0s - loss: 0.01333/8 [==========>...................] - ETA: 0s - loss: 0.01765/8 [=================>............] - ETA: 0s - loss: 0.01737/8 [=========================>....] - ETA: 0s - loss: 0.01818/8 [==============================] - 0s 27ms/step - loss: 0.0187
1/8 [==>...........................] - ETA: 0s - loss: 0.00273/8 [==========>...................] - ETA: 0s - loss: 0.00225/8 [=================>............] - ETA: 0s - loss: 0.00257/8 [=========================>....] - ETA: 0s - loss: 0.00398/8 [==============================] - 0s 26ms/step - loss: 0.0040
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.004005742515437305:
Train Score: 0.00399 MSE 0.06317 RMSE
Test Score: 0.00610 MSE 0.07812 RMSE
Deviation Min [8.07261353e-05], Max [0.4261436]
Deviation 99.5th pctile [0.16026793]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1655,    1]))
Confusion matrix 
[[1647    8]
 [   0    1]]
precision 0.11111, recall 1.00000, f1 0.20000
Time to train: 682258 ms
Saving model models/A4Benchmark/A4Benchmark-TS47.csv.h5
Total Time to proces all the selected files : 684865 ms
A4Benchmark : Avg precision 0.11111 recall 1.00000 f1 0.20000 time to train 682258.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS47.csv  --epochs 20 --n_iter 3 --patience 3 :: took 692 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS48.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 08:22:04 PM MST
2020-11-30 20:22:29.316714: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 20:22:29.335195: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 20:22:29.336038: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55edd205f8e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 20:22:29.336065: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 20:22:29.336181: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS48.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00275/8 [=================>............] - ETA: 0s - loss: 0.00227/8 [=========================>....] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 39ms/step - loss: 0.0019
1/8 [==>...........................] - ETA: 0s - loss: 0.00543/8 [==========>...................] - ETA: 0s - loss: 0.00685/8 [=================>............] - ETA: 0s - loss: 0.00677/8 [=========================>....] - ETA: 0s - loss: 0.01298/8 [==============================] - 0s 27ms/step - loss: 0.0152
1/8 [==>...........................] - ETA: 0s - loss: 0.04033/8 [==========>...................] - ETA: 0s - loss: 0.03925/8 [=================>............] - ETA: 0s - loss: 0.03917/8 [=========================>....] - ETA: 0s - loss: 0.03768/8 [==============================] - 0s 27ms/step - loss: 0.0383
1/8 [==>...........................] - ETA: 0s - loss: 0.02793/8 [==========>...................] - ETA: 0s - loss: 0.02695/8 [=================>............] - ETA: 0s - loss: 0.02087/8 [=========================>....] - ETA: 0s - loss: 0.01818/8 [==============================] - 0s 26ms/step - loss: 0.0181
1/8 [==>...........................] - ETA: 0s - loss: 0.00742/8 [======>.......................] - ETA: 0s - loss: 0.00654/8 [==============>...............] - ETA: 0s - loss: 0.00535/8 [=================>............] - ETA: 0s - loss: 0.00547/8 [=========================>....] - ETA: 0s - loss: 0.00548/8 [==============================] - 0s 42ms/step - loss: 0.0055
1/8 [==>...........................] - ETA: 0s - loss: 0.00565/8 [=================>............] - ETA: 0s - loss: 0.00638/8 [==============================] - 0s 13ms/step - loss: 0.0062
1/8 [==>...........................] - ETA: 0s - loss: 0.00234/8 [==============>...............] - ETA: 0s - loss: 0.00246/8 [=====================>........] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 20ms/step - loss: 0.0061
1/8 [==>...........................] - ETA: 0s - loss: 0.02005/8 [=================>............] - ETA: 0s - loss: 0.01058/8 [==============================] - 0s 14ms/step - loss: 0.0106
1/8 [==>...........................] - ETA: 0s - loss: 0.00504/8 [==============>...............] - ETA: 0s - loss: 0.00427/8 [=========================>....] - ETA: 0s - loss: 0.00358/8 [==============================] - 0s 19ms/step - loss: 0.0034
1/8 [==>...........................] - ETA: 0s - loss: 0.00253/8 [==========>...................] - ETA: 0s - loss: 0.00197/8 [=========================>....] - ETA: 0s - loss: 0.00178/8 [==============================] - 0s 17ms/step - loss: 0.0017
1/8 [==>...........................] - ETA: 0s - loss: 0.00234/8 [==============>...............] - ETA: 0s - loss: 0.00256/8 [=====================>........] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 18ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.00146/8 [=====================>........] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 11ms/step - loss: 0.0044
1/8 [==>...........................] - ETA: 0s - loss: 0.02164/8 [==============>...............] - ETA: 0s - loss: 0.01107/8 [=========================>....] - ETA: 0s - loss: 0.01168/8 [==============================] - 0s 17ms/step - loss: 0.0118
1/8 [==>...........................] - ETA: 0s - loss: 0.00875/8 [=================>............] - ETA: 0s - loss: 0.00618/8 [==============================] - ETA: 0s - loss: 0.00548/8 [==============================] - 0s 16ms/step - loss: 0.0054
1/8 [==>...........................] - ETA: 0s - loss: 8.1882e-044/8 [==============>...............] - ETA: 0s - loss: 9.6224e-047/8 [=========================>....] - ETA: 0s - loss: 8.8097e-048/8 [==============================] - 0s 16ms/step - loss: 8.7428e-04
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.004953902761917562:
Train Score: 0.00518 MSE 0.07194 RMSE
Test Score: 0.00276 MSE 0.05254 RMSE
Deviation Min [1.16385303e-05], Max [0.60902619]
Deviation 99.5th pctile [0.24188941]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1645,   11]))
Confusion matrix 
[[1640    5]
 [   7    4]]
precision 0.44444, recall 0.36364, f1 0.40000
Time to train: 430527 ms
Saving model models/A4Benchmark/A4Benchmark-TS48.csv.h5
Total Time to proces all the selected files : 433549 ms
A4Benchmark : Avg precision 0.44444 recall 0.36364 f1 0.40000 time to train 430527.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS48.csv  --epochs 20 --n_iter 3 --patience 3 :: took 459 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS49.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 08:29:48 PM MST
2020-11-30 20:30:02.760804: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 20:30:02.767527: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 20:30:02.768236: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5651128a88e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 20:30:02.768259: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 20:30:02.768369: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS49.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00323/8 [==========>...................] - ETA: 0s - loss: 0.00325/8 [=================>............] - ETA: 0s - loss: 0.00307/8 [=========================>....] - ETA: 0s - loss: 0.00308/8 [==============================] - 0s 31ms/step - loss: 0.0031
1/8 [==>...........................] - ETA: 0s - loss: 0.00163/8 [==========>...................] - ETA: 0s - loss: 0.00225/8 [=================>............] - ETA: 0s - loss: 0.00247/8 [=========================>....] - ETA: 0s - loss: 0.00248/8 [==============================] - 0s 26ms/step - loss: 0.0024
1/8 [==>...........................] - ETA: 0s - loss: 0.00203/8 [==========>...................] - ETA: 0s - loss: 0.00145/8 [=================>............] - ETA: 0s - loss: 0.00147/8 [=========================>....] - ETA: 0s - loss: 0.00148/8 [==============================] - 0s 27ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 9.0441e-043/8 [==========>...................] - ETA: 0s - loss: 0.0013    5/8 [=================>............] - ETA: 0s - loss: 0.00157/8 [=========================>....] - ETA: 0s - loss: 0.00178/8 [==============================] - 0s 26ms/step - loss: 0.0018
1/8 [==>...........................] - ETA: 0s - loss: 0.00323/8 [==========>...................] - ETA: 0s - loss: 0.00335/8 [=================>............] - ETA: 0s - loss: 0.00397/8 [=========================>....] - ETA: 0s - loss: 0.00478/8 [==============================] - 0s 39ms/step - loss: 0.0049
1/8 [==>...........................] - ETA: 0s - loss: 0.00205/8 [=================>............] - ETA: 0s - loss: 0.00218/8 [==============================] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 15ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.00164/8 [==============>...............] - ETA: 0s - loss: 0.00267/8 [=========================>....] - ETA: 0s - loss: 0.00288/8 [==============================] - 0s 15ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 0.00155/8 [=================>............] - ETA: 0s - loss: 8.0056e-048/8 [==============================] - 0s 12ms/step - loss: 7.6983e-04
1/8 [==>...........................] - ETA: 0s - loss: 5.3823e-045/8 [=================>............] - ETA: 0s - loss: 0.0010    8/8 [==============================] - 0s 13ms/step - loss: 0.0013
1/8 [==>...........................] - ETA: 0s - loss: 0.00206/8 [=====================>........] - ETA: 0s - loss: 0.00318/8 [==============================] - 0s 11ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.00155/8 [=================>............] - ETA: 0s - loss: 0.00178/8 [==============================] - 0s 14ms/step - loss: 0.0018
1/8 [==>...........................] - ETA: 0s - loss: 0.00184/8 [==============>...............] - ETA: 0s - loss: 0.00248/8 [==============================] - ETA: 0s - loss: 0.00258/8 [==============================] - 0s 16ms/step - loss: 0.0025
1/8 [==>...........................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 8.3602e-048/8 [==============================] - 0s 14ms/step - loss: 7.9761e-04
1/8 [==>...........................] - ETA: 0s - loss: 3.5952e-045/8 [=================>............] - ETA: 0s - loss: 4.2750e-048/8 [==============================] - 0s 12ms/step - loss: 5.1472e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00344/8 [==============>...............] - ETA: 0s - loss: 0.00368/8 [==============================] - ETA: 0s - loss: 0.00508/8 [==============================] - 0s 15ms/step - loss: 0.0050
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.00211202756036073:
Train Score: 0.00190 MSE 0.04357 RMSE
Test Score: 0.01184 MSE 0.10879 RMSE
Deviation Min [2.08469375e-05], Max [0.17226461]
Deviation 99.5th pctile [0.15950412]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Confusion matrix 
[[1638    9]
 [   9    0]]
precision 0.00000, recall 0.00000, f1 0.00000
Time to train: 261346 ms
Saving model models/A4Benchmark/A4Benchmark-TS49.csv.h5
Total Time to proces all the selected files : 264133 ms
A4Benchmark : Avg precision 0.00000 recall 0.00000 f1 0.00000 time to train 261346.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS49.csv  --epochs 20 --n_iter 3 --patience 3 :: took 279 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS4.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 08:34:32 PM MST
2020-11-30 20:34:45.547227: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 20:34:45.566189: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 20:34:45.567524: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55edac2b38e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 20:34:45.567565: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 20:34:45.567743: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS4.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00625/8 [=================>............] - ETA: 0s - loss: 0.00788/8 [==============================] - 0s 14ms/step - loss: 0.0079
1/8 [==>...........................] - ETA: 0s - loss: 0.00184/8 [==============>...............] - ETA: 0s - loss: 0.00268/8 [==============================] - ETA: 0s - loss: 0.00268/8 [==============================] - 0s 15ms/step - loss: 0.0026
1/8 [==>...........................] - ETA: 0s - loss: 0.00154/8 [==============>...............] - ETA: 0s - loss: 0.00167/8 [=========================>....] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 17ms/step - loss: 0.0018
1/8 [==>...........................] - ETA: 0s - loss: 9.2554e-045/8 [=================>............] - ETA: 0s - loss: 0.0011    8/8 [==============================] - 0s 14ms/step - loss: 0.0011
1/8 [==>...........................] - ETA: 0s - loss: 8.4144e-044/8 [==============>...............] - ETA: 0s - loss: 0.0019    7/8 [=========================>....] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 19ms/step - loss: 0.0018
1/8 [==>...........................] - ETA: 0s - loss: 0.00612/8 [======>.......................] - ETA: 0s - loss: 0.00744/8 [==============>...............] - ETA: 0s - loss: 0.00646/8 [=====================>........] - ETA: 0s - loss: 0.00687/8 [=========================>....] - ETA: 0s - loss: 0.00698/8 [==============================] - 0s 40ms/step - loss: 0.0070
1/8 [==>...........................] - ETA: 0s - loss: 0.00433/8 [==========>...................] - ETA: 0s - loss: 0.00505/8 [=================>............] - ETA: 0s - loss: 0.00507/8 [=========================>....] - ETA: 0s - loss: 0.00518/8 [==============================] - 0s 35ms/step - loss: 0.0052
1/8 [==>...........................] - ETA: 0s - loss: 0.00773/8 [==========>...................] - ETA: 0s - loss: 0.01035/8 [=================>............] - ETA: 0s - loss: 0.00967/8 [=========================>....] - ETA: 0s - loss: 0.01018/8 [==============================] - 0s 32ms/step - loss: 0.0107
1/8 [==>...........................] - ETA: 0s - loss: 0.00253/8 [==========>...................] - ETA: 0s - loss: 0.00175/8 [=================>............] - ETA: 0s - loss: 0.00266/8 [=====================>........] - ETA: 0s - loss: 0.00308/8 [==============================] - ETA: 0s - loss: 0.00268/8 [==============================] - 0s 41ms/step - loss: 0.0026
1/8 [==>...........................] - ETA: 0s - loss: 8.5834e-043/8 [==========>...................] - ETA: 0s - loss: 0.0029    5/8 [=================>............] - ETA: 0s - loss: 0.00277/8 [=========================>....] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 33ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.00873/8 [==========>...................] - ETA: 0s - loss: 0.01015/8 [=================>............] - ETA: 0s - loss: 0.01117/8 [=========================>....] - ETA: 0s - loss: 0.01038/8 [==============================] - 0s 38ms/step - loss: 0.0104
1/8 [==>...........................] - ETA: 0s - loss: 0.00683/8 [==========>...................] - ETA: 0s - loss: 0.00865/8 [=================>............] - ETA: 0s - loss: 0.00957/8 [=========================>....] - ETA: 0s - loss: 0.00968/8 [==============================] - 0s 34ms/step - loss: 0.0098
1/8 [==>...........................] - ETA: 0s - loss: 0.00393/8 [==========>...................] - ETA: 0s - loss: 0.00555/8 [=================>............] - ETA: 0s - loss: 0.00387/8 [=========================>....] - ETA: 0s - loss: 0.00448/8 [==============================] - 0s 34ms/step - loss: 0.0046
1/8 [==>...........................] - ETA: 0s - loss: 8.5591e-043/8 [==========>...................] - ETA: 0s - loss: 0.0015    5/8 [=================>............] - ETA: 0s - loss: 0.00147/8 [=========================>....] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 26ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 0.00113/8 [==========>...................] - ETA: 0s - loss: 0.00225/8 [=================>............] - ETA: 0s - loss: 0.00247/8 [=========================>....] - ETA: 0s - loss: 0.00208/8 [==============================] - 0s 32ms/step - loss: 0.0020
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0030498500680550935:
Train Score: 0.00172 MSE 0.04149 RMSE
Test Score: 0.00407 MSE 0.06379 RMSE
Deviation Min [6.7872377e-05], Max [0.29848736]
Deviation 99.5th pctile [0.19847635]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1650,    6]))
Confusion matrix 
[[1646    4]
 [   1    5]]
precision 0.55556, recall 0.83333, f1 0.66667
Time to train: 700626 ms
Saving model models/A4Benchmark/A4Benchmark-TS4.csv.h5
Total Time to proces all the selected files : 703277 ms
A4Benchmark : Avg precision 0.55556 recall 0.83333 f1 0.66667 time to train 700626.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS4.csv  --epochs 20 --n_iter 3 --patience 3 :: took 717 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS50.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 08:46:34 PM MST
2020-11-30 20:46:46.556055: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 20:46:46.574189: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 20:46:46.574957: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5600af86c310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 20:46:46.574983: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 20:46:46.575090: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS50.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 1.5233e-046/8 [=====================>........] - ETA: 0s - loss: 1.9671e-048/8 [==============================] - 0s 10ms/step - loss: 1.9491e-04
1/8 [==>...........................] - ETA: 0s - loss: 1.8588e-045/8 [=================>............] - ETA: 0s - loss: 0.0011    8/8 [==============================] - 0s 13ms/step - loss: 0.0018
1/8 [==>...........................] - ETA: 0s - loss: 0.00414/8 [==============>...............] - ETA: 0s - loss: 0.00467/8 [=========================>....] - ETA: 0s - loss: 0.00468/8 [==============================] - 0s 16ms/step - loss: 0.0045
1/8 [==>...........................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 12ms/step - loss: 0.0093
1/8 [==>...........................] - ETA: 0s - loss: 0.02504/8 [==============>...............] - ETA: 0s - loss: 0.02557/8 [=========================>....] - ETA: 0s - loss: 0.02278/8 [==============================] - 0s 17ms/step - loss: 0.0224
1/8 [==>...........................] - ETA: 0s - loss: 5.6657e-045/8 [=================>............] - ETA: 0s - loss: 6.8887e-048/8 [==============================] - 0s 12ms/step - loss: 6.6008e-04
1/8 [==>...........................] - ETA: 0s - loss: 2.8062e-045/8 [=================>............] - ETA: 0s - loss: 0.0013    7/8 [=========================>....] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 20ms/step - loss: 0.0020
1/8 [==>...........................] - ETA: 0s - loss: 0.00275/8 [=================>............] - ETA: 0s - loss: 0.00308/8 [==============================] - ETA: 0s - loss: 0.00288/8 [==============================] - 0s 15ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 8.3062e-044/8 [==============>...............] - ETA: 0s - loss: 8.5800e-047/8 [=========================>....] - ETA: 0s - loss: 0.0076    8/8 [==============================] - 0s 18ms/step - loss: 0.0086
1/8 [==>...........................] - ETA: 0s - loss: 0.02475/8 [=================>............] - ETA: 0s - loss: 0.02348/8 [==============================] - 0s 13ms/step - loss: 0.0216
1/8 [==>...........................] - ETA: 0s - loss: 1.4971e-044/8 [==============>...............] - ETA: 0s - loss: 1.8833e-047/8 [=========================>....] - ETA: 0s - loss: 1.9289e-048/8 [==============================] - 0s 15ms/step - loss: 1.9470e-04
1/8 [==>...........................] - ETA: 0s - loss: 1.8566e-044/8 [==============>...............] - ETA: 0s - loss: 4.6230e-047/8 [=========================>....] - ETA: 0s - loss: 0.0017    8/8 [==============================] - 0s 18ms/step - loss: 0.0019
1/8 [==>...........................] - ETA: 0s - loss: 0.00414/8 [==============>...............] - ETA: 0s - loss: 0.00457/8 [=========================>....] - ETA: 0s - loss: 0.00448/8 [==============================] - 0s 18ms/step - loss: 0.0043
1/8 [==>...........................] - ETA: 0s - loss: 8.1409e-045/8 [=================>............] - ETA: 0s - loss: 0.0030    8/8 [==============================] - 0s 14ms/step - loss: 0.0083
1/8 [==>...........................] - ETA: 0s - loss: 0.02474/8 [==============>...............] - ETA: 0s - loss: 0.02517/8 [=========================>....] - ETA: 0s - loss: 0.02238/8 [==============================] - 0s 19ms/step - loss: 0.0221
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.007130620046518743:
Train Score: 0.00648 MSE 0.08050 RMSE
Test Score: 0.00061 MSE 0.02465 RMSE
Deviation Min [6.60858113e-06], Max [0.65676636]
Deviation 99.5th pctile [0.28649064]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1649,    7]))
Confusion matrix 
[[1643    6]
 [   4    3]]
precision 0.33333, recall 0.42857, f1 0.37500
Time to train: 187605 ms
Saving model models/A4Benchmark/A4Benchmark-TS50.csv.h5
Total Time to proces all the selected files : 189896 ms
A4Benchmark : Avg precision 0.33333 recall 0.42857 f1 0.37500 time to train 187605.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS50.csv  --epochs 20 --n_iter 3 --patience 3 :: took 202 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS51.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 08:50:01 PM MST
2020-11-30 20:50:09.270582: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 20:50:09.289245: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 20:50:09.290793: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55a446623310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 20:50:09.290840: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 20:50:09.291061: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS51.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00914/8 [==============>...............] - ETA: 0s - loss: 0.00637/8 [=========================>....] - ETA: 0s - loss: 0.00628/8 [==============================] - 0s 16ms/step - loss: 0.0060
1/8 [==>...........................] - ETA: 0s - loss: 0.00415/8 [=================>............] - ETA: 0s - loss: 0.00258/8 [==============================] - ETA: 0s - loss: 0.00198/8 [==============================] - 0s 17ms/step - loss: 0.0019
1/8 [==>...........................] - ETA: 0s - loss: 8.1053e-045/8 [=================>............] - ETA: 0s - loss: 8.5665e-048/8 [==============================] - 0s 13ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 9.9274e-044/8 [==============>...............] - ETA: 0s - loss: 0.0011    7/8 [=========================>....] - ETA: 0s - loss: 9.1469e-048/8 [==============================] - 0s 17ms/step - loss: 9.3646e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00115/8 [=================>............] - ETA: 0s - loss: 0.00108/8 [==============================] - 0s 14ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 0.03503/8 [==========>...................] - ETA: 0s - loss: 0.04045/8 [=================>............] - ETA: 0s - loss: 0.03957/8 [=========================>....] - ETA: 0s - loss: 0.03928/8 [==============================] - 0s 33ms/step - loss: 0.0401
1/8 [==>...........................] - ETA: 0s - loss: 0.00602/8 [======>.......................] - ETA: 0s - loss: 0.00705/8 [=================>............] - ETA: 0s - loss: 0.00327/8 [=========================>....] - ETA: 0s - loss: 0.00298/8 [==============================] - ETA: 0s - loss: 0.00288/8 [==============================] - 0s 47ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 0.00143/8 [==========>...................] - ETA: 0s - loss: 0.00185/8 [=================>............] - ETA: 0s - loss: 0.00146/8 [=====================>........] - ETA: 0s - loss: 0.00148/8 [==============================] - ETA: 0s - loss: 0.00178/8 [==============================] - 0s 43ms/step - loss: 0.0017
1/8 [==>...........................] - ETA: 0s - loss: 0.00173/8 [==========>...................] - ETA: 0s - loss: 0.00345/8 [=================>............] - ETA: 0s - loss: 0.00277/8 [=========================>....] - ETA: 0s - loss: 0.00258/8 [==============================] - 0s 26ms/step - loss: 0.0027
1/8 [==>...........................] - ETA: 0s - loss: 0.00153/8 [==========>...................] - ETA: 0s - loss: 0.00135/8 [=================>............] - ETA: 0s - loss: 0.00147/8 [=========================>....] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 30ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 0.03413/8 [==========>...................] - ETA: 0s - loss: 0.03985/8 [=================>............] - ETA: 0s - loss: 0.03907/8 [=========================>....] - ETA: 0s - loss: 0.03878/8 [==============================] - 0s 33ms/step - loss: 0.0397
1/8 [==>...........................] - ETA: 0s - loss: 0.00823/8 [==========>...................] - ETA: 0s - loss: 0.00765/8 [=================>............] - ETA: 0s - loss: 0.00537/8 [=========================>....] - ETA: 0s - loss: 0.00418/8 [==============================] - 0s 30ms/step - loss: 0.0039
1/8 [==>...........................] - ETA: 0s - loss: 0.00153/8 [==========>...................] - ETA: 0s - loss: 0.00215/8 [=================>............] - ETA: 0s - loss: 0.00157/8 [=========================>....] - ETA: 0s - loss: 0.00178/8 [==============================] - 0s 35ms/step - loss: 0.0019
1/8 [==>...........................] - ETA: 0s - loss: 0.00132/8 [======>.......................] - ETA: 0s - loss: 0.00133/8 [==========>...................] - ETA: 0s - loss: 0.00125/8 [=================>............] - ETA: 0s - loss: 0.00107/8 [=========================>....] - ETA: 0s - loss: 9.4127e-048/8 [==============================] - 0s 33ms/step - loss: 9.5718e-04
1/8 [==>...........................] - ETA: 0s - loss: 9.8513e-042/8 [======>.......................] - ETA: 0s - loss: 0.0011    3/8 [==========>...................] - ETA: 0s - loss: 0.00194/8 [==============>...............] - ETA: 0s - loss: 0.00195/8 [=================>............] - ETA: 0s - loss: 0.00186/8 [=====================>........] - ETA: 0s - loss: 0.00187/8 [=========================>....] - ETA: 0s - loss: 0.00178/8 [==============================] - ETA: 0s - loss: 0.00178/8 [==============================] - 1s 75ms/step - loss: 0.0017
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0022536240285262465:
Train Score: 0.00194 MSE 0.04399 RMSE
Test Score: 0.00187 MSE 0.04320 RMSE
Deviation Min [1.51333e-05], Max [0.2146412]
Deviation 99.5th pctile [0.13900161]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1655,    1]))
Confusion matrix 
[[1647    8]
 [   0    1]]
precision 0.11111, recall 1.00000, f1 0.20000
Time to train: 787589 ms
Saving model models/A4Benchmark/A4Benchmark-TS51.csv.h5
Total Time to proces all the selected files : 790085 ms
A4Benchmark : Avg precision 0.11111 recall 1.00000 f1 0.20000 time to train 787589.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS51.csv  --epochs 20 --n_iter 3 --patience 3 :: took 798 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS52.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 09:03:24 PM MST
2020-11-30 21:03:31.468681: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 21:03:31.487195: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 21:03:31.488075: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d2662588e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 21:03:31.488103: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 21:03:31.488213: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS52.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.01123/8 [==========>...................] - ETA: 0s - loss: 0.00806/8 [=====================>........] - ETA: 0s - loss: 0.00818/8 [==============================] - ETA: 0s - loss: 0.00828/8 [==============================] - 0s 22ms/step - loss: 0.0082
1/8 [==>...........................] - ETA: 0s - loss: 0.00242/8 [======>.......................] - ETA: 0s - loss: 0.00264/8 [==============>...............] - ETA: 0s - loss: 0.00266/8 [=====================>........] - ETA: 0s - loss: 0.00288/8 [==============================] - ETA: 0s - loss: 0.00288/8 [==============================] - 0s 28ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 0.00153/8 [==========>...................] - ETA: 0s - loss: 0.00455/8 [=================>............] - ETA: 0s - loss: 0.00377/8 [=========================>....] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 32ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.00503/8 [==========>...................] - ETA: 0s - loss: 0.00545/8 [=================>............] - ETA: 0s - loss: 0.00597/8 [=========================>....] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 24ms/step - loss: 0.0060
1/8 [==>...........................] - ETA: 0s - loss: 0.00373/8 [==========>...................] - ETA: 0s - loss: 0.00315/8 [=================>............] - ETA: 0s - loss: 0.00347/8 [=========================>....] - ETA: 0s - loss: 0.00348/8 [==============================] - 0s 25ms/step - loss: 0.0034
1/8 [==>...........................] - ETA: 0s - loss: 0.00463/8 [==========>...................] - ETA: 0s - loss: 0.00275/8 [=================>............] - ETA: 0s - loss: 0.00237/8 [=========================>....] - ETA: 0s - loss: 0.00308/8 [==============================] - 0s 32ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00223/8 [==========>...................] - ETA: 0s - loss: 0.00205/8 [=================>............] - ETA: 0s - loss: 0.00437/8 [=========================>....] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 33ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.00253/8 [==========>...................] - ETA: 0s - loss: 0.00555/8 [=================>............] - ETA: 0s - loss: 0.00517/8 [=========================>....] - ETA: 0s - loss: 0.00508/8 [==============================] - 0s 26ms/step - loss: 0.0049
1/8 [==>...........................] - ETA: 0s - loss: 0.00883/8 [==========>...................] - ETA: 0s - loss: 0.01115/8 [=================>............] - ETA: 0s - loss: 0.01097/8 [=========================>....] - ETA: 0s - loss: 0.01098/8 [==============================] - 0s 26ms/step - loss: 0.0113
1/8 [==>...........................] - ETA: 0s - loss: 0.01512/8 [======>.......................] - ETA: 0s - loss: 0.01643/8 [==========>...................] - ETA: 0s - loss: 0.01904/8 [==============>...............] - ETA: 0s - loss: 0.01896/8 [=====================>........] - ETA: 0s - loss: 0.01867/8 [=========================>....] - ETA: 0s - loss: 0.01828/8 [==============================] - ETA: 0s - loss: 0.01838/8 [==============================] - 1s 63ms/step - loss: 0.0183
1/8 [==>...........................] - ETA: 0s - loss: 0.00525/8 [=================>............] - ETA: 0s - loss: 0.00418/8 [==============================] - 0s 13ms/step - loss: 0.0046
1/8 [==>...........................] - ETA: 0s - loss: 0.00265/8 [=================>............] - ETA: 0s - loss: 0.00378/8 [==============================] - ETA: 0s - loss: 0.00378/8 [==============================] - 0s 15ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.00317/8 [=========================>....] - ETA: 0s - loss: 0.00528/8 [==============================] - 0s 8ms/step - loss: 0.0051
1/8 [==>...........................] - ETA: 0s - loss: 0.00445/8 [=================>............] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 13ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.00245/8 [=================>............] - ETA: 0s - loss: 0.00348/8 [==============================] - 0s 13ms/step - loss: 0.0033
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.004070053994655609:
Train Score: 0.00315 MSE 0.05615 RMSE
Test Score: 0.00320 MSE 0.05652 RMSE
Deviation Min [5.20043404e-05], Max [0.37058858]
Deviation 99.5th pctile [0.25308086]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1645,   11]))
Confusion matrix 
[[1645    0]
 [   2    9]]
precision 1.00000, recall 0.81818, f1 0.90000
Time to train: 664970 ms
Saving model models/A4Benchmark/A4Benchmark-TS52.csv.h5
Total Time to proces all the selected files : 667354 ms
A4Benchmark : Avg precision 1.00000 recall 0.81818 f1 0.90000 time to train 664970.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS52.csv  --epochs 20 --n_iter 3 --patience 3 :: took 675 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS53.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 09:14:44 PM MST
2020-11-30 21:14:51.506310: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 21:14:51.525253: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 21:14:51.526715: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5568b51b6310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 21:14:51.526755: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 21:14:51.526917: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS53.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.01113/8 [==========>...................] - ETA: 0s - loss: 0.01275/8 [=================>............] - ETA: 0s - loss: 0.01307/8 [=========================>....] - ETA: 0s - loss: 0.01278/8 [==============================] - 0s 32ms/step - loss: 0.0131
1/8 [==>...........................] - ETA: 0s - loss: 0.01043/8 [==========>...................] - ETA: 0s - loss: 0.01315/8 [=================>............] - ETA: 0s - loss: 0.01337/8 [=========================>....] - ETA: 0s - loss: 0.01388/8 [==============================] - 0s 25ms/step - loss: 0.0142
1/8 [==>...........................] - ETA: 0s - loss: 0.01143/8 [==========>...................] - ETA: 0s - loss: 0.01535/8 [=================>............] - ETA: 0s - loss: 0.01397/8 [=========================>....] - ETA: 0s - loss: 0.01428/8 [==============================] - 0s 28ms/step - loss: 0.0149
1/8 [==>...........................] - ETA: 0s - loss: 0.00163/8 [==========>...................] - ETA: 0s - loss: 0.00195/8 [=================>............] - ETA: 0s - loss: 0.00257/8 [=========================>....] - ETA: 0s - loss: 0.00268/8 [==============================] - 0s 33ms/step - loss: 0.0026
1/8 [==>...........................] - ETA: 0s - loss: 0.00323/8 [==========>...................] - ETA: 0s - loss: 0.00185/8 [=================>............] - ETA: 0s - loss: 0.00227/8 [=========================>....] - ETA: 0s - loss: 0.00338/8 [==============================] - 0s 31ms/step - loss: 0.0033
1/8 [==>...........................] - ETA: 0s - loss: 0.00305/8 [=================>............] - ETA: 0s - loss: 0.00268/8 [==============================] - ETA: 0s - loss: 0.00278/8 [==============================] - 0s 16ms/step - loss: 0.0027
1/8 [==>...........................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 12ms/step - loss: 0.0024
1/8 [==>...........................] - ETA: 0s - loss: 0.00235/8 [=================>............] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 13ms/step - loss: 0.0024
1/8 [==>...........................] - ETA: 0s - loss: 0.00875/8 [=================>............] - ETA: 0s - loss: 0.01168/8 [==============================] - 0s 14ms/step - loss: 0.0121
1/8 [==>...........................] - ETA: 0s - loss: 0.00115/8 [=================>............] - ETA: 0s - loss: 0.00208/8 [==============================] - 0s 13ms/step - loss: 0.0025
1/8 [==>...........................] - ETA: 0s - loss: 0.00354/8 [==============>...............] - ETA: 0s - loss: 0.00307/8 [=========================>....] - ETA: 0s - loss: 0.00328/8 [==============================] - 0s 18ms/step - loss: 0.0032
1/8 [==>...........................] - ETA: 0s - loss: 7.7418e-044/8 [==============>...............] - ETA: 0s - loss: 0.0013    7/8 [=========================>....] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 17ms/step - loss: 0.0017
1/8 [==>...........................] - ETA: 0s - loss: 0.01055/8 [=================>............] - ETA: 0s - loss: 0.01298/8 [==============================] - 0s 13ms/step - loss: 0.0139
1/8 [==>...........................] - ETA: 0s - loss: 0.00264/8 [==============>...............] - ETA: 0s - loss: 0.00257/8 [=========================>....] - ETA: 0s - loss: 0.00268/8 [==============================] - 0s 17ms/step - loss: 0.0025
1/8 [==>...........................] - ETA: 0s - loss: 0.00105/8 [=================>............] - ETA: 0s - loss: 0.00148/8 [==============================] - 0s 14ms/step - loss: 0.0019
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.0044497974216938015:
Train Score: 0.00222 MSE 0.04710 RMSE
Test Score: 0.01137 MSE 0.10661 RMSE
Deviation Min [1.76070427e-05], Max [0.32500942]
Deviation 99.5th pctile [0.24215037]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1654,    2]))
Confusion matrix 
[[1647    7]
 [   0    2]]
precision 0.22222, recall 1.00000, f1 0.36364
Time to train: 521854 ms
Saving model models/A4Benchmark/A4Benchmark-TS53.csv.h5
Total Time to proces all the selected files : 524121 ms
A4Benchmark : Avg precision 0.22222 recall 1.00000 f1 0.36364 time to train 521854.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS53.csv  --epochs 20 --n_iter 3 --patience 3 :: took 532 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS54.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 09:23:41 PM MST
2020-11-30 21:23:47.395879: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 21:23:47.414231: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 21:23:47.415100: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5599a75d68e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 21:23:47.415127: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 21:23:47.415236: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS54.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00623/8 [==========>...................] - ETA: 0s - loss: 0.00595/8 [=================>............] - ETA: 0s - loss: 0.00667/8 [=========================>....] - ETA: 0s - loss: 0.00598/8 [==============================] - 0s 28ms/step - loss: 0.0059
1/8 [==>...........................] - ETA: 0s - loss: 0.00353/8 [==========>...................] - ETA: 0s - loss: 0.00465/8 [=================>............] - ETA: 0s - loss: 0.00527/8 [=========================>....] - ETA: 0s - loss: 0.00538/8 [==============================] - 0s 28ms/step - loss: 0.0055
1/8 [==>...........................] - ETA: 0s - loss: 0.00143/8 [==========>...................] - ETA: 0s - loss: 0.00195/8 [=================>............] - ETA: 0s - loss: 0.00157/8 [=========================>....] - ETA: 0s - loss: 0.00168/8 [==============================] - 0s 32ms/step - loss: 0.0018
1/8 [==>...........................] - ETA: 0s - loss: 0.00363/8 [==========>...................] - ETA: 0s - loss: 0.00475/8 [=================>............] - ETA: 0s - loss: 0.00477/8 [=========================>....] - ETA: 0s - loss: 0.00498/8 [==============================] - 0s 26ms/step - loss: 0.0051
1/8 [==>...........................] - ETA: 0s - loss: 0.00243/8 [==========>...................] - ETA: 0s - loss: 0.00125/8 [=================>............] - ETA: 0s - loss: 0.00147/8 [=========================>....] - ETA: 0s - loss: 0.00168/8 [==============================] - 0s 23ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 0.00475/8 [=================>............] - ETA: 0s - loss: 0.00498/8 [==============================] - 0s 14ms/step - loss: 0.0044
1/8 [==>...........................] - ETA: 0s - loss: 6.8323e-044/8 [==============>...............] - ETA: 0s - loss: 0.0013    7/8 [=========================>....] - ETA: 0s - loss: 0.00128/8 [==============================] - 0s 16ms/step - loss: 0.0011
1/8 [==>...........................] - ETA: 0s - loss: 0.00395/8 [=================>............] - ETA: 0s - loss: 0.00408/8 [==============================] - 0s 14ms/step - loss: 0.0047
1/8 [==>...........................] - ETA: 0s - loss: 0.00314/8 [==============>...............] - ETA: 0s - loss: 0.00407/8 [=========================>....] - ETA: 0s - loss: 0.00428/8 [==============================] - 0s 17ms/step - loss: 0.0043
1/8 [==>...........................] - ETA: 0s - loss: 5.2954e-045/8 [=================>............] - ETA: 0s - loss: 0.0011    8/8 [==============================] - 0s 13ms/step - loss: 0.0010
1/8 [==>...........................] - ETA: 0s - loss: 0.00453/8 [==========>...................] - ETA: 0s - loss: 0.00485/8 [=================>............] - ETA: 0s - loss: 0.00527/8 [=========================>....] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 27ms/step - loss: 0.0049
1/8 [==>...........................] - ETA: 0s - loss: 0.00383/8 [==========>...................] - ETA: 0s - loss: 0.00495/8 [=================>............] - ETA: 0s - loss: 0.00497/8 [=========================>....] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 34ms/step - loss: 0.0049
1/8 [==>...........................] - ETA: 0s - loss: 0.00463/8 [==========>...................] - ETA: 0s - loss: 0.00505/8 [=================>............] - ETA: 0s - loss: 0.00467/8 [=========================>....] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 28ms/step - loss: 0.0051
1/8 [==>...........................] - ETA: 0s - loss: 0.00492/8 [======>.......................] - ETA: 0s - loss: 0.00494/8 [==============>...............] - ETA: 0s - loss: 0.00586/8 [=====================>........] - ETA: 0s - loss: 0.00678/8 [==============================] - ETA: 0s - loss: 0.00658/8 [==============================] - 0s 30ms/step - loss: 0.0065
1/8 [==>...........................] - ETA: 0s - loss: 0.00193/8 [==========>...................] - ETA: 0s - loss: 0.00235/8 [=================>............] - ETA: 0s - loss: 0.00227/8 [=========================>....] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 30ms/step - loss: 0.0023
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0031146575463935735:
Train Score: 0.00418 MSE 0.06467 RMSE
Test Score: 0.00417 MSE 0.06457 RMSE
Deviation Min [0.00010304], Max [0.22189201]
Deviation 99.5th pctile [0.14726348]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1653,    3]))
Confusion matrix 
[[1646    7]
 [   1    2]]
precision 0.22222, recall 0.66667, f1 0.33333
Time to train: 497901 ms
Saving model models/A4Benchmark/A4Benchmark-TS54.csv.h5
Total Time to proces all the selected files : 500248 ms
A4Benchmark : Avg precision 0.22222 recall 0.66667 f1 0.33333 time to train 497901.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS54.csv  --epochs 20 --n_iter 3 --patience 3 :: took 507 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS55.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 09:32:13 PM MST
2020-11-30 21:32:21.163891: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 21:32:21.182232: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 21:32:21.183086: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f6535528e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 21:32:21.183113: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 21:32:21.183225: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS55.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.01105/8 [=================>............] - ETA: 0s - loss: 0.00938/8 [==============================] - 0s 12ms/step - loss: 0.0085
1/8 [==>...........................] - ETA: 0s - loss: 0.00434/8 [==============>...............] - ETA: 0s - loss: 0.00367/8 [=========================>....] - ETA: 0s - loss: 0.00358/8 [==============================] - 0s 17ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.00484/8 [==============>...............] - ETA: 0s - loss: 0.00687/8 [=========================>....] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 16ms/step - loss: 0.0055
1/8 [==>...........................] - ETA: 0s - loss: 0.00115/8 [=================>............] - ETA: 0s - loss: 0.00118/8 [==============================] - 0s 12ms/step - loss: 0.0010
1/8 [==>...........................] - ETA: 0s - loss: 2.7281e-044/8 [==============>...............] - ETA: 0s - loss: 5.4043e-048/8 [==============================] - ETA: 0s - loss: 7.5075e-048/8 [==============================] - 0s 14ms/step - loss: 7.5075e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.02554/8 [==============>...............] - ETA: 0s - loss: 0.03067/8 [=========================>....] - ETA: 0s - loss: 0.03298/8 [==============================] - 0s 19ms/step - loss: 0.0340
1/8 [==>...........................] - ETA: 0s - loss: 0.00364/8 [==============>...............] - ETA: 0s - loss: 0.00357/8 [=========================>....] - ETA: 0s - loss: 0.00348/8 [==============================] - 0s 18ms/step - loss: 0.0033
1/8 [==>...........................] - ETA: 0s - loss: 0.02176/8 [=====================>........] - ETA: 0s - loss: 0.03148/8 [==============================] - 0s 12ms/step - loss: 0.0287
1/8 [==>...........................] - ETA: 0s - loss: 0.01214/8 [==============>...............] - ETA: 0s - loss: 0.00967/8 [=========================>....] - ETA: 0s - loss: 0.00868/8 [==============================] - 0s 19ms/step - loss: 0.0086
1/8 [==>...........................] - ETA: 0s - loss: 0.00195/8 [=================>............] - ETA: 0s - loss: 0.00408/8 [==============================] - 0s 14ms/step - loss: 0.0042
1/8 [==>...........................] - ETA: 0s - loss: 0.02593/8 [==========>...................] - ETA: 0s - loss: 0.03115/8 [=================>............] - ETA: 0s - loss: 0.03207/8 [=========================>....] - ETA: 0s - loss: 0.03188/8 [==============================] - 0s 26ms/step - loss: 0.0325
1/8 [==>...........................] - ETA: 0s - loss: 0.02023/8 [==========>...................] - ETA: 0s - loss: 0.02505/8 [=================>............] - ETA: 0s - loss: 0.02537/8 [=========================>....] - ETA: 0s - loss: 0.02418/8 [==============================] - 0s 36ms/step - loss: 0.0245
1/8 [==>...........................] - ETA: 0s - loss: 0.01903/8 [==========>...................] - ETA: 0s - loss: 0.03055/8 [=================>............] - ETA: 0s - loss: 0.02927/8 [=========================>....] - ETA: 0s - loss: 0.02678/8 [==============================] - 0s 33ms/step - loss: 0.0258
1/8 [==>...........................] - ETA: 0s - loss: 0.00193/8 [==========>...................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00197/8 [=========================>....] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 37ms/step - loss: 0.0020
1/8 [==>...........................] - ETA: 0s - loss: 6.2421e-043/8 [==========>...................] - ETA: 0s - loss: 0.0015    5/8 [=================>............] - ETA: 0s - loss: 0.00177/8 [=========================>....] - ETA: 0s - loss: 0.00178/8 [==============================] - 0s 27ms/step - loss: 0.0018
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.003848376905079931:
Train Score: 0.00783 MSE 0.08846 RMSE
Test Score: 0.00654 MSE 0.08085 RMSE
Deviation Min [8.15092813e-06], Max [0.45543712]
Deviation 99.5th pctile [0.28046153]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1654,    2]))
Confusion matrix 
[[1646    8]
 [   1    1]]
precision 0.11111, recall 0.50000, f1 0.18182
Time to train: 487173 ms
Saving model models/A4Benchmark/A4Benchmark-TS55.csv.h5
Total Time to proces all the selected files : 489421 ms
A4Benchmark : Avg precision 0.11111 recall 0.50000 f1 0.18182 time to train 487173.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS55.csv  --epochs 20 --n_iter 3 --patience 3 :: took 497 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS56.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 09:40:35 PM MST
2020-11-30 21:40:45.656219: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 21:40:45.675230: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 21:40:45.676111: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56340ebab310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 21:40:45.676140: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 21:40:45.676254: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS56.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00433/8 [==========>...................] - ETA: 0s - loss: 0.00425/8 [=================>............] - ETA: 0s - loss: 0.00517/8 [=========================>....] - ETA: 0s - loss: 0.00508/8 [==============================] - 0s 29ms/step - loss: 0.0050
1/8 [==>...........................] - ETA: 0s - loss: 0.00723/8 [==========>...................] - ETA: 0s - loss: 0.01684/8 [==============>...............] - ETA: 0s - loss: 0.01606/8 [=====================>........] - ETA: 0s - loss: 0.01628/8 [==============================] - ETA: 0s - loss: 0.01758/8 [==============================] - 0s 36ms/step - loss: 0.0175
1/8 [==>...........................] - ETA: 0s - loss: 0.01503/8 [==========>...................] - ETA: 0s - loss: 0.01925/8 [=================>............] - ETA: 0s - loss: 0.01787/8 [=========================>....] - ETA: 0s - loss: 0.01688/8 [==============================] - 0s 29ms/step - loss: 0.0168
1/8 [==>...........................] - ETA: 0s - loss: 0.00823/8 [==========>...................] - ETA: 0s - loss: 0.00775/8 [=================>............] - ETA: 0s - loss: 0.00797/8 [=========================>....] - ETA: 0s - loss: 0.00858/8 [==============================] - 0s 28ms/step - loss: 0.0086
1/8 [==>...........................] - ETA: 0s - loss: 0.00233/8 [==========>...................] - ETA: 0s - loss: 0.00295/8 [=================>............] - ETA: 0s - loss: 0.00307/8 [=========================>....] - ETA: 0s - loss: 0.00468/8 [==============================] - 0s 39ms/step - loss: 0.0049
1/8 [==>...........................] - ETA: 0s - loss: 0.00254/8 [==============>...............] - ETA: 0s - loss: 0.00218/8 [==============================] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 15ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.00585/8 [=================>............] - ETA: 0s - loss: 0.01358/8 [==============================] - 0s 13ms/step - loss: 0.0147
1/8 [==>...........................] - ETA: 0s - loss: 0.01334/8 [==============>...............] - ETA: 0s - loss: 0.01397/8 [=========================>....] - ETA: 0s - loss: 0.01298/8 [==============================] - 0s 18ms/step - loss: 0.0127
1/8 [==>...........................] - ETA: 0s - loss: 0.00284/8 [==============>...............] - ETA: 0s - loss: 0.00207/8 [=========================>....] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 17ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.00124/8 [==============>...............] - ETA: 0s - loss: 6.9850e-047/8 [=========================>....] - ETA: 0s - loss: 0.0013    8/8 [==============================] - 0s 15ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 0.00443/8 [==========>...................] - ETA: 0s - loss: 0.00445/8 [=================>............] - ETA: 0s - loss: 0.00507/8 [=========================>....] - ETA: 0s - loss: 0.00498/8 [==============================] - ETA: 0s - loss: 0.00498/8 [==============================] - 0s 30ms/step - loss: 0.0049
1/8 [==>...........................] - ETA: 0s - loss: 0.00513/8 [==========>...................] - ETA: 0s - loss: 0.01465/8 [=================>............] - ETA: 0s - loss: 0.01497/8 [=========================>....] - ETA: 0s - loss: 0.01508/8 [==============================] - 0s 27ms/step - loss: 0.0165
1/8 [==>...........................] - ETA: 0s - loss: 0.01543/8 [==========>...................] - ETA: 0s - loss: 0.01805/8 [=================>............] - ETA: 0s - loss: 0.01777/8 [=========================>....] - ETA: 0s - loss: 0.01628/8 [==============================] - 0s 30ms/step - loss: 0.0160
1/8 [==>...........................] - ETA: 0s - loss: 0.00253/8 [==========>...................] - ETA: 0s - loss: 0.00225/8 [=================>............] - ETA: 0s - loss: 0.00257/8 [=========================>....] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 23ms/step - loss: 0.0024
1/8 [==>...........................] - ETA: 0s - loss: 0.00293/8 [==========>...................] - ETA: 0s - loss: 0.00365/8 [=================>............] - ETA: 0s - loss: 0.00367/8 [=========================>....] - ETA: 0s - loss: 0.00528/8 [==============================] - 0s 26ms/step - loss: 0.0055
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.006603113608434796:
Train Score: 0.00860 MSE 0.09273 RMSE
Test Score: 0.00802 MSE 0.08954 RMSE
Deviation Min [5.66506414e-06], Max [0.41730633]
Deviation 99.5th pctile [0.25421463]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1640,   16]))
Confusion matrix 
[[1634    6]
 [  13    3]]
precision 0.33333, recall 0.18750, f1 0.24000
Time to train: 344316 ms
Saving model models/A4Benchmark/A4Benchmark-TS56.csv.h5
Total Time to proces all the selected files : 346958 ms
A4Benchmark : Avg precision 0.33333 recall 0.18750 f1 0.24000 time to train 344316.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS56.csv  --epochs 20 --n_iter 3 --patience 3 :: took 358 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS57.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 09:46:38 PM MST
2020-11-30 21:46:47.120200: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 21:46:47.139180: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 21:46:47.140477: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x563a2da71c00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 21:46:47.140520: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 21:46:47.140689: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS57.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.01023/8 [==========>...................] - ETA: 0s - loss: 0.00705/8 [=================>............] - ETA: 0s - loss: 0.00767/8 [=========================>....] - ETA: 0s - loss: 0.00668/8 [==============================] - 0s 25ms/step - loss: 0.0062
1/8 [==>...........................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00195/8 [=================>............] - ETA: 0s - loss: 0.00957/8 [=========================>....] - ETA: 0s - loss: 0.01428/8 [==============================] - 0s 30ms/step - loss: 0.0156
1/8 [==>...........................] - ETA: 0s - loss: 0.00813/8 [==========>...................] - ETA: 0s - loss: 0.01085/8 [=================>............] - ETA: 0s - loss: 0.00767/8 [=========================>....] - ETA: 0s - loss: 0.00748/8 [==============================] - 0s 25ms/step - loss: 0.0074
1/8 [==>...........................] - ETA: 0s - loss: 0.01963/8 [==========>...................] - ETA: 0s - loss: 0.02125/8 [=================>............] - ETA: 0s - loss: 0.02037/8 [=========================>....] - ETA: 0s - loss: 0.02038/8 [==============================] - 0s 31ms/step - loss: 0.0206
1/8 [==>...........................] - ETA: 0s - loss: 0.00853/8 [==========>...................] - ETA: 0s - loss: 0.00745/8 [=================>............] - ETA: 0s - loss: 0.00647/8 [=========================>....] - ETA: 0s - loss: 0.00598/8 [==============================] - 0s 26ms/step - loss: 0.0060
1/8 [==>...........................] - ETA: 0s - loss: 0.00853/8 [==========>...................] - ETA: 0s - loss: 0.00605/8 [=================>............] - ETA: 0s - loss: 0.00767/8 [=========================>....] - ETA: 0s - loss: 0.00668/8 [==============================] - 0s 26ms/step - loss: 0.0062
1/8 [==>...........................] - ETA: 0s - loss: 1.6444e-043/8 [==========>...................] - ETA: 0s - loss: 3.1462e-045/8 [=================>............] - ETA: 0s - loss: 0.0030    7/8 [=========================>....] - ETA: 0s - loss: 0.00358/8 [==============================] - 0s 35ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.00603/8 [==========>...................] - ETA: 0s - loss: 0.00895/8 [=================>............] - ETA: 0s - loss: 0.00647/8 [=========================>....] - ETA: 0s - loss: 0.00608/8 [==============================] - 0s 39ms/step - loss: 0.0060
1/8 [==>...........................] - ETA: 0s - loss: 0.00973/8 [==========>...................] - ETA: 0s - loss: 0.00575/8 [=================>............] - ETA: 0s - loss: 0.00727/8 [=========================>....] - ETA: 0s - loss: 0.00668/8 [==============================] - 0s 37ms/step - loss: 0.0064
1/8 [==>...........................] - ETA: 0s - loss: 0.00893/8 [==========>...................] - ETA: 0s - loss: 0.00785/8 [=================>............] - ETA: 0s - loss: 0.00767/8 [=========================>....] - ETA: 0s - loss: 0.00708/8 [==============================] - 0s 34ms/step - loss: 0.0070
1/8 [==>...........................] - ETA: 0s - loss: 0.01835/8 [=================>............] - ETA: 0s - loss: 0.01878/8 [==============================] - 0s 12ms/step - loss: 0.0140
1/8 [==>...........................] - ETA: 0s - loss: 0.00175/8 [=================>............] - ETA: 0s - loss: 0.00258/8 [==============================] - 0s 14ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.00715/8 [=================>............] - ETA: 0s - loss: 0.00628/8 [==============================] - ETA: 0s - loss: 0.00588/8 [==============================] - 0s 13ms/step - loss: 0.0058
1/8 [==>...........................] - ETA: 0s - loss: 0.00934/8 [==============>...............] - ETA: 0s - loss: 0.00447/8 [=========================>....] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 17ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.00904/8 [==============>...............] - ETA: 0s - loss: 0.00607/8 [=========================>....] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 18ms/step - loss: 0.0048
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.005835342314094305:
Train Score: 0.00524 MSE 0.07242 RMSE
Test Score: 0.00651 MSE 0.08071 RMSE
Deviation Min [1.69418979e-05], Max [0.42966541]
Deviation 99.5th pctile [0.25089014]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1650,    6]))
Confusion matrix 
[[1646    4]
 [   1    5]]
precision 0.55556, recall 0.83333, f1 0.66667
Time to train: 758191 ms
Saving model models/A4Benchmark/A4Benchmark-TS57.csv.h5
Total Time to proces all the selected files : 762802 ms
A4Benchmark : Avg precision 0.55556 recall 0.83333 f1 0.66667 time to train 758191.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS57.csv  --epochs 20 --n_iter 3 --patience 3 :: took 772 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS58.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 09:59:35 PM MST
2020-11-30 22:00:03.562525: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 22:00:03.582216: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 22:00:03.583585: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55e08f0fbc00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 22:00:03.583636: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 22:00:03.583831: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS58.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.02853/8 [==========>...................] - ETA: 0s - loss: 0.04165/8 [=================>............] - ETA: 0s - loss: 0.03187/8 [=========================>....] - ETA: 0s - loss: 0.02608/8 [==============================] - 0s 32ms/step - loss: 0.0254
1/8 [==>...........................] - ETA: 0s - loss: 0.00823/8 [==========>...................] - ETA: 0s - loss: 0.00975/8 [=================>............] - ETA: 0s - loss: 0.01077/8 [=========================>....] - ETA: 0s - loss: 0.01058/8 [==============================] - 0s 33ms/step - loss: 0.0105
1/8 [==>...........................] - ETA: 0s - loss: 0.00773/8 [==========>...................] - ETA: 0s - loss: 0.01065/8 [=================>............] - ETA: 0s - loss: 0.00947/8 [=========================>....] - ETA: 0s - loss: 0.00948/8 [==============================] - 0s 33ms/step - loss: 0.0096
1/8 [==>...........................] - ETA: 0s - loss: 0.01063/8 [==========>...................] - ETA: 0s - loss: 0.01095/8 [=================>............] - ETA: 0s - loss: 0.01257/8 [=========================>....] - ETA: 0s - loss: 0.01618/8 [==============================] - 0s 30ms/step - loss: 0.0165
1/8 [==>...........................] - ETA: 0s - loss: 0.03963/8 [==========>...................] - ETA: 0s - loss: 0.05035/8 [=================>............] - ETA: 0s - loss: 0.04797/8 [=========================>....] - ETA: 0s - loss: 0.04468/8 [==============================] - 0s 28ms/step - loss: 0.0444
1/8 [==>...........................] - ETA: 0s - loss: 0.01235/8 [=================>............] - ETA: 0s - loss: 0.01098/8 [==============================] - 0s 14ms/step - loss: 0.0082
1/8 [==>...........................] - ETA: 0s - loss: 0.00255/8 [=================>............] - ETA: 0s - loss: 0.00278/8 [==============================] - 0s 13ms/step - loss: 0.0026
1/8 [==>...........................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00138/8 [==============================] - 0s 13ms/step - loss: 0.0011
1/8 [==>...........................] - ETA: 0s - loss: 0.00344/8 [==============>...............] - ETA: 0s - loss: 0.00307/8 [=========================>....] - ETA: 0s - loss: 0.00498/8 [==============================] - 0s 17ms/step - loss: 0.0049
1/8 [==>...........................] - ETA: 0s - loss: 0.00384/8 [==============>...............] - ETA: 0s - loss: 0.00487/8 [=========================>....] - ETA: 0s - loss: 0.00468/8 [==============================] - 0s 17ms/step - loss: 0.0047
1/8 [==>...........................] - ETA: 0s - loss: 0.02413/8 [==========>...................] - ETA: 0s - loss: 0.03555/8 [=================>............] - ETA: 0s - loss: 0.02807/8 [=========================>....] - ETA: 0s - loss: 0.02158/8 [==============================] - 0s 23ms/step - loss: 0.0207
1/8 [==>...........................] - ETA: 0s - loss: 0.00683/8 [==========>...................] - ETA: 0s - loss: 0.00865/8 [=================>............] - ETA: 0s - loss: 0.00947/8 [=========================>....] - ETA: 0s - loss: 0.00918/8 [==============================] - 0s 25ms/step - loss: 0.0092
1/8 [==>...........................] - ETA: 0s - loss: 0.00523/8 [==========>...................] - ETA: 0s - loss: 0.00655/8 [=================>............] - ETA: 0s - loss: 0.00637/8 [=========================>....] - ETA: 0s - loss: 0.00608/8 [==============================] - 0s 30ms/step - loss: 0.0061
1/8 [==>...........................] - ETA: 0s - loss: 0.01063/8 [==========>...................] - ETA: 0s - loss: 0.01075/8 [=================>............] - ETA: 0s - loss: 0.01197/8 [=========================>....] - ETA: 0s - loss: 0.01418/8 [==============================] - 0s 31ms/step - loss: 0.0143
1/8 [==>...........................] - ETA: 0s - loss: 0.02213/8 [==========>...................] - ETA: 0s - loss: 0.02955/8 [=================>............] - ETA: 0s - loss: 0.02747/8 [=========================>....] - ETA: 0s - loss: 0.02678/8 [==============================] - 0s 23ms/step - loss: 0.0269
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.004297596751712263:
Train Score: 0.00321 MSE 0.05662 RMSE
Test Score: 0.00389 MSE 0.06233 RMSE
Deviation Min [1.99267469e-05], Max [0.36166858]
Deviation 99.5th pctile [0.20353099]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1648,    8]))
Confusion matrix 
[[1641    7]
 [   6    2]]
precision 0.22222, recall 0.25000, f1 0.23529
Time to train: 387623 ms
Saving model models/A4Benchmark/A4Benchmark-TS58.csv.h5
Total Time to proces all the selected files : 390050 ms
A4Benchmark : Avg precision 0.22222 recall 0.25000 f1 0.23529 time to train 387623.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS58.csv  --epochs 20 --n_iter 3 --patience 3 :: took 419 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS59.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 10:06:39 PM MST
2020-11-30 22:07:01.978740: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 22:07:01.997197: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 22:07:01.998077: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5597e1e120b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 22:07:01.998105: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 22:07:01.998212: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS59.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.01884/8 [==============>...............] - ETA: 0s - loss: 0.02136/8 [=====================>........] - ETA: 0s - loss: 0.02288/8 [==============================] - 0s 18ms/step - loss: 0.0235
1/8 [==>...........................] - ETA: 0s - loss: 0.02565/8 [=================>............] - ETA: 0s - loss: 0.02918/8 [==============================] - 0s 14ms/step - loss: 0.0310
1/8 [==>...........................] - ETA: 0s - loss: 0.03204/8 [==============>...............] - ETA: 0s - loss: 0.03857/8 [=========================>....] - ETA: 0s - loss: 0.03698/8 [==============================] - 0s 20ms/step - loss: 0.0358
1/8 [==>...........................] - ETA: 0s - loss: 0.02254/8 [==============>...............] - ETA: 0s - loss: 0.01957/8 [=========================>....] - ETA: 0s - loss: 0.01728/8 [==============================] - 0s 16ms/step - loss: 0.0169
1/8 [==>...........................] - ETA: 0s - loss: 7.7383e-054/8 [==============>...............] - ETA: 0s - loss: 9.1950e-057/8 [=========================>....] - ETA: 0s - loss: 7.5756e-058/8 [==============================] - 0s 18ms/step - loss: 8.2475e-05
1/8 [==>...........................] - ETA: 0s - loss: 0.01255/8 [=================>............] - ETA: 0s - loss: 0.01358/8 [==============================] - ETA: 0s - loss: 0.01278/8 [==============================] - 0s 22ms/step - loss: 0.0127
1/8 [==>...........................] - ETA: 0s - loss: 0.01174/8 [==============>...............] - ETA: 0s - loss: 0.01318/8 [==============================] - ETA: 0s - loss: 0.01258/8 [==============================] - 0s 15ms/step - loss: 0.0125
1/8 [==>...........................] - ETA: 0s - loss: 0.00676/8 [=====================>........] - ETA: 0s - loss: 0.00798/8 [==============================] - 0s 13ms/step - loss: 0.0090
1/8 [==>...........................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00168/8 [==============================] - 0s 13ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 3.0352e-045/8 [=================>............] - ETA: 0s - loss: 3.2950e-048/8 [==============================] - 0s 13ms/step - loss: 2.6499e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.02153/8 [==========>...................] - ETA: 0s - loss: 0.02565/8 [=================>............] - ETA: 0s - loss: 0.02627/8 [=========================>....] - ETA: 0s - loss: 0.02548/8 [==============================] - 0s 41ms/step - loss: 0.0259
1/8 [==>...........................] - ETA: 0s - loss: 0.02653/8 [==========>...................] - ETA: 0s - loss: 0.02855/8 [=================>............] - ETA: 0s - loss: 0.03057/8 [=========================>....] - ETA: 0s - loss: 0.03158/8 [==============================] - 0s 35ms/step - loss: 0.0321
1/8 [==>...........................] - ETA: 0s - loss: 0.03013/8 [==========>...................] - ETA: 0s - loss: 0.03735/8 [=================>............] - ETA: 0s - loss: 0.03457/8 [=========================>....] - ETA: 0s - loss: 0.03388/8 [==============================] - 0s 35ms/step - loss: 0.0325
1/8 [==>...........................] - ETA: 0s - loss: 0.05283/8 [==========>...................] - ETA: 0s - loss: 0.04825/8 [=================>............] - ETA: 0s - loss: 0.04427/8 [=========================>....] - ETA: 0s - loss: 0.04108/8 [==============================] - 0s 26ms/step - loss: 0.0402
1/8 [==>...........................] - ETA: 0s - loss: 0.00473/8 [==========>...................] - ETA: 0s - loss: 0.00425/8 [=================>............] - ETA: 0s - loss: 0.00347/8 [=========================>....] - ETA: 0s - loss: 0.00278/8 [==============================] - 0s 29ms/step - loss: 0.0026
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.007223694433923811:
Train Score: 0.01934 MSE 0.13907 RMSE
Test Score: 0.00216 MSE 0.04652 RMSE
Deviation Min [9.0523361e-06], Max [0.40880962]
Deviation 99.5th pctile [0.36135029]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1655,    1]))
Confusion matrix 
[[1646    9]
 [   1    0]]
precision 0.00000, recall 0.00000, f1 0.00000
Time to train: 322428 ms
Saving model models/A4Benchmark/A4Benchmark-TS59.csv.h5
Total Time to proces all the selected files : 324896 ms
A4Benchmark : Avg precision 0.00000 recall 0.00000 f1 0.00000 time to train 322428.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS59.csv  --epochs 20 --n_iter 3 --patience 3 :: took 348 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS5.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 10:12:32 PM MST
2020-11-30 22:12:44.374503: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 22:12:44.393254: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 22:12:44.394630: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56542ed8e310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 22:12:44.394679: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 22:12:44.394880: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS5.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00614/8 [==============>...............] - ETA: 0s - loss: 0.00547/8 [=========================>....] - ETA: 0s - loss: 0.00378/8 [==============================] - 0s 18ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 1.7050e-044/8 [==============>...............] - ETA: 0s - loss: 2.1857e-047/8 [=========================>....] - ETA: 0s - loss: 3.1578e-048/8 [==============================] - 0s 19ms/step - loss: 3.1363e-04
1/8 [==>...........................] - ETA: 0s - loss: 8.3041e-054/8 [==============>...............] - ETA: 0s - loss: 1.2768e-047/8 [=========================>....] - ETA: 0s - loss: 1.4515e-048/8 [==============================] - 0s 20ms/step - loss: 1.4475e-04
1/8 [==>...........................] - ETA: 0s - loss: 1.3223e-044/8 [==============>...............] - ETA: 0s - loss: 0.0015    8/8 [==============================] - ETA: 0s - loss: 0.00128/8 [==============================] - 0s 16ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 0.01894/8 [==============>...............] - ETA: 0s - loss: 0.01587/8 [=========================>....] - ETA: 0s - loss: 0.01688/8 [==============================] - 0s 19ms/step - loss: 0.0169
1/8 [==>...........................] - ETA: 0s - loss: 0.00833/8 [==========>...................] - ETA: 0s - loss: 0.00775/8 [=================>............] - ETA: 0s - loss: 0.00556/8 [=====================>........] - ETA: 0s - loss: 0.00487/8 [=========================>....] - ETA: 0s - loss: 0.00438/8 [==============================] - ETA: 0s - loss: 0.00418/8 [==============================] - 0s 45ms/step - loss: 0.0041
1/8 [==>...........................] - ETA: 0s - loss: 1.7501e-043/8 [==========>...................] - ETA: 0s - loss: 2.2614e-045/8 [=================>............] - ETA: 0s - loss: 2.8408e-047/8 [=========================>....] - ETA: 0s - loss: 3.7634e-048/8 [==============================] - 0s 40ms/step - loss: 3.7518e-04
1/8 [==>...........................] - ETA: 0s - loss: 1.8363e-043/8 [==========>...................] - ETA: 0s - loss: 2.5690e-045/8 [=================>............] - ETA: 0s - loss: 2.6919e-047/8 [=========================>....] - ETA: 0s - loss: 3.0841e-048/8 [==============================] - 0s 25ms/step - loss: 3.5148e-04
1/8 [==>...........................] - ETA: 0s - loss: 8.6235e-053/8 [==========>...................] - ETA: 0s - loss: 2.8638e-045/8 [=================>............] - ETA: 0s - loss: 0.0015    7/8 [=========================>....] - ETA: 0s - loss: 0.00128/8 [==============================] - 0s 29ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 0.00683/8 [==========>...................] - ETA: 0s - loss: 0.00515/8 [=================>............] - ETA: 0s - loss: 0.00447/8 [=========================>....] - ETA: 0s - loss: 0.00528/8 [==============================] - 0s 30ms/step - loss: 0.0054
1/8 [==>...........................] - ETA: 0s - loss: 0.02983/8 [==========>...................] - ETA: 0s - loss: 0.02975/8 [=================>............] - ETA: 0s - loss: 0.01947/8 [=========================>....] - ETA: 0s - loss: 0.01538/8 [==============================] - 0s 39ms/step - loss: 0.0147
1/8 [==>...........................] - ETA: 0s - loss: 7.9508e-043/8 [==========>...................] - ETA: 0s - loss: 7.6339e-045/8 [=================>............] - ETA: 0s - loss: 0.0011    7/8 [=========================>....] - ETA: 0s - loss: 0.00118/8 [==============================] - 0s 28ms/step - loss: 0.0010
1/8 [==>...........................] - ETA: 0s - loss: 0.00283/8 [==========>...................] - ETA: 0s - loss: 0.00355/8 [=================>............] - ETA: 0s - loss: 0.00407/8 [=========================>....] - ETA: 0s - loss: 0.00408/8 [==============================] - 0s 27ms/step - loss: 0.0041
1/8 [==>...........................] - ETA: 0s - loss: 1.0915e-043/8 [==========>...................] - ETA: 0s - loss: 3.9312e-045/8 [=================>............] - ETA: 0s - loss: 0.0017    7/8 [=========================>....] - ETA: 0s - loss: 0.00148/8 [==============================] - 0s 29ms/step - loss: 0.0013
1/8 [==>...........................] - ETA: 0s - loss: 0.02063/8 [==========>...................] - ETA: 0s - loss: 0.01855/8 [=================>............] - ETA: 0s - loss: 0.01827/8 [=========================>....] - ETA: 0s - loss: 0.01868/8 [==============================] - 0s 35ms/step - loss: 0.0187
Best parameters {'n_units': 72, 'n_hidden': 2} best score 0.0022682477603666483:
Train Score: 0.01507 MSE 0.12276 RMSE
Test Score: 0.02040 MSE 0.14282 RMSE
Deviation Min [7.88335365e-05], Max [0.32720103]
Deviation 99.5th pctile [0.3136991]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1650,    6]))
Confusion matrix 
[[1641    9]
 [   6    0]]
precision 0.00000, recall 0.00000, f1 0.00000
Time to train: 717093 ms
Saving model models/A4Benchmark/A4Benchmark-TS5.csv.h5
Total Time to proces all the selected files : 721361 ms
A4Benchmark : Avg precision 0.00000 recall 0.00000 f1 0.00000 time to train 717093.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS5.csv  --epochs 20 --n_iter 3 --patience 3 :: took 734 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS60.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 10:24:51 PM MST
2020-11-30 22:24:57.622601: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 22:24:57.643209: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 22:24:57.643964: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55bd8ac99c00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 22:24:57.643991: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 22:24:57.644110: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS60.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00773/8 [==========>...................] - ETA: 0s - loss: 0.00465/8 [=================>............] - ETA: 0s - loss: 0.00417/8 [=========================>....] - ETA: 0s - loss: 0.00418/8 [==============================] - 0s 24ms/step - loss: 0.0039
1/8 [==>...........................] - ETA: 0s - loss: 0.00633/8 [==========>...................] - ETA: 0s - loss: 0.00585/8 [=================>............] - ETA: 0s - loss: 0.00407/8 [=========================>....] - ETA: 0s - loss: 0.00478/8 [==============================] - 0s 24ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00373/8 [==========>...................] - ETA: 0s - loss: 0.00435/8 [=================>............] - ETA: 0s - loss: 0.00327/8 [=========================>....] - ETA: 0s - loss: 0.00328/8 [==============================] - 0s 31ms/step - loss: 0.0032
1/8 [==>...........................] - ETA: 0s - loss: 0.00143/8 [==========>...................] - ETA: 0s - loss: 0.00146/8 [=====================>........] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 22ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.00743/8 [==========>...................] - ETA: 0s - loss: 0.00845/8 [=================>............] - ETA: 0s - loss: 0.00747/8 [=========================>....] - ETA: 0s - loss: 0.00758/8 [==============================] - 0s 24ms/step - loss: 0.0077
1/8 [==>...........................] - ETA: 0s - loss: 0.01563/8 [==========>...................] - ETA: 0s - loss: 0.01715/8 [=================>............] - ETA: 0s - loss: 0.01747/8 [=========================>....] - ETA: 0s - loss: 0.01738/8 [==============================] - 0s 26ms/step - loss: 0.0178
1/8 [==>...........................] - ETA: 0s - loss: 0.01503/8 [==========>...................] - ETA: 0s - loss: 0.01745/8 [=================>............] - ETA: 0s - loss: 0.01727/8 [=========================>....] - ETA: 0s - loss: 0.01698/8 [==============================] - 0s 34ms/step - loss: 0.0175
1/8 [==>...........................] - ETA: 0s - loss: 0.00243/8 [==========>...................] - ETA: 0s - loss: 0.00295/8 [=================>............] - ETA: 0s - loss: 0.00237/8 [=========================>....] - ETA: 0s - loss: 0.00208/8 [==============================] - 0s 32ms/step - loss: 0.0020
1/8 [==>...........................] - ETA: 0s - loss: 0.00693/8 [==========>...................] - ETA: 0s - loss: 0.00885/8 [=================>............] - ETA: 0s - loss: 0.00867/8 [=========================>....] - ETA: 0s - loss: 0.00888/8 [==============================] - 0s 28ms/step - loss: 0.0092
1/8 [==>...........................] - ETA: 0s - loss: 0.00103/8 [==========>...................] - ETA: 0s - loss: 0.00115/8 [=================>............] - ETA: 0s - loss: 0.00117/8 [=========================>....] - ETA: 0s - loss: 0.00178/8 [==============================] - 0s 37ms/step - loss: 0.0017
1/8 [==>...........................] - ETA: 0s - loss: 0.00604/8 [==============>...............] - ETA: 0s - loss: 0.00317/8 [=========================>....] - ETA: 0s - loss: 0.00318/8 [==============================] - 0s 19ms/step - loss: 0.0030
1/8 [==>...........................] - ETA: 0s - loss: 0.00115/8 [=================>............] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 14ms/step - loss: 0.0017
1/8 [==>...........................] - ETA: 0s - loss: 0.01115/8 [=================>............] - ETA: 0s - loss: 0.01088/8 [==============================] - 0s 14ms/step - loss: 0.0099
1/8 [==>...........................] - ETA: 0s - loss: 3.2063e-045/8 [=================>............] - ETA: 0s - loss: 7.2387e-048/8 [==============================] - 0s 14ms/step - loss: 6.7731e-04
1/8 [==>...........................] - ETA: 0s - loss: 8.2502e-045/8 [=================>............] - ETA: 0s - loss: 0.0014    8/8 [==============================] - 0s 14ms/step - loss: 0.0013
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.003314274922013283:
Train Score: 0.00190 MSE 0.04358 RMSE
Test Score: 0.01477 MSE 0.12152 RMSE
Deviation Min [5.47926273e-05], Max [0.38026771]
Deviation 99.5th pctile [0.26408535]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1653,    3]))
Confusion matrix 
[[1645    8]
 [   2    1]]
precision 0.11111, recall 0.33333, f1 0.16667
Time to train: 706460 ms
Saving model models/A4Benchmark/A4Benchmark-TS60.csv.h5
Total Time to proces all the selected files : 708883 ms
A4Benchmark : Avg precision 0.11111 recall 0.33333 f1 0.16667 time to train 706460.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS60.csv  --epochs 20 --n_iter 3 --patience 3 :: took 715 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS61.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 10:36:51 PM MST
2020-11-30 22:37:03.531165: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 22:37:03.549247: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 22:37:03.550803: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d7c94dac00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 22:37:03.550874: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 22:37:03.551112: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS61.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00464/8 [==============>...............] - ETA: 0s - loss: 0.00657/8 [=========================>....] - ETA: 0s - loss: 0.00858/8 [==============================] - 0s 18ms/step - loss: 0.0085
1/8 [==>...........................] - ETA: 0s - loss: 0.00595/8 [=================>............] - ETA: 0s - loss: 0.00918/8 [==============================] - 0s 14ms/step - loss: 0.0083
1/8 [==>...........................] - ETA: 0s - loss: 0.00504/8 [==============>...............] - ETA: 0s - loss: 0.00707/8 [=========================>....] - ETA: 0s - loss: 0.00658/8 [==============================] - 0s 18ms/step - loss: 0.0065
1/8 [==>...........................] - ETA: 0s - loss: 0.00964/8 [==============>...............] - ETA: 0s - loss: 0.00657/8 [=========================>....] - ETA: 0s - loss: 0.00648/8 [==============================] - 0s 18ms/step - loss: 0.0065
1/8 [==>...........................] - ETA: 0s - loss: 0.02155/8 [=================>............] - ETA: 0s - loss: 0.01678/8 [==============================] - 0s 14ms/step - loss: 0.0191
1/8 [==>...........................] - ETA: 0s - loss: 0.00493/8 [==========>...................] - ETA: 0s - loss: 0.00585/8 [=================>............] - ETA: 0s - loss: 0.00707/8 [=========================>....] - ETA: 0s - loss: 0.00868/8 [==============================] - 0s 26ms/step - loss: 0.0086
1/8 [==>...........................] - ETA: 0s - loss: 0.00493/8 [==========>...................] - ETA: 0s - loss: 0.00975/8 [=================>............] - ETA: 0s - loss: 0.00897/8 [=========================>....] - ETA: 0s - loss: 0.00828/8 [==============================] - 0s 24ms/step - loss: 0.0083
1/8 [==>...........................] - ETA: 0s - loss: 0.00523/8 [==========>...................] - ETA: 0s - loss: 0.00825/8 [=================>............] - ETA: 0s - loss: 0.00877/8 [=========================>....] - ETA: 0s - loss: 0.00798/8 [==============================] - 0s 34ms/step - loss: 0.0078
1/8 [==>...........................] - ETA: 0s - loss: 0.00843/8 [==========>...................] - ETA: 0s - loss: 0.00635/8 [=================>............] - ETA: 0s - loss: 0.00607/8 [=========================>....] - ETA: 0s - loss: 0.00618/8 [==============================] - 0s 26ms/step - loss: 0.0061
1/8 [==>...........................] - ETA: 0s - loss: 0.00953/8 [==========>...................] - ETA: 0s - loss: 0.00785/8 [=================>............] - ETA: 0s - loss: 0.00727/8 [=========================>....] - ETA: 0s - loss: 0.00848/8 [==============================] - 0s 26ms/step - loss: 0.0084
1/8 [==>...........................] - ETA: 0s - loss: 0.00895/8 [=================>............] - ETA: 0s - loss: 0.01128/8 [==============================] - 0s 13ms/step - loss: 0.0121
1/8 [==>...........................] - ETA: 0s - loss: 0.00574/8 [==============>...............] - ETA: 0s - loss: 0.00997/8 [=========================>....] - ETA: 0s - loss: 0.00808/8 [==============================] - 0s 16ms/step - loss: 0.0080
1/8 [==>...........................] - ETA: 0s - loss: 0.00815/8 [=================>............] - ETA: 0s - loss: 0.00948/8 [==============================] - 0s 13ms/step - loss: 0.0089
1/8 [==>...........................] - ETA: 0s - loss: 0.00704/8 [==============>...............] - ETA: 0s - loss: 0.00867/8 [=========================>....] - ETA: 0s - loss: 0.00838/8 [==============================] - 0s 16ms/step - loss: 0.0085
1/8 [==>...........................] - ETA: 0s - loss: 0.00745/8 [=================>............] - ETA: 0s - loss: 0.00638/8 [==============================] - 0s 14ms/step - loss: 0.0082
Best parameters {'n_units': 72, 'n_hidden': 2} best score 0.007839646376669406:
Train Score: 0.00965 MSE 0.09825 RMSE
Test Score: 0.00796 MSE 0.08920 RMSE
Deviation Min [7.41789166e-05], Max [0.74084419]
Deviation 99.5th pctile [0.27150253]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1653,    3]))
Confusion matrix 
[[1647    6]
 [   0    3]]
precision 0.33333, recall 1.00000, f1 0.50000
Time to train: 654636 ms
Saving model models/A4Benchmark/A4Benchmark-TS61.csv.h5
Total Time to proces all the selected files : 659072 ms
A4Benchmark : Avg precision 0.33333 recall 1.00000 f1 0.50000 time to train 654636.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS61.csv  --epochs 20 --n_iter 3 --patience 3 :: took 671 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS62.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 10:48:07 PM MST
2020-11-30 22:48:19.556700: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 22:48:19.575273: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 22:48:19.576406: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x558ee8a21d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 22:48:19.576458: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 22:48:19.576655: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS62.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00684/8 [==============>...............] - ETA: 0s - loss: 0.00497/8 [=========================>....] - ETA: 0s - loss: 0.00468/8 [==============================] - 0s 19ms/step - loss: 0.0045
1/8 [==>...........................] - ETA: 0s - loss: 0.00334/8 [==============>...............] - ETA: 0s - loss: 0.00527/8 [=========================>....] - ETA: 0s - loss: 0.00418/8 [==============================] - 0s 19ms/step - loss: 0.0041
1/8 [==>...........................] - ETA: 0s - loss: 0.00134/8 [==============>...............] - ETA: 0s - loss: 0.00187/8 [=========================>....] - ETA: 0s - loss: 0.00198/8 [==============================] - 0s 20ms/step - loss: 0.0019
1/8 [==>...........................] - ETA: 0s - loss: 0.00215/8 [=================>............] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 14ms/step - loss: 0.0013
1/8 [==>...........................] - ETA: 0s - loss: 0.00514/8 [==============>...............] - ETA: 0s - loss: 0.02348/8 [==============================] - ETA: 0s - loss: 0.09798/8 [==============================] - 0s 14ms/step - loss: 0.0979
1/8 [==>...........................] - ETA: 0s - loss: 0.00465/8 [=================>............] - ETA: 0s - loss: 0.00438/8 [==============================] - 0s 14ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.00435/8 [=================>............] - ETA: 0s - loss: 0.00638/8 [==============================] - 0s 14ms/step - loss: 0.0051
1/8 [==>...........................] - ETA: 0s - loss: 0.00204/8 [==============>...............] - ETA: 0s - loss: 0.00297/8 [=========================>....] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 16ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00255/8 [=================>............] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 14ms/step - loss: 0.0018
1/8 [==>...........................] - ETA: 0s - loss: 1.7869e-045/8 [=================>............] - ETA: 0s - loss: 0.0018    8/8 [==============================] - 0s 13ms/step - loss: 0.0042
1/8 [==>...........................] - ETA: 0s - loss: 0.00553/8 [==========>...................] - ETA: 0s - loss: 0.00485/8 [=================>............] - ETA: 0s - loss: 0.00387/8 [=========================>....] - ETA: 0s - loss: 0.00348/8 [==============================] - 0s 25ms/step - loss: 0.0033
1/8 [==>...........................] - ETA: 0s - loss: 0.00583/8 [==========>...................] - ETA: 0s - loss: 0.00865/8 [=================>............] - ETA: 0s - loss: 0.00687/8 [=========================>....] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 30ms/step - loss: 0.0057
1/8 [==>...........................] - ETA: 0s - loss: 0.00533/8 [==========>...................] - ETA: 0s - loss: 0.00665/8 [=================>............] - ETA: 0s - loss: 0.00517/8 [=========================>....] - ETA: 0s - loss: 0.00528/8 [==============================] - 0s 25ms/step - loss: 0.0054
1/8 [==>...........................] - ETA: 0s - loss: 0.00343/8 [==========>...................] - ETA: 0s - loss: 0.00455/8 [=================>............] - ETA: 0s - loss: 0.00407/8 [=========================>....] - ETA: 0s - loss: 0.00308/8 [==============================] - 0s 26ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 4.2457e-043/8 [==========>...................] - ETA: 0s - loss: 8.1711e-045/8 [=================>............] - ETA: 0s - loss: 8.7374e-047/8 [=========================>....] - ETA: 0s - loss: 9.0846e-048/8 [==============================] - 0s 33ms/step - loss: 9.5475e-04
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0035104112466797233:
Train Score: 0.00257 MSE 0.05074 RMSE
Test Score: 0.00245 MSE 0.04948 RMSE
Deviation Min [3.08875039e-05], Max [0.31832573]
Deviation 99.5th pctile [0.17802605]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1642,   14]))
Confusion matrix 
[[1640    2]
 [   7    7]]
precision 0.77778, recall 0.50000, f1 0.60870
Time to train: 604940 ms
Saving model models/A4Benchmark/A4Benchmark-TS62.csv.h5
Total Time to proces all the selected files : 607335 ms
A4Benchmark : Avg precision 0.77778 recall 0.50000 f1 0.60870 time to train 604940.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS62.csv  --epochs 20 --n_iter 3 --patience 3 :: took 620 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS63.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 10:58:32 PM MST
2020-11-30 22:58:44.199607: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 22:58:44.218246: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 22:58:44.219679: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55678e946d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 22:58:44.219732: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 22:58:44.219971: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS63.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00314/8 [==============>...............] - ETA: 0s - loss: 0.00328/8 [==============================] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 15ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00164/8 [==============>...............] - ETA: 0s - loss: 0.00198/8 [==============================] - ETA: 0s - loss: 0.00208/8 [==============================] - 0s 15ms/step - loss: 0.0020
1/8 [==>...........................] - ETA: 0s - loss: 0.00205/8 [=================>............] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 13ms/step - loss: 0.0025
1/8 [==>...........................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00208/8 [==============================] - 0s 13ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.00175/8 [=================>............] - ETA: 0s - loss: 0.00248/8 [==============================] - 0s 13ms/step - loss: 0.0025
1/8 [==>...........................] - ETA: 0s - loss: 0.00313/8 [==========>...................] - ETA: 0s - loss: 0.00345/8 [=================>............] - ETA: 0s - loss: 0.00377/8 [=========================>....] - ETA: 0s - loss: 0.00338/8 [==============================] - 0s 28ms/step - loss: 0.0033
1/8 [==>...........................] - ETA: 0s - loss: 0.00213/8 [==========>...................] - ETA: 0s - loss: 0.00265/8 [=================>............] - ETA: 0s - loss: 0.00257/8 [=========================>....] - ETA: 0s - loss: 0.00258/8 [==============================] - 0s 29ms/step - loss: 0.0026
1/8 [==>...........................] - ETA: 0s - loss: 0.00293/8 [==========>...................] - ETA: 0s - loss: 0.00375/8 [=================>............] - ETA: 0s - loss: 0.00327/8 [=========================>....] - ETA: 0s - loss: 0.00348/8 [==============================] - 0s 28ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.00193/8 [==========>...................] - ETA: 0s - loss: 0.00265/8 [=================>............] - ETA: 0s - loss: 0.00257/8 [=========================>....] - ETA: 0s - loss: 0.00268/8 [==============================] - 0s 27ms/step - loss: 0.0027
1/8 [==>...........................] - ETA: 0s - loss: 0.00213/8 [==========>...................] - ETA: 0s - loss: 0.00285/8 [=================>............] - ETA: 0s - loss: 0.00277/8 [=========================>....] - ETA: 0s - loss: 0.00288/8 [==============================] - 0s 25ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00414/8 [==============>...............] - ETA: 0s - loss: 0.00437/8 [=========================>....] - ETA: 0s - loss: 0.00378/8 [==============================] - 0s 19ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 14ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.01824/8 [==============>...............] - ETA: 0s - loss: 0.03068/8 [==============================] - ETA: 0s - loss: 0.03498/8 [==============================] - 0s 15ms/step - loss: 0.0349
1/8 [==>...........................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 13ms/step - loss: 0.0022
1/8 [==>...........................] - ETA: 0s - loss: 0.10845/8 [=================>............] - ETA: 0s - loss: 0.14028/8 [==============================] - 0s 12ms/step - loss: 0.1459
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.002426645811647177:
Train Score: 0.00234 MSE 0.04840 RMSE
Test Score: 0.00279 MSE 0.05279 RMSE
Deviation Min [3.33133038e-05], Max [0.17843614]
Deviation 99.5th pctile [0.11719821]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1649,    7]))
Confusion matrix 
[[1646    3]
 [   1    6]]
precision 0.66667, recall 0.85714, f1 0.75000
Time to train: 360030 ms
Saving model models/A4Benchmark/A4Benchmark-TS63.csv.h5
Total Time to proces all the selected files : 362307 ms
A4Benchmark : Avg precision 0.66667 recall 0.85714 f1 0.75000 time to train 360030.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS63.csv  --epochs 20 --n_iter 3 --patience 3 :: took 374 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS64.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 11:04:51 PM MST
2020-11-30 23:05:18.939974: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 23:05:18.958230: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 23:05:18.959812: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f7dab6ad30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 23:05:18.959913: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 23:05:18.960110: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS64.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.02243/8 [==========>...................] - ETA: 0s - loss: 0.02065/8 [=================>............] - ETA: 0s - loss: 0.01787/8 [=========================>....] - ETA: 0s - loss: 0.01458/8 [==============================] - 0s 27ms/step - loss: 0.0139
1/8 [==>...........................] - ETA: 0s - loss: 0.00293/8 [==========>...................] - ETA: 0s - loss: 0.00375/8 [=================>............] - ETA: 0s - loss: 0.00387/8 [=========================>....] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 30ms/step - loss: 0.0039
1/8 [==>...........................] - ETA: 0s - loss: 0.00313/8 [==========>...................] - ETA: 0s - loss: 0.00405/8 [=================>............] - ETA: 0s - loss: 0.00387/8 [=========================>....] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 24ms/step - loss: 0.0039
1/8 [==>...........................] - ETA: 0s - loss: 0.00313/8 [==========>...................] - ETA: 0s - loss: 0.00515/8 [=================>............] - ETA: 0s - loss: 0.00487/8 [=========================>....] - ETA: 0s - loss: 0.00468/8 [==============================] - 0s 24ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00353/8 [==========>...................] - ETA: 0s - loss: 0.00415/8 [=================>............] - ETA: 0s - loss: 0.00397/8 [=========================>....] - ETA: 0s - loss: 0.00398/8 [==============================] - 0s 28ms/step - loss: 0.0041
1/8 [==>...........................] - ETA: 0s - loss: 0.02534/8 [==============>...............] - ETA: 0s - loss: 0.02158/8 [==============================] - ETA: 0s - loss: 0.01518/8 [==============================] - 0s 14ms/step - loss: 0.0151
1/8 [==>...........................] - ETA: 0s - loss: 0.00225/8 [=================>............] - ETA: 0s - loss: 0.00288/8 [==============================] - 0s 14ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 0.00214/8 [==============>...............] - ETA: 0s - loss: 0.00267/8 [=========================>....] - ETA: 0s - loss: 0.00268/8 [==============================] - 0s 17ms/step - loss: 0.0027
1/8 [==>...........................] - ETA: 0s - loss: 0.00324/8 [==============>...............] - ETA: 0s - loss: 0.00337/8 [=========================>....] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 17ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.00304/8 [==============>...............] - ETA: 0s - loss: 0.00318/8 [==============================] - ETA: 0s - loss: 0.00348/8 [==============================] - 0s 14ms/step - loss: 0.0034
1/8 [==>...........................] - ETA: 0s - loss: 0.02454/8 [==============>...............] - ETA: 0s - loss: 0.02108/8 [==============================] - ETA: 0s - loss: 0.01488/8 [==============================] - 0s 15ms/step - loss: 0.0148
1/8 [==>...........................] - ETA: 0s - loss: 0.00295/8 [=================>............] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 14ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.00274/8 [==============>...............] - ETA: 0s - loss: 0.00307/8 [=========================>....] - ETA: 0s - loss: 0.00318/8 [==============================] - 0s 16ms/step - loss: 0.0033
1/8 [==>...........................] - ETA: 0s - loss: 0.00265/8 [=================>............] - ETA: 0s - loss: 0.00408/8 [==============================] - 0s 12ms/step - loss: 0.0041
1/8 [==>...........................] - ETA: 0s - loss: 0.00296/8 [=====================>........] - ETA: 0s - loss: 0.00328/8 [==============================] - 0s 11ms/step - loss: 0.0034
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.005522926291450858:
Train Score: 0.00523 MSE 0.07232 RMSE
Test Score: 0.00786 MSE 0.08865 RMSE
Deviation Min [1.9518323e-06], Max [0.42243937]
Deviation 99.5th pctile [0.21778139]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1651,    5]))
Confusion matrix 
[[1643    8]
 [   4    1]]
precision 0.11111, recall 0.20000, f1 0.14286
Time to train: 354872 ms
Saving model models/A4Benchmark/A4Benchmark-TS64.csv.h5
Total Time to proces all the selected files : 357526 ms
A4Benchmark : Avg precision 0.11111 recall 0.20000 f1 0.14286 time to train 354872.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS64.csv  --epochs 20 --n_iter 3 --patience 3 :: took 385 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS65.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 11:11:21 PM MST
2020-11-30 23:11:29.427789: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 23:11:29.446210: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 23:11:29.447555: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f8450ac310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 23:11:29.447599: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 23:11:29.447783: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS65.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00175/8 [=================>............] - ETA: 0s - loss: 0.00508/8 [==============================] - ETA: 0s - loss: 0.00398/8 [==============================] - 0s 17ms/step - loss: 0.0039
1/8 [==>...........................] - ETA: 0s - loss: 0.00264/8 [==============>...............] - ETA: 0s - loss: 0.00277/8 [=========================>....] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 18ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 6.8520e-045/8 [=================>............] - ETA: 0s - loss: 9.9645e-048/8 [==============================] - 0s 14ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 0.00184/8 [==============>...............] - ETA: 0s - loss: 0.00266/8 [=====================>........] - ETA: 0s - loss: 0.00248/8 [==============================] - ETA: 0s - loss: 0.00258/8 [==============================] - 0s 27ms/step - loss: 0.0025
1/8 [==>...........................] - ETA: 0s - loss: 0.00104/8 [==============>...............] - ETA: 0s - loss: 0.00197/8 [=========================>....] - ETA: 0s - loss: 0.00308/8 [==============================] - 0s 17ms/step - loss: 0.0030
1/8 [==>...........................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.01568/8 [==============================] - 0s 14ms/step - loss: 0.0113
1/8 [==>...........................] - ETA: 0s - loss: 4.5540e-045/8 [=================>............] - ETA: 0s - loss: 0.0014    8/8 [==============================] - ETA: 0s - loss: 0.00118/8 [==============================] - 0s 15ms/step - loss: 0.0011
1/8 [==>...........................] - ETA: 0s - loss: 0.00135/8 [=================>............] - ETA: 0s - loss: 0.00148/8 [==============================] - 0s 14ms/step - loss: 0.0019
1/8 [==>...........................] - ETA: 0s - loss: 0.00265/8 [=================>............] - ETA: 0s - loss: 0.00358/8 [==============================] - 0s 14ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.00154/8 [==============>...............] - ETA: 0s - loss: 0.00217/8 [=========================>....] - ETA: 0s - loss: 0.00338/8 [==============================] - 0s 20ms/step - loss: 0.0032
1/8 [==>...........................] - ETA: 0s - loss: 0.00182/8 [======>.......................] - ETA: 0s - loss: 0.00214/8 [==============>...............] - ETA: 0s - loss: 0.00416/8 [=====================>........] - ETA: 0s - loss: 0.00538/8 [==============================] - ETA: 0s - loss: 0.00478/8 [==============================] - 0s 34ms/step - loss: 0.0047
1/8 [==>...........................] - ETA: 0s - loss: 8.7190e-042/8 [======>.......................] - ETA: 0s - loss: 0.0011    4/8 [==============>...............] - ETA: 0s - loss: 9.1144e-046/8 [=====================>........] - ETA: 0s - loss: 0.0017    8/8 [==============================] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 33ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 0.00143/8 [==========>...................] - ETA: 0s - loss: 0.00185/8 [=================>............] - ETA: 0s - loss: 0.00197/8 [=========================>....] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 39ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.00143/8 [==========>...................] - ETA: 0s - loss: 0.00254/8 [==============>...............] - ETA: 0s - loss: 0.00236/8 [=====================>........] - ETA: 0s - loss: 0.00208/8 [==============================] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 35ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 9.8507e-043/8 [==========>...................] - ETA: 0s - loss: 0.0025    5/8 [=================>............] - ETA: 0s - loss: 0.00337/8 [=========================>....] - ETA: 0s - loss: 0.00308/8 [==============================] - 0s 27ms/step - loss: 0.0031
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.0027217081049457194:
Train Score: 0.00288 MSE 0.05364 RMSE
Test Score: 0.00252 MSE 0.05022 RMSE
Deviation Min [4.74415259e-06], Max [0.40336462]
Deviation 99.5th pctile [0.28998657]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1641,   15]))
Confusion matrix 
[[1641    0]
 [   6    9]]
precision 1.00000, recall 0.60000, f1 0.75000
Time to train: 619224 ms
Saving model models/A4Benchmark/A4Benchmark-TS65.csv.h5
Total Time to proces all the selected files : 623941 ms
A4Benchmark : Avg precision 1.00000 recall 0.60000 f1 0.75000 time to train 619224.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS65.csv  --epochs 20 --n_iter 3 --patience 3 :: took 632 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS66.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 11:21:58 PM MST
2020-11-30 23:22:12.994482: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 23:22:13.013196: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 23:22:13.014021: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d21afa6d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 23:22:13.014048: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 23:22:13.014149: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS66.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00134/8 [==============>...............] - ETA: 0s - loss: 0.00107/8 [=========================>....] - ETA: 0s - loss: 0.00178/8 [==============================] - 0s 16ms/step - loss: 0.0017
1/8 [==>...........................] - ETA: 0s - loss: 8.6739e-045/8 [=================>............] - ETA: 0s - loss: 0.0015    8/8 [==============================] - 0s 14ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 0.00305/8 [=================>............] - ETA: 0s - loss: 0.00328/8 [==============================] - 0s 14ms/step - loss: 0.0031
1/8 [==>...........................] - ETA: 0s - loss: 0.00284/8 [==============>...............] - ETA: 0s - loss: 0.00426/8 [=====================>........] - ETA: 0s - loss: 0.00438/8 [==============================] - 0s 21ms/step - loss: 0.0043
1/8 [==>...........................] - ETA: 0s - loss: 0.00615/8 [=================>............] - ETA: 0s - loss: 0.01688/8 [==============================] - 0s 14ms/step - loss: 0.0160
1/8 [==>...........................] - ETA: 0s - loss: 7.2320e-043/8 [==========>...................] - ETA: 0s - loss: 6.2263e-045/8 [=================>............] - ETA: 0s - loss: 0.0015    7/8 [=========================>....] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 27ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 0.00223/8 [==========>...................] - ETA: 0s - loss: 0.00235/8 [=================>............] - ETA: 0s - loss: 0.00207/8 [=========================>....] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 35ms/step - loss: 0.0022
1/8 [==>...........................] - ETA: 0s - loss: 0.00913/8 [==========>...................] - ETA: 0s - loss: 0.01275/8 [=================>............] - ETA: 0s - loss: 0.01207/8 [=========================>....] - ETA: 0s - loss: 0.01178/8 [==============================] - 0s 35ms/step - loss: 0.0123
1/8 [==>...........................] - ETA: 0s - loss: 0.00893/8 [==========>...................] - ETA: 0s - loss: 0.01145/8 [=================>............] - ETA: 0s - loss: 0.01127/8 [=========================>....] - ETA: 0s - loss: 0.01138/8 [==============================] - 0s 27ms/step - loss: 0.0117
1/8 [==>...........................] - ETA: 0s - loss: 0.02203/8 [==========>...................] - ETA: 0s - loss: 0.02705/8 [=================>............] - ETA: 0s - loss: 0.02677/8 [=========================>....] - ETA: 0s - loss: 0.02628/8 [==============================] - 0s 27ms/step - loss: 0.0267
1/8 [==>...........................] - ETA: 0s - loss: 0.00263/8 [==========>...................] - ETA: 0s - loss: 0.00355/8 [=================>............] - ETA: 0s - loss: 0.00577/8 [=========================>....] - ETA: 0s - loss: 0.00738/8 [==============================] - 0s 31ms/step - loss: 0.0079
1/8 [==>...........................] - ETA: 0s - loss: 0.00823/8 [==========>...................] - ETA: 0s - loss: 0.01195/8 [=================>............] - ETA: 0s - loss: 0.01147/8 [=========================>....] - ETA: 0s - loss: 0.01148/8 [==============================] - 0s 26ms/step - loss: 0.0118
1/8 [==>...........................] - ETA: 0s - loss: 0.00953/8 [==========>...................] - ETA: 0s - loss: 0.01195/8 [=================>............] - ETA: 0s - loss: 0.01197/8 [=========================>....] - ETA: 0s - loss: 0.01158/8 [==============================] - 0s 25ms/step - loss: 0.0120
1/8 [==>...........................] - ETA: 0s - loss: 0.00913/8 [==========>...................] - ETA: 0s - loss: 0.01135/8 [=================>............] - ETA: 0s - loss: 0.01117/8 [=========================>....] - ETA: 0s - loss: 0.01128/8 [==============================] - 0s 26ms/step - loss: 0.0117
1/8 [==>...........................] - ETA: 0s - loss: 0.02303/8 [==========>...................] - ETA: 0s - loss: 0.02715/8 [=================>............] - ETA: 0s - loss: 0.02637/8 [=========================>....] - ETA: 0s - loss: 0.02588/8 [==============================] - 0s 25ms/step - loss: 0.0263
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.00529357825871557:
Train Score: 0.01112 MSE 0.10545 RMSE
Test Score: 0.02620 MSE 0.16185 RMSE
Deviation Min [4.80982446e-05], Max [0.40109027]
Deviation 99.5th pctile [0.3520212]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1655,    1]))
Confusion matrix 
[[1646    9]
 [   1    0]]
precision 0.00000, recall 0.00000, f1 0.00000
Time to train: 375508 ms
Saving model models/A4Benchmark/A4Benchmark-TS66.csv.h5
Total Time to proces all the selected files : 378200 ms
A4Benchmark : Avg precision 0.00000 recall 0.00000 f1 0.00000 time to train 375508.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS66.csv  --epochs 20 --n_iter 3 --patience 3 :: took 393 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS67.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 11:28:36 PM MST
2020-11-30 23:29:09.915333: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 23:29:09.934198: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 23:29:09.935632: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x561f4313c8e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 23:29:09.935682: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 23:29:09.935886: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS67.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00644/8 [==============>...............] - ETA: 0s - loss: 0.00347/8 [=========================>....] - ETA: 0s - loss: 0.00418/8 [==============================] - 0s 17ms/step - loss: 0.0045
1/8 [==>...........................] - ETA: 0s - loss: 0.00724/8 [==============>...............] - ETA: 0s - loss: 0.00766/8 [=====================>........] - ETA: 0s - loss: 0.00798/8 [==============================] - 0s 18ms/step - loss: 0.0080
1/8 [==>...........................] - ETA: 0s - loss: 0.00924/8 [==============>...............] - ETA: 0s - loss: 0.00897/8 [=========================>....] - ETA: 0s - loss: 0.00888/8 [==============================] - 0s 15ms/step - loss: 0.0086
1/8 [==>...........................] - ETA: 0s - loss: 0.00214/8 [==============>...............] - ETA: 0s - loss: 0.00257/8 [=========================>....] - ETA: 0s - loss: 0.00278/8 [==============================] - 0s 15ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 0.00225/8 [=================>............] - ETA: 0s - loss: 0.00258/8 [==============================] - 0s 12ms/step - loss: 0.0026
1/8 [==>...........................] - ETA: 0s - loss: 0.00645/8 [=================>............] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 12ms/step - loss: 0.0046
1/8 [==>...........................] - ETA: 0s - loss: 0.00674/8 [==============>...............] - ETA: 0s - loss: 0.00698/8 [==============================] - ETA: 0s - loss: 0.00728/8 [==============================] - 0s 14ms/step - loss: 0.0072
1/8 [==>...........................] - ETA: 0s - loss: 0.00925/8 [=================>............] - ETA: 0s - loss: 0.00938/8 [==============================] - 0s 11ms/step - loss: 0.0086
1/8 [==>...........................] - ETA: 0s - loss: 0.00115/8 [=================>............] - ETA: 0s - loss: 0.00128/8 [==============================] - 0s 13ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 6.6941e-045/8 [=================>............] - ETA: 0s - loss: 0.0010    8/8 [==============================] - 0s 12ms/step - loss: 0.0010
1/8 [==>...........................] - ETA: 0s - loss: 0.00743/8 [==========>...................] - ETA: 0s - loss: 0.00445/8 [=================>............] - ETA: 0s - loss: 0.00407/8 [=========================>....] - ETA: 0s - loss: 0.00478/8 [==============================] - 0s 23ms/step - loss: 0.0052
1/8 [==>...........................] - ETA: 0s - loss: 0.00723/8 [==========>...................] - ETA: 0s - loss: 0.00865/8 [=================>............] - ETA: 0s - loss: 0.00857/8 [=========================>....] - ETA: 0s - loss: 0.00858/8 [==============================] - 0s 25ms/step - loss: 0.0088
1/8 [==>...........................] - ETA: 0s - loss: 0.01014/8 [==============>...............] - ETA: 0s - loss: 0.01016/8 [=====================>........] - ETA: 0s - loss: 0.01098/8 [==============================] - ETA: 0s - loss: 0.00978/8 [==============================] - 0s 23ms/step - loss: 0.0097
1/8 [==>...........................] - ETA: 0s - loss: 0.00263/8 [==========>...................] - ETA: 0s - loss: 0.00355/8 [=================>............] - ETA: 0s - loss: 0.00347/8 [=========================>....] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 24ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.00263/8 [==========>...................] - ETA: 0s - loss: 0.00295/8 [=================>............] - ETA: 0s - loss: 0.00297/8 [=========================>....] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 31ms/step - loss: 0.0030
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.004582727490924299:
Train Score: 0.00579 MSE 0.07608 RMSE
Test Score: 0.01054 MSE 0.10266 RMSE
Deviation Min [3.27547026e-05], Max [0.41584507]
Deviation 99.5th pctile [0.22038969]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1642,   14]))
Confusion matrix 
[[1642    0]
 [   5    9]]
precision 1.00000, recall 0.64286, f1 0.78261
Time to train: 303328 ms
Saving model models/A4Benchmark/A4Benchmark-TS67.csv.h5
Total Time to proces all the selected files : 305792 ms
A4Benchmark : Avg precision 1.00000 recall 0.64286 f1 0.78261 time to train 303328.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS67.csv  --epochs 20 --n_iter 3 --patience 3 :: took 340 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS68.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 11:34:21 PM MST
2020-11-30 23:34:33.091895: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 23:34:33.110242: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 23:34:33.111647: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x564df4a3bd30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 23:34:33.111698: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 23:34:33.111903: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS68.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.01075/8 [=================>............] - ETA: 0s - loss: 0.01338/8 [==============================] - 0s 14ms/step - loss: 0.0137
1/8 [==>...........................] - ETA: 0s - loss: 0.00155/8 [=================>............] - ETA: 0s - loss: 0.00278/8 [==============================] - 0s 11ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.00134/8 [==============>...............] - ETA: 0s - loss: 0.00208/8 [==============================] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 14ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.02434/8 [==============>...............] - ETA: 0s - loss: 0.02067/8 [=========================>....] - ETA: 0s - loss: 0.02498/8 [==============================] - 0s 16ms/step - loss: 0.0252
1/8 [==>...........................] - ETA: 0s - loss: 4.4335e-045/8 [=================>............] - ETA: 0s - loss: 0.0012    8/8 [==============================] - 0s 14ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 0.01194/8 [==============>...............] - ETA: 0s - loss: 0.01547/8 [=========================>....] - ETA: 0s - loss: 0.01648/8 [==============================] - 0s 17ms/step - loss: 0.0175
1/8 [==>...........................] - ETA: 0s - loss: 0.00224/8 [==============>...............] - ETA: 0s - loss: 0.00317/8 [=========================>....] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 15ms/step - loss: 0.0030
1/8 [==>...........................] - ETA: 0s - loss: 0.00585/8 [=================>............] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 12ms/step - loss: 0.0064
1/8 [==>...........................] - ETA: 0s - loss: 0.00915/8 [=================>............] - ETA: 0s - loss: 0.00798/8 [==============================] - 0s 14ms/step - loss: 0.0081
1/8 [==>...........................] - ETA: 0s - loss: 0.00345/8 [=================>............] - ETA: 0s - loss: 0.02768/8 [==============================] - ETA: 0s - loss: 0.02178/8 [==============================] - 0s 14ms/step - loss: 0.0217
1/8 [==>...........................] - ETA: 0s - loss: 0.01423/8 [==========>...................] - ETA: 0s - loss: 0.01585/8 [=================>............] - ETA: 0s - loss: 0.01777/8 [=========================>....] - ETA: 0s - loss: 0.01698/8 [==============================] - 0s 34ms/step - loss: 0.0172
1/8 [==>...........................] - ETA: 0s - loss: 0.01333/8 [==========>...................] - ETA: 0s - loss: 0.01725/8 [=================>............] - ETA: 0s - loss: 0.01637/8 [=========================>....] - ETA: 0s - loss: 0.01638/8 [==============================] - 0s 33ms/step - loss: 0.0168
1/8 [==>...........................] - ETA: 0s - loss: 0.00223/8 [==========>...................] - ETA: 0s - loss: 0.00315/8 [=================>............] - ETA: 0s - loss: 0.00287/8 [=========================>....] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 28ms/step - loss: 0.0031
1/8 [==>...........................] - ETA: 0s - loss: 0.00162/8 [======>.......................] - ETA: 0s - loss: 0.00134/8 [==============>...............] - ETA: 0s - loss: 0.00136/8 [=====================>........] - ETA: 0s - loss: 0.00208/8 [==============================] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 42ms/step - loss: 0.0018
1/8 [==>...........................] - ETA: 0s - loss: 0.01293/8 [==========>...................] - ETA: 0s - loss: 0.01105/8 [=================>............] - ETA: 0s - loss: 0.01407/8 [=========================>....] - ETA: 0s - loss: 0.01378/8 [==============================] - 0s 32ms/step - loss: 0.0141
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.008960314840078355:
Train Score: 0.00109 MSE 0.03306 RMSE
Test Score: 0.00119 MSE 0.03447 RMSE
Deviation Min [7.71622058e-05], Max [0.21974505]
Deviation 99.5th pctile [0.10056386]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1655,    1]))
Confusion matrix 
[[1647    8]
 [   0    1]]
precision 0.11111, recall 1.00000, f1 0.20000
Time to train: 472911 ms
Saving model models/A4Benchmark/A4Benchmark-TS68.csv.h5
Total Time to proces all the selected files : 475815 ms
A4Benchmark : Avg precision 0.11111 recall 1.00000 f1 0.20000 time to train 472911.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS68.csv  --epochs 20 --n_iter 3 --patience 3 :: took 488 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS69.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 11:42:34 PM MST
2020-11-30 23:42:40.546224: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 23:42:40.564189: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 23:42:40.565728: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x557ae786dd30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 23:42:40.565802: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 23:42:40.566078: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS69.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.01013/8 [==========>...................] - ETA: 0s - loss: 0.00855/8 [=================>............] - ETA: 0s - loss: 0.00897/8 [=========================>....] - ETA: 0s - loss: 0.00788/8 [==============================] - 0s 31ms/step - loss: 0.0074
1/8 [==>...........................] - ETA: 0s - loss: 0.00173/8 [==========>...................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00157/8 [=========================>....] - ETA: 0s - loss: 0.00168/8 [==============================] - 0s 33ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 0.00213/8 [==========>...................] - ETA: 0s - loss: 0.00265/8 [=================>............] - ETA: 0s - loss: 0.00187/8 [=========================>....] - ETA: 0s - loss: 0.00198/8 [==============================] - 0s 26ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 8.8335e-043/8 [==========>...................] - ETA: 0s - loss: 7.8967e-045/8 [=================>............] - ETA: 0s - loss: 0.0011    7/8 [=========================>....] - ETA: 0s - loss: 0.00128/8 [==============================] - 0s 28ms/step - loss: 0.0011
1/8 [==>...........................] - ETA: 0s - loss: 0.00343/8 [==========>...................] - ETA: 0s - loss: 0.01165/8 [=================>............] - ETA: 0s - loss: 0.01447/8 [=========================>....] - ETA: 0s - loss: 0.01348/8 [==============================] - 0s 31ms/step - loss: 0.0137
1/8 [==>...........................] - ETA: 0s - loss: 0.00816/8 [=====================>........] - ETA: 0s - loss: 0.00708/8 [==============================] - 0s 12ms/step - loss: 0.0062
1/8 [==>...........................] - ETA: 0s - loss: 0.00145/8 [=================>............] - ETA: 0s - loss: 0.00118/8 [==============================] - 0s 13ms/step - loss: 0.0013
1/8 [==>...........................] - ETA: 0s - loss: 0.00145/8 [=================>............] - ETA: 0s - loss: 8.8937e-048/8 [==============================] - 0s 13ms/step - loss: 9.2414e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00125/8 [=================>............] - ETA: 0s - loss: 0.00128/8 [==============================] - 0s 11ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 4.4460e-046/8 [=====================>........] - ETA: 0s - loss: 0.0043    8/8 [==============================] - 0s 11ms/step - loss: 0.0044
1/8 [==>...........................] - ETA: 0s - loss: 0.00353/8 [==========>...................] - ETA: 0s - loss: 0.00675/8 [=================>............] - ETA: 0s - loss: 0.01037/8 [=========================>....] - ETA: 0s - loss: 0.00828/8 [==============================] - 0s 27ms/step - loss: 0.0078
1/8 [==>...........................] - ETA: 0s - loss: 0.00162/8 [======>.......................] - ETA: 0s - loss: 0.00204/8 [==============>...............] - ETA: 0s - loss: 0.00176/8 [=====================>........] - ETA: 0s - loss: 0.00158/8 [==============================] - ETA: 0s - loss: 0.00178/8 [==============================] - 0s 32ms/step - loss: 0.0017
1/8 [==>...........................] - ETA: 0s - loss: 0.00223/8 [==========>...................] - ETA: 0s - loss: 0.00265/8 [=================>............] - ETA: 0s - loss: 0.00187/8 [=========================>....] - ETA: 0s - loss: 0.00198/8 [==============================] - 0s 39ms/step - loss: 0.0020
1/8 [==>...........................] - ETA: 0s - loss: 8.5423e-043/8 [==========>...................] - ETA: 0s - loss: 5.1838e-045/8 [=================>............] - ETA: 0s - loss: 8.6376e-047/8 [=========================>....] - ETA: 0s - loss: 8.8197e-048/8 [==============================] - 0s 25ms/step - loss: 8.4348e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00645/8 [=================>............] - ETA: 0s - loss: 0.00637/8 [=========================>....] - ETA: 0s - loss: 0.00638/8 [==============================] - 0s 39ms/step - loss: 0.0065
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.002797125105280429:
Train Score: 0.00198 MSE 0.04450 RMSE
Test Score: 0.00465 MSE 0.06816 RMSE
Deviation Min [1.56478259e-05], Max [0.51419333]
Deviation 99.5th pctile [0.1554154]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1654,    2]))
Confusion matrix 
[[1647    7]
 [   0    2]]
precision 0.22222, recall 1.00000, f1 0.36364
Time to train: 867922 ms
Saving model models/A4Benchmark/A4Benchmark-TS69.csv.h5
Total Time to proces all the selected files : 870263 ms
A4Benchmark : Avg precision 0.22222 recall 1.00000 f1 0.36364 time to train 867922.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS69.csv  --epochs 20 --n_iter 3 --patience 3 :: took 877 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS6.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 11:57:16 PM MST
2020-11-30 23:57:25.541642: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 23:57:25.560220: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-11-30 23:57:25.561671: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5569048fed30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 23:57:25.561717: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 23:57:25.561915: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS6.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00594/8 [==============>...............] - ETA: 0s - loss: 0.00667/8 [=========================>....] - ETA: 0s - loss: 0.00618/8 [==============================] - 0s 17ms/step - loss: 0.0058
1/8 [==>...........................] - ETA: 0s - loss: 0.02165/8 [=================>............] - ETA: 0s - loss: 0.02088/8 [==============================] - 0s 13ms/step - loss: 0.0191
1/8 [==>...........................] - ETA: 0s - loss: 0.00425/8 [=================>............] - ETA: 0s - loss: 0.00458/8 [==============================] - 0s 12ms/step - loss: 0.0057
1/8 [==>...........................] - ETA: 0s - loss: 0.00125/8 [=================>............] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 13ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 8.1272e-045/8 [=================>............] - ETA: 0s - loss: 0.0017    8/8 [==============================] - 0s 13ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.00585/8 [=================>............] - ETA: 0s - loss: 0.00618/8 [==============================] - ETA: 0s - loss: 0.00568/8 [==============================] - 0s 15ms/step - loss: 0.0056
1/8 [==>...........................] - ETA: 0s - loss: 0.01205/8 [=================>............] - ETA: 0s - loss: 0.01298/8 [==============================] - 0s 13ms/step - loss: 0.0107
1/8 [==>...........................] - ETA: 0s - loss: 0.00594/8 [==============>...............] - ETA: 0s - loss: 0.00577/8 [=========================>....] - ETA: 0s - loss: 0.00728/8 [==============================] - 0s 19ms/step - loss: 0.0070
1/8 [==>...........................] - ETA: 0s - loss: 0.00305/8 [=================>............] - ETA: 0s - loss: 0.00258/8 [==============================] - 0s 13ms/step - loss: 0.0024
1/8 [==>...........................] - ETA: 0s - loss: 0.00544/8 [==============>...............] - ETA: 0s - loss: 0.00887/8 [=========================>....] - ETA: 0s - loss: 0.00838/8 [==============================] - 0s 16ms/step - loss: 0.0085
1/8 [==>...........................] - ETA: 0s - loss: 0.00723/8 [==========>...................] - ETA: 0s - loss: 0.00485/8 [=================>............] - ETA: 0s - loss: 0.00707/8 [=========================>....] - ETA: 0s - loss: 0.00678/8 [==============================] - ETA: 0s - loss: 0.00648/8 [==============================] - 0s 32ms/step - loss: 0.0064
1/8 [==>...........................] - ETA: 0s - loss: 0.01293/8 [==========>...................] - ETA: 0s - loss: 0.01205/8 [=================>............] - ETA: 0s - loss: 0.01307/8 [=========================>....] - ETA: 0s - loss: 0.01148/8 [==============================] - 0s 24ms/step - loss: 0.0113
1/8 [==>...........................] - ETA: 0s - loss: 0.00233/8 [==========>...................] - ETA: 0s - loss: 0.00315/8 [=================>............] - ETA: 0s - loss: 0.00327/8 [=========================>....] - ETA: 0s - loss: 0.00438/8 [==============================] - 0s 24ms/step - loss: 0.0043
1/8 [==>...........................] - ETA: 0s - loss: 0.00173/8 [==========>...................] - ETA: 0s - loss: 0.00155/8 [=================>............] - ETA: 0s - loss: 0.00167/8 [=========================>....] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 30ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 0.00203/8 [==========>...................] - ETA: 0s - loss: 0.00225/8 [=================>............] - ETA: 0s - loss: 0.00217/8 [=========================>....] - ETA: 0s - loss: 0.00258/8 [==============================] - 0s 32ms/step - loss: 0.0025
Best parameters {'n_units': 48, 'n_hidden': 2} best score 0.005199838196858764:
Train Score: 0.00416 MSE 0.06453 RMSE
Test Score: 0.00127 MSE 0.03562 RMSE
Deviation Min [2.02214202e-05], Max [0.58043402]
Deviation 99.5th pctile [0.2467522]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1648,    8]))
Confusion matrix 
[[1647    1]
 [   0    8]]
precision 0.88889, recall 1.00000, f1 0.94118
Time to train: 704374 ms
Saving model models/A4Benchmark/A4Benchmark-TS6.csv.h5
Total Time to proces all the selected files : 708358 ms
A4Benchmark : Avg precision 0.88889 recall 1.00000 f1 0.94118 time to train 704374.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS6.csv  --epochs 20 --n_iter 3 --patience 3 :: took 718 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS70.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 12:09:19 AM MST
2020-12-01 00:09:38.837021: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 00:09:38.855213: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-12-01 00:09:38.856042: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x558210a3c8e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 00:09:38.856070: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 00:09:38.856176: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS70.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00885/8 [=================>............] - ETA: 0s - loss: 0.00498/8 [==============================] - ETA: 0s - loss: 0.00498/8 [==============================] - 0s 16ms/step - loss: 0.0049
1/8 [==>...........................] - ETA: 0s - loss: 0.00425/8 [=================>............] - ETA: 0s - loss: 0.00508/8 [==============================] - 0s 13ms/step - loss: 0.0054
1/8 [==>...........................] - ETA: 0s - loss: 0.00625/8 [=================>............] - ETA: 0s - loss: 0.00538/8 [==============================] - 0s 14ms/step - loss: 0.0050
1/8 [==>...........................] - ETA: 0s - loss: 0.00554/8 [==============>...............] - ETA: 0s - loss: 0.00468/8 [==============================] - ETA: 0s - loss: 0.00438/8 [==============================] - 0s 14ms/step - loss: 0.0043
1/8 [==>...........................] - ETA: 0s - loss: 0.00334/8 [==============>...............] - ETA: 0s - loss: 0.00627/8 [=========================>....] - ETA: 0s - loss: 0.00528/8 [==============================] - 0s 18ms/step - loss: 0.0053
1/8 [==>...........................] - ETA: 0s - loss: 0.00853/8 [==========>...................] - ETA: 0s - loss: 0.00635/8 [=================>............] - ETA: 0s - loss: 0.00567/8 [=========================>....] - ETA: 0s - loss: 0.00598/8 [==============================] - 0s 32ms/step - loss: 0.0058
1/8 [==>...........................] - ETA: 0s - loss: 0.00273/8 [==========>...................] - ETA: 0s - loss: 0.00345/8 [=================>............] - ETA: 0s - loss: 0.00447/8 [=========================>....] - ETA: 0s - loss: 0.00508/8 [==============================] - 0s 29ms/step - loss: 0.0050
1/8 [==>...........................] - ETA: 0s - loss: 0.00893/8 [==========>...................] - ETA: 0s - loss: 0.00775/8 [=================>............] - ETA: 0s - loss: 0.00727/8 [=========================>....] - ETA: 0s - loss: 0.00658/8 [==============================] - 0s 31ms/step - loss: 0.0066
1/8 [==>...........................] - ETA: 0s - loss: 0.00483/8 [==========>...................] - ETA: 0s - loss: 0.00505/8 [=================>............] - ETA: 0s - loss: 0.00497/8 [=========================>....] - ETA: 0s - loss: 0.00448/8 [==============================] - 0s 27ms/step - loss: 0.0044
1/8 [==>...........................] - ETA: 0s - loss: 0.00433/8 [==========>...................] - ETA: 0s - loss: 0.00655/8 [=================>............] - ETA: 0s - loss: 0.00877/8 [=========================>....] - ETA: 0s - loss: 0.00738/8 [==============================] - 0s 31ms/step - loss: 0.0073
1/8 [==>...........................] - ETA: 0s - loss: 0.01143/8 [==========>...................] - ETA: 0s - loss: 0.00805/8 [=================>............] - ETA: 0s - loss: 0.00627/8 [=========================>....] - ETA: 0s - loss: 0.00738/8 [==============================] - 0s 29ms/step - loss: 0.0071
1/8 [==>...........................] - ETA: 0s - loss: 0.00213/8 [==========>...................] - ETA: 0s - loss: 0.00285/8 [=================>............] - ETA: 0s - loss: 0.00417/8 [=========================>....] - ETA: 0s - loss: 0.00438/8 [==============================] - 0s 34ms/step - loss: 0.0042
1/8 [==>...........................] - ETA: 0s - loss: 0.00612/8 [======>.......................] - ETA: 0s - loss: 0.00603/8 [==========>...................] - ETA: 0s - loss: 0.00665/8 [=================>............] - ETA: 0s - loss: 0.00567/8 [=========================>....] - ETA: 0s - loss: 0.00518/8 [==============================] - 0s 40ms/step - loss: 0.0054
1/8 [==>...........................] - ETA: 0s - loss: 0.00963/8 [==========>...................] - ETA: 0s - loss: 0.00645/8 [=================>............] - ETA: 0s - loss: 0.00647/8 [=========================>....] - ETA: 0s - loss: 0.00598/8 [==============================] - 0s 32ms/step - loss: 0.0058
1/8 [==>...........................] - ETA: 0s - loss: 0.00453/8 [==========>...................] - ETA: 0s - loss: 0.00565/8 [=================>............] - ETA: 0s - loss: 0.00737/8 [=========================>....] - ETA: 0s - loss: 0.00628/8 [==============================] - 0s 31ms/step - loss: 0.0063
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0049748788587749004:
Train Score: 0.00409 MSE 0.06396 RMSE
Test Score: 0.00408 MSE 0.06389 RMSE
Deviation Min [0.00012488], Max [0.50574976]
Deviation 99.5th pctile [0.17853251]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1652,    4]))
Confusion matrix 
[[1647    5]
 [   0    4]]
precision 0.44444, recall 1.00000, f1 0.61538
Time to train: 692298 ms
Saving model models/A4Benchmark/A4Benchmark-TS70.csv.h5
Total Time to proces all the selected files : 694677 ms
A4Benchmark : Avg precision 0.44444 recall 1.00000 f1 0.61538 time to train 692298.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS70.csv  --epochs 20 --n_iter 3 --patience 3 :: took 715 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS71.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 12:21:19 AM MST
2020-12-01 00:21:38.408844: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 00:21:38.427242: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-12-01 00:21:38.428100: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55a479e9bc00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 00:21:38.428126: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 00:21:38.428234: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS71.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 6.7758e-043/8 [==========>...................] - ETA: 0s - loss: 5.0332e-045/8 [=================>............] - ETA: 0s - loss: 4.0715e-047/8 [=========================>....] - ETA: 0s - loss: 3.3162e-048/8 [==============================] - 0s 24ms/step - loss: 3.2502e-04
1/8 [==>...........................] - ETA: 0s - loss: 6.3209e-043/8 [==========>...................] - ETA: 0s - loss: 5.4762e-046/8 [=====================>........] - ETA: 0s - loss: 3.6717e-048/8 [==============================] - 0s 22ms/step - loss: 3.8106e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.01013/8 [==========>...................] - ETA: 0s - loss: 0.01435/8 [=================>............] - ETA: 0s - loss: 0.01377/8 [=========================>....] - ETA: 0s - loss: 0.01448/8 [==============================] - 0s 30ms/step - loss: 0.0148
1/8 [==>...........................] - ETA: 0s - loss: 0.01173/8 [==========>...................] - ETA: 0s - loss: 0.01625/8 [=================>............] - ETA: 0s - loss: 0.01517/8 [=========================>....] - ETA: 0s - loss: 0.01468/8 [==============================] - 0s 26ms/step - loss: 0.0150
1/8 [==>...........................] - ETA: 0s - loss: 0.02093/8 [==========>...................] - ETA: 0s - loss: 0.02985/8 [=================>............] - ETA: 0s - loss: 0.03017/8 [=========================>....] - ETA: 0s - loss: 0.02748/8 [==============================] - 0s 23ms/step - loss: 0.0270
1/8 [==>...........................] - ETA: 0s - loss: 0.00225/8 [=================>............] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 13ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 2.1603e-046/8 [=====================>........] - ETA: 0s - loss: 6.2507e-048/8 [==============================] - 0s 10ms/step - loss: 7.8072e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00805/8 [=================>............] - ETA: 0s - loss: 0.01068/8 [==============================] - 0s 13ms/step - loss: 0.0109
1/8 [==>...........................] - ETA: 0s - loss: 0.00974/8 [==============>...............] - ETA: 0s - loss: 0.01297/8 [=========================>....] - ETA: 0s - loss: 0.01218/8 [==============================] - 0s 16ms/step - loss: 0.0125
1/8 [==>...........................] - ETA: 0s - loss: 0.00564/8 [==============>...............] - ETA: 0s - loss: 0.00667/8 [=========================>....] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 16ms/step - loss: 0.0045
1/8 [==>...........................] - ETA: 0s - loss: 8.5342e-043/8 [==========>...................] - ETA: 0s - loss: 7.1872e-045/8 [=================>............] - ETA: 0s - loss: 6.2893e-047/8 [=========================>....] - ETA: 0s - loss: 5.1818e-048/8 [==============================] - 0s 33ms/step - loss: 4.9787e-04
1/8 [==>...........................] - ETA: 0s - loss: 1.1735e-043/8 [==========>...................] - ETA: 0s - loss: 1.4743e-045/8 [=================>............] - ETA: 0s - loss: 1.5522e-047/8 [=========================>....] - ETA: 0s - loss: 1.4889e-048/8 [==============================] - 0s 34ms/step - loss: 2.1153e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00973/8 [==========>...................] - ETA: 0s - loss: 0.01325/8 [=================>............] - ETA: 0s - loss: 0.01297/8 [=========================>....] - ETA: 0s - loss: 0.01318/8 [==============================] - 0s 34ms/step - loss: 0.0135
1/8 [==>...........................] - ETA: 0s - loss: 0.01403/8 [==========>...................] - ETA: 0s - loss: 0.01795/8 [=================>............] - ETA: 0s - loss: 0.01697/8 [=========================>....] - ETA: 0s - loss: 0.01698/8 [==============================] - 0s 28ms/step - loss: 0.0173
1/8 [==>...........................] - ETA: 0s - loss: 0.02362/8 [======>.......................] - ETA: 0s - loss: 0.02803/8 [==========>...................] - ETA: 0s - loss: 0.03365/8 [=================>............] - ETA: 0s - loss: 0.03487/8 [=========================>....] - ETA: 0s - loss: 0.03258/8 [==============================] - 0s 34ms/step - loss: 0.0321
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.0060491371084935965:
Train Score: 0.00420 MSE 0.06484 RMSE
Test Score: 0.00611 MSE 0.07817 RMSE
Deviation Min [1.70039844e-05], Max [0.47447574]
Deviation 99.5th pctile [0.21053083]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1646,   10]))
Confusion matrix 
[[1641    5]
 [   6    4]]
precision 0.44444, recall 0.40000, f1 0.42105
Time to train: 371785 ms
Saving model models/A4Benchmark/A4Benchmark-TS71.csv.h5
Total Time to proces all the selected files : 374328 ms
A4Benchmark : Avg precision 0.44444 recall 0.40000 f1 0.42105 time to train 371785.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS71.csv  --epochs 20 --n_iter 3 --patience 3 :: took 394 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS72.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 12:27:58 AM MST
2020-12-01 00:28:28.517942: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 00:28:28.536263: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-12-01 00:28:28.537136: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x562804853c00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 00:28:28.537163: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 00:28:28.537280: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS72.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 1.8468e-043/8 [==========>...................] - ETA: 0s - loss: 2.2598e-045/8 [=================>............] - ETA: 0s - loss: 0.0019    7/8 [=========================>....] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 29ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.01453/8 [==========>...................] - ETA: 0s - loss: 0.01755/8 [=================>............] - ETA: 0s - loss: 0.01767/8 [=========================>....] - ETA: 0s - loss: 0.01758/8 [==============================] - 0s 24ms/step - loss: 0.0181
1/8 [==>...........................] - ETA: 0s - loss: 0.01433/8 [==========>...................] - ETA: 0s - loss: 0.01975/8 [=================>............] - ETA: 0s - loss: 0.01887/8 [=========================>....] - ETA: 0s - loss: 0.01868/8 [==============================] - 0s 28ms/step - loss: 0.0197
1/8 [==>...........................] - ETA: 0s - loss: 0.01333/8 [==========>...................] - ETA: 0s - loss: 0.01645/8 [=================>............] - ETA: 0s - loss: 0.01607/8 [=========================>....] - ETA: 0s - loss: 0.01798/8 [==============================] - 0s 32ms/step - loss: 0.0183
1/8 [==>...........................] - ETA: 0s - loss: 0.02443/8 [==========>...................] - ETA: 0s - loss: 0.02735/8 [=================>............] - ETA: 0s - loss: 0.02547/8 [=========================>....] - ETA: 0s - loss: 0.02488/8 [==============================] - 0s 31ms/step - loss: 0.0252
1/8 [==>...........................] - ETA: 0s - loss: 4.3246e-045/8 [=================>............] - ETA: 0s - loss: 0.0021    8/8 [==============================] - ETA: 0s - loss: 0.00278/8 [==============================] - 0s 16ms/step - loss: 0.0027
1/8 [==>...........................] - ETA: 0s - loss: 0.01015/8 [=================>............] - ETA: 0s - loss: 0.01208/8 [==============================] - 0s 12ms/step - loss: 0.0123
1/8 [==>...........................] - ETA: 0s - loss: 0.01325/8 [=================>............] - ETA: 0s - loss: 0.01688/8 [==============================] - ETA: 0s - loss: 0.01758/8 [==============================] - 0s 16ms/step - loss: 0.0175
1/8 [==>...........................] - ETA: 0s - loss: 0.00754/8 [==============>...............] - ETA: 0s - loss: 0.00837/8 [=========================>....] - ETA: 0s - loss: 0.00988/8 [==============================] - 0s 16ms/step - loss: 0.0099
1/8 [==>...........................] - ETA: 0s - loss: 0.01055/8 [=================>............] - ETA: 0s - loss: 0.00618/8 [==============================] - ETA: 0s - loss: 0.00598/8 [==============================] - 0s 16ms/step - loss: 0.0059
1/8 [==>...........................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00155/8 [=================>............] - ETA: 0s - loss: 0.00567/8 [=========================>....] - ETA: 0s - loss: 0.00888/8 [==============================] - 0s 26ms/step - loss: 0.0099
1/8 [==>...........................] - ETA: 0s - loss: 0.01423/8 [==========>...................] - ETA: 0s - loss: 0.01705/8 [=================>............] - ETA: 0s - loss: 0.01727/8 [=========================>....] - ETA: 0s - loss: 0.01728/8 [==============================] - 0s 36ms/step - loss: 0.0178
1/8 [==>...........................] - ETA: 0s - loss: 0.01383/8 [==========>...................] - ETA: 0s - loss: 0.01885/8 [=================>............] - ETA: 0s - loss: 0.01807/8 [=========================>....] - ETA: 0s - loss: 0.01798/8 [==============================] - 0s 26ms/step - loss: 0.0189
1/8 [==>...........................] - ETA: 0s - loss: 0.00313/8 [==========>...................] - ETA: 0s - loss: 0.00484/8 [==============>...............] - ETA: 0s - loss: 0.00466/8 [=====================>........] - ETA: 0s - loss: 0.00728/8 [==============================] - ETA: 0s - loss: 0.00688/8 [==============================] - 0s 37ms/step - loss: 0.0068
1/8 [==>...........................] - ETA: 0s - loss: 0.02483/8 [==========>...................] - ETA: 0s - loss: 0.02725/8 [=================>............] - ETA: 0s - loss: 0.02527/8 [=========================>....] - ETA: 0s - loss: 0.02468/8 [==============================] - 0s 29ms/step - loss: 0.0250
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.009647811809554697:
Train Score: 0.00423 MSE 0.06501 RMSE
Test Score: 0.00632 MSE 0.07950 RMSE
Deviation Min [1.13078193e-05], Max [0.46337741]
Deviation 99.5th pctile [0.25897313]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1651,    5]))
Confusion matrix 
[[1645    6]
 [   2    3]]
precision 0.33333, recall 0.60000, f1 0.42857
Time to train: 346693 ms
Saving model models/A4Benchmark/A4Benchmark-TS72.csv.h5
Total Time to proces all the selected files : 348973 ms
A4Benchmark : Avg precision 0.33333 recall 0.60000 f1 0.42857 time to train 346693.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS72.csv  --epochs 20 --n_iter 3 --patience 3 :: took 379 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS73.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 12:34:22 AM MST
2020-12-01 00:34:45.228362: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 00:34:45.247142: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-12-01 00:34:45.248347: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55b2dcfa3d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 00:34:45.248380: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 00:34:45.248508: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS73.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00354/8 [==============>...............] - ETA: 0s - loss: 0.00318/8 [==============================] - 0s 12ms/step - loss: 0.0030
1/8 [==>...........................] - ETA: 0s - loss: 0.01205/8 [=================>............] - ETA: 0s - loss: 0.01588/8 [==============================] - 0s 11ms/step - loss: 0.0155
1/8 [==>...........................] - ETA: 0s - loss: 0.01345/8 [=================>............] - ETA: 0s - loss: 0.01838/8 [==============================] - ETA: 0s - loss: 0.01978/8 [==============================] - 0s 16ms/step - loss: 0.0197
1/8 [==>...........................] - ETA: 0s - loss: 0.01764/8 [==============>...............] - ETA: 0s - loss: 0.01646/8 [=====================>........] - ETA: 0s - loss: 0.01948/8 [==============================] - 0s 18ms/step - loss: 0.0193
1/8 [==>...........................] - ETA: 0s - loss: 0.00684/8 [==============>...............] - ETA: 0s - loss: 0.00567/8 [=========================>....] - ETA: 0s - loss: 0.00448/8 [==============================] - 0s 17ms/step - loss: 0.0045
1/8 [==>...........................] - ETA: 0s - loss: 0.01253/8 [==========>...................] - ETA: 0s - loss: 0.01505/8 [=================>............] - ETA: 0s - loss: 0.01477/8 [=========================>....] - ETA: 0s - loss: 0.01458/8 [==============================] - 0s 27ms/step - loss: 0.0149
1/8 [==>...........................] - ETA: 0s - loss: 0.01083/8 [==========>...................] - ETA: 0s - loss: 0.01465/8 [=================>............] - ETA: 0s - loss: 0.01537/8 [=========================>....] - ETA: 0s - loss: 0.01468/8 [==============================] - 0s 27ms/step - loss: 0.0149
1/8 [==>...........................] - ETA: 0s - loss: 0.01103/8 [==========>...................] - ETA: 0s - loss: 0.01525/8 [=================>............] - ETA: 0s - loss: 0.01437/8 [=========================>....] - ETA: 0s - loss: 0.01488/8 [==============================] - 0s 29ms/step - loss: 0.0152
1/8 [==>...........................] - ETA: 0s - loss: 0.01693/8 [==========>...................] - ETA: 0s - loss: 0.01665/8 [=================>............] - ETA: 0s - loss: 0.01587/8 [=========================>....] - ETA: 0s - loss: 0.01848/8 [==============================] - 0s 28ms/step - loss: 0.0187
1/8 [==>...........................] - ETA: 0s - loss: 0.01803/8 [==========>...................] - ETA: 0s - loss: 0.01915/8 [=================>............] - ETA: 0s - loss: 0.01697/8 [=========================>....] - ETA: 0s - loss: 0.01628/8 [==============================] - 0s 26ms/step - loss: 0.0165
1/8 [==>...........................] - ETA: 0s - loss: 0.01243/8 [==========>...................] - ETA: 0s - loss: 0.01495/8 [=================>............] - ETA: 0s - loss: 0.01477/8 [=========================>....] - ETA: 0s - loss: 0.01438/8 [==============================] - 0s 24ms/step - loss: 0.0147
1/8 [==>...........................] - ETA: 0s - loss: 0.01393/8 [==========>...................] - ETA: 0s - loss: 0.01595/8 [=================>............] - ETA: 0s - loss: 0.01827/8 [=========================>....] - ETA: 0s - loss: 0.01808/8 [==============================] - 0s 27ms/step - loss: 0.0181
1/8 [==>...........................] - ETA: 0s - loss: 0.00353/8 [==========>...................] - ETA: 0s - loss: 0.00345/8 [=================>............] - ETA: 0s - loss: 0.00477/8 [=========================>....] - ETA: 0s - loss: 0.00438/8 [==============================] - 0s 33ms/step - loss: 0.0043
1/8 [==>...........................] - ETA: 0s - loss: 0.01283/8 [==========>...................] - ETA: 0s - loss: 0.01405/8 [=================>............] - ETA: 0s - loss: 0.01337/8 [=========================>....] - ETA: 0s - loss: 0.01508/8 [==============================] - 0s 23ms/step - loss: 0.0154
1/8 [==>...........................] - ETA: 0s - loss: 0.01884/8 [==============>...............] - ETA: 0s - loss: 0.01866/8 [=====================>........] - ETA: 0s - loss: 0.01778/8 [==============================] - ETA: 0s - loss: 0.01748/8 [==============================] - 0s 24ms/step - loss: 0.0174
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.012398466793820262:
Train Score: 0.00320 MSE 0.05657 RMSE
Test Score: 0.00472 MSE 0.06874 RMSE
Deviation Min [1.72869299e-05], Max [0.3970778]
Deviation 99.5th pctile [0.1488671]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1651,    5]))
Confusion matrix 
[[1647    4]
 [   0    5]]
precision 0.55556, recall 1.00000, f1 0.71429
Time to train: 359613 ms
Saving model models/A4Benchmark/A4Benchmark-TS73.csv.h5
Total Time to proces all the selected files : 362004 ms
A4Benchmark : Avg precision 0.55556 recall 1.00000 f1 0.71429 time to train 359613.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS73.csv  --epochs 20 --n_iter 3 --patience 3 :: took 385 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS74.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 12:40:52 AM MST
2020-12-01 00:41:00.679196: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 00:41:00.698209: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-12-01 00:41:00.699048: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55702289b310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 00:41:00.699075: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 00:41:00.699187: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS74.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00353/8 [==========>...................] - ETA: 0s - loss: 0.00216/8 [=====================>........] - ETA: 0s - loss: 0.00188/8 [==============================] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 26ms/step - loss: 0.0018
1/8 [==>...........................] - ETA: 0s - loss: 0.01023/8 [==========>...................] - ETA: 0s - loss: 0.01275/8 [=================>............] - ETA: 0s - loss: 0.01417/8 [=========================>....] - ETA: 0s - loss: 0.01318/8 [==============================] - 0s 24ms/step - loss: 0.0134
1/8 [==>...........................] - ETA: 0s - loss: 0.00143/8 [==========>...................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00107/8 [=========================>....] - ETA: 0s - loss: 8.6527e-048/8 [==============================] - 0s 32ms/step - loss: 8.5366e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00443/8 [==========>...................] - ETA: 0s - loss: 0.00575/8 [=================>............] - ETA: 0s - loss: 0.00567/8 [=========================>....] - ETA: 0s - loss: 0.00568/8 [==============================] - 0s 24ms/step - loss: 0.0058
1/8 [==>...........................] - ETA: 0s - loss: 0.00923/8 [==========>...................] - ETA: 0s - loss: 0.00945/8 [=================>............] - ETA: 0s - loss: 0.01117/8 [=========================>....] - ETA: 0s - loss: 0.01178/8 [==============================] - 0s 33ms/step - loss: 0.0120
1/8 [==>...........................] - ETA: 0s - loss: 0.01883/8 [==========>...................] - ETA: 0s - loss: 0.02215/8 [=================>............] - ETA: 0s - loss: 0.02277/8 [=========================>....] - ETA: 0s - loss: 0.02208/8 [==============================] - 0s 38ms/step - loss: 0.0225
1/8 [==>...........................] - ETA: 0s - loss: 0.01753/8 [==========>...................] - ETA: 0s - loss: 0.02195/8 [=================>............] - ETA: 0s - loss: 0.02237/8 [=========================>....] - ETA: 0s - loss: 0.02178/8 [==============================] - 0s 35ms/step - loss: 0.0223
1/8 [==>...........................] - ETA: 0s - loss: 0.00253/8 [==========>...................] - ETA: 0s - loss: 0.00195/8 [=================>............] - ETA: 0s - loss: 0.00127/8 [=========================>....] - ETA: 0s - loss: 0.00128/8 [==============================] - 0s 32ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 2.6013e-043/8 [==========>...................] - ETA: 0s - loss: 4.2585e-045/8 [=================>............] - ETA: 0s - loss: 4.8089e-047/8 [=========================>....] - ETA: 0s - loss: 5.0833e-048/8 [==============================] - 0s 27ms/step - loss: 5.3248e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00893/8 [==========>...................] - ETA: 0s - loss: 0.00925/8 [=================>............] - ETA: 0s - loss: 0.01087/8 [=========================>....] - ETA: 0s - loss: 0.01148/8 [==============================] - 0s 29ms/step - loss: 0.0117
1/8 [==>...........................] - ETA: 0s - loss: 0.00284/8 [==============>...............] - ETA: 0s - loss: 0.00247/8 [=========================>....] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 16ms/step - loss: 0.0022
1/8 [==>...........................] - ETA: 0s - loss: 0.00125/8 [=================>............] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 14ms/step - loss: 0.0019
1/8 [==>...........................] - ETA: 0s - loss: 0.00294/8 [==============>...............] - ETA: 0s - loss: 0.00127/8 [=========================>....] - ETA: 0s - loss: 0.00118/8 [==============================] - 0s 17ms/step - loss: 0.0011
1/8 [==>...........................] - ETA: 0s - loss: 1.9575e-044/8 [==============>...............] - ETA: 0s - loss: 3.5087e-047/8 [=========================>....] - ETA: 0s - loss: 2.8648e-048/8 [==============================] - 0s 16ms/step - loss: 3.0350e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00245/8 [=================>............] - ETA: 0s - loss: 0.00338/8 [==============================] - 0s 14ms/step - loss: 0.0041
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.0019284709473140539:
Train Score: 0.00199 MSE 0.04459 RMSE
Test Score: 0.00648 MSE 0.08053 RMSE
Deviation Min [2.03115567e-05], Max [0.40690237]
Deviation 99.5th pctile [0.15991165]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1654,    2]))
Confusion matrix 
[[1647    7]
 [   0    2]]
precision 0.22222, recall 1.00000, f1 0.36364
Time to train: 607717 ms
Saving model models/A4Benchmark/A4Benchmark-TS74.csv.h5
Total Time to proces all the selected files : 610154 ms
A4Benchmark : Avg precision 0.22222 recall 1.00000 f1 0.36364 time to train 607717.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS74.csv  --epochs 20 --n_iter 3 --patience 3 :: took 619 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS75.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 12:51:16 AM MST
2020-12-01 00:51:27.749020: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 00:51:27.767185: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-12-01 00:51:27.767990: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x558fb5c00c00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 00:51:27.768018: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 00:51:27.768142: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS75.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00665/8 [=================>............] - ETA: 0s - loss: 0.00628/8 [==============================] - 0s 14ms/step - loss: 0.0061
1/8 [==>...........................] - ETA: 0s - loss: 0.00785/8 [=================>............] - ETA: 0s - loss: 0.00948/8 [==============================] - 0s 14ms/step - loss: 0.0101
1/8 [==>...........................] - ETA: 0s - loss: 0.00424/8 [==============>...............] - ETA: 0s - loss: 0.00617/8 [=========================>....] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 19ms/step - loss: 0.0060
1/8 [==>...........................] - ETA: 0s - loss: 0.00485/8 [=================>............] - ETA: 0s - loss: 0.00358/8 [==============================] - 0s 14ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00275/8 [=================>............] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 14ms/step - loss: 0.0054
1/8 [==>...........................] - ETA: 0s - loss: 0.00203/8 [==========>...................] - ETA: 0s - loss: 0.00495/8 [=================>............] - ETA: 0s - loss: 0.00467/8 [=========================>....] - ETA: 0s - loss: 0.00398/8 [==============================] - 0s 28ms/step - loss: 0.0038
1/8 [==>...........................] - ETA: 0s - loss: 0.01413/8 [==========>...................] - ETA: 0s - loss: 0.01785/8 [=================>............] - ETA: 0s - loss: 0.01797/8 [=========================>....] - ETA: 0s - loss: 0.01888/8 [==============================] - 0s 27ms/step - loss: 0.0195
1/8 [==>...........................] - ETA: 0s - loss: 0.00293/8 [==========>...................] - ETA: 0s - loss: 0.00585/8 [=================>............] - ETA: 0s - loss: 0.00517/8 [=========================>....] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 27ms/step - loss: 0.0049
1/8 [==>...........................] - ETA: 0s - loss: 0.01163/8 [==========>...................] - ETA: 0s - loss: 0.01205/8 [=================>............] - ETA: 0s - loss: 0.01287/8 [=========================>....] - ETA: 0s - loss: 0.01228/8 [==============================] - 0s 34ms/step - loss: 0.0125
1/8 [==>...........................] - ETA: 0s - loss: 0.00343/8 [==========>...................] - ETA: 0s - loss: 0.00675/8 [=================>............] - ETA: 0s - loss: 0.00637/8 [=========================>....] - ETA: 0s - loss: 0.00588/8 [==============================] - 0s 33ms/step - loss: 0.0060
1/8 [==>...........................] - ETA: 0s - loss: 0.01473/8 [==========>...................] - ETA: 0s - loss: 0.01735/8 [=================>............] - ETA: 0s - loss: 0.01667/8 [=========================>....] - ETA: 0s - loss: 0.01668/8 [==============================] - 0s 24ms/step - loss: 0.0166
1/8 [==>...........................] - ETA: 0s - loss: 0.00443/8 [==========>...................] - ETA: 0s - loss: 0.00455/8 [=================>............] - ETA: 0s - loss: 0.00357/8 [=========================>....] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 27ms/step - loss: 0.0040
1/8 [==>...........................] - ETA: 0s - loss: 0.01074/8 [==============>...............] - ETA: 0s - loss: 0.01206/8 [=====================>........] - ETA: 0s - loss: 0.01228/8 [==============================] - 0s 22ms/step - loss: 0.0120
1/8 [==>...........................] - ETA: 0s - loss: 0.00783/8 [==========>...................] - ETA: 0s - loss: 0.00515/8 [=================>............] - ETA: 0s - loss: 0.00647/8 [=========================>....] - ETA: 0s - loss: 0.00588/8 [==============================] - 0s 26ms/step - loss: 0.0056
1/8 [==>...........................] - ETA: 0s - loss: 0.00303/8 [==========>...................] - ETA: 0s - loss: 0.00435/8 [=================>............] - ETA: 0s - loss: 0.00477/8 [=========================>....] - ETA: 0s - loss: 0.00438/8 [==============================] - 0s 24ms/step - loss: 0.0044
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.006113828113302589:
Train Score: 0.01053 MSE 0.10261 RMSE
Test Score: 0.00354 MSE 0.05949 RMSE
Deviation Min [1.1591086e-05], Max [0.46026335]
Deviation 99.5th pctile [0.25702297]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1643,   13]))
Confusion matrix 
[[1641    2]
 [   6    7]]
precision 0.77778, recall 0.53846, f1 0.63636
Time to train: 583351 ms
Saving model models/A4Benchmark/A4Benchmark-TS75.csv.h5
Total Time to proces all the selected files : 586180 ms
A4Benchmark : Avg precision 0.77778 recall 0.53846 f1 0.63636 time to train 583351.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS75.csv  --epochs 20 --n_iter 3 --patience 3 :: took 598 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS76.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 01:01:19 AM MST
2020-12-01 01:01:30.727999: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 01:01:30.746196: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-12-01 01:01:30.747059: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5616cd626c00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 01:01:30.747087: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 01:01:30.747202: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS76.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 5.4030e-044/8 [==============>...............] - ETA: 0s - loss: 9.6709e-047/8 [=========================>....] - ETA: 0s - loss: 0.0011    8/8 [==============================] - 0s 19ms/step - loss: 0.0011
1/8 [==>...........................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.01078/8 [==============================] - 0s 14ms/step - loss: 0.0101
1/8 [==>...........................] - ETA: 0s - loss: 0.00855/8 [=================>............] - ETA: 0s - loss: 0.00918/8 [==============================] - 0s 14ms/step - loss: 0.0092
1/8 [==>...........................] - ETA: 0s - loss: 0.00855/8 [=================>............] - ETA: 0s - loss: 0.00948/8 [==============================] - 0s 14ms/step - loss: 0.0098
1/8 [==>...........................] - ETA: 0s - loss: 0.00874/8 [==============>...............] - ETA: 0s - loss: 0.01207/8 [=========================>....] - ETA: 0s - loss: 0.00948/8 [==============================] - 0s 19ms/step - loss: 0.0091
1/8 [==>...........................] - ETA: 0s - loss: 8.0980e-045/8 [=================>............] - ETA: 0s - loss: 0.0014    8/8 [==============================] - ETA: 0s - loss: 0.00168/8 [==============================] - 0s 15ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 0.00255/8 [=================>............] - ETA: 0s - loss: 0.01128/8 [==============================] - 0s 12ms/step - loss: 0.0105
1/8 [==>...........................] - ETA: 0s - loss: 0.00954/8 [==============>...............] - ETA: 0s - loss: 0.01117/8 [=========================>....] - ETA: 0s - loss: 0.01098/8 [==============================] - 0s 17ms/step - loss: 0.0112
1/8 [==>...........................] - ETA: 0s - loss: 0.00954/8 [==============>...............] - ETA: 0s - loss: 0.01017/8 [=========================>....] - ETA: 0s - loss: 0.01068/8 [==============================] - 0s 18ms/step - loss: 0.0109
1/8 [==>...........................] - ETA: 0s - loss: 0.00895/8 [=================>............] - ETA: 0s - loss: 0.01098/8 [==============================] - 0s 14ms/step - loss: 0.0083
1/8 [==>...........................] - ETA: 0s - loss: 7.3538e-045/8 [=================>............] - ETA: 0s - loss: 0.0013    8/8 [==============================] - ETA: 0s - loss: 0.00148/8 [==============================] - 0s 16ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 0.00285/8 [=================>............] - ETA: 0s - loss: 0.01188/8 [==============================] - 0s 11ms/step - loss: 0.0110
1/8 [==>...........................] - ETA: 0s - loss: 0.00936/8 [=====================>........] - ETA: 0s - loss: 0.00978/8 [==============================] - 0s 11ms/step - loss: 0.0095
1/8 [==>...........................] - ETA: 0s - loss: 0.00834/8 [==============>...............] - ETA: 0s - loss: 0.00927/8 [=========================>....] - ETA: 0s - loss: 0.00928/8 [==============================] - 0s 17ms/step - loss: 0.0094
1/8 [==>...........................] - ETA: 0s - loss: 0.00795/8 [=================>............] - ETA: 0s - loss: 0.00908/8 [==============================] - 0s 12ms/step - loss: 0.0063
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.007514681573957205:
Train Score: 0.00685 MSE 0.08275 RMSE
Test Score: 0.00039 MSE 0.01964 RMSE
Deviation Min [1.86646456e-05], Max [0.41646865]
Deviation 99.5th pctile [0.2239606]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Confusion matrix 
[[1641    6]
 [   6    3]]
precision 0.33333, recall 0.33333, f1 0.33333
Time to train: 197198 ms
Saving model models/A4Benchmark/A4Benchmark-TS76.csv.h5
Total Time to proces all the selected files : 199717 ms
A4Benchmark : Avg precision 0.33333 recall 0.33333 f1 0.33333 time to train 197198.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS76.csv  --epochs 20 --n_iter 3 --patience 3 :: took 211 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS77.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 01:04:55 AM MST
2020-12-01 01:05:04.784388: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 01:05:04.803261: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-12-01 01:05:04.804802: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5608675c28e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 01:05:04.804846: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 01:05:04.805032: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS77.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.01513/8 [==========>...................] - ETA: 0s - loss: 0.01845/8 [=================>............] - ETA: 0s - loss: 0.01727/8 [=========================>....] - ETA: 0s - loss: 0.01538/8 [==============================] - 0s 24ms/step - loss: 0.0151
1/8 [==>...........................] - ETA: 0s - loss: 0.01123/8 [==========>...................] - ETA: 0s - loss: 0.01135/8 [=================>............] - ETA: 0s - loss: 0.01337/8 [=========================>....] - ETA: 0s - loss: 0.01418/8 [==============================] - 0s 24ms/step - loss: 0.0144
1/8 [==>...........................] - ETA: 0s - loss: 0.00864/8 [==============>...............] - ETA: 0s - loss: 0.01206/8 [=====================>........] - ETA: 0s - loss: 0.01488/8 [==============================] - 0s 22ms/step - loss: 0.0156
1/8 [==>...........................] - ETA: 0s - loss: 0.01593/8 [==========>...................] - ETA: 0s - loss: 0.01295/8 [=================>............] - ETA: 0s - loss: 0.01117/8 [=========================>....] - ETA: 0s - loss: 0.01178/8 [==============================] - 0s 33ms/step - loss: 0.0118
1/8 [==>...........................] - ETA: 0s - loss: 0.00723/8 [==========>...................] - ETA: 0s - loss: 0.01105/8 [=================>............] - ETA: 0s - loss: 0.01027/8 [=========================>....] - ETA: 0s - loss: 0.00998/8 [==============================] - 0s 23ms/step - loss: 0.0099
1/8 [==>...........................] - ETA: 0s - loss: 0.01523/8 [==========>...................] - ETA: 0s - loss: 0.01755/8 [=================>............] - ETA: 0s - loss: 0.01757/8 [=========================>....] - ETA: 0s - loss: 0.01518/8 [==============================] - 0s 32ms/step - loss: 0.0148
1/8 [==>...........................] - ETA: 0s - loss: 0.00973/8 [==========>...................] - ETA: 0s - loss: 0.00985/8 [=================>............] - ETA: 0s - loss: 0.01037/8 [=========================>....] - ETA: 0s - loss: 0.01068/8 [==============================] - 0s 32ms/step - loss: 0.0109
1/8 [==>...........................] - ETA: 0s - loss: 0.00913/8 [==========>...................] - ETA: 0s - loss: 0.01365/8 [=================>............] - ETA: 0s - loss: 0.01397/8 [=========================>....] - ETA: 0s - loss: 0.01618/8 [==============================] - 0s 36ms/step - loss: 0.0171
1/8 [==>...........................] - ETA: 0s - loss: 0.01932/8 [======>.......................] - ETA: 0s - loss: 0.01473/8 [==========>...................] - ETA: 0s - loss: 0.01435/8 [=================>............] - ETA: 0s - loss: 0.01227/8 [=========================>....] - ETA: 0s - loss: 0.01308/8 [==============================] - 0s 35ms/step - loss: 0.0130
1/8 [==>...........................] - ETA: 0s - loss: 0.00693/8 [==========>...................] - ETA: 0s - loss: 0.00905/8 [=================>............] - ETA: 0s - loss: 0.00857/8 [=========================>....] - ETA: 0s - loss: 0.00878/8 [==============================] - 0s 27ms/step - loss: 0.0088
1/8 [==>...........................] - ETA: 0s - loss: 0.00564/8 [==============>...............] - ETA: 0s - loss: 0.00487/8 [=========================>....] - ETA: 0s - loss: 0.00428/8 [==============================] - 0s 19ms/step - loss: 0.0040
1/8 [==>...........................] - ETA: 0s - loss: 0.00315/8 [=================>............] - ETA: 0s - loss: 0.00348/8 [==============================] - 0s 13ms/step - loss: 0.0032
1/8 [==>...........................] - ETA: 0s - loss: 0.00444/8 [==============>...............] - ETA: 0s - loss: 0.00637/8 [=========================>....] - ETA: 0s - loss: 0.00598/8 [==============================] - 0s 20ms/step - loss: 0.0060
1/8 [==>...........................] - ETA: 0s - loss: 0.02165/8 [=================>............] - ETA: 0s - loss: 0.01378/8 [==============================] - 0s 12ms/step - loss: 0.0146
1/8 [==>...........................] - ETA: 0s - loss: 8.4285e-044/8 [==============>...............] - ETA: 0s - loss: 0.0026    7/8 [=========================>....] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 20ms/step - loss: 0.0022
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.005999279720708728:
Train Score: 0.00283 MSE 0.05319 RMSE
Test Score: 0.00061 MSE 0.02476 RMSE
Deviation Min [5.72526408e-05], Max [0.3670128]
Deviation 99.5th pctile [0.22250143]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1643,   13]))
Confusion matrix 
[[1643    0]
 [   4    9]]
precision 1.00000, recall 0.69231, f1 0.81818
Time to train: 341211 ms
Saving model models/A4Benchmark/A4Benchmark-TS77.csv.h5
Total Time to proces all the selected files : 343870 ms
A4Benchmark : Avg precision 1.00000 recall 0.69231 f1 0.81818 time to train 341211.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS77.csv  --epochs 20 --n_iter 3 --patience 3 :: took 354 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS78.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 01:10:54 AM MST
2020-12-01 01:11:06.967234: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 01:11:06.986231: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-12-01 01:11:06.987119: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f826023d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 01:11:06.987147: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 01:11:06.987256: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS78.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00374/8 [==============>...............] - ETA: 0s - loss: 0.00457/8 [=========================>....] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 16ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00415/8 [=================>............] - ETA: 0s - loss: 0.00118/8 [==============================] - 0s 12ms/step - loss: 8.1853e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00116/8 [=====================>........] - ETA: 0s - loss: 0.00108/8 [==============================] - 0s 11ms/step - loss: 0.0011
1/8 [==>...........................] - ETA: 0s - loss: 2.4568e-044/8 [==============>...............] - ETA: 0s - loss: 2.4263e-047/8 [=========================>....] - ETA: 0s - loss: 0.0012    8/8 [==============================] - 0s 16ms/step - loss: 0.0013
1/8 [==>...........................] - ETA: 0s - loss: 0.00656/8 [=====================>........] - ETA: 0s - loss: 0.01148/8 [==============================] - 0s 10ms/step - loss: 0.0125
1/8 [==>...........................] - ETA: 0s - loss: 0.00385/8 [=================>............] - ETA: 0s - loss: 0.00478/8 [==============================] - 0s 14ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00135/8 [=================>............] - ETA: 0s - loss: 5.7442e-048/8 [==============================] - 0s 14ms/step - loss: 4.9931e-04
1/8 [==>...........................] - ETA: 0s - loss: 1.6436e-045/8 [=================>............] - ETA: 0s - loss: 1.6608e-048/8 [==============================] - 0s 14ms/step - loss: 1.6585e-04
1/8 [==>...........................] - ETA: 0s - loss: 2.8970e-044/8 [==============>...............] - ETA: 0s - loss: 3.5888e-047/8 [=========================>....] - ETA: 0s - loss: 0.0022    8/8 [==============================] - 0s 17ms/step - loss: 0.0027
1/8 [==>...........................] - ETA: 0s - loss: 0.00774/8 [==============>...............] - ETA: 0s - loss: 0.01007/8 [=========================>....] - ETA: 0s - loss: 0.01248/8 [==============================] - 0s 19ms/step - loss: 0.0132
1/8 [==>...........................] - ETA: 0s - loss: 0.00433/8 [==========>...................] - ETA: 0s - loss: 0.00505/8 [=================>............] - ETA: 0s - loss: 0.00547/8 [=========================>....] - ETA: 0s - loss: 0.00548/8 [==============================] - 0s 31ms/step - loss: 0.0054
1/8 [==>...........................] - ETA: 0s - loss: 0.00503/8 [==========>...................] - ETA: 0s - loss: 0.00195/8 [=================>............] - ETA: 0s - loss: 0.00137/8 [=========================>....] - ETA: 0s - loss: 0.00108/8 [==============================] - 0s 28ms/step - loss: 0.0010
1/8 [==>...........................] - ETA: 0s - loss: 4.3332e-042/8 [======>.......................] - ETA: 0s - loss: 4.3409e-044/8 [==============>...............] - ETA: 0s - loss: 3.8272e-046/8 [=====================>........] - ETA: 0s - loss: 4.3626e-048/8 [==============================] - ETA: 0s - loss: 4.2501e-048/8 [==============================] - 0s 30ms/step - loss: 4.2501e-04
1/8 [==>...........................] - ETA: 0s - loss: 4.1573e-04WARNING:tensorflow:Method (on_test_batch_end) is slow compared to the batch update (0.246541). Check your callbacks.
WARNING:tensorflow:Method (on_test_batch_end) is slow compared to the batch update (0.123282). Check your callbacks.
3/8 [==========>...................] - ETA: 0s - loss: 4.3480e-045/8 [=================>............] - ETA: 0s - loss: 4.3019e-047/8 [=========================>....] - ETA: 0s - loss: 0.0029    8/8 [==============================] - 0s 28ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.00883/8 [==========>...................] - ETA: 0s - loss: 0.01195/8 [=================>............] - ETA: 0s - loss: 0.01237/8 [=========================>....] - ETA: 0s - loss: 0.01468/8 [==============================] - 0s 28ms/step - loss: 0.0154
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.0040914763347245755:
Train Score: 0.00135 MSE 0.03679 RMSE
Test Score: 0.03420 MSE 0.18494 RMSE
Deviation Min [2.18227173e-05], Max [0.8922397]
Deviation 99.5th pctile [0.55627883]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1643,   13]))
Confusion matrix 
[[1635    8]
 [  12    1]]
precision 0.11111, recall 0.07692, f1 0.09091
Time to train: 315347 ms
Saving model models/A4Benchmark/A4Benchmark-TS78.csv.h5
Total Time to proces all the selected files : 317783 ms
A4Benchmark : Avg precision 0.11111 recall 0.07692 f1 0.09091 time to train 315347.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS78.csv  --epochs 20 --n_iter 3 --patience 3 :: took 331 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS79.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 01:16:30 AM MST
2020-12-01 01:16:37.336043: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 01:16:37.354218: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-12-01 01:16:37.355678: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5564bffc2c00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 01:16:37.355726: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 01:16:37.355947: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS79.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.02024/8 [==============>...............] - ETA: 0s - loss: 0.02437/8 [=========================>....] - ETA: 0s - loss: 0.02708/8 [==============================] - 0s 19ms/step - loss: 0.0278
1/8 [==>...........................] - ETA: 0s - loss: 0.01834/8 [==============>...............] - ETA: 0s - loss: 0.01096/8 [=====================>........] - ETA: 0s - loss: 0.01168/8 [==============================] - 0s 19ms/step - loss: 0.0125
1/8 [==>...........................] - ETA: 0s - loss: 0.02165/8 [=================>............] - ETA: 0s - loss: 0.02568/8 [==============================] - ETA: 0s - loss: 0.02698/8 [==============================] - 0s 16ms/step - loss: 0.0269
1/8 [==>...........................] - ETA: 0s - loss: 0.00115/8 [=================>............] - ETA: 0s - loss: 0.00168/8 [==============================] - 0s 13ms/step - loss: 0.0018
1/8 [==>...........................] - ETA: 0s - loss: 0.01745/8 [=================>............] - ETA: 0s - loss: 0.01808/8 [==============================] - 0s 14ms/step - loss: 0.0177
1/8 [==>...........................] - ETA: 0s - loss: 0.01885/8 [=================>............] - ETA: 0s - loss: 0.02658/8 [==============================] - 0s 12ms/step - loss: 0.0254
1/8 [==>...........................] - ETA: 0s - loss: 0.02086/8 [=====================>........] - ETA: 0s - loss: 0.01438/8 [==============================] - 0s 10ms/step - loss: 0.0153
1/8 [==>...........................] - ETA: 0s - loss: 0.04016/8 [=====================>........] - ETA: 0s - loss: 0.05178/8 [==============================] - 0s 11ms/step - loss: 0.0533
1/8 [==>...........................] - ETA: 0s - loss: 0.00975/8 [=================>............] - ETA: 0s - loss: 0.01008/8 [==============================] - 0s 12ms/step - loss: 0.0099
1/8 [==>...........................] - ETA: 0s - loss: 8.7346e-044/8 [==============>...............] - ETA: 0s - loss: 0.0010    7/8 [=========================>....] - ETA: 0s - loss: 0.00108/8 [==============================] - 0s 16ms/step - loss: 0.0010
1/8 [==>...........................] - ETA: 0s - loss: 0.01835/8 [=================>............] - ETA: 0s - loss: 0.02478/8 [==============================] - 0s 14ms/step - loss: 0.0255
1/8 [==>...........................] - ETA: 0s - loss: 0.01674/8 [==============>...............] - ETA: 0s - loss: 0.00877/8 [=========================>....] - ETA: 0s - loss: 0.00908/8 [==============================] - 0s 17ms/step - loss: 0.0095
1/8 [==>...........................] - ETA: 0s - loss: 0.01294/8 [==============>...............] - ETA: 0s - loss: 0.01618/8 [==============================] - ETA: 0s - loss: 0.01568/8 [==============================] - 0s 15ms/step - loss: 0.0156
1/8 [==>...........................] - ETA: 0s - loss: 6.7398e-045/8 [=================>............] - ETA: 0s - loss: 6.8147e-047/8 [=========================>....] - ETA: 0s - loss: 5.5945e-048/8 [==============================] - 0s 17ms/step - loss: 5.2995e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.01404/8 [==============>...............] - ETA: 0s - loss: 0.01487/8 [=========================>....] - ETA: 0s - loss: 0.01438/8 [==============================] - 0s 16ms/step - loss: 0.0142
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.013050231942906975:
Train Score: 0.00480 MSE 0.06930 RMSE
Test Score: 0.00096 MSE 0.03104 RMSE
Deviation Min [5.05901638e-05], Max [0.31386342]
Deviation 99.5th pctile [0.25741598]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1653,    3]))
Confusion matrix 
[[1645    8]
 [   2    1]]
precision 0.11111, recall 0.33333, f1 0.16667
Time to train: 256463 ms
Saving model models/A4Benchmark/A4Benchmark-TS79.csv.h5
Total Time to proces all the selected files : 258812 ms
A4Benchmark : Avg precision 0.11111 recall 0.33333 f1 0.16667 time to train 256463.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS79.csv  --epochs 20 --n_iter 3 --patience 3 :: took 266 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS7.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 01:21:01 AM MST
2020-12-01 01:21:19.939275: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 01:21:19.958193: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-12-01 01:21:19.959073: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55637e24dc00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 01:21:19.959100: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 01:21:19.959203: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS7.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.01203/8 [==========>...................] - ETA: 0s - loss: 0.01265/8 [=================>............] - ETA: 0s - loss: 0.01487/8 [=========================>....] - ETA: 0s - loss: 0.01358/8 [==============================] - 0s 35ms/step - loss: 0.0136
1/8 [==>...........................] - ETA: 0s - loss: 0.01033/8 [==========>...................] - ETA: 0s - loss: 0.01375/8 [=================>............] - ETA: 0s - loss: 0.01497/8 [=========================>....] - ETA: 0s - loss: 0.01438/8 [==============================] - 0s 26ms/step - loss: 0.0147
1/8 [==>...........................] - ETA: 0s - loss: 0.00962/8 [======>.......................] - ETA: 0s - loss: 0.01124/8 [==============>...............] - ETA: 0s - loss: 0.00986/8 [=====================>........] - ETA: 0s - loss: 0.00678/8 [==============================] - ETA: 0s - loss: 0.00548/8 [==============================] - 0s 39ms/step - loss: 0.0054
1/8 [==>...........................] - ETA: 0s - loss: 4.7892e-043/8 [==========>...................] - ETA: 0s - loss: 5.7081e-044/8 [==============>...............] - ETA: 0s - loss: 5.7820e-046/8 [=====================>........] - ETA: 0s - loss: 5.6722e-048/8 [==============================] - ETA: 0s - loss: 5.6631e-048/8 [==============================] - 0s 39ms/step - loss: 5.6631e-04
1/8 [==>...........................] - ETA: 0s - loss: 2.0262e-043/8 [==========>...................] - ETA: 0s - loss: 1.7964e-045/8 [=================>............] - ETA: 0s - loss: 1.7917e-047/8 [=========================>....] - ETA: 0s - loss: 2.7148e-048/8 [==============================] - 0s 26ms/step - loss: 2.9459e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00545/8 [=================>............] - ETA: 0s - loss: 0.00698/8 [==============================] - 0s 13ms/step - loss: 0.0064
1/8 [==>...........................] - ETA: 0s - loss: 0.00985/8 [=================>............] - ETA: 0s - loss: 0.01398/8 [==============================] - 0s 13ms/step - loss: 0.0138
1/8 [==>...........................] - ETA: 0s - loss: 0.01035/8 [=================>............] - ETA: 0s - loss: 0.00858/8 [==============================] - 0s 13ms/step - loss: 0.0061
1/8 [==>...........................] - ETA: 0s - loss: 3.2128e-044/8 [==============>...............] - ETA: 0s - loss: 3.9562e-047/8 [=========================>....] - ETA: 0s - loss: 3.8929e-048/8 [==============================] - 0s 16ms/step - loss: 3.9121e-04
1/8 [==>...........................] - ETA: 0s - loss: 1.6703e-045/8 [=================>............] - ETA: 0s - loss: 1.5381e-048/8 [==============================] - 0s 13ms/step - loss: 2.6121e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00925/8 [=================>............] - ETA: 0s - loss: 0.01298/8 [==============================] - 0s 14ms/step - loss: 0.0119
1/8 [==>...........................] - ETA: 0s - loss: 0.00905/8 [=================>............] - ETA: 0s - loss: 0.01328/8 [==============================] - 0s 14ms/step - loss: 0.0131
1/8 [==>...........................] - ETA: 0s - loss: 0.00564/8 [==============>...............] - ETA: 0s - loss: 0.00548/8 [==============================] - ETA: 0s - loss: 0.00308/8 [==============================] - 0s 13ms/step - loss: 0.0030
1/8 [==>...........................] - ETA: 0s - loss: 0.00124/8 [==============>...............] - ETA: 0s - loss: 0.00117/8 [=========================>....] - ETA: 0s - loss: 0.00128/8 [==============================] - 0s 20ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 0.00214/8 [==============>...............] - ETA: 0s - loss: 0.00247/8 [=========================>....] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 17ms/step - loss: 0.0023
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.005377326702000573:
Train Score: 0.00690 MSE 0.08308 RMSE
Test Score: 0.00062 MSE 0.02489 RMSE
Deviation Min [8.41898617e-06], Max [0.48732042]
Deviation 99.5th pctile [0.22668131]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1642,   14]))
Confusion matrix 
[[1638    4]
 [   9    5]]
precision 0.55556, recall 0.35714, f1 0.43478
Time to train: 342390 ms
Saving model models/A4Benchmark/A4Benchmark-TS7.csv.h5
Total Time to proces all the selected files : 344878 ms
A4Benchmark : Avg precision 0.55556 recall 0.35714 f1 0.43478 time to train 342390.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS7.csv  --epochs 20 --n_iter 3 --patience 3 :: took 364 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS80.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 01:27:10 AM MST
2020-12-01 01:27:18.990396: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 01:27:19.009247: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-12-01 01:27:19.010121: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x560faa01bd90 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 01:27:19.010149: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 01:27:19.010265: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS80.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.01933/8 [==========>...................] - ETA: 0s - loss: 0.02215/8 [=================>............] - ETA: 0s - loss: 0.02437/8 [=========================>....] - ETA: 0s - loss: 0.02058/8 [==============================] - 0s 39ms/step - loss: 0.0201
1/8 [==>...........................] - ETA: 0s - loss: 0.00113/8 [==========>...................] - ETA: 0s - loss: 8.8606e-045/8 [=================>............] - ETA: 0s - loss: 0.0038    7/8 [=========================>....] - ETA: 0s - loss: 0.00428/8 [==============================] - 0s 37ms/step - loss: 0.0041
1/8 [==>...........................] - ETA: 0s - loss: 0.00603/8 [==========>...................] - ETA: 0s - loss: 0.00745/8 [=================>............] - ETA: 0s - loss: 0.00927/8 [=========================>....] - ETA: 0s - loss: 0.00888/8 [==============================] - 0s 25ms/step - loss: 0.0083
1/8 [==>...........................] - ETA: 0s - loss: 2.3230e-043/8 [==========>...................] - ETA: 0s - loss: 1.0673e-045/8 [=================>............] - ETA: 0s - loss: 1.6828e-047/8 [=========================>....] - ETA: 0s - loss: 1.7990e-048/8 [==============================] - 0s 27ms/step - loss: 1.8178e-04
1/8 [==>...........................] - ETA: 0s - loss: 1.1213e-043/8 [==========>...................] - ETA: 0s - loss: 2.9584e-045/8 [=================>............] - ETA: 0s - loss: 3.2060e-047/8 [=========================>....] - ETA: 0s - loss: 3.1505e-048/8 [==============================] - 0s 30ms/step - loss: 4.5724e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00424/8 [==============>...............] - ETA: 0s - loss: 0.00327/8 [=========================>....] - ETA: 0s - loss: 0.00448/8 [==============================] - 0s 19ms/step - loss: 0.0042
1/8 [==>...........................] - ETA: 0s - loss: 5.3757e-045/8 [=================>............] - ETA: 0s - loss: 0.0035    8/8 [==============================] - 0s 13ms/step - loss: 0.0034
1/8 [==>...........................] - ETA: 0s - loss: 0.00435/8 [=================>............] - ETA: 0s - loss: 0.00648/8 [==============================] - 0s 14ms/step - loss: 0.0055
1/8 [==>...........................] - ETA: 0s - loss: 1.4423e-045/8 [=================>............] - ETA: 0s - loss: 1.2429e-048/8 [==============================] - 0s 13ms/step - loss: 1.6427e-04
1/8 [==>...........................] - ETA: 0s - loss: 6.5719e-055/8 [=================>............] - ETA: 0s - loss: 1.2214e-048/8 [==============================] - 0s 13ms/step - loss: 2.0922e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.01004/8 [==============>...............] - ETA: 0s - loss: 0.00797/8 [=========================>....] - ETA: 0s - loss: 0.00908/8 [==============================] - 0s 17ms/step - loss: 0.0088
1/8 [==>...........................] - ETA: 0s - loss: 0.00315/8 [=================>............] - ETA: 0s - loss: 0.01638/8 [==============================] - 0s 13ms/step - loss: 0.0188
1/8 [==>...........................] - ETA: 0s - loss: 0.00555/8 [=================>............] - ETA: 0s - loss: 0.00748/8 [==============================] - 0s 13ms/step - loss: 0.0065
1/8 [==>...........................] - ETA: 0s - loss: 1.5218e-045/8 [=================>............] - ETA: 0s - loss: 1.6418e-048/8 [==============================] - 0s 12ms/step - loss: 1.5499e-04
1/8 [==>...........................] - ETA: 0s - loss: 1.9812e-046/8 [=====================>........] - ETA: 0s - loss: 1.9551e-048/8 [==============================] - 0s 11ms/step - loss: 2.9592e-04
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.002701709480606951:
Train Score: 0.00203 MSE 0.04502 RMSE
Test Score: 0.00058 MSE 0.02404 RMSE
Deviation Min [7.40664577e-06], Max [0.39156663]
Deviation 99.5th pctile [0.21738681]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1644,   12]))
Confusion matrix 
[[1642    2]
 [   5    7]]
precision 0.77778, recall 0.58333, f1 0.66667
Time to train: 550775 ms
Saving model models/A4Benchmark/A4Benchmark-TS80.csv.h5
Total Time to proces all the selected files : 553101 ms
A4Benchmark : Avg precision 0.77778 recall 0.58333 f1 0.66667 time to train 550775.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS80.csv  --epochs 20 --n_iter 3 --patience 3 :: took 562 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS81.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 01:36:37 AM MST
2020-12-01 01:36:51.548895: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 01:36:51.567250: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-12-01 01:36:51.568120: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55aa5fbb98e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 01:36:51.568148: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 01:36:51.568261: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS81.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00765/8 [=================>............] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 13ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00205/8 [=================>............] - ETA: 0s - loss: 0.00258/8 [==============================] - 0s 12ms/step - loss: 0.0024
1/8 [==>...........................] - ETA: 0s - loss: 0.00195/8 [=================>............] - ETA: 0s - loss: 0.00178/8 [==============================] - 0s 13ms/step - loss: 0.0022
1/8 [==>...........................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00678/8 [==============================] - 0s 13ms/step - loss: 0.0069
1/8 [==>...........................] - ETA: 0s - loss: 0.00594/8 [==============>...............] - ETA: 0s - loss: 0.00578/8 [==============================] - ETA: 0s - loss: 0.00358/8 [==============================] - 0s 16ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.00864/8 [==============>...............] - ETA: 0s - loss: 0.00327/8 [=========================>....] - ETA: 0s - loss: 0.00288/8 [==============================] - 0s 17ms/step - loss: 0.0027
1/8 [==>...........................] - ETA: 0s - loss: 0.00285/8 [=================>............] - ETA: 0s - loss: 0.00278/8 [==============================] - 0s 13ms/step - loss: 0.0030
1/8 [==>...........................] - ETA: 0s - loss: 0.00164/8 [==============>...............] - ETA: 0s - loss: 0.00198/8 [==============================] - ETA: 0s - loss: 0.00268/8 [==============================] - 0s 14ms/step - loss: 0.0026
1/8 [==>...........................] - ETA: 0s - loss: 0.00805/8 [=================>............] - ETA: 0s - loss: 0.01808/8 [==============================] - 0s 12ms/step - loss: 0.0205
1/8 [==>...........................] - ETA: 0s - loss: 0.00815/8 [=================>............] - ETA: 0s - loss: 0.00598/8 [==============================] - 0s 13ms/step - loss: 0.0042
1/8 [==>...........................] - ETA: 0s - loss: 0.00772/8 [======>.......................] - ETA: 0s - loss: 0.00504/8 [==============>...............] - ETA: 0s - loss: 0.00396/8 [=====================>........] - ETA: 0s - loss: 0.00358/8 [==============================] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 32ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.04603/8 [==========>...................] - ETA: 0s - loss: 0.04535/8 [=================>............] - ETA: 0s - loss: 0.04727/8 [=========================>....] - ETA: 0s - loss: 0.04578/8 [==============================] - 0s 29ms/step - loss: 0.0448
1/8 [==>...........................] - ETA: 0s - loss: 0.00223/8 [==========>...................] - ETA: 0s - loss: 0.00225/8 [=================>............] - ETA: 0s - loss: 0.00257/8 [=========================>....] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 36ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 0.00122/8 [======>.......................] - ETA: 0s - loss: 0.00444/8 [==============>...............] - ETA: 0s - loss: 0.00556/8 [=====================>........] - ETA: 0s - loss: 0.00488/8 [==============================] - ETA: 0s - loss: 0.00558/8 [==============================] - 0s 35ms/step - loss: 0.0055
1/8 [==>...........................] - ETA: 0s - loss: 0.00743/8 [==========>...................] - ETA: 0s - loss: 0.01025/8 [=================>............] - ETA: 0s - loss: 0.00817/8 [=========================>....] - ETA: 0s - loss: 0.00628/8 [==============================] - 0s 27ms/step - loss: 0.0061
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.0035910296719521284:
Train Score: 0.00416 MSE 0.06451 RMSE
Test Score: 0.00166 MSE 0.04077 RMSE
Deviation Min [3.78226383e-05], Max [0.43953271]
Deviation 99.5th pctile [0.18623083]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1648,    8]))
Confusion matrix 
[[1646    2]
 [   1    7]]
precision 0.77778, recall 0.87500, f1 0.82353
Time to train: 604797 ms
Saving model models/A4Benchmark/A4Benchmark-TS81.csv.h5
Total Time to proces all the selected files : 607046 ms
A4Benchmark : Avg precision 0.77778 recall 0.87500 f1 0.82353 time to train 604797.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS81.csv  --epochs 20 --n_iter 3 --patience 3 :: took 621 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS82.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 01:47:03 AM MST
2020-12-01 01:47:13.324192: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 01:47:13.342260: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-12-01 01:47:13.343739: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55bfef4cb8e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 01:47:13.343792: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 01:47:13.344046: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS82.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00275/8 [=================>............] - ETA: 0s - loss: 0.00418/8 [==============================] - 0s 13ms/step - loss: 0.0072
1/8 [==>...........................] - ETA: 0s - loss: 0.00175/8 [=================>............] - ETA: 0s - loss: 0.00478/8 [==============================] - 0s 12ms/step - loss: 0.0053
1/8 [==>...........................] - ETA: 0s - loss: 0.00124/8 [==============>...............] - ETA: 0s - loss: 0.00257/8 [=========================>....] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 15ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00294/8 [==============>...............] - ETA: 0s - loss: 0.00177/8 [=========================>....] - ETA: 0s - loss: 0.00208/8 [==============================] - 0s 17ms/step - loss: 0.0020
1/8 [==>...........................] - ETA: 0s - loss: 0.00115/8 [=================>............] - ETA: 0s - loss: 8.9330e-048/8 [==============================] - ETA: 0s - loss: 9.0831e-048/8 [==============================] - 0s 15ms/step - loss: 9.0831e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00284/8 [==============>...............] - ETA: 0s - loss: 0.00297/8 [=========================>....] - ETA: 0s - loss: 0.00468/8 [==============================] - 0s 16ms/step - loss: 0.0050
1/8 [==>...........................] - ETA: 0s - loss: 0.00154/8 [==============>...............] - ETA: 0s - loss: 0.00477/8 [=========================>....] - ETA: 0s - loss: 0.00428/8 [==============================] - 0s 16ms/step - loss: 0.0051
1/8 [==>...........................] - ETA: 0s - loss: 0.00295/8 [=================>............] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 14ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 0.00154/8 [==============>...............] - ETA: 0s - loss: 0.00107/8 [=========================>....] - ETA: 0s - loss: 0.00118/8 [==============================] - 0s 17ms/step - loss: 0.0011
1/8 [==>...........................] - ETA: 0s - loss: 0.00525/8 [=================>............] - ETA: 0s - loss: 0.00568/8 [==============================] - 0s 13ms/step - loss: 0.0057
1/8 [==>...........................] - ETA: 0s - loss: 0.00395/8 [=================>............] - ETA: 0s - loss: 0.00488/8 [==============================] - ETA: 0s - loss: 0.00588/8 [==============================] - 0s 15ms/step - loss: 0.0058
1/8 [==>...........................] - ETA: 0s - loss: 0.00324/8 [==============>...............] - ETA: 0s - loss: 0.00678/8 [==============================] - ETA: 0s - loss: 0.00718/8 [==============================] - 0s 16ms/step - loss: 0.0071
1/8 [==>...........................] - ETA: 0s - loss: 0.00335/8 [=================>............] - ETA: 0s - loss: 0.00278/8 [==============================] - 0s 14ms/step - loss: 0.0033
1/8 [==>...........................] - ETA: 0s - loss: 6.1827e-045/8 [=================>............] - ETA: 0s - loss: 4.7501e-048/8 [==============================] - ETA: 0s - loss: 4.8335e-048/8 [==============================] - 0s 14ms/step - loss: 4.8335e-04
1/8 [==>...........................] - ETA: 0s - loss: 6.8663e-044/8 [==============>...............] - ETA: 0s - loss: 0.0015    8/8 [==============================] - ETA: 0s - loss: 0.00128/8 [==============================] - 0s 15ms/step - loss: 0.0012
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0035955046594608577:
Train Score: 0.00547 MSE 0.07394 RMSE
Test Score: 0.00406 MSE 0.06376 RMSE
Deviation Min [0.00030991], Max [0.51355425]
Deviation 99.5th pctile [0.28650043]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1642,   14]))
Confusion matrix 
[[1642    0]
 [   5    9]]
precision 1.00000, recall 0.64286, f1 0.78261
Time to train: 409110 ms
Saving model models/A4Benchmark/A4Benchmark-TS82.csv.h5
Total Time to proces all the selected files : 411496 ms
A4Benchmark : Avg precision 1.00000 recall 0.64286 f1 0.78261 time to train 409110.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS82.csv  --epochs 20 --n_iter 3 --patience 3 :: took 422 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS83.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 01:54:10 AM MST
2020-12-01 01:54:19.078514: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 01:54:19.097141: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-12-01 01:54:19.097868: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559b00e968e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 01:54:19.097893: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 01:54:19.098009: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS83.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00245/8 [=================>............] - ETA: 0s - loss: 0.00278/8 [==============================] - ETA: 0s - loss: 0.00288/8 [==============================] - 0s 15ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 3.8814e-045/8 [=================>............] - ETA: 0s - loss: 6.2502e-048/8 [==============================] - 0s 14ms/step - loss: 6.3160e-04
1/8 [==>...........................] - ETA: 0s - loss: 2.2937e-044/8 [==============>...............] - ETA: 0s - loss: 5.1344e-047/8 [=========================>....] - ETA: 0s - loss: 0.0015    8/8 [==============================] - 0s 20ms/step - loss: 0.0017
1/8 [==>...........................] - ETA: 0s - loss: 0.03574/8 [==============>...............] - ETA: 0s - loss: 0.04417/8 [=========================>....] - ETA: 0s - loss: 0.04558/8 [==============================] - 0s 17ms/step - loss: 0.0471
1/8 [==>...........................] - ETA: 0s - loss: 0.01615/8 [=================>............] - ETA: 0s - loss: 0.01298/8 [==============================] - 0s 14ms/step - loss: 0.0137
1/8 [==>...........................] - ETA: 0s - loss: 0.00135/8 [=================>............] - ETA: 0s - loss: 0.00138/8 [==============================] - 0s 13ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 2.7717e-045/8 [=================>............] - ETA: 0s - loss: 5.5487e-048/8 [==============================] - 0s 13ms/step - loss: 5.5629e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00115/8 [=================>............] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 13ms/step - loss: 0.0056
1/8 [==>...........................] - ETA: 0s - loss: 0.00695/8 [=================>............] - ETA: 0s - loss: 0.01278/8 [==============================] - 0s 14ms/step - loss: 0.0118
1/8 [==>...........................] - ETA: 0s - loss: 0.04025/8 [=================>............] - ETA: 0s - loss: 0.04738/8 [==============================] - 0s 12ms/step - loss: 0.0478
1/8 [==>...........................] - ETA: 0s - loss: 0.00303/8 [==========>...................] - ETA: 0s - loss: 0.00345/8 [=================>............] - ETA: 0s - loss: 0.00327/8 [=========================>....] - ETA: 0s - loss: 0.00328/8 [==============================] - 0s 29ms/step - loss: 0.0033
1/8 [==>...........................] - ETA: 0s - loss: 0.00223/8 [==========>...................] - ETA: 0s - loss: 0.00305/8 [=================>............] - ETA: 0s - loss: 0.00308/8 [==============================] - ETA: 0s - loss: 0.00318/8 [==============================] - 0s 26ms/step - loss: 0.0031
1/8 [==>...........................] - ETA: 0s - loss: 0.00143/8 [==========>...................] - ETA: 0s - loss: 0.00195/8 [=================>............] - ETA: 0s - loss: 0.00207/8 [=========================>....] - ETA: 0s - loss: 0.00418/8 [==============================] - 0s 29ms/step - loss: 0.0063
1/8 [==>...........................] - ETA: 0s - loss: 0.04193/8 [==========>...................] - ETA: 0s - loss: 0.05585/8 [=================>............] - ETA: 0s - loss: 0.05367/8 [=========================>....] - ETA: 0s - loss: 0.05428/8 [==============================] - 0s 27ms/step - loss: 0.0562
1/8 [==>...........................] - ETA: 0s - loss: 0.04403/8 [==========>...................] - ETA: 0s - loss: 0.04875/8 [=================>............] - ETA: 0s - loss: 0.04617/8 [=========================>....] - ETA: 0s - loss: 0.04658/8 [==============================] - 0s 26ms/step - loss: 0.0472
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.01318366393679753:
Train Score: 0.00449 MSE 0.06698 RMSE
Test Score: 0.01057 MSE 0.10282 RMSE
Deviation Min [1.45114963e-06], Max [0.28096732]
Deviation 99.5th pctile [0.26061051]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1653,    3]))
Confusion matrix 
[[1644    9]
 [   3    0]]
precision 0.00000, recall 0.00000, f1 0.00000
Time to train: 312177 ms
Saving model models/A4Benchmark/A4Benchmark-TS83.csv.h5
Total Time to proces all the selected files : 314656 ms
A4Benchmark : Avg precision 0.00000 recall 0.00000 f1 0.00000 time to train 312177.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS83.csv  --epochs 20 --n_iter 3 --patience 3 :: took 324 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS84.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 01:59:39 AM MST
2020-12-01 01:59:52.643786: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 01:59:52.662303: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-12-01 01:59:52.663955: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x555a51b408e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 01:59:52.664016: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 01:59:52.664249: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS84.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00283/8 [==========>...................] - ETA: 0s - loss: 0.00705/8 [=================>............] - ETA: 0s - loss: 0.00767/8 [=========================>....] - ETA: 0s - loss: 0.00788/8 [==============================] - 0s 30ms/step - loss: 0.0080
1/8 [==>...........................] - ETA: 0s - loss: 0.00653/8 [==========>...................] - ETA: 0s - loss: 0.00865/8 [=================>............] - ETA: 0s - loss: 0.00837/8 [=========================>....] - ETA: 0s - loss: 0.00818/8 [==============================] - 0s 28ms/step - loss: 0.0083
1/8 [==>...........................] - ETA: 0s - loss: 0.00853/8 [==========>...................] - ETA: 0s - loss: 0.00935/8 [=================>............] - ETA: 0s - loss: 0.01077/8 [=========================>....] - ETA: 0s - loss: 0.01028/8 [==============================] - 0s 29ms/step - loss: 0.0103
1/8 [==>...........................] - ETA: 0s - loss: 0.00643/8 [==========>...................] - ETA: 0s - loss: 0.00895/8 [=================>............] - ETA: 0s - loss: 0.00837/8 [=========================>....] - ETA: 0s - loss: 0.00828/8 [==============================] - 0s 28ms/step - loss: 0.0084
1/8 [==>...........................] - ETA: 0s - loss: 0.00303/8 [==========>...................] - ETA: 0s - loss: 0.00265/8 [=================>............] - ETA: 0s - loss: 0.00317/8 [=========================>....] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 29ms/step - loss: 0.0040
1/8 [==>...........................] - ETA: 0s - loss: 0.00205/8 [=================>............] - ETA: 0s - loss: 0.00618/8 [==============================] - 0s 14ms/step - loss: 0.0063
1/8 [==>...........................] - ETA: 0s - loss: 0.00574/8 [==============>...............] - ETA: 0s - loss: 0.00718/8 [==============================] - ETA: 0s - loss: 0.00728/8 [==============================] - 0s 15ms/step - loss: 0.0072
1/8 [==>...........................] - ETA: 0s - loss: 0.00595/8 [=================>............] - ETA: 0s - loss: 0.00708/8 [==============================] - 0s 14ms/step - loss: 0.0071
1/8 [==>...........................] - ETA: 0s - loss: 0.00664/8 [==============>...............] - ETA: 0s - loss: 0.00897/8 [=========================>....] - ETA: 0s - loss: 0.00848/8 [==============================] - 0s 19ms/step - loss: 0.0085
1/8 [==>...........................] - ETA: 0s - loss: 0.00145/8 [=================>............] - ETA: 0s - loss: 0.00118/8 [==============================] - 0s 14ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 0.00243/8 [==========>...................] - ETA: 0s - loss: 0.00675/8 [=================>............] - ETA: 0s - loss: 0.00757/8 [=========================>....] - ETA: 0s - loss: 0.00758/8 [==============================] - 0s 26ms/step - loss: 0.0077
1/8 [==>...........................] - ETA: 0s - loss: 0.00653/8 [==========>...................] - ETA: 0s - loss: 0.00875/8 [=================>............] - ETA: 0s - loss: 0.00837/8 [=========================>....] - ETA: 0s - loss: 0.00838/8 [==============================] - 0s 27ms/step - loss: 0.0086
1/8 [==>...........................] - ETA: 0s - loss: 0.00683/8 [==========>...................] - ETA: 0s - loss: 0.00805/8 [=================>............] - ETA: 0s - loss: 0.00847/8 [=========================>....] - ETA: 0s - loss: 0.00818/8 [==============================] - 0s 28ms/step - loss: 0.0083
1/8 [==>...........................] - ETA: 0s - loss: 0.00773/8 [==========>...................] - ETA: 0s - loss: 0.01115/8 [=================>............] - ETA: 0s - loss: 0.01057/8 [=========================>....] - ETA: 0s - loss: 0.01008/8 [==============================] - 0s 36ms/step - loss: 0.0102
1/8 [==>...........................] - ETA: 0s - loss: 0.00143/8 [==========>...................] - ETA: 0s - loss: 9.4458e-045/8 [=================>............] - ETA: 0s - loss: 0.0011    7/8 [=========================>....] - ETA: 0s - loss: 0.00148/8 [==============================] - 0s 27ms/step - loss: 0.0014
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.00613915310241282:
Train Score: 0.00404 MSE 0.06360 RMSE
Test Score: 0.00943 MSE 0.09713 RMSE
Deviation Min [2.22919332e-06], Max [0.26413274]
Deviation 99.5th pctile [0.23006339]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1653,    3]))
Confusion matrix 
[[1646    7]
 [   1    2]]
precision 0.22222, recall 0.66667, f1 0.33333
Time to train: 354351 ms
Saving model models/A4Benchmark/A4Benchmark-TS84.csv.h5
Total Time to proces all the selected files : 356682 ms
A4Benchmark : Avg precision 0.22222 recall 0.66667 f1 0.33333 time to train 354351.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS84.csv  --epochs 20 --n_iter 3 --patience 3 :: took 370 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS85.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 02:05:54 AM MST
2020-12-01 02:06:14.757832: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 02:06:14.776260: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-12-01 02:06:14.777176: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55dc64490c00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 02:06:14.777204: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 02:06:14.777321: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS85.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00435/8 [=================>............] - ETA: 0s - loss: 0.00458/8 [==============================] - 0s 14ms/step - loss: 0.0040
1/8 [==>...........................] - ETA: 0s - loss: 0.00635/8 [=================>............] - ETA: 0s - loss: 0.00398/8 [==============================] - 0s 14ms/step - loss: 0.0047
1/8 [==>...........................] - ETA: 0s - loss: 0.00685/8 [=================>............] - ETA: 0s - loss: 0.01228/8 [==============================] - 0s 14ms/step - loss: 0.0126
1/8 [==>...........................] - ETA: 0s - loss: 0.00205/8 [=================>............] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 14ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 9.8932e-044/8 [==============>...............] - ETA: 0s - loss: 0.0011    7/8 [=========================>....] - ETA: 0s - loss: 0.00128/8 [==============================] - 0s 17ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 0.01393/8 [==========>...................] - ETA: 0s - loss: 0.01335/8 [=================>............] - ETA: 0s - loss: 0.01287/8 [=========================>....] - ETA: 0s - loss: 0.01228/8 [==============================] - 0s 24ms/step - loss: 0.0124
1/8 [==>...........................] - ETA: 0s - loss: 0.01383/8 [==========>...................] - ETA: 0s - loss: 0.01235/8 [=================>............] - ETA: 0s - loss: 0.01167/8 [=========================>....] - ETA: 0s - loss: 0.01288/8 [==============================] - 0s 23ms/step - loss: 0.0131
1/8 [==>...........................] - ETA: 0s - loss: 0.00843/8 [==========>...................] - ETA: 0s - loss: 0.01385/8 [=================>............] - ETA: 0s - loss: 0.01377/8 [=========================>....] - ETA: 0s - loss: 0.01388/8 [==============================] - 0s 25ms/step - loss: 0.0139
1/8 [==>...........................] - ETA: 0s - loss: 0.01063/8 [==========>...................] - ETA: 0s - loss: 0.01105/8 [=================>............] - ETA: 0s - loss: 0.01117/8 [=========================>....] - ETA: 0s - loss: 0.01228/8 [==============================] - 0s 22ms/step - loss: 0.0125
1/8 [==>...........................] - ETA: 0s - loss: 0.00183/8 [==========>...................] - ETA: 0s - loss: 0.00155/8 [=================>............] - ETA: 0s - loss: 0.00137/8 [=========================>....] - ETA: 0s - loss: 0.00128/8 [==============================] - 0s 29ms/step - loss: 0.0013
1/8 [==>...........................] - ETA: 0s - loss: 0.01373/8 [==========>...................] - ETA: 0s - loss: 0.01315/8 [=================>............] - ETA: 0s - loss: 0.01287/8 [=========================>....] - ETA: 0s - loss: 0.01218/8 [==============================] - 0s 30ms/step - loss: 0.0122
1/8 [==>...........................] - ETA: 0s - loss: 0.00623/8 [==========>...................] - ETA: 0s - loss: 0.00485/8 [=================>............] - ETA: 0s - loss: 0.00417/8 [=========================>....] - ETA: 0s - loss: 0.00498/8 [==============================] - ETA: 0s - loss: 0.00498/8 [==============================] - 0s 29ms/step - loss: 0.0049
1/8 [==>...........................] - ETA: 0s - loss: 0.00793/8 [==========>...................] - ETA: 0s - loss: 0.01425/8 [=================>............] - ETA: 0s - loss: 0.01347/8 [=========================>....] - ETA: 0s - loss: 0.01378/8 [==============================] - 0s 28ms/step - loss: 0.0139
1/8 [==>...........................] - ETA: 0s - loss: 0.01093/8 [==========>...................] - ETA: 0s - loss: 0.01135/8 [=================>............] - ETA: 0s - loss: 0.01157/8 [=========================>....] - ETA: 0s - loss: 0.01258/8 [==============================] - 0s 27ms/step - loss: 0.0128
1/8 [==>...........................] - ETA: 0s - loss: 0.00333/8 [==========>...................] - ETA: 0s - loss: 0.00205/8 [=================>............] - ETA: 0s - loss: 0.00187/8 [=========================>....] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 30ms/step - loss: 0.0018
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.005194568051956594:
Train Score: 0.00291 MSE 0.05398 RMSE
Test Score: 0.00075 MSE 0.02743 RMSE
Deviation Min [1.40085449e-05], Max [0.46242804]
Deviation 99.5th pctile [0.23391469]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1640,   16]))
Confusion matrix 
[[1640    0]
 [   7    9]]
precision 1.00000, recall 0.56250, f1 0.72000
Time to train: 428779 ms
Saving model models/A4Benchmark/A4Benchmark-TS85.csv.h5
Total Time to proces all the selected files : 431208 ms
A4Benchmark : Avg precision 1.00000 recall 0.56250 f1 0.72000 time to train 428779.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS85.csv  --epochs 20 --n_iter 3 --patience 3 :: took 452 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS86.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 02:13:31 AM MST
2020-12-01 02:13:47.363435: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 02:13:47.382275: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-12-01 02:13:47.383561: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55b92cd59310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 02:13:47.383612: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 02:13:47.383838: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS86.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00195/8 [=================>............] - ETA: 0s - loss: 0.00258/8 [==============================] - 0s 12ms/step - loss: 0.0032
1/8 [==>...........................] - ETA: 0s - loss: 0.00214/8 [==============>...............] - ETA: 0s - loss: 0.00317/8 [=========================>....] - ETA: 0s - loss: 0.00538/8 [==============================] - 0s 15ms/step - loss: 0.0057
1/8 [==>...........................] - ETA: 0s - loss: 0.00764/8 [==============>...............] - ETA: 0s - loss: 0.00967/8 [=========================>....] - ETA: 0s - loss: 0.00978/8 [==============================] - 0s 17ms/step - loss: 0.0100
1/8 [==>...........................] - ETA: 0s - loss: 0.00524/8 [==============>...............] - ETA: 0s - loss: 0.00518/8 [==============================] - 0s 13ms/step - loss: 0.0046
1/8 [==>...........................] - ETA: 0s - loss: 0.00866/8 [=====================>........] - ETA: 0s - loss: 0.00858/8 [==============================] - 0s 11ms/step - loss: 0.0084
1/8 [==>...........................] - ETA: 0s - loss: 0.00223/8 [==========>...................] - ETA: 0s - loss: 0.00295/8 [=================>............] - ETA: 0s - loss: 0.00297/8 [=========================>....] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 39ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.00293/8 [==========>...................] - ETA: 0s - loss: 0.00365/8 [=================>............] - ETA: 0s - loss: 0.00457/8 [=========================>....] - ETA: 0s - loss: 0.00688/8 [==============================] - 0s 27ms/step - loss: 0.0073
1/8 [==>...........................] - ETA: 0s - loss: 0.00873/8 [==========>...................] - ETA: 0s - loss: 0.01175/8 [=================>............] - ETA: 0s - loss: 0.01147/8 [=========================>....] - ETA: 0s - loss: 0.01148/8 [==============================] - 0s 29ms/step - loss: 0.0118
1/8 [==>...........................] - ETA: 0s - loss: 0.01033/8 [==========>...................] - ETA: 0s - loss: 0.01305/8 [=================>............] - ETA: 0s - loss: 0.01157/8 [=========================>....] - ETA: 0s - loss: 0.01138/8 [==============================] - 0s 32ms/step - loss: 0.0116
1/8 [==>...........................] - ETA: 0s - loss: 0.01033/8 [==========>...................] - ETA: 0s - loss: 0.01145/8 [=================>............] - ETA: 0s - loss: 0.01077/8 [=========================>....] - ETA: 0s - loss: 0.01038/8 [==============================] - 0s 30ms/step - loss: 0.0104
1/8 [==>...........................] - ETA: 0s - loss: 0.00195/8 [=================>............] - ETA: 0s - loss: 0.00248/8 [==============================] - 0s 14ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00224/8 [==============>...............] - ETA: 0s - loss: 0.00327/8 [=========================>....] - ETA: 0s - loss: 0.00528/8 [==============================] - 0s 17ms/step - loss: 0.0057
1/8 [==>...........................] - ETA: 0s - loss: 0.00704/8 [==============>...............] - ETA: 0s - loss: 0.00877/8 [=========================>....] - ETA: 0s - loss: 0.00918/8 [==============================] - 0s 18ms/step - loss: 0.0094
1/8 [==>...........................] - ETA: 0s - loss: 0.00954/8 [==============>...............] - ETA: 0s - loss: 0.01088/8 [==============================] - ETA: 0s - loss: 0.01068/8 [==============================] - 0s 15ms/step - loss: 0.0106
1/8 [==>...........................] - ETA: 0s - loss: 0.00964/8 [==============>...............] - ETA: 0s - loss: 0.00906/8 [=====================>........] - ETA: 0s - loss: 0.00938/8 [==============================] - 0s 22ms/step - loss: 0.0092
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.006368921557441354:
Train Score: 0.00760 MSE 0.08719 RMSE
Test Score: 0.01015 MSE 0.10076 RMSE
Deviation Min [0.00011747], Max [0.46166825]
Deviation 99.5th pctile [0.25532132]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1641,   15]))
Confusion matrix 
[[1639    2]
 [   8    7]]
precision 0.77778, recall 0.46667, f1 0.58333
Time to train: 248854 ms
Saving model models/A4Benchmark/A4Benchmark-TS86.csv.h5
Total Time to proces all the selected files : 251120 ms
A4Benchmark : Avg precision 0.77778 recall 0.46667 f1 0.58333 time to train 248854.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS86.csv  --epochs 20 --n_iter 3 --patience 3 :: took 267 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS87.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 02:18:03 AM MST
2020-12-01 02:18:16.035902: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 02:18:16.054265: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-12-01 02:18:16.055835: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x555e18774d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 02:18:16.055928: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 02:18:16.056155: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS87.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00184/8 [==============>...............] - ETA: 0s - loss: 0.00258/8 [==============================] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 15ms/step - loss: 0.0022
1/8 [==>...........................] - ETA: 0s - loss: 0.01254/8 [==============>...............] - ETA: 0s - loss: 0.01577/8 [=========================>....] - ETA: 0s - loss: 0.01678/8 [==============================] - 0s 19ms/step - loss: 0.0171
1/8 [==>...........................] - ETA: 0s - loss: 6.2023e-044/8 [==============>...............] - ETA: 0s - loss: 7.1611e-047/8 [=========================>....] - ETA: 0s - loss: 9.6062e-048/8 [==============================] - 0s 16ms/step - loss: 9.1263e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00204/8 [==============>...............] - ETA: 0s - loss: 0.00147/8 [=========================>....] - ETA: 0s - loss: 0.00198/8 [==============================] - 0s 19ms/step - loss: 0.0019
1/8 [==>...........................] - ETA: 0s - loss: 0.00115/8 [=================>............] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 14ms/step - loss: 0.0027
1/8 [==>...........................] - ETA: 0s - loss: 0.01515/8 [=================>............] - ETA: 0s - loss: 0.01788/8 [==============================] - ETA: 0s - loss: 0.01878/8 [==============================] - 0s 17ms/step - loss: 0.0187
1/8 [==>...........................] - ETA: 0s - loss: 0.00395/8 [=================>............] - ETA: 0s - loss: 0.00668/8 [==============================] - 0s 14ms/step - loss: 0.0062
1/8 [==>...........................] - ETA: 0s - loss: 0.00115/8 [=================>............] - ETA: 0s - loss: 9.0398e-048/8 [==============================] - 0s 13ms/step - loss: 0.0011
1/8 [==>...........................] - ETA: 0s - loss: 6.1409e-045/8 [=================>............] - ETA: 0s - loss: 9.9043e-048/8 [==============================] - 0s 14ms/step - loss: 9.3532e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00105/8 [=================>............] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 13ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.00453/8 [==========>...................] - ETA: 0s - loss: 0.00335/8 [=================>............] - ETA: 0s - loss: 0.00417/8 [=========================>....] - ETA: 0s - loss: 0.00428/8 [==============================] - 0s 30ms/step - loss: 0.0041
1/8 [==>...........................] - ETA: 0s - loss: 0.01423/8 [==========>...................] - ETA: 0s - loss: 0.01875/8 [=================>............] - ETA: 0s - loss: 0.01897/8 [=========================>....] - ETA: 0s - loss: 0.01878/8 [==============================] - 0s 27ms/step - loss: 0.0193
1/8 [==>...........................] - ETA: 0s - loss: 3.9791e-043/8 [==========>...................] - ETA: 0s - loss: 6.3932e-045/8 [=================>............] - ETA: 0s - loss: 0.0017    7/8 [=========================>....] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 27ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 0.00153/8 [==========>...................] - ETA: 0s - loss: 0.00155/8 [=================>............] - ETA: 0s - loss: 0.00237/8 [=========================>....] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 33ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.02113/8 [==========>...................] - ETA: 0s - loss: 0.03545/8 [=================>............] - ETA: 0s - loss: 0.03597/8 [=========================>....] - ETA: 0s - loss: 0.03508/8 [==============================] - 0s 36ms/step - loss: 0.0353
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.004965068830642849:
Train Score: 0.00295 MSE 0.05435 RMSE
Test Score: 0.00418 MSE 0.06466 RMSE
Deviation Min [0.00012039], Max [0.33140901]
Deviation 99.5th pctile [0.15594109]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1655,    1]))
Confusion matrix 
[[1647    8]
 [   0    1]]
precision 0.11111, recall 1.00000, f1 0.20000
Time to train: 530472 ms
Saving model models/A4Benchmark/A4Benchmark-TS87.csv.h5
Total Time to proces all the selected files : 533213 ms
A4Benchmark : Avg precision 0.11111 recall 1.00000 f1 0.20000 time to train 530472.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS87.csv  --epochs 20 --n_iter 3 --patience 3 :: took 546 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS88.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 02:27:14 AM MST
2020-12-01 02:27:43.546421: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 02:27:43.565252: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-12-01 02:27:43.566721: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559a6688bd30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 02:27:43.566775: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 02:27:43.567035: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS88.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00125/8 [=================>............] - ETA: 0s - loss: 0.00198/8 [==============================] - 0s 13ms/step - loss: 0.0019
1/8 [==>...........................] - ETA: 0s - loss: 0.00174/8 [==============>...............] - ETA: 0s - loss: 0.00657/8 [=========================>....] - ETA: 0s - loss: 0.01148/8 [==============================] - 0s 16ms/step - loss: 0.0120
1/8 [==>...........................] - ETA: 0s - loss: 0.02265/8 [=================>............] - ETA: 0s - loss: 0.02688/8 [==============================] - 0s 14ms/step - loss: 0.0275
1/8 [==>...........................] - ETA: 0s - loss: 0.02525/8 [=================>............] - ETA: 0s - loss: 0.02088/8 [==============================] - ETA: 0s - loss: 0.01708/8 [==============================] - 0s 16ms/step - loss: 0.0170
1/8 [==>...........................] - ETA: 0s - loss: 0.00485/8 [=================>............] - ETA: 0s - loss: 0.00568/8 [==============================] - 0s 13ms/step - loss: 0.0057
1/8 [==>...........................] - ETA: 0s - loss: 1.4747e-043/8 [==========>...................] - ETA: 0s - loss: 4.2851e-045/8 [=================>............] - ETA: 0s - loss: 5.3547e-047/8 [=========================>....] - ETA: 0s - loss: 4.3999e-048/8 [==============================] - 0s 28ms/step - loss: 4.3316e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00163/8 [==========>...................] - ETA: 0s - loss: 0.00495/8 [=================>............] - ETA: 0s - loss: 0.01727/8 [=========================>....] - ETA: 0s - loss: 0.02158/8 [==============================] - 0s 31ms/step - loss: 0.0233
1/8 [==>...........................] - ETA: 0s - loss: 0.02633/8 [==========>...................] - ETA: 0s - loss: 0.03205/8 [=================>............] - ETA: 0s - loss: 0.03297/8 [=========================>....] - ETA: 0s - loss: 0.03308/8 [==============================] - 0s 32ms/step - loss: 0.0336
1/8 [==>...........................] - ETA: 0s - loss: 0.03093/8 [==========>...................] - ETA: 0s - loss: 0.03735/8 [=================>............] - ETA: 0s - loss: 0.02837/8 [=========================>....] - ETA: 0s - loss: 0.02408/8 [==============================] - 0s 27ms/step - loss: 0.0236
1/8 [==>...........................] - ETA: 0s - loss: 0.00913/8 [==========>...................] - ETA: 0s - loss: 0.00975/8 [=================>............] - ETA: 0s - loss: 0.00967/8 [=========================>....] - ETA: 0s - loss: 0.00968/8 [==============================] - 0s 30ms/step - loss: 0.0097
1/8 [==>...........................] - ETA: 0s - loss: 0.00144/8 [==============>...............] - ETA: 0s - loss: 0.00217/8 [=========================>....] - ETA: 0s - loss: 0.00208/8 [==============================] - 0s 17ms/step - loss: 0.0020
1/8 [==>...........................] - ETA: 0s - loss: 0.00174/8 [==============>...............] - ETA: 0s - loss: 0.00937/8 [=========================>....] - ETA: 0s - loss: 0.01778/8 [==============================] - 0s 17ms/step - loss: 0.0189
1/8 [==>...........................] - ETA: 0s - loss: 0.02255/8 [=================>............] - ETA: 0s - loss: 0.02678/8 [==============================] - 0s 14ms/step - loss: 0.0274
1/8 [==>...........................] - ETA: 0s - loss: 0.00794/8 [==============>...............] - ETA: 0s - loss: 0.00857/8 [=========================>....] - ETA: 0s - loss: 0.00628/8 [==============================] - 0s 18ms/step - loss: 0.0060
1/8 [==>...........................] - ETA: 0s - loss: 0.00795/8 [=================>............] - ETA: 0s - loss: 0.00838/8 [==============================] - 0s 13ms/step - loss: 0.0084
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.012571917939931154:
Train Score: 0.01364 MSE 0.11678 RMSE
Test Score: 0.01068 MSE 0.10337 RMSE
Deviation Min [0.00035901], Max [0.58236009]
Deviation 99.5th pctile [0.33972672]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1643,   13]))
Confusion matrix 
[[1638    5]
 [   9    4]]
precision 0.44444, recall 0.30769, f1 0.36364
Time to train: 306458 ms
Saving model models/A4Benchmark/A4Benchmark-TS88.csv.h5
Total Time to proces all the selected files : 308970 ms
A4Benchmark : Avg precision 0.44444 recall 0.30769 f1 0.36364 time to train 306458.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS88.csv  --epochs 20 --n_iter 3 --patience 3 :: took 338 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS89.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 02:32:57 AM MST
2020-12-01 02:33:04.899160: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 02:33:04.918230: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-12-01 02:33:04.919100: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x564e7707bc00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 02:33:04.919127: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 02:33:04.919249: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS89.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00383/8 [==========>...................] - ETA: 0s - loss: 0.00355/8 [=================>............] - ETA: 0s - loss: 0.00347/8 [=========================>....] - ETA: 0s - loss: 0.00328/8 [==============================] - 0s 33ms/step - loss: 0.0032
1/8 [==>...........................] - ETA: 0s - loss: 0.02073/8 [==========>...................] - ETA: 0s - loss: 0.03505/8 [=================>............] - ETA: 0s - loss: 0.03326/8 [=====================>........] - ETA: 0s - loss: 0.03188/8 [==============================] - ETA: 0s - loss: 0.03258/8 [==============================] - 0s 39ms/step - loss: 0.0325
1/8 [==>...........................] - ETA: 0s - loss: 0.00803/8 [==========>...................] - ETA: 0s - loss: 0.01055/8 [=================>............] - ETA: 0s - loss: 0.00717/8 [=========================>....] - ETA: 0s - loss: 0.00788/8 [==============================] - 0s 30ms/step - loss: 0.0081
1/8 [==>...........................] - ETA: 0s - loss: 0.00263/8 [==========>...................] - ETA: 0s - loss: 0.00305/8 [=================>............] - ETA: 0s - loss: 0.00557/8 [=========================>....] - ETA: 0s - loss: 0.00618/8 [==============================] - 0s 24ms/step - loss: 0.0059
1/8 [==>...........................] - ETA: 0s - loss: 0.00333/8 [==========>...................] - ETA: 0s - loss: 0.00555/8 [=================>............] - ETA: 0s - loss: 0.00667/8 [=========================>....] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 24ms/step - loss: 0.0059
1/8 [==>...........................] - ETA: 0s - loss: 0.00995/8 [=================>............] - ETA: 0s - loss: 0.01368/8 [==============================] - 0s 11ms/step - loss: 0.0131
1/8 [==>...........................] - ETA: 0s - loss: 0.00475/8 [=================>............] - ETA: 0s - loss: 0.01038/8 [==============================] - ETA: 0s - loss: 0.00958/8 [==============================] - 0s 15ms/step - loss: 0.0095
1/8 [==>...........................] - ETA: 0s - loss: 0.00395/8 [=================>............] - ETA: 0s - loss: 0.00418/8 [==============================] - 0s 13ms/step - loss: 0.0043
1/8 [==>...........................] - ETA: 0s - loss: 0.00306/8 [=====================>........] - ETA: 0s - loss: 0.00498/8 [==============================] - 0s 11ms/step - loss: 0.0054
1/8 [==>...........................] - ETA: 0s - loss: 0.00635/8 [=================>............] - ETA: 0s - loss: 0.00858/8 [==============================] - 0s 13ms/step - loss: 0.0084
1/8 [==>...........................] - ETA: 0s - loss: 0.00353/8 [==========>...................] - ETA: 0s - loss: 0.00275/8 [=================>............] - ETA: 0s - loss: 0.00247/8 [=========================>....] - ETA: 0s - loss: 0.00248/8 [==============================] - 0s 35ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.00223/8 [==========>...................] - ETA: 0s - loss: 0.00685/8 [=================>............] - ETA: 0s - loss: 0.00797/8 [=========================>....] - ETA: 0s - loss: 0.00698/8 [==============================] - 0s 26ms/step - loss: 0.0070
1/8 [==>...........................] - ETA: 0s - loss: 0.00373/8 [==========>...................] - ETA: 0s - loss: 0.00455/8 [=================>............] - ETA: 0s - loss: 0.00357/8 [=========================>....] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 25ms/step - loss: 0.0038
1/8 [==>...........................] - ETA: 0s - loss: 0.00413/8 [==========>...................] - ETA: 0s - loss: 0.00345/8 [=================>............] - ETA: 0s - loss: 0.00627/8 [=========================>....] - ETA: 0s - loss: 0.00688/8 [==============================] - 0s 35ms/step - loss: 0.0065
1/8 [==>...........................] - ETA: 0s - loss: 0.01853/8 [==========>...................] - ETA: 0s - loss: 0.02305/8 [=================>............] - ETA: 0s - loss: 0.02317/8 [=========================>....] - ETA: 0s - loss: 0.02308/8 [==============================] - 0s 26ms/step - loss: 0.0233
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.008138092886656522:
Train Score: 0.00582 MSE 0.07628 RMSE
Test Score: 0.02009 MSE 0.14174 RMSE
Deviation Min [3.06881755e-06], Max [1.13715088]
Deviation 99.5th pctile [0.41184567]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Confusion matrix 
[[1641    6]
 [   6    3]]
precision 0.33333, recall 0.33333, f1 0.33333
Time to train: 543848 ms
Saving model models/A4Benchmark/A4Benchmark-TS89.csv.h5
Total Time to proces all the selected files : 546368 ms
A4Benchmark : Avg precision 0.33333 recall 0.33333 f1 0.33333 time to train 543848.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS89.csv  --epochs 20 --n_iter 3 --patience 3 :: took 554 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS8.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 02:42:16 AM MST
2020-12-01 02:42:37.079335: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 02:42:37.098218: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-12-01 02:42:37.099737: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56459ccb90b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 02:42:37.099790: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 02:42:37.100016: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS8.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 5.6207e-042/8 [======>.......................] - ETA: 0s - loss: 6.0753e-044/8 [==============>...............] - ETA: 0s - loss: 5.8665e-046/8 [=====================>........] - ETA: 0s - loss: 6.0775e-048/8 [==============================] - ETA: 0s - loss: 6.2264e-048/8 [==============================] - 0s 28ms/step - loss: 6.2264e-04
1/8 [==>...........................] - ETA: 0s - loss: 4.8779e-043/8 [==========>...................] - ETA: 0s - loss: 5.7937e-045/8 [=================>............] - ETA: 0s - loss: 5.5507e-047/8 [=========================>....] - ETA: 0s - loss: 0.0065    8/8 [==============================] - 0s 28ms/step - loss: 0.0085
1/8 [==>...........................] - ETA: 0s - loss: 0.02363/8 [==========>...................] - ETA: 0s - loss: 0.02965/8 [=================>............] - ETA: 0s - loss: 0.02967/8 [=========================>....] - ETA: 0s - loss: 0.03008/8 [==============================] - 0s 24ms/step - loss: 0.0290
1/8 [==>...........................] - ETA: 0s - loss: 0.00603/8 [==========>...................] - ETA: 0s - loss: 0.00765/8 [=================>............] - ETA: 0s - loss: 0.00757/8 [=========================>....] - ETA: 0s - loss: 0.00738/8 [==============================] - 0s 28ms/step - loss: 0.0076
1/8 [==>...........................] - ETA: 0s - loss: 0.00774/8 [==============>...............] - ETA: 0s - loss: 0.00746/8 [=====================>........] - ETA: 0s - loss: 0.00798/8 [==============================] - 0s 22ms/step - loss: 0.0082
1/8 [==>...........................] - ETA: 0s - loss: 4.8971e-044/8 [==============>...............] - ETA: 0s - loss: 6.1473e-047/8 [=========================>....] - ETA: 0s - loss: 6.0081e-048/8 [==============================] - 0s 16ms/step - loss: 6.1072e-04
1/8 [==>...........................] - ETA: 0s - loss: 3.6278e-045/8 [=================>............] - ETA: 0s - loss: 4.3372e-048/8 [==============================] - 0s 13ms/step - loss: 0.0076
1/8 [==>...........................] - ETA: 0s - loss: 0.02174/8 [==============>...............] - ETA: 0s - loss: 0.02597/8 [=========================>....] - ETA: 0s - loss: 0.02748/8 [==============================] - 0s 17ms/step - loss: 0.0264
1/8 [==>...........................] - ETA: 0s - loss: 0.00534/8 [==============>...............] - ETA: 0s - loss: 0.00607/8 [=========================>....] - ETA: 0s - loss: 0.00618/8 [==============================] - 0s 16ms/step - loss: 0.0062
1/8 [==>...........................] - ETA: 0s - loss: 0.00694/8 [==============>...............] - ETA: 0s - loss: 0.00667/8 [=========================>....] - ETA: 0s - loss: 0.00688/8 [==============================] - 0s 18ms/step - loss: 0.0069
1/8 [==>...........................] - ETA: 0s - loss: 4.2783e-044/8 [==============>...............] - ETA: 0s - loss: 4.7347e-046/8 [=====================>........] - ETA: 0s - loss: 4.9278e-048/8 [==============================] - 0s 17ms/step - loss: 5.0221e-04
1/8 [==>...........................] - ETA: 0s - loss: 4.3800e-045/8 [=================>............] - ETA: 0s - loss: 4.8890e-048/8 [==============================] - 0s 14ms/step - loss: 0.0076
1/8 [==>...........................] - ETA: 0s - loss: 0.02054/8 [==============>...............] - ETA: 0s - loss: 0.02457/8 [=========================>....] - ETA: 0s - loss: 0.02618/8 [==============================] - 0s 18ms/step - loss: 0.0252
1/8 [==>...........................] - ETA: 0s - loss: 0.00544/8 [==============>...............] - ETA: 0s - loss: 0.00627/8 [=========================>....] - ETA: 0s - loss: 0.00628/8 [==============================] - 0s 18ms/step - loss: 0.0064
1/8 [==>...........................] - ETA: 0s - loss: 0.00646/8 [=====================>........] - ETA: 0s - loss: 0.00668/8 [==============================] - 0s 11ms/step - loss: 0.0067
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.009270420635584743:
Train Score: 0.00799 MSE 0.08941 RMSE
Test Score: 0.00801 MSE 0.08951 RMSE
Deviation Min [5.20907781e-05], Max [0.63401896]
Deviation 99.5th pctile [0.28144909]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1643,   13]))
Confusion matrix 
[[1635    8]
 [  12    1]]
precision 0.11111, recall 0.07692, f1 0.09091
Time to train: 258619 ms
Saving model models/A4Benchmark/A4Benchmark-TS8.csv.h5
Total Time to proces all the selected files : 261399 ms
A4Benchmark : Avg precision 0.11111 recall 0.07692 f1 0.09091 time to train 258619.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS8.csv  --epochs 20 --n_iter 3 --patience 3 :: took 282 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS90.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 02:47:03 AM MST
2020-12-01 02:47:15.199264: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 02:47:15.218217: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-12-01 02:47:15.219104: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x558c7cfdf310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 02:47:15.219132: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 02:47:15.219247: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS90.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00833/8 [==========>...................] - ETA: 0s - loss: 0.00995/8 [=================>............] - ETA: 0s - loss: 0.01027/8 [=========================>....] - ETA: 0s - loss: 0.00988/8 [==============================] - 0s 23ms/step - loss: 0.0101
1/8 [==>...........................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00255/8 [=================>............] - ETA: 0s - loss: 0.00257/8 [=========================>....] - ETA: 0s - loss: 0.00208/8 [==============================] - 0s 23ms/step - loss: 0.0020
1/8 [==>...........................] - ETA: 0s - loss: 0.00263/8 [==========>...................] - ETA: 0s - loss: 0.00535/8 [=================>............] - ETA: 0s - loss: 0.00387/8 [=========================>....] - ETA: 0s - loss: 0.00408/8 [==============================] - 0s 29ms/step - loss: 0.0041
1/8 [==>...........................] - ETA: 0s - loss: 0.01513/8 [==========>...................] - ETA: 0s - loss: 0.01585/8 [=================>............] - ETA: 0s - loss: 0.01597/8 [=========================>....] - ETA: 0s - loss: 0.01738/8 [==============================] - 0s 33ms/step - loss: 0.0175
1/8 [==>...........................] - ETA: 0s - loss: 0.01913/8 [==========>...................] - ETA: 0s - loss: 0.03545/8 [=================>............] - ETA: 0s - loss: 0.03697/8 [=========================>....] - ETA: 0s - loss: 0.03628/8 [==============================] - 0s 24ms/step - loss: 0.0364
1/8 [==>...........................] - ETA: 0s - loss: 0.00695/8 [=================>............] - ETA: 0s - loss: 0.00848/8 [==============================] - 0s 14ms/step - loss: 0.0082
1/8 [==>...........................] - ETA: 0s - loss: 0.00295/8 [=================>............] - ETA: 0s - loss: 0.00558/8 [==============================] - 0s 14ms/step - loss: 0.0049
1/8 [==>...........................] - ETA: 0s - loss: 0.00844/8 [==============>...............] - ETA: 0s - loss: 0.01807/8 [=========================>....] - ETA: 0s - loss: 0.01788/8 [==============================] - 0s 20ms/step - loss: 0.0191
1/8 [==>...........................] - ETA: 0s - loss: 0.01774/8 [==============>...............] - ETA: 0s - loss: 0.01597/8 [=========================>....] - ETA: 0s - loss: 0.01898/8 [==============================] - 0s 19ms/step - loss: 0.0190
1/8 [==>...........................] - ETA: 0s - loss: 0.01174/8 [==============>...............] - ETA: 0s - loss: 0.02147/8 [=========================>....] - ETA: 0s - loss: 0.02088/8 [==============================] - 0s 15ms/step - loss: 0.0210
1/8 [==>...........................] - ETA: 0s - loss: 0.00755/8 [=================>............] - ETA: 0s - loss: 0.00938/8 [==============================] - 0s 12ms/step - loss: 0.0106
1/8 [==>...........................] - ETA: 0s - loss: 0.00655/8 [=================>............] - ETA: 0s - loss: 0.00978/8 [==============================] - 0s 12ms/step - loss: 0.0094
1/8 [==>...........................] - ETA: 0s - loss: 0.00675/8 [=================>............] - ETA: 0s - loss: 0.01148/8 [==============================] - 0s 13ms/step - loss: 0.0127
1/8 [==>...........................] - ETA: 0s - loss: 0.00495/8 [=================>............] - ETA: 0s - loss: 0.00698/8 [==============================] - ETA: 0s - loss: 0.00688/8 [==============================] - 0s 16ms/step - loss: 0.0068
1/8 [==>...........................] - ETA: 0s - loss: 0.00335/8 [=================>............] - ETA: 0s - loss: 0.00548/8 [==============================] - 0s 13ms/step - loss: 0.0060
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.009103840310126543:
Train Score: 0.00220 MSE 0.04694 RMSE
Test Score: 0.00447 MSE 0.06687 RMSE
Deviation Min [1.38453831e-05], Max [0.33369529]
Deviation 99.5th pctile [0.2115254]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1644,   12]))
Confusion matrix 
[[1643    1]
 [   4    8]]
precision 0.88889, recall 0.66667, f1 0.76190
Time to train: 372357 ms
Saving model models/A4Benchmark/A4Benchmark-TS90.csv.h5
Total Time to proces all the selected files : 374763 ms
A4Benchmark : Avg precision 0.88889 recall 0.66667 f1 0.76190 time to train 372357.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS90.csv  --epochs 20 --n_iter 3 --patience 3 :: took 387 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS91.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 02:53:35 AM MST
2020-12-01 02:53:52.408170: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 02:53:52.426216: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-12-01 02:53:52.427075: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55b176eedc00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 02:53:52.427102: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 02:53:52.427205: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS91.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00134/8 [==============>...............] - ETA: 0s - loss: 0.00227/8 [=========================>....] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 18ms/step - loss: 0.0022
1/8 [==>...........................] - ETA: 0s - loss: 0.00194/8 [==============>...............] - ETA: 0s - loss: 0.00197/8 [=========================>....] - ETA: 0s - loss: 0.00208/8 [==============================] - 0s 19ms/step - loss: 0.0020
1/8 [==>...........................] - ETA: 0s - loss: 0.00144/8 [==============>...............] - ETA: 0s - loss: 0.00167/8 [=========================>....] - ETA: 0s - loss: 0.00178/8 [==============================] - 0s 15ms/step - loss: 0.0017
1/8 [==>...........................] - ETA: 0s - loss: 0.00114/8 [==============>...............] - ETA: 0s - loss: 0.00177/8 [=========================>....] - ETA: 0s - loss: 0.00178/8 [==============================] - 0s 16ms/step - loss: 0.0018
1/8 [==>...........................] - ETA: 0s - loss: 0.00555/8 [=================>............] - ETA: 0s - loss: 0.00668/8 [==============================] - 0s 13ms/step - loss: 0.0071
1/8 [==>...........................] - ETA: 0s - loss: 0.00153/8 [==========>...................] - ETA: 0s - loss: 0.00225/8 [=================>............] - ETA: 0s - loss: 0.00237/8 [=========================>....] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 28ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.00193/8 [==========>...................] - ETA: 0s - loss: 0.00215/8 [=================>............] - ETA: 0s - loss: 0.00227/8 [=========================>....] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 24ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.00163/8 [==========>...................] - ETA: 0s - loss: 0.00205/8 [=================>............] - ETA: 0s - loss: 0.00217/8 [=========================>....] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 29ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.00143/8 [==========>...................] - ETA: 0s - loss: 0.00235/8 [=================>............] - ETA: 0s - loss: 0.00217/8 [=========================>....] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 24ms/step - loss: 0.0022
1/8 [==>...........................] - ETA: 0s - loss: 0.00623/8 [==========>...................] - ETA: 0s - loss: 0.00725/8 [=================>............] - ETA: 0s - loss: 0.00767/8 [=========================>....] - ETA: 0s - loss: 0.00798/8 [==============================] - 0s 28ms/step - loss: 0.0080
1/8 [==>...........................] - ETA: 0s - loss: 0.00153/8 [==========>...................] - ETA: 0s - loss: 0.00225/8 [=================>............] - ETA: 0s - loss: 0.00247/8 [=========================>....] - ETA: 0s - loss: 0.00248/8 [==============================] - 0s 35ms/step - loss: 0.0024
1/8 [==>...........................] - ETA: 0s - loss: 0.00253/8 [==========>...................] - ETA: 0s - loss: 0.00245/8 [=================>............] - ETA: 0s - loss: 0.00247/8 [=========================>....] - ETA: 0s - loss: 0.00258/8 [==============================] - 0s 35ms/step - loss: 0.0025
1/8 [==>...........................] - ETA: 0s - loss: 0.00163/8 [==========>...................] - ETA: 0s - loss: 0.00205/8 [=================>............] - ETA: 0s - loss: 0.00197/8 [=========================>....] - ETA: 0s - loss: 0.00208/8 [==============================] - 0s 33ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.00143/8 [==========>...................] - ETA: 0s - loss: 0.00225/8 [=================>............] - ETA: 0s - loss: 0.00207/8 [=========================>....] - ETA: 0s - loss: 0.00208/8 [==============================] - 0s 40ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.00593/8 [==========>...................] - ETA: 0s - loss: 0.00715/8 [=================>............] - ETA: 0s - loss: 0.00747/8 [=========================>....] - ETA: 0s - loss: 0.00768/8 [==============================] - 0s 26ms/step - loss: 0.0077
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0029693455202504993:
Train Score: 0.00265 MSE 0.05151 RMSE
Test Score: 0.01163 MSE 0.10783 RMSE
Deviation Min [8.83718194e-06], Max [0.26536241]
Deviation 99.5th pctile [0.22325119]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1644,   12]))
Confusion matrix 
[[1635    9]
 [  12    0]]
precision 0.00000, recall 0.00000, f1 0.00000
Time to train: 303134 ms
Saving model models/A4Benchmark/A4Benchmark-TS91.csv.h5
Total Time to proces all the selected files : 305963 ms
A4Benchmark : Avg precision 0.00000 recall 0.00000 f1 0.00000 time to train 303134.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS91.csv  --epochs 20 --n_iter 3 --patience 3 :: took 323 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS92.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 02:59:03 AM MST
2020-12-01 02:59:11.018939: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 02:59:11.037266: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-12-01 02:59:11.038152: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55cab63b4d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 02:59:11.038180: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 02:59:11.038290: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS92.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00125/8 [=================>............] - ETA: 0s - loss: 0.00117/8 [=========================>....] - ETA: 0s - loss: 0.00138/8 [==============================] - 0s 35ms/step - loss: 0.0013
1/8 [==>...........................] - ETA: 0s - loss: 0.00103/8 [==========>...................] - ETA: 0s - loss: 0.00135/8 [=================>............] - ETA: 0s - loss: 0.00137/8 [=========================>....] - ETA: 0s - loss: 0.00138/8 [==============================] - 0s 33ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 0.00263/8 [==========>...................] - ETA: 0s - loss: 0.00235/8 [=================>............] - ETA: 0s - loss: 0.00207/8 [=========================>....] - ETA: 0s - loss: 0.00178/8 [==============================] - 0s 31ms/step - loss: 0.0018
1/8 [==>...........................] - ETA: 0s - loss: 7.8051e-043/8 [==========>...................] - ETA: 0s - loss: 0.0011    5/8 [=================>............] - ETA: 0s - loss: 0.00137/8 [=========================>....] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 29ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 0.00503/8 [==========>...................] - ETA: 0s - loss: 0.00535/8 [=================>............] - ETA: 0s - loss: 0.00607/8 [=========================>....] - ETA: 0s - loss: 0.00688/8 [==============================] - 0s 29ms/step - loss: 0.0070
1/8 [==>...........................] - ETA: 0s - loss: 0.00114/8 [==============>...............] - ETA: 0s - loss: 0.00107/8 [=========================>....] - ETA: 0s - loss: 0.00128/8 [==============================] - 0s 18ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 0.00145/8 [=================>............] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 13ms/step - loss: 0.0018
1/8 [==>...........................] - ETA: 0s - loss: 0.00214/8 [==============>...............] - ETA: 0s - loss: 0.00177/8 [=========================>....] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 19ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 6.7979e-045/8 [=================>............] - ETA: 0s - loss: 0.0010    8/8 [==============================] - 0s 12ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 0.00203/8 [==========>...................] - ETA: 0s - loss: 0.00227/8 [=========================>....] - ETA: 0s - loss: 0.00338/8 [==============================] - 0s 18ms/step - loss: 0.0034
1/8 [==>...........................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00115/8 [=================>............] - ETA: 0s - loss: 0.00107/8 [=========================>....] - ETA: 0s - loss: 0.00118/8 [==============================] - 0s 26ms/step - loss: 0.0011
1/8 [==>...........................] - ETA: 0s - loss: 0.00133/8 [==========>...................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00177/8 [=========================>....] - ETA: 0s - loss: 0.00178/8 [==============================] - 0s 26ms/step - loss: 0.0017
1/8 [==>...........................] - ETA: 0s - loss: 0.00143/8 [==========>...................] - ETA: 0s - loss: 0.00125/8 [=================>............] - ETA: 0s - loss: 0.00127/8 [=========================>....] - ETA: 0s - loss: 0.00118/8 [==============================] - 0s 37ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 8.0645e-043/8 [==========>...................] - ETA: 0s - loss: 0.0011    5/8 [=================>............] - ETA: 0s - loss: 0.00137/8 [=========================>....] - ETA: 0s - loss: 0.00148/8 [==============================] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 38ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 0.00993/8 [==========>...................] - ETA: 0s - loss: 0.01025/8 [=================>............] - ETA: 0s - loss: 0.01127/8 [=========================>....] - ETA: 0s - loss: 0.01248/8 [==============================] - 0s 28ms/step - loss: 0.0126
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0018317484762519598:
Train Score: 0.00155 MSE 0.03941 RMSE
Test Score: 0.01099 MSE 0.10483 RMSE
Deviation Min [1.64993116e-05], Max [0.17958246]
Deviation 99.5th pctile [0.16249129]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1641,   15]))
Confusion matrix 
[[1632    9]
 [  15    0]]
precision 0.00000, recall 0.00000, f1 0.00000
Time to train: 296923 ms
Saving model models/A4Benchmark/A4Benchmark-TS92.csv.h5
Total Time to proces all the selected files : 299417 ms
A4Benchmark : Avg precision 0.00000 recall 0.00000 f1 0.00000 time to train 296923.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS92.csv  --epochs 20 --n_iter 3 --patience 3 :: took 307 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS93.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 03:04:15 AM MST
2020-12-01 03:04:32.575605: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 03:04:32.594205: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-12-01 03:04:32.595645: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55a217b5fd30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 03:04:32.595696: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 03:04:32.595918: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS93.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00943/8 [==========>...................] - ETA: 0s - loss: 0.00675/8 [=================>............] - ETA: 0s - loss: 0.00677/8 [=========================>....] - ETA: 0s - loss: 0.00698/8 [==============================] - 0s 31ms/step - loss: 0.0080
1/8 [==>...........................] - ETA: 0s - loss: 0.02883/8 [==========>...................] - ETA: 0s - loss: 0.01945/8 [=================>............] - ETA: 0s - loss: 0.01747/8 [=========================>....] - ETA: 0s - loss: 0.01878/8 [==============================] - 0s 26ms/step - loss: 0.0184
1/8 [==>...........................] - ETA: 0s - loss: 0.00644/8 [==============>...............] - ETA: 0s - loss: 0.00566/8 [=====================>........] - ETA: 0s - loss: 0.00818/8 [==============================] - ETA: 0s - loss: 0.00818/8 [==============================] - 0s 23ms/step - loss: 0.0081
1/8 [==>...........................] - ETA: 0s - loss: 0.00313/8 [==========>...................] - ETA: 0s - loss: 0.00875/8 [=================>............] - ETA: 0s - loss: 0.00937/8 [=========================>....] - ETA: 0s - loss: 0.00888/8 [==============================] - 0s 27ms/step - loss: 0.0096
1/8 [==>...........................] - ETA: 0s - loss: 0.00313/8 [==========>...................] - ETA: 0s - loss: 0.00205/8 [=================>............] - ETA: 0s - loss: 0.00187/8 [=========================>....] - ETA: 0s - loss: 0.00198/8 [==============================] - 0s 27ms/step - loss: 0.0019
1/8 [==>...........................] - ETA: 0s - loss: 0.00553/8 [==========>...................] - ETA: 0s - loss: 0.00415/8 [=================>............] - ETA: 0s - loss: 0.00497/8 [=========================>....] - ETA: 0s - loss: 0.00508/8 [==============================] - 0s 34ms/step - loss: 0.0061
1/8 [==>...........................] - ETA: 0s - loss: 0.01963/8 [==========>...................] - ETA: 0s - loss: 0.02355/8 [=================>............] - ETA: 0s - loss: 0.02607/8 [=========================>....] - ETA: 0s - loss: 0.02578/8 [==============================] - 0s 32ms/step - loss: 0.0257
1/8 [==>...........................] - ETA: 0s - loss: 0.00803/8 [==========>...................] - ETA: 0s - loss: 0.00695/8 [=================>............] - ETA: 0s - loss: 0.00797/8 [=========================>....] - ETA: 0s - loss: 0.00908/8 [==============================] - 0s 35ms/step - loss: 0.0088
1/8 [==>...........................] - ETA: 0s - loss: 0.00413/8 [==========>...................] - ETA: 0s - loss: 0.00675/8 [=================>............] - ETA: 0s - loss: 0.00727/8 [=========================>....] - ETA: 0s - loss: 0.00718/8 [==============================] - 0s 26ms/step - loss: 0.0076
1/8 [==>...........................] - ETA: 0s - loss: 0.00353/8 [==========>...................] - ETA: 0s - loss: 0.00235/8 [=================>............] - ETA: 0s - loss: 0.00207/8 [=========================>....] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 33ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.00534/8 [==============>...............] - ETA: 0s - loss: 0.00427/8 [=========================>....] - ETA: 0s - loss: 0.00508/8 [==============================] - 0s 18ms/step - loss: 0.0059
1/8 [==>...........................] - ETA: 0s - loss: 0.00805/8 [=================>............] - ETA: 0s - loss: 0.00688/8 [==============================] - 0s 12ms/step - loss: 0.0065
1/8 [==>...........................] - ETA: 0s - loss: 0.00324/8 [==============>...............] - ETA: 0s - loss: 0.00317/8 [=========================>....] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 15ms/step - loss: 0.0046
1/8 [==>...........................] - ETA: 0s - loss: 0.00685/8 [=================>............] - ETA: 0s - loss: 0.00898/8 [==============================] - 0s 11ms/step - loss: 0.0093
1/8 [==>...........................] - ETA: 0s - loss: 0.00274/8 [==============>...............] - ETA: 0s - loss: 0.00187/8 [=========================>....] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 17ms/step - loss: 0.0021
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.005686874873936177:
Train Score: 0.00525 MSE 0.07243 RMSE
Test Score: 0.00406 MSE 0.06375 RMSE
Deviation Min [7.98514033e-05], Max [0.51911572]
Deviation 99.5th pctile [0.21214589]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1650,    6]))
Confusion matrix 
[[1646    4]
 [   1    5]]
precision 0.55556, recall 0.83333, f1 0.66667
Time to train: 649082 ms
Saving model models/A4Benchmark/A4Benchmark-TS93.csv.h5
Total Time to proces all the selected files : 651304 ms
A4Benchmark : Avg precision 0.55556 recall 0.83333 f1 0.66667 time to train 649082.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS93.csv  --epochs 20 --n_iter 3 --patience 3 :: took 669 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS94.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 03:15:29 AM MST
2020-12-01 03:15:56.460663: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 03:15:56.479237: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-12-01 03:15:56.480102: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x560447fdbd30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 03:15:56.480136: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 03:15:56.480243: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS94.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00474/8 [==============>...............] - ETA: 0s - loss: 0.00457/8 [=========================>....] - ETA: 0s - loss: 0.00408/8 [==============================] - 0s 16ms/step - loss: 0.0039
1/8 [==>...........................] - ETA: 0s - loss: 0.00255/8 [=================>............] - ETA: 0s - loss: 0.00108/8 [==============================] - 0s 13ms/step - loss: 8.3810e-04
1/8 [==>...........................] - ETA: 0s - loss: 3.7777e-045/8 [=================>............] - ETA: 0s - loss: 0.0059    8/8 [==============================] - 0s 14ms/step - loss: 0.0064
1/8 [==>...........................] - ETA: 0s - loss: 0.00495/8 [=================>............] - ETA: 0s - loss: 0.00498/8 [==============================] - 0s 12ms/step - loss: 0.0040
1/8 [==>...........................] - ETA: 0s - loss: 4.4564e-045/8 [=================>............] - ETA: 0s - loss: 7.8432e-048/8 [==============================] - 0s 12ms/step - loss: 7.7135e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.01653/8 [==========>...................] - ETA: 0s - loss: 0.01945/8 [=================>............] - ETA: 0s - loss: 0.02017/8 [=========================>....] - ETA: 0s - loss: 0.01948/8 [==============================] - 0s 26ms/step - loss: 0.0198
1/8 [==>...........................] - ETA: 0s - loss: 0.00233/8 [==========>...................] - ETA: 0s - loss: 0.00135/8 [=================>............] - ETA: 0s - loss: 9.3297e-047/8 [=========================>....] - ETA: 0s - loss: 7.1539e-048/8 [==============================] - 0s 34ms/step - loss: 6.8139e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00133/8 [==========>...................] - ETA: 0s - loss: 0.00475/8 [=================>............] - ETA: 0s - loss: 0.00847/8 [=========================>....] - ETA: 0s - loss: 0.00768/8 [==============================] - 0s 33ms/step - loss: 0.0076
1/8 [==>...........................] - ETA: 0s - loss: 0.01503/8 [==========>...................] - ETA: 0s - loss: 0.02295/8 [=================>............] - ETA: 0s - loss: 0.01637/8 [=========================>....] - ETA: 0s - loss: 0.01238/8 [==============================] - 0s 31ms/step - loss: 0.0118
1/8 [==>...........................] - ETA: 0s - loss: 3.6828e-043/8 [==========>...................] - ETA: 0s - loss: 0.0011    5/8 [=================>............] - ETA: 0s - loss: 9.0598e-047/8 [=========================>....] - ETA: 0s - loss: 8.3942e-048/8 [==============================] - 0s 30ms/step - loss: 8.8823e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.01653/8 [==========>...................] - ETA: 0s - loss: 0.01965/8 [=================>............] - ETA: 0s - loss: 0.02027/8 [=========================>....] - ETA: 0s - loss: 0.01958/8 [==============================] - 0s 38ms/step - loss: 0.0199
1/8 [==>...........................] - ETA: 0s - loss: 0.01363/8 [==========>...................] - ETA: 0s - loss: 0.00625/8 [=================>............] - ETA: 0s - loss: 0.00487/8 [=========================>....] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 27ms/step - loss: 0.0049
1/8 [==>...........................] - ETA: 0s - loss: 0.00163/8 [==========>...................] - ETA: 0s - loss: 0.00755/8 [=================>............] - ETA: 0s - loss: 0.01237/8 [=========================>....] - ETA: 0s - loss: 0.01258/8 [==============================] - 0s 27ms/step - loss: 0.0131
1/8 [==>...........................] - ETA: 0s - loss: 0.00313/8 [==========>...................] - ETA: 0s - loss: 0.00405/8 [=================>............] - ETA: 0s - loss: 0.00397/8 [=========================>....] - ETA: 0s - loss: 0.00338/8 [==============================] - 0s 27ms/step - loss: 0.0032
1/8 [==>...........................] - ETA: 0s - loss: 4.8293e-043/8 [==========>...................] - ETA: 0s - loss: 0.0013    5/8 [=================>............] - ETA: 0s - loss: 0.00127/8 [=========================>....] - ETA: 0s - loss: 0.00128/8 [==============================] - 0s 35ms/step - loss: 0.0012
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.0032035020529292526:
Train Score: 0.00239 MSE 0.04887 RMSE
Test Score: 0.00408 MSE 0.06388 RMSE
Deviation Min [1.17853514e-05], Max [0.33317479]
Deviation 99.5th pctile [0.19412475]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1643,   13]))
Confusion matrix 
[[1641    2]
 [   6    7]]
precision 0.77778, recall 0.53846, f1 0.63636
Time to train: 608854 ms
Saving model models/A4Benchmark/A4Benchmark-TS94.csv.h5
Total Time to proces all the selected files : 611528 ms
A4Benchmark : Avg precision 0.77778 recall 0.53846 f1 0.63636 time to train 608854.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS94.csv  --epochs 20 --n_iter 3 --patience 3 :: took 639 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS95.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 03:26:13 AM MST
2020-12-01 03:26:20.994837: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 03:26:21.013234: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-12-01 03:26:21.014551: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x557096dc8c00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 03:26:21.014593: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 03:26:21.014755: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS95.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00756/8 [=====================>........] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 11ms/step - loss: 0.0053
1/8 [==>...........................] - ETA: 0s - loss: 0.01284/8 [==============>...............] - ETA: 0s - loss: 0.01557/8 [=========================>....] - ETA: 0s - loss: 0.01488/8 [==============================] - 0s 19ms/step - loss: 0.0148
1/8 [==>...........................] - ETA: 0s - loss: 0.00155/8 [=================>............] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 14ms/step - loss: 0.0024
1/8 [==>...........................] - ETA: 0s - loss: 0.00734/8 [==============>...............] - ETA: 0s - loss: 0.00468/8 [==============================] - ETA: 0s - loss: 0.00448/8 [==============================] - 0s 14ms/step - loss: 0.0044
1/8 [==>...........................] - ETA: 0s - loss: 0.01305/8 [=================>............] - ETA: 0s - loss: 0.02198/8 [==============================] - 0s 12ms/step - loss: 0.0229
1/8 [==>...........................] - ETA: 0s - loss: 0.01334/8 [==============>...............] - ETA: 0s - loss: 0.01557/8 [=========================>....] - ETA: 0s - loss: 0.01688/8 [==============================] - 0s 18ms/step - loss: 0.0178
1/8 [==>...........................] - ETA: 0s - loss: 0.01705/8 [=================>............] - ETA: 0s - loss: 0.02228/8 [==============================] - 0s 13ms/step - loss: 0.0214
1/8 [==>...........................] - ETA: 0s - loss: 0.00455/8 [=================>............] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 11ms/step - loss: 0.0039
1/8 [==>...........................] - ETA: 0s - loss: 0.00755/8 [=================>............] - ETA: 0s - loss: 0.00418/8 [==============================] - 0s 14ms/step - loss: 0.0033
1/8 [==>...........................] - ETA: 0s - loss: 0.00394/8 [==============>...............] - ETA: 0s - loss: 0.00277/8 [=========================>....] - ETA: 0s - loss: 0.00338/8 [==============================] - 0s 17ms/step - loss: 0.0032
1/8 [==>...........................] - ETA: 0s - loss: 0.01503/8 [==========>...................] - ETA: 0s - loss: 0.01805/8 [=================>............] - ETA: 0s - loss: 0.01787/8 [=========================>....] - ETA: 0s - loss: 0.01828/8 [==============================] - 0s 28ms/step - loss: 0.0190
1/8 [==>...........................] - ETA: 0s - loss: 0.01933/8 [==========>...................] - ETA: 0s - loss: 0.02145/8 [=================>............] - ETA: 0s - loss: 0.02577/8 [=========================>....] - ETA: 0s - loss: 0.02508/8 [==============================] - 0s 33ms/step - loss: 0.0249
1/8 [==>...........................] - ETA: 0s - loss: 0.00933/8 [==========>...................] - ETA: 0s - loss: 0.01335/8 [=================>............] - ETA: 0s - loss: 0.01187/8 [=========================>....] - ETA: 0s - loss: 0.01198/8 [==============================] - 0s 35ms/step - loss: 0.0125
1/8 [==>...........................] - ETA: 0s - loss: 0.01573/8 [==========>...................] - ETA: 0s - loss: 0.01165/8 [=================>............] - ETA: 0s - loss: 0.00947/8 [=========================>....] - ETA: 0s - loss: 0.00918/8 [==============================] - 0s 31ms/step - loss: 0.0089
1/8 [==>...........................] - ETA: 0s - loss: 0.01173/8 [==========>...................] - ETA: 0s - loss: 0.01875/8 [=================>............] - ETA: 0s - loss: 0.01877/8 [=========================>....] - ETA: 0s - loss: 0.01918/8 [==============================] - 0s 36ms/step - loss: 0.0193
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.009912473615258932:
Train Score: 0.00173 MSE 0.04160 RMSE
Test Score: 0.00221 MSE 0.04701 RMSE
Deviation Min [1.09931923e-05], Max [0.32059831]
Deviation 99.5th pctile [0.1186686]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1651,    5]))
Confusion matrix 
[[1646    5]
 [   1    4]]
precision 0.44444, recall 0.80000, f1 0.57143
Time to train: 319192 ms
Saving model models/A4Benchmark/A4Benchmark-TS95.csv.h5
Total Time to proces all the selected files : 321558 ms
A4Benchmark : Avg precision 0.44444 recall 0.80000 f1 0.57143 time to train 319192.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS95.csv  --epochs 20 --n_iter 3 --patience 3 :: took 330 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS96.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 03:31:48 AM MST
2020-12-01 03:31:55.001567: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 03:31:55.020270: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-12-01 03:31:55.021842: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55a3ff3fbd30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 03:31:55.021915: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 03:31:55.022132: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS96.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.01414/8 [==============>...............] - ETA: 0s - loss: 0.01437/8 [=========================>....] - ETA: 0s - loss: 0.01238/8 [==============================] - 0s 17ms/step - loss: 0.0118
1/8 [==>...........................] - ETA: 0s - loss: 7.0462e-044/8 [==============>...............] - ETA: 0s - loss: 9.3757e-047/8 [=========================>....] - ETA: 0s - loss: 9.3572e-048/8 [==============================] - 0s 16ms/step - loss: 9.5360e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00185/8 [=================>............] - ETA: 0s - loss: 0.00458/8 [==============================] - 0s 14ms/step - loss: 0.0051
1/8 [==>...........................] - ETA: 0s - loss: 9.1241e-046/8 [=====================>........] - ETA: 0s - loss: 0.0026    8/8 [==============================] - 0s 11ms/step - loss: 0.0026
1/8 [==>...........................] - ETA: 0s - loss: 0.00115/8 [=================>............] - ETA: 0s - loss: 7.8573e-048/8 [==============================] - 0s 13ms/step - loss: 6.3806e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00973/8 [==========>...................] - ETA: 0s - loss: 0.01125/8 [=================>............] - ETA: 0s - loss: 0.01137/8 [=========================>....] - ETA: 0s - loss: 0.00948/8 [==============================] - 0s 28ms/step - loss: 0.0092
1/8 [==>...........................] - ETA: 0s - loss: 6.4174e-053/8 [==========>...................] - ETA: 0s - loss: 1.2567e-045/8 [=================>............] - ETA: 0s - loss: 2.6630e-047/8 [=========================>....] - ETA: 0s - loss: 2.2594e-048/8 [==============================] - 0s 24ms/step - loss: 2.1660e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00423/8 [==========>...................] - ETA: 0s - loss: 0.01835/8 [=================>............] - ETA: 0s - loss: 0.01857/8 [=========================>....] - ETA: 0s - loss: 0.02048/8 [==============================] - ETA: 0s - loss: 0.02198/8 [==============================] - 0s 39ms/step - loss: 0.0219
1/8 [==>...........................] - ETA: 0s - loss: 0.02263/8 [==========>...................] - ETA: 0s - loss: 0.02645/8 [=================>............] - ETA: 0s - loss: 0.02497/8 [=========================>....] - ETA: 0s - loss: 0.02718/8 [==============================] - 0s 27ms/step - loss: 0.0273
1/8 [==>...........................] - ETA: 0s - loss: 0.00233/8 [==========>...................] - ETA: 0s - loss: 0.00255/8 [=================>............] - ETA: 0s - loss: 0.00186/8 [=====================>........] - ETA: 0s - loss: 0.00168/8 [==============================] - ETA: 0s - loss: 0.00148/8 [==============================] - 0s 36ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 0.01183/8 [==========>...................] - ETA: 0s - loss: 0.01215/8 [=================>............] - ETA: 0s - loss: 0.01287/8 [=========================>....] - ETA: 0s - loss: 0.01048/8 [==============================] - 0s 27ms/step - loss: 0.0099
1/8 [==>...........................] - ETA: 0s - loss: 5.2747e-043/8 [==========>...................] - ETA: 0s - loss: 8.0877e-045/8 [=================>............] - ETA: 0s - loss: 9.2454e-047/8 [=========================>....] - ETA: 0s - loss: 8.4375e-048/8 [==============================] - 0s 39ms/step - loss: 8.4443e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00253/8 [==========>...................] - ETA: 0s - loss: 0.00535/8 [=================>............] - ETA: 0s - loss: 0.00427/8 [=========================>....] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 36ms/step - loss: 0.0049
1/8 [==>...........................] - ETA: 0s - loss: 7.7889e-043/8 [==========>...................] - ETA: 0s - loss: 0.0034    5/8 [=================>............] - ETA: 0s - loss: 0.00267/8 [=========================>....] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 27ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.00112/8 [======>.......................] - ETA: 0s - loss: 0.00244/8 [==============>...............] - ETA: 0s - loss: 0.00366/8 [=====================>........] - ETA: 0s - loss: 0.00277/8 [=========================>....] - ETA: 0s - loss: 0.00268/8 [==============================] - 0s 33ms/step - loss: 0.0027
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.004123797127977014:
Train Score: 0.00219 MSE 0.04679 RMSE
Test Score: 0.00138 MSE 0.03716 RMSE
Deviation Min [1.37701917e-05], Max [0.35248542]
Deviation 99.5th pctile [0.13690868]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1654,    2]))
Confusion matrix 
[[1647    7]
 [   0    2]]
precision 0.22222, recall 1.00000, f1 0.36364
Time to train: 633630 ms
Saving model models/A4Benchmark/A4Benchmark-TS96.csv.h5
Total Time to proces all the selected files : 638530 ms
A4Benchmark : Avg precision 0.22222 recall 1.00000 f1 0.36364 time to train 633630.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS96.csv  --epochs 20 --n_iter 3 --patience 3 :: took 645 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS97.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 03:42:38 AM MST
2020-12-01 03:42:45.383291: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 03:42:45.402188: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-12-01 03:42:45.403514: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56175bd520b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 03:42:45.403562: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 03:42:45.403759: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS97.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00205/8 [=================>............] - ETA: 0s - loss: 0.00138/8 [==============================] - 0s 12ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 0.00725/8 [=================>............] - ETA: 0s - loss: 0.00808/8 [==============================] - 0s 12ms/step - loss: 0.0085
1/8 [==>...........................] - ETA: 0s - loss: 0.00684/8 [==============>...............] - ETA: 0s - loss: 0.00877/8 [=========================>....] - ETA: 0s - loss: 0.00808/8 [==============================] - 0s 16ms/step - loss: 0.0077
1/8 [==>...........................] - ETA: 0s - loss: 0.00164/8 [==============>...............] - ETA: 0s - loss: 0.00187/8 [=========================>....] - ETA: 0s - loss: 0.00208/8 [==============================] - 0s 16ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.00126/8 [=====================>........] - ETA: 0s - loss: 0.00278/8 [==============================] - 0s 11ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.00595/8 [=================>............] - ETA: 0s - loss: 0.00698/8 [==============================] - 0s 12ms/step - loss: 0.0072
1/8 [==>...........................] - ETA: 0s - loss: 0.00694/8 [==============>...............] - ETA: 0s - loss: 0.00778/8 [==============================] - ETA: 0s - loss: 0.00818/8 [==============================] - 0s 14ms/step - loss: 0.0081
1/8 [==>...........................] - ETA: 0s - loss: 0.00665/8 [=================>............] - ETA: 0s - loss: 0.00838/8 [==============================] - 0s 13ms/step - loss: 0.0075
1/8 [==>...........................] - ETA: 0s - loss: 0.00144/8 [==============>...............] - ETA: 0s - loss: 0.00177/8 [=========================>....] - ETA: 0s - loss: 0.00198/8 [==============================] - 0s 16ms/step - loss: 0.0020
1/8 [==>...........................] - ETA: 0s - loss: 8.8935e-044/8 [==============>...............] - ETA: 0s - loss: 0.0012    7/8 [=========================>....] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 17ms/step - loss: 0.0025
1/8 [==>...........................] - ETA: 0s - loss: 0.00703/8 [==========>...................] - ETA: 0s - loss: 0.00836/8 [=====================>........] - ETA: 0s - loss: 0.00838/8 [==============================] - 0s 24ms/step - loss: 0.0087
1/8 [==>...........................] - ETA: 0s - loss: 0.00773/8 [==========>...................] - ETA: 0s - loss: 0.00955/8 [=================>............] - ETA: 0s - loss: 0.00887/8 [=========================>....] - ETA: 0s - loss: 0.00928/8 [==============================] - 0s 23ms/step - loss: 0.0094
1/8 [==>...........................] - ETA: 0s - loss: 0.00753/8 [==========>...................] - ETA: 0s - loss: 0.01055/8 [=================>............] - ETA: 0s - loss: 0.00937/8 [=========================>....] - ETA: 0s - loss: 0.00878/8 [==============================] - 0s 25ms/step - loss: 0.0084
1/8 [==>...........................] - ETA: 0s - loss: 0.00183/8 [==========>...................] - ETA: 0s - loss: 0.00245/8 [=================>............] - ETA: 0s - loss: 0.00267/8 [=========================>....] - ETA: 0s - loss: 0.00278/8 [==============================] - 0s 32ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00233/8 [==========>...................] - ETA: 0s - loss: 0.00265/8 [=================>............] - ETA: 0s - loss: 0.00307/8 [=========================>....] - ETA: 0s - loss: 0.00358/8 [==============================] - 0s 23ms/step - loss: 0.0037
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.004655131534673273:
Train Score: 0.00592 MSE 0.07694 RMSE
Test Score: 0.00957 MSE 0.09781 RMSE
Deviation Min [3.63861509e-05], Max [0.3162417]
Deviation 99.5th pctile [0.20475245]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1640,   16]))
Confusion matrix 
[[1639    1]
 [   8    8]]
precision 0.88889, recall 0.50000, f1 0.64000
Time to train: 284533 ms
Saving model models/A4Benchmark/A4Benchmark-TS97.csv.h5
Total Time to proces all the selected files : 287249 ms
A4Benchmark : Avg precision 0.88889 recall 0.50000 f1 0.64000 time to train 284533.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS97.csv  --epochs 20 --n_iter 3 --patience 3 :: took 295 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS98.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 03:47:38 AM MST
2020-12-01 03:47:44.997181: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 03:47:45.016213: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-12-01 03:47:45.017724: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x558cfcf23c00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 03:47:45.017778: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 03:47:45.018021: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS98.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00685/8 [=================>............] - ETA: 0s - loss: 0.00648/8 [==============================] - 0s 13ms/step - loss: 0.0056
1/8 [==>...........................] - ETA: 0s - loss: 0.00234/8 [==============>...............] - ETA: 0s - loss: 0.00327/8 [=========================>....] - ETA: 0s - loss: 0.00328/8 [==============================] - 0s 17ms/step - loss: 0.0032
1/8 [==>...........................] - ETA: 0s - loss: 0.00245/8 [=================>............] - ETA: 0s - loss: 0.00268/8 [==============================] - 0s 13ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00154/8 [==============>...............] - ETA: 0s - loss: 0.00157/8 [=========================>....] - ETA: 0s - loss: 0.00178/8 [==============================] - 0s 15ms/step - loss: 0.0017
1/8 [==>...........................] - ETA: 0s - loss: 0.01784/8 [==============>...............] - ETA: 0s - loss: 0.02307/8 [=========================>....] - ETA: 0s - loss: 0.02378/8 [==============================] - 0s 17ms/step - loss: 0.0238
1/8 [==>...........................] - ETA: 0s - loss: 0.00743/8 [==========>...................] - ETA: 0s - loss: 0.00675/8 [=================>............] - ETA: 0s - loss: 0.00697/8 [=========================>....] - ETA: 0s - loss: 0.00628/8 [==============================] - 0s 28ms/step - loss: 0.0061
1/8 [==>...........................] - ETA: 0s - loss: 0.00263/8 [==========>...................] - ETA: 0s - loss: 0.00375/8 [=================>............] - ETA: 0s - loss: 0.00437/8 [=========================>....] - ETA: 0s - loss: 0.00458/8 [==============================] - 0s 24ms/step - loss: 0.0045
1/8 [==>...........................] - ETA: 0s - loss: 0.00183/8 [==========>...................] - ETA: 0s - loss: 0.00225/8 [=================>............] - ETA: 0s - loss: 0.00197/8 [=========================>....] - ETA: 0s - loss: 0.00208/8 [==============================] - 0s 24ms/step - loss: 0.0020
1/8 [==>...........................] - ETA: 0s - loss: 0.00333/8 [==========>...................] - ETA: 0s - loss: 0.00335/8 [=================>............] - ETA: 0s - loss: 0.00367/8 [=========================>....] - ETA: 0s - loss: 0.00378/8 [==============================] - 0s 28ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.01853/8 [==========>...................] - ETA: 0s - loss: 0.02335/8 [=================>............] - ETA: 0s - loss: 0.02357/8 [=========================>....] - ETA: 0s - loss: 0.02428/8 [==============================] - 0s 23ms/step - loss: 0.0243
1/8 [==>...........................] - ETA: 0s - loss: 0.00415/8 [=================>............] - ETA: 0s - loss: 0.00418/8 [==============================] - ETA: 0s - loss: 0.00398/8 [==============================] - 0s 15ms/step - loss: 0.0039
1/8 [==>...........................] - ETA: 0s - loss: 0.00235/8 [=================>............] - ETA: 0s - loss: 0.00328/8 [==============================] - 0s 12ms/step - loss: 0.0031
1/8 [==>...........................] - ETA: 0s - loss: 0.04794/8 [==============>...............] - ETA: 0s - loss: 0.06287/8 [=========================>....] - ETA: 0s - loss: 0.06978/8 [==============================] - 0s 18ms/step - loss: 0.0720
1/8 [==>...........................] - ETA: 0s - loss: 0.00214/8 [==============>...............] - ETA: 0s - loss: 0.00227/8 [=========================>....] - ETA: 0s - loss: 0.00248/8 [==============================] - 0s 17ms/step - loss: 0.0025
1/8 [==>...........................] - ETA: 0s - loss: 0.11824/8 [==============>...............] - ETA: 0s - loss: 0.14047/8 [=========================>....] - ETA: 0s - loss: 0.14728/8 [==============================] - 0s 16ms/step - loss: 0.1482
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.007459329813718796:
Train Score: 0.00273 MSE 0.05226 RMSE
Test Score: 0.00234 MSE 0.04840 RMSE
Deviation Min [0.00012968], Max [0.23656549]
Deviation 99.5th pctile [0.13131332]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1641,   15]))
Confusion matrix 
[[1636    5]
 [  11    4]]
precision 0.44444, recall 0.26667, f1 0.33333
Time to train: 319438 ms
Saving model models/A4Benchmark/A4Benchmark-TS98.csv.h5
Total Time to proces all the selected files : 321912 ms
A4Benchmark : Avg precision 0.44444 recall 0.26667 f1 0.33333 time to train 319438.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS98.csv  --epochs 20 --n_iter 3 --patience 3 :: took 329 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS99.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 03:53:12 AM MST
2020-12-01 03:53:29.039452: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 03:53:29.058276: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-12-01 03:53:29.059849: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55eaa44028e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 03:53:29.059924: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 03:53:29.060160: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS99.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 5.3160e-043/8 [==========>...................] - ETA: 0s - loss: 5.8412e-045/8 [=================>............] - ETA: 0s - loss: 6.7338e-047/8 [=========================>....] - ETA: 0s - loss: 6.2716e-048/8 [==============================] - 0s 30ms/step - loss: 6.3029e-04
1/8 [==>...........................] - ETA: 0s - loss: 6.1599e-043/8 [==========>...................] - ETA: 0s - loss: 7.6070e-045/8 [=================>............] - ETA: 0s - loss: 0.0012    7/8 [=========================>....] - ETA: 0s - loss: 0.00148/8 [==============================] - 0s 32ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 0.00213/8 [==========>...................] - ETA: 0s - loss: 0.00345/8 [=================>............] - ETA: 0s - loss: 0.00317/8 [=========================>....] - ETA: 0s - loss: 0.00358/8 [==============================] - 0s 30ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.00423/8 [==========>...................] - ETA: 0s - loss: 0.00415/8 [=================>............] - ETA: 0s - loss: 0.00847/8 [=========================>....] - ETA: 0s - loss: 0.01838/8 [==============================] - 0s 24ms/step - loss: 0.0200
1/8 [==>...........................] - ETA: 0s - loss: 0.02673/8 [==========>...................] - ETA: 0s - loss: 0.04215/8 [=================>............] - ETA: 0s - loss: 0.03887/8 [=========================>....] - ETA: 0s - loss: 0.03868/8 [==============================] - 0s 23ms/step - loss: 0.0380
1/8 [==>...........................] - ETA: 0s - loss: 5.1070e-043/8 [==========>...................] - ETA: 0s - loss: 5.7117e-045/8 [=================>............] - ETA: 0s - loss: 6.3889e-047/8 [=========================>....] - ETA: 0s - loss: 5.9955e-048/8 [==============================] - 0s 26ms/step - loss: 6.0486e-04
1/8 [==>...........................] - ETA: 0s - loss: 8.3851e-043/8 [==========>...................] - ETA: 0s - loss: 9.8488e-045/8 [=================>............] - ETA: 0s - loss: 0.0013    7/8 [=========================>....] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 30ms/step - loss: 0.0017
1/8 [==>...........................] - ETA: 0s - loss: 0.00173/8 [==========>...................] - ETA: 0s - loss: 0.00255/8 [=================>............] - ETA: 0s - loss: 0.00237/8 [=========================>....] - ETA: 0s - loss: 0.00258/8 [==============================] - 0s 28ms/step - loss: 0.0026
1/8 [==>...........................] - ETA: 0s - loss: 0.00263/8 [==========>...................] - ETA: 0s - loss: 0.00275/8 [=================>............] - ETA: 0s - loss: 0.00697/8 [=========================>....] - ETA: 0s - loss: 0.01608/8 [==============================] - 0s 34ms/step - loss: 0.0178
1/8 [==>...........................] - ETA: 0s - loss: 0.02653/8 [==========>...................] - ETA: 0s - loss: 0.04165/8 [=================>............] - ETA: 0s - loss: 0.03847/8 [=========================>....] - ETA: 0s - loss: 0.03808/8 [==============================] - 0s 25ms/step - loss: 0.0375
1/8 [==>...........................] - ETA: 0s - loss: 6.6866e-045/8 [=================>............] - ETA: 0s - loss: 8.1394e-048/8 [==============================] - 0s 11ms/step - loss: 7.6373e-04
1/8 [==>...........................] - ETA: 0s - loss: 4.5673e-045/8 [=================>............] - ETA: 0s - loss: 9.0327e-048/8 [==============================] - 0s 13ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 0.00144/8 [==============>...............] - ETA: 0s - loss: 0.00207/8 [=========================>....] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 18ms/step - loss: 0.0022
1/8 [==>...........................] - ETA: 0s - loss: 0.00155/8 [=================>............] - ETA: 0s - loss: 0.00428/8 [==============================] - 0s 14ms/step - loss: 0.0105
1/8 [==>...........................] - ETA: 0s - loss: 0.02525/8 [=================>............] - ETA: 0s - loss: 0.03618/8 [==============================] - 0s 13ms/step - loss: 0.0355
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.010033690580166876:
Train Score: 0.01011 MSE 0.10054 RMSE
Test Score: 0.00961 MSE 0.09805 RMSE
Deviation Min [3.34078454e-05], Max [0.54627758]
Deviation 99.5th pctile [0.37602834]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1640,   16]))
Confusion matrix 
[[1633    7]
 [  14    2]]
precision 0.22222, recall 0.12500, f1 0.16000
Time to train: 314602 ms
Saving model models/A4Benchmark/A4Benchmark-TS99.csv.h5
Total Time to proces all the selected files : 317051 ms
A4Benchmark : Avg precision 0.22222 recall 0.12500 f1 0.16000 time to train 314602.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS99.csv  --epochs 20 --n_iter 3 --patience 3 :: took 334 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS9.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 03:58:51 AM MST
2020-12-01 03:58:58.229579: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 03:58:58.248215: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593630000 Hz
2020-12-01 03:58:58.249260: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56221dc990b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 03:58:58.249327: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 03:58:58.249524: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A4Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A4Benchmark/A4Benchmark-TS9.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00573/8 [==========>...................] - ETA: 0s - loss: 0.00615/8 [=================>............] - ETA: 0s - loss: 0.00607/8 [=========================>....] - ETA: 0s - loss: 0.00608/8 [==============================] - 0s 29ms/step - loss: 0.0063
1/8 [==>...........................] - ETA: 0s - loss: 0.00243/8 [==========>...................] - ETA: 0s - loss: 0.00205/8 [=================>............] - ETA: 0s - loss: 0.00177/8 [=========================>....] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 25ms/step - loss: 0.0018
1/8 [==>...........................] - ETA: 0s - loss: 0.00243/8 [==========>...................] - ETA: 0s - loss: 0.00245/8 [=================>............] - ETA: 0s - loss: 0.00197/8 [=========================>....] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 30ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.00533/8 [==========>...................] - ETA: 0s - loss: 0.00665/8 [=================>............] - ETA: 0s - loss: 0.00497/8 [=========================>....] - ETA: 0s - loss: 0.00458/8 [==============================] - 0s 36ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.03773/8 [==========>...................] - ETA: 0s - loss: 0.04034/8 [==============>...............] - ETA: 0s - loss: 0.03826/8 [=====================>........] - ETA: 0s - loss: 0.04328/8 [==============================] - ETA: 0s - loss: 0.04318/8 [==============================] - 0s 41ms/step - loss: 0.0431
1/8 [==>...........................] - ETA: 0s - loss: 0.00185/8 [=================>............] - ETA: 0s - loss: 0.00178/8 [==============================] - ETA: 0s - loss: 0.00178/8 [==============================] - 0s 15ms/step - loss: 0.0017
1/8 [==>...........................] - ETA: 0s - loss: 0.00404/8 [==============>...............] - ETA: 0s - loss: 0.00477/8 [=========================>....] - ETA: 0s - loss: 0.00478/8 [==============================] - 0s 18ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00235/8 [=================>............] - ETA: 0s - loss: 0.00178/8 [==============================] - 0s 11ms/step - loss: 0.0020
1/8 [==>...........................] - ETA: 0s - loss: 0.00285/8 [=================>............] - ETA: 0s - loss: 0.00288/8 [==============================] - 0s 13ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.03105/8 [=================>............] - ETA: 0s - loss: 0.03508/8 [==============================] - 0s 13ms/step - loss: 0.0373
1/8 [==>...........................] - ETA: 0s - loss: 0.00524/8 [==============>...............] - ETA: 0s - loss: 0.00566/8 [=====================>........] - ETA: 0s - loss: 0.00588/8 [==============================] - ETA: 0s - loss: 0.00598/8 [==============================] - 0s 22ms/step - loss: 0.0059
1/8 [==>...........................] - ETA: 0s - loss: 0.00223/8 [==========>...................] - ETA: 0s - loss: 0.00175/8 [=================>............] - ETA: 0s - loss: 0.00177/8 [=========================>....] - ETA: 0s - loss: 0.00178/8 [==============================] - 0s 24ms/step - loss: 0.0017
1/8 [==>...........................] - ETA: 0s - loss: 0.00102/8 [======>.......................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00104/8 [==============>...............] - ETA: 0s - loss: 9.9413e-046/8 [=====================>........] - ETA: 0s - loss: 8.8546e-048/8 [==============================] - ETA: 0s - loss: 0.0010    8/8 [==============================] - 0s 40ms/step - loss: 0.0010
1/8 [==>...........................] - ETA: 0s - loss: 0.00813/8 [==========>...................] - ETA: 0s - loss: 0.01005/8 [=================>............] - ETA: 0s - loss: 0.01087/8 [=========================>....] - ETA: 0s - loss: 0.01068/8 [==============================] - 0s 28ms/step - loss: 0.0111
1/8 [==>...........................] - ETA: 0s - loss: 0.03333/8 [==========>...................] - ETA: 0s - loss: 0.03975/8 [=================>............] - ETA: 0s - loss: 0.03957/8 [=========================>....] - ETA: 0s - loss: 0.04108/8 [==============================] - ETA: 0s - loss: 0.04198/8 [==============================] - 0s 36ms/step - loss: 0.0419
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.009738967311568559:
Train Score: 0.01099 MSE 0.10483 RMSE
Test Score: 0.03441 MSE 0.18551 RMSE
Deviation Min [4.14290665e-05], Max [0.48002465]
Deviation 99.5th pctile [0.38894993]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1655,    1]))
Confusion matrix 
[[1646    9]
 [   1    0]]
precision 0.00000, recall 0.00000, f1 0.00000
Time to train: 507747 ms
Saving model models/A4Benchmark/A4Benchmark-TS9.csv.h5
Total Time to proces all the selected files : 510035 ms
A4Benchmark : Avg precision 0.00000 recall 0.00000 f1 0.00000 time to train 507747.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A4Benchmark --save 1 --file_name A4Benchmark-TS9.csv  --epochs 20 --n_iter 3 --patience 3 :: took 517 seconds

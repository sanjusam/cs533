DATA_FOLDER : ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS100.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 02:41:53 PM MST
2020-11-30 14:42:12.439015: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 14:42:12.557983: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 14:42:12.558801: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5577c66f8c00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 14:42:12.558828: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 14:42:12.576427: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS100.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.01053/8 [==========>...................] - ETA: 0s - loss: 0.00605/8 [=================>............] - ETA: 0s - loss: 0.00427/8 [=========================>....] - ETA: 0s - loss: 0.00608/8 [==============================] - 0s 35ms/step - loss: 0.0057
1/8 [==>...........................] - ETA: 0s - loss: 0.02012/8 [======>.......................] - ETA: 0s - loss: 0.01334/8 [==============>...............] - ETA: 0s - loss: 0.00896/8 [=====================>........] - ETA: 0s - loss: 0.00708/8 [==============================] - ETA: 0s - loss: 0.00778/8 [==============================] - 0s 33ms/step - loss: 0.0077
1/8 [==>...........................] - ETA: 0s - loss: 0.00273/8 [==========>...................] - ETA: 0s - loss: 0.00505/8 [=================>............] - ETA: 0s - loss: 0.00387/8 [=========================>....] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 31ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.00182/8 [======>.......................] - ETA: 0s - loss: 0.00143/8 [==========>...................] - ETA: 0s - loss: 0.00134/8 [==============>...............] - ETA: 0s - loss: 0.00295/8 [=================>............] - ETA: 0s - loss: 0.00346/8 [=====================>........] - ETA: 0s - loss: 0.00337/8 [=========================>....] - ETA: 0s - loss: 0.00308/8 [==============================] - ETA: 0s - loss: 0.00298/8 [==============================] - 1s 91ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00253/8 [==========>...................] - ETA: 0s - loss: 0.00634/8 [==============>...............] - ETA: 0s - loss: 0.00595/8 [=================>............] - ETA: 0s - loss: 0.00516/8 [=====================>........] - ETA: 0s - loss: 0.00647/8 [=========================>....] - ETA: 0s - loss: 0.00568/8 [==============================] - ETA: 0s - loss: 0.00568/8 [==============================] - 0s 62ms/step - loss: 0.0056
1/8 [==>...........................] - ETA: 0s - loss: 0.00802/8 [======>.......................] - ETA: 0s - loss: 0.00573/8 [==========>...................] - ETA: 0s - loss: 0.00425/8 [=================>............] - ETA: 0s - loss: 0.00337/8 [=========================>....] - ETA: 0s - loss: 0.00478/8 [==============================] - 0s 45ms/step - loss: 0.0044
1/8 [==>...........................] - ETA: 0s - loss: 0.01903/8 [==========>...................] - ETA: 0s - loss: 0.00825/8 [=================>............] - ETA: 0s - loss: 0.00847/8 [=========================>....] - ETA: 0s - loss: 0.00788/8 [==============================] - 0s 30ms/step - loss: 0.0074
1/8 [==>...........................] - ETA: 0s - loss: 0.00152/8 [======>.......................] - ETA: 0s - loss: 0.00603/8 [==========>...................] - ETA: 0s - loss: 0.00464/8 [==============>...............] - ETA: 0s - loss: 0.00375/8 [=================>............] - ETA: 0s - loss: 0.00346/8 [=====================>........] - ETA: 0s - loss: 0.00317/8 [=========================>....] - ETA: 0s - loss: 0.00308/8 [==============================] - ETA: 0s - loss: 0.00318/8 [==============================] - 1s 144ms/step - loss: 0.0031
1/8 [==>...........................] - ETA: 0s - loss: 0.00142/8 [======>.......................] - ETA: 0s - loss: 0.00253/8 [==========>...................] - ETA: 0s - loss: 0.00344/8 [==============>...............] - ETA: 0s - loss: 0.00445/8 [=================>............] - ETA: 0s - loss: 0.00457/8 [=========================>....] - ETA: 0s - loss: 0.00398/8 [==============================] - 0s 50ms/step - loss: 0.0039
1/8 [==>...........................] - ETA: 0s - loss: 0.00323/8 [==========>...................] - ETA: 0s - loss: 0.00565/8 [=================>............] - ETA: 0s - loss: 0.00446/8 [=====================>........] - ETA: 0s - loss: 0.00598/8 [==============================] - ETA: 0s - loss: 0.00518/8 [==============================] - 0s 33ms/step - loss: 0.0051
1/8 [==>...........................] - ETA: 0s - loss: 0.00586/8 [=====================>........] - ETA: 0s - loss: 0.00478/8 [==============================] - 0s 11ms/step - loss: 0.0049
1/8 [==>...........................] - ETA: 0s - loss: 0.01833/8 [==========>...................] - ETA: 0s - loss: 0.00975/8 [=================>............] - ETA: 0s - loss: 0.00738/8 [==============================] - ETA: 0s - loss: 0.00778/8 [==============================] - 0s 25ms/step - loss: 0.0077
1/8 [==>...........................] - ETA: 0s - loss: 0.00173/8 [==========>...................] - ETA: 0s - loss: 0.00395/8 [=================>............] - ETA: 0s - loss: 0.00376/8 [=====================>........] - ETA: 0s - loss: 0.00347/8 [=========================>....] - ETA: 0s - loss: 0.00328/8 [==============================] - ETA: 0s - loss: 0.00318/8 [==============================] - 0s 45ms/step - loss: 0.0031
1/8 [==>...........................] - ETA: 0s - loss: 0.00354/8 [==============>...............] - ETA: 0s - loss: 0.00336/8 [=====================>........] - ETA: 0s - loss: 0.00428/8 [==============================] - 0s 18ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.00365/8 [=================>............] - ETA: 0s - loss: 0.00528/8 [==============================] - 0s 14ms/step - loss: 0.0062
Best parameters {'n_units': 72, 'n_hidden': 2} best score 0.004793658526614309:
Train Score: 0.00485 MSE 0.06966 RMSE
Test Score: 0.00410 MSE 0.06405 RMSE
Deviation Min [7.12734833e-05], Max [0.52529562]
Deviation 99.5th pctile [0.37279737]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1646,   10]))
Confusion matrix 
[[1646    0]
 [   1    9]]
precision 1.00000, recall 0.90000, f1 0.94737
Time to train: 1194027 ms
Saving model models/A3Benchmark/A3Benchmark-TS100.csv.h5
Total Time to proces all the selected files : 1201239 ms
A3Benchmark : Avg precision 1.00000 recall 0.90000 f1 0.94737 time to train 1194027.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS100.csv  --epochs 20 --n_iter 3 --patience 3 :: took 1221 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS10.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 03:02:19 PM MST
2020-11-30 15:02:25.030915: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 15:02:25.051065: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 15:02:25.051891: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x555b1a617d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 15:02:25.051920: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 15:02:25.052072: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS10.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00112/8 [======>.......................] - ETA: 0s - loss: 0.00134/8 [==============>...............] - ETA: 0s - loss: 0.00126/8 [=====================>........] - ETA: 0s - loss: 0.00138/8 [==============================] - ETA: 0s - loss: 0.00138/8 [==============================] - 0s 36ms/step - loss: 0.0013
1/8 [==>...........................] - ETA: 0s - loss: 8.7509e-045/8 [=================>............] - ETA: 0s - loss: 0.0013    8/8 [==============================] - 0s 14ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 0.00105/8 [=================>............] - ETA: 0s - loss: 0.00117/8 [=========================>....] - ETA: 0s - loss: 0.00128/8 [==============================] - ETA: 0s - loss: 0.00128/8 [==============================] - 0s 32ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 7.2796e-043/8 [==========>...................] - ETA: 0s - loss: 0.0011    5/8 [=================>............] - ETA: 0s - loss: 0.00118/8 [==============================] - ETA: 0s - loss: 0.00118/8 [==============================] - 0s 26ms/step - loss: 0.0011
1/8 [==>...........................] - ETA: 0s - loss: 0.00175/8 [=================>............] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 13ms/step - loss: 0.0024
1/8 [==>...........................] - ETA: 0s - loss: 9.2416e-044/8 [==============>...............] - ETA: 0s - loss: 9.9438e-047/8 [=========================>....] - ETA: 0s - loss: 0.0010    8/8 [==============================] - 0s 19ms/step - loss: 0.0011
1/8 [==>...........................] - ETA: 0s - loss: 0.00125/8 [=================>............] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 13ms/step - loss: 0.0018
1/8 [==>...........................] - ETA: 0s - loss: 0.00104/8 [==============>...............] - ETA: 0s - loss: 0.00127/8 [=========================>....] - ETA: 0s - loss: 0.00128/8 [==============================] - 0s 17ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 7.1999e-042/8 [======>.......................] - ETA: 0s - loss: 0.0011    4/8 [==============>...............] - ETA: 0s - loss: 0.00125/8 [=================>............] - ETA: 0s - loss: 0.00126/8 [=====================>........] - ETA: 0s - loss: 0.00128/8 [==============================] - ETA: 0s - loss: 0.00138/8 [==============================] - 0s 52ms/step - loss: 0.0013
1/8 [==>...........................] - ETA: 0s - loss: 0.00205/8 [=================>............] - ETA: 0s - loss: 0.00258/8 [==============================] - 0s 12ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 9.5955e-045/8 [=================>............] - ETA: 0s - loss: 0.0011    8/8 [==============================] - 0s 14ms/step - loss: 0.0011
1/8 [==>...........................] - ETA: 0s - loss: 8.6894e-044/8 [==============>...............] - ETA: 0s - loss: 0.0011    7/8 [=========================>....] - ETA: 0s - loss: 0.00118/8 [==============================] - 0s 16ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 7.6409e-045/8 [=================>............] - ETA: 0s - loss: 9.4663e-048/8 [==============================] - 0s 13ms/step - loss: 0.0010
1/8 [==>...........................] - ETA: 0s - loss: 7.4007e-044/8 [==============>...............] - ETA: 0s - loss: 0.0013    7/8 [=========================>....] - ETA: 0s - loss: 0.00148/8 [==============================] - 0s 17ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 0.00333/8 [==========>...................] - ETA: 0s - loss: 0.00325/8 [=================>............] - ETA: 0s - loss: 0.00376/8 [=====================>........] - ETA: 0s - loss: 0.00397/8 [=========================>....] - ETA: 0s - loss: 0.00418/8 [==============================] - ETA: 0s - loss: 0.00428/8 [==============================] - 0s 59ms/step - loss: 0.0042
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.0014816599898040295:
Train Score: 0.00150 MSE 0.03874 RMSE
Test Score: 0.00727 MSE 0.08525 RMSE
Deviation Min [3.17644723e-06], Max [0.2327607]
Deviation 99.5th pctile [0.14101106]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1646,   10]))
Confusion matrix 
[[1639    7]
 [   8    2]]
precision 0.22222, recall 0.20000, f1 0.21053
Time to train: 281596 ms
Saving model models/A3Benchmark/A3Benchmark-TS10.csv.h5
Total Time to proces all the selected files : 284574 ms
A3Benchmark : Avg precision 0.22222 recall 0.20000 f1 0.21053 time to train 281596.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS10.csv  --epochs 20 --n_iter 3 --patience 3 :: took 291 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS11.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 03:07:15 PM MST
2020-11-30 15:07:21.085814: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 15:07:21.104307: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 15:07:21.105772: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55bd24b08310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 15:07:21.105822: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 15:07:21.106037: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS11.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00773/8 [==========>...................] - ETA: 0s - loss: 0.00935/8 [=================>............] - ETA: 0s - loss: 0.00887/8 [=========================>....] - ETA: 0s - loss: 0.00948/8 [==============================] - 0s 40ms/step - loss: 0.0097
1/8 [==>...........................] - ETA: 0s - loss: 0.00862/8 [======>.......................] - ETA: 0s - loss: 0.00865/8 [=================>............] - ETA: 0s - loss: 0.01036/8 [=====================>........] - ETA: 0s - loss: 0.01098/8 [==============================] - ETA: 0s - loss: 0.01098/8 [==============================] - 0s 36ms/step - loss: 0.0109
1/8 [==>...........................] - ETA: 0s - loss: 0.01052/8 [======>.......................] - ETA: 0s - loss: 0.01043/8 [==========>...................] - ETA: 0s - loss: 0.01234/8 [==============>...............] - ETA: 0s - loss: 0.01215/8 [=================>............] - ETA: 0s - loss: 0.01176/8 [=====================>........] - ETA: 0s - loss: 0.01247/8 [=========================>....] - ETA: 0s - loss: 0.01278/8 [==============================] - ETA: 0s - loss: 0.01318/8 [==============================] - 1s 113ms/step - loss: 0.0131
1/8 [==>...........................] - ETA: 0s - loss: 0.00833/8 [==========>...................] - ETA: 0s - loss: 0.00945/8 [=================>............] - ETA: 0s - loss: 0.00897/8 [=========================>....] - ETA: 0s - loss: 0.00968/8 [==============================] - 0s 30ms/step - loss: 0.0098
1/8 [==>...........................] - ETA: 0s - loss: 0.01352/8 [======>.......................] - ETA: 0s - loss: 0.01503/8 [==========>...................] - ETA: 0s - loss: 0.01814/8 [==============>...............] - ETA: 0s - loss: 0.01795/8 [=================>............] - ETA: 0s - loss: 0.01736/8 [=====================>........] - ETA: 0s - loss: 0.01787/8 [=========================>....] - ETA: 0s - loss: 0.01778/8 [==============================] - ETA: 0s - loss: 0.01828/8 [==============================] - 1s 100ms/step - loss: 0.0182
1/8 [==>...........................] - ETA: 0s - loss: 0.00663/8 [==========>...................] - ETA: 0s - loss: 0.00795/8 [=================>............] - ETA: 0s - loss: 0.00827/8 [=========================>....] - ETA: 0s - loss: 0.00778/8 [==============================] - ETA: 0s - loss: 0.00778/8 [==============================] - 0s 58ms/step - loss: 0.0077
1/8 [==>...........................] - ETA: 0s - loss: 0.00792/8 [======>.......................] - ETA: 0s - loss: 0.00823/8 [==========>...................] - ETA: 0s - loss: 0.00894/8 [==============>...............] - ETA: 0s - loss: 0.00906/8 [=====================>........] - ETA: 0s - loss: 0.00987/8 [=========================>....] - ETA: 0s - loss: 0.00968/8 [==============================] - ETA: 0s - loss: 0.00988/8 [==============================] - 0s 51ms/step - loss: 0.0098
1/8 [==>...........................] - ETA: 0s - loss: 0.01443/8 [==========>...................] - ETA: 0s - loss: 0.01664/8 [==============>...............] - ETA: 0s - loss: 0.01636/8 [=====================>........] - ETA: 0s - loss: 0.01658/8 [==============================] - ETA: 0s - loss: 0.01748/8 [==============================] - 0s 56ms/step - loss: 0.0174
1/8 [==>...........................] - ETA: 0s - loss: 0.01673/8 [==========>...................] - ETA: 0s - loss: 0.01685/8 [=================>............] - ETA: 0s - loss: 0.01667/8 [=========================>....] - ETA: 0s - loss: 0.01908/8 [==============================] - 0s 30ms/step - loss: 0.0193
1/8 [==>...........................] - ETA: 0s - loss: 0.00743/8 [==========>...................] - ETA: 0s - loss: 0.00885/8 [=================>............] - ETA: 0s - loss: 0.00807/8 [=========================>....] - ETA: 0s - loss: 0.00808/8 [==============================] - 0s 23ms/step - loss: 0.0083
1/8 [==>...........................] - ETA: 0s - loss: 0.00595/8 [=================>............] - ETA: 0s - loss: 0.00718/8 [==============================] - ETA: 0s - loss: 0.00678/8 [==============================] - 0s 14ms/step - loss: 0.0067
1/8 [==>...........................] - ETA: 0s - loss: 0.00586/8 [=====================>........] - ETA: 0s - loss: 0.00678/8 [==============================] - 0s 11ms/step - loss: 0.0066
1/8 [==>...........................] - ETA: 0s - loss: 0.00515/8 [=================>............] - ETA: 0s - loss: 0.00568/8 [==============================] - ETA: 0s - loss: 0.00598/8 [==============================] - 0s 15ms/step - loss: 0.0059
1/8 [==>...........................] - ETA: 0s - loss: 0.00395/8 [=================>............] - ETA: 0s - loss: 0.00418/8 [==============================] - 0s 13ms/step - loss: 0.0042
1/8 [==>...........................] - ETA: 0s - loss: 0.00145/8 [=================>............] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 14ms/step - loss: 0.0018
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.005017531104385853:
Train Score: 0.00883 MSE 0.09398 RMSE
Test Score: 0.01182 MSE 0.10870 RMSE
Deviation Min [2.94601797e-05], Max [0.35344273]
Deviation 99.5th pctile [0.23225157]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1649,    7]))
Confusion matrix 
[[1645    4]
 [   2    5]]
precision 0.55556, recall 0.71429, f1 0.62500
Time to train: 412473 ms
Saving model models/A3Benchmark/A3Benchmark-TS11.csv.h5
Total Time to proces all the selected files : 415425 ms
A3Benchmark : Avg precision 0.55556 recall 0.71429 f1 0.62500 time to train 412473.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS11.csv  --epochs 20 --n_iter 3 --patience 3 :: took 422 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS12.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 03:14:22 PM MST
2020-11-30 15:14:27.757897: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 15:14:27.777042: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 15:14:27.777846: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d687cefc00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 15:14:27.777889: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 15:14:27.778031: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS12.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00623/8 [==========>...................] - ETA: 0s - loss: 0.00455/8 [=================>............] - ETA: 0s - loss: 0.00347/8 [=========================>....] - ETA: 0s - loss: 0.00428/8 [==============================] - 0s 31ms/step - loss: 0.0040
1/8 [==>...........................] - ETA: 0s - loss: 4.1842e-042/8 [======>.......................] - ETA: 0s - loss: 5.8599e-043/8 [==========>...................] - ETA: 0s - loss: 0.0025    4/8 [==============>...............] - ETA: 0s - loss: 0.00256/8 [=====================>........] - ETA: 0s - loss: 0.00418/8 [==============================] - ETA: 0s - loss: 0.00348/8 [==============================] - 0s 45ms/step - loss: 0.0034
1/8 [==>...........................] - ETA: 0s - loss: 0.00173/8 [==========>...................] - ETA: 0s - loss: 0.00254/8 [==============>...............] - ETA: 0s - loss: 0.00205/8 [=================>............] - ETA: 0s - loss: 0.00206/8 [=====================>........] - ETA: 0s - loss: 0.00297/8 [=========================>....] - ETA: 0s - loss: 0.00308/8 [==============================] - 0s 59ms/step - loss: 0.0030
1/8 [==>...........................] - ETA: 0s - loss: 0.00323/8 [==========>...................] - ETA: 0s - loss: 0.00715/8 [=================>............] - ETA: 0s - loss: 0.00647/8 [=========================>....] - ETA: 0s - loss: 0.00618/8 [==============================] - 0s 34ms/step - loss: 0.0061
1/8 [==>...........................] - ETA: 0s - loss: 0.01623/8 [==========>...................] - ETA: 0s - loss: 0.02085/8 [=================>............] - ETA: 0s - loss: 0.01917/8 [=========================>....] - ETA: 0s - loss: 0.01868/8 [==============================] - 0s 27ms/step - loss: 0.0187
1/8 [==>...........................] - ETA: 0s - loss: 0.00585/8 [=================>............] - ETA: 0s - loss: 0.00468/8 [==============================] - 0s 13ms/step - loss: 0.0046
1/8 [==>...........................] - ETA: 0s - loss: 0.00155/8 [=================>............] - ETA: 0s - loss: 0.00668/8 [==============================] - 0s 13ms/step - loss: 0.0051
1/8 [==>...........................] - ETA: 0s - loss: 0.00223/8 [==========>...................] - ETA: 0s - loss: 0.00244/8 [==============>...............] - ETA: 0s - loss: 0.00215/8 [=================>............] - ETA: 0s - loss: 0.00237/8 [=========================>....] - ETA: 0s - loss: 0.00388/8 [==============================] - ETA: 0s - loss: 0.00378/8 [==============================] - 0s 61ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.00185/8 [=================>............] - ETA: 0s - loss: 0.00438/8 [==============================] - ETA: 0s - loss: 0.00428/8 [==============================] - 0s 17ms/step - loss: 0.0042
1/8 [==>...........................] - ETA: 0s - loss: 0.00406/8 [=====================>........] - ETA: 0s - loss: 0.00508/8 [==============================] - 0s 12ms/step - loss: 0.0046
1/8 [==>...........................] - ETA: 0s - loss: 0.00425/8 [=================>............] - ETA: 0s - loss: 0.00328/8 [==============================] - ETA: 0s - loss: 0.00318/8 [==============================] - 0s 15ms/step - loss: 0.0031
1/8 [==>...........................] - ETA: 0s - loss: 9.4682e-044/8 [==============>...............] - ETA: 0s - loss: 0.0037    7/8 [=========================>....] - ETA: 0s - loss: 0.00468/8 [==============================] - 0s 16ms/step - loss: 0.0045
1/8 [==>...........................] - ETA: 0s - loss: 0.00154/8 [==============>...............] - ETA: 0s - loss: 0.00147/8 [=========================>....] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 17ms/step - loss: 0.0022
1/8 [==>...........................] - ETA: 0s - loss: 0.00286/8 [=====================>........] - ETA: 0s - loss: 0.00478/8 [==============================] - 0s 12ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00135/8 [=================>............] - ETA: 0s - loss: 0.00478/8 [==============================] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 16ms/step - loss: 0.0038
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.003684502188116312:
Train Score: 0.00372 MSE 0.06103 RMSE
Test Score: 0.00448 MSE 0.06696 RMSE
Deviation Min [1.43115052e-05], Max [0.47994145]
Deviation 99.5th pctile [0.33599255]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1644,   12]))
Confusion matrix 
[[1644    0]
 [   3    9]]
precision 1.00000, recall 0.75000, f1 0.85714
Time to train: 883822 ms
Saving model models/A3Benchmark/A3Benchmark-TS12.csv.h5
Total Time to proces all the selected files : 888254 ms
A3Benchmark : Avg precision 1.00000 recall 0.75000 f1 0.85714 time to train 883822.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS12.csv  --epochs 20 --n_iter 3 --patience 3 :: took 894 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS13.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 03:29:21 PM MST
2020-11-30 15:29:27.083771: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 15:29:27.102034: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 15:29:27.102810: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55645fe78310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 15:29:27.102839: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 15:29:27.102985: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS13.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00554/8 [==============>...............] - ETA: 0s - loss: 0.00397/8 [=========================>....] - ETA: 0s - loss: 0.00438/8 [==============================] - 0s 15ms/step - loss: 0.0041
1/8 [==>...........................] - ETA: 0s - loss: 0.00303/8 [==========>...................] - ETA: 0s - loss: 0.00484/8 [==============>...............] - ETA: 0s - loss: 0.00676/8 [=====================>........] - ETA: 0s - loss: 0.00558/8 [==============================] - ETA: 0s - loss: 0.00538/8 [==============================] - 0s 35ms/step - loss: 0.0053
1/8 [==>...........................] - ETA: 0s - loss: 0.00315/8 [=================>............] - ETA: 0s - loss: 0.00578/8 [==============================] - ETA: 0s - loss: 0.00628/8 [==============================] - 0s 13ms/step - loss: 0.0062
1/8 [==>...........................] - ETA: 0s - loss: 0.00254/8 [==============>...............] - ETA: 0s - loss: 0.00677/8 [=========================>....] - ETA: 0s - loss: 0.00628/8 [==============================] - 0s 20ms/step - loss: 0.0063
1/8 [==>...........................] - ETA: 0s - loss: 0.00304/8 [==============>...............] - ETA: 0s - loss: 0.00398/8 [==============================] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 16ms/step - loss: 0.0038
1/8 [==>...........................] - ETA: 0s - loss: 0.01784/8 [==============>...............] - ETA: 0s - loss: 0.02037/8 [=========================>....] - ETA: 0s - loss: 0.02048/8 [==============================] - 0s 17ms/step - loss: 0.0208
1/8 [==>...........................] - ETA: 0s - loss: 0.00342/8 [======>.......................] - ETA: 0s - loss: 0.00344/8 [==============>...............] - ETA: 0s - loss: 0.00716/8 [=====================>........] - ETA: 0s - loss: 0.00597/8 [=========================>....] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 42ms/step - loss: 0.0055
1/8 [==>...........................] - ETA: 0s - loss: 0.00245/8 [=================>............] - ETA: 0s - loss: 0.00488/8 [==============================] - ETA: 0s - loss: 0.00498/8 [==============================] - 0s 16ms/step - loss: 0.0049
1/8 [==>...........................] - ETA: 0s - loss: 0.00244/8 [==============>...............] - ETA: 0s - loss: 0.00377/8 [=========================>....] - ETA: 0s - loss: 0.00398/8 [==============================] - 0s 16ms/step - loss: 0.0038
1/8 [==>...........................] - ETA: 0s - loss: 0.01623/8 [==========>...................] - ETA: 0s - loss: 0.02234/8 [==============>...............] - ETA: 0s - loss: 0.02317/8 [=========================>....] - ETA: 0s - loss: 0.02228/8 [==============================] - 0s 27ms/step - loss: 0.0225
1/8 [==>...........................] - ETA: 0s - loss: 0.00833/8 [==========>...................] - ETA: 0s - loss: 0.00515/8 [=================>............] - ETA: 0s - loss: 0.00437/8 [=========================>....] - ETA: 0s - loss: 0.00518/8 [==============================] - 0s 34ms/step - loss: 0.0049
1/8 [==>...........................] - ETA: 0s - loss: 0.02142/8 [======>.......................] - ETA: 0s - loss: 0.02783/8 [==========>...................] - ETA: 0s - loss: 0.02845/8 [=================>............] - ETA: 0s - loss: 0.02726/8 [=====================>........] - ETA: 0s - loss: 0.02667/8 [=========================>....] - ETA: 0s - loss: 0.02618/8 [==============================] - ETA: 0s - loss: 0.02688/8 [==============================] - 1s 118ms/step - loss: 0.0268
1/8 [==>...........................] - ETA: 0s - loss: 0.01333/8 [==========>...................] - ETA: 0s - loss: 0.01544/8 [==============>...............] - ETA: 0s - loss: 0.01615/8 [=================>............] - ETA: 0s - loss: 0.01896/8 [=====================>........] - ETA: 0s - loss: 0.01837/8 [=========================>....] - ETA: 0s - loss: 0.01848/8 [==============================] - ETA: 0s - loss: 0.01868/8 [==============================] - 1s 90ms/step - loss: 0.0186
1/8 [==>...........................] - ETA: 0s - loss: 0.00512/8 [======>.......................] - ETA: 0s - loss: 0.00334/8 [==============>...............] - ETA: 0s - loss: 0.00426/8 [=====================>........] - ETA: 0s - loss: 0.00578/8 [==============================] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 40ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00213/8 [==========>...................] - ETA: 0s - loss: 0.00465/8 [=================>............] - ETA: 0s - loss: 0.00507/8 [=========================>....] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 38ms/step - loss: 0.0050
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.005169877363368869:
Train Score: 0.00352 MSE 0.05936 RMSE
Test Score: 0.00262 MSE 0.05123 RMSE
Deviation Min [1.06438983e-05], Max [0.43379199]
Deviation 99.5th pctile [0.18877587]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1648,    8]))
Confusion matrix 
[[1647    1]
 [   0    8]]
precision 0.88889, recall 1.00000, f1 0.94118
Time to train: 926234 ms
Saving model models/A3Benchmark/A3Benchmark-TS13.csv.h5
Total Time to proces all the selected files : 929567 ms
A3Benchmark : Avg precision 0.88889 recall 1.00000 f1 0.94118 time to train 926234.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS13.csv  --epochs 20 --n_iter 3 --patience 3 :: took 936 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS14.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 03:45:02 PM MST
2020-11-30 15:45:07.842475: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 15:45:07.861027: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 15:45:07.861962: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5618d6d09310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 15:45:07.861991: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 15:45:07.862134: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS14.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00162/8 [======>.......................] - ETA: 0s - loss: 0.00173/8 [==========>...................] - ETA: 0s - loss: 0.00164/8 [==============>...............] - ETA: 0s - loss: 0.00156/8 [=====================>........] - ETA: 0s - loss: 0.00127/8 [=========================>....] - ETA: 0s - loss: 0.00128/8 [==============================] - 0s 54ms/step - loss: 0.0011
1/8 [==>...........................] - ETA: 0s - loss: 0.00293/8 [==========>...................] - ETA: 0s - loss: 0.00295/8 [=================>............] - ETA: 0s - loss: 0.00307/8 [=========================>....] - ETA: 0s - loss: 0.00288/8 [==============================] - 0s 26ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 0.00153/8 [==========>...................] - ETA: 0s - loss: 0.00155/8 [=================>............] - ETA: 0s - loss: 0.00127/8 [=========================>....] - ETA: 0s - loss: 0.00118/8 [==============================] - 0s 30ms/step - loss: 0.0011
1/8 [==>...........................] - ETA: 0s - loss: 4.9277e-042/8 [======>.......................] - ETA: 0s - loss: 5.8171e-045/8 [=================>............] - ETA: 0s - loss: 6.9042e-047/8 [=========================>....] - ETA: 0s - loss: 7.6895e-048/8 [==============================] - ETA: 0s - loss: 8.2705e-048/8 [==============================] - 0s 35ms/step - loss: 8.2705e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00923/8 [==========>...................] - ETA: 0s - loss: 0.00955/8 [=================>............] - ETA: 0s - loss: 0.01127/8 [=========================>....] - ETA: 0s - loss: 0.01288/8 [==============================] - 0s 24ms/step - loss: 0.0131
1/8 [==>...........................] - ETA: 0s - loss: 0.00122/8 [======>.......................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00114/8 [==============>...............] - ETA: 0s - loss: 0.00115/8 [=================>............] - ETA: 0s - loss: 0.00116/8 [=====================>........] - ETA: 0s - loss: 0.00117/8 [=========================>....] - ETA: 0s - loss: 0.00118/8 [==============================] - ETA: 0s - loss: 0.00118/8 [==============================] - 1s 135ms/step - loss: 0.0011
1/8 [==>...........................] - ETA: 0s - loss: 7.7795e-044/8 [==============>...............] - ETA: 0s - loss: 9.0383e-047/8 [=========================>....] - ETA: 0s - loss: 9.0773e-048/8 [==============================] - 0s 24ms/step - loss: 9.1157e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00103/8 [==========>...................] - ETA: 0s - loss: 0.00125/8 [=================>............] - ETA: 0s - loss: 0.00107/8 [=========================>....] - ETA: 0s - loss: 0.00108/8 [==============================] - 0s 28ms/step - loss: 0.0010
1/8 [==>...........................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00197/8 [=========================>....] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 37ms/step - loss: 0.0022
1/8 [==>...........................] - ETA: 0s - loss: 0.00463/8 [==========>...................] - ETA: 0s - loss: 0.00475/8 [=================>............] - ETA: 0s - loss: 0.00577/8 [=========================>....] - ETA: 0s - loss: 0.00658/8 [==============================] - 0s 30ms/step - loss: 0.0067
1/8 [==>...........................] - ETA: 0s - loss: 5.2428e-044/8 [==============>...............] - ETA: 0s - loss: 5.5250e-047/8 [=========================>....] - ETA: 0s - loss: 5.8985e-048/8 [==============================] - 0s 19ms/step - loss: 6.0183e-04
1/8 [==>...........................] - ETA: 0s - loss: 5.2394e-046/8 [=====================>........] - ETA: 0s - loss: 7.0334e-048/8 [==============================] - 0s 11ms/step - loss: 6.8578e-04
1/8 [==>...........................] - ETA: 0s - loss: 5.4349e-045/8 [=================>............] - ETA: 0s - loss: 6.1837e-048/8 [==============================] - 0s 12ms/step - loss: 5.9729e-04
1/8 [==>...........................] - ETA: 0s - loss: 8.4213e-044/8 [==============>...............] - ETA: 0s - loss: 0.0012    7/8 [=========================>....] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 18ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 0.00374/8 [==============>...............] - ETA: 0s - loss: 0.00417/8 [=========================>....] - ETA: 0s - loss: 0.00538/8 [==============================] - 0s 26ms/step - loss: 0.0055
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0017799177672713994:
Train Score: 0.00117 MSE 0.03419 RMSE
Test Score: 0.00923 MSE 0.09606 RMSE
Deviation Min [1.7036589e-05], Max [0.16002584]
Deviation 99.5th pctile [0.14829001]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1641,   15]))
Confusion matrix 
[[1633    8]
 [  14    1]]
precision 0.11111, recall 0.06667, f1 0.08333
Time to train: 426189 ms
Saving model models/A3Benchmark/A3Benchmark-TS14.csv.h5
Total Time to proces all the selected files : 429639 ms
A3Benchmark : Avg precision 0.11111 recall 0.06667 f1 0.08333 time to train 426189.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS14.csv  --epochs 20 --n_iter 3 --patience 3 :: took 435 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS15.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 03:52:22 PM MST
2020-11-30 15:52:28.706520: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 15:52:28.728037: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 15:52:28.729199: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55984ac9ed30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 15:52:28.729233: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 15:52:28.729416: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS15.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00546/8 [=====================>........] - ETA: 0s - loss: 0.00738/8 [==============================] - 0s 12ms/step - loss: 0.0070
1/8 [==>...........................] - ETA: 0s - loss: 7.9861e-043/8 [==========>...................] - ETA: 0s - loss: 0.0011    5/8 [=================>............] - ETA: 0s - loss: 0.00206/8 [=====================>........] - ETA: 0s - loss: 0.00188/8 [==============================] - ETA: 0s - loss: 0.00168/8 [==============================] - 0s 47ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 0.00423/8 [==========>...................] - ETA: 0s - loss: 0.00544/8 [==============>...............] - ETA: 0s - loss: 0.00466/8 [=====================>........] - ETA: 0s - loss: 0.00438/8 [==============================] - 0s 26ms/step - loss: 0.0047
1/8 [==>...........................] - ETA: 0s - loss: 0.00192/8 [======>.......................] - ETA: 0s - loss: 0.00193/8 [==========>...................] - ETA: 0s - loss: 0.00244/8 [==============>...............] - ETA: 0s - loss: 0.00255/8 [=================>............] - ETA: 0s - loss: 0.00278/8 [==============================] - ETA: 0s - loss: 0.00278/8 [==============================] - 1s 92ms/step - loss: 0.0027
1/8 [==>...........................] - ETA: 0s - loss: 0.00545/8 [=================>............] - ETA: 0s - loss: 0.00358/8 [==============================] - 0s 14ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00435/8 [=================>............] - ETA: 0s - loss: 0.00618/8 [==============================] - 0s 14ms/step - loss: 0.0059
1/8 [==>...........................] - ETA: 0s - loss: 0.00666/8 [=====================>........] - ETA: 0s - loss: 0.00868/8 [==============================] - 0s 10ms/step - loss: 0.0086
1/8 [==>...........................] - ETA: 0s - loss: 0.00705/8 [=================>............] - ETA: 0s - loss: 0.00918/8 [==============================] - ETA: 0s - loss: 0.00918/8 [==============================] - 0s 15ms/step - loss: 0.0091
1/8 [==>...........................] - ETA: 0s - loss: 0.00274/8 [==============>...............] - ETA: 0s - loss: 0.00277/8 [=========================>....] - ETA: 0s - loss: 0.00288/8 [==============================] - 0s 16ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.01254/8 [==============>...............] - ETA: 0s - loss: 0.01067/8 [=========================>....] - ETA: 0s - loss: 0.01228/8 [==============================] - 0s 18ms/step - loss: 0.0123
1/8 [==>...........................] - ETA: 0s - loss: 0.01153/8 [==========>...................] - ETA: 0s - loss: 0.01275/8 [=================>............] - ETA: 0s - loss: 0.01207/8 [=========================>....] - ETA: 0s - loss: 0.01208/8 [==============================] - 0s 26ms/step - loss: 0.0121
1/8 [==>...........................] - ETA: 0s - loss: 0.00202/8 [======>.......................] - ETA: 0s - loss: 0.00194/8 [==============>...............] - ETA: 0s - loss: 0.00486/8 [=====================>........] - ETA: 0s - loss: 0.00487/8 [=========================>....] - ETA: 0s - loss: 0.00448/8 [==============================] - ETA: 0s - loss: 0.00438/8 [==============================] - 1s 66ms/step - loss: 0.0043
1/8 [==>...........................] - ETA: 0s - loss: 0.00453/8 [==========>...................] - ETA: 0s - loss: 0.00565/8 [=================>............] - ETA: 0s - loss: 0.00447/8 [=========================>....] - ETA: 0s - loss: 0.00468/8 [==============================] - 0s 23ms/step - loss: 0.0049
1/8 [==>...........................] - ETA: 0s - loss: 0.00433/8 [==========>...................] - ETA: 0s - loss: 0.00635/8 [=================>............] - ETA: 0s - loss: 0.00626/8 [=====================>........] - ETA: 0s - loss: 0.00647/8 [=========================>....] - ETA: 0s - loss: 0.00618/8 [==============================] - ETA: 0s - loss: 0.00648/8 [==============================] - 0s 42ms/step - loss: 0.0064
1/8 [==>...........................] - ETA: 0s - loss: 0.01473/8 [==========>...................] - ETA: 0s - loss: 0.01355/8 [=================>............] - ETA: 0s - loss: 0.01387/8 [=========================>....] - ETA: 0s - loss: 0.01468/8 [==============================] - 0s 34ms/step - loss: 0.0146
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.004159409808926285:
Train Score: 0.00588 MSE 0.07668 RMSE
Test Score: 0.00814 MSE 0.09020 RMSE
Deviation Min [7.33837108e-05], Max [0.30605834]
Deviation 99.5th pctile [0.19373115]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1650,    6]))
Confusion matrix 
[[1644    6]
 [   3    3]]
precision 0.33333, recall 0.50000, f1 0.40000
Time to train: 681622 ms
Saving model models/A3Benchmark/A3Benchmark-TS15.csv.h5
Total Time to proces all the selected files : 684337 ms
A3Benchmark : Avg precision 0.33333 recall 0.50000 f1 0.40000 time to train 681622.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS15.csv  --epochs 20 --n_iter 3 --patience 3 :: took 691 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS16.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 04:03:58 PM MST
2020-11-30 16:04:04.768314: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 16:04:04.787277: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 16:04:04.788905: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55be4cf11310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 16:04:04.788959: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 16:04:04.789177: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS16.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00825/8 [=================>............] - ETA: 0s - loss: 0.00818/8 [==============================] - 0s 14ms/step - loss: 0.0079
1/8 [==>...........................] - ETA: 0s - loss: 0.00584/8 [==============>...............] - ETA: 0s - loss: 0.00637/8 [=========================>....] - ETA: 0s - loss: 0.00708/8 [==============================] - 0s 17ms/step - loss: 0.0072
1/8 [==>...........................] - ETA: 0s - loss: 0.00544/8 [==============>...............] - ETA: 0s - loss: 0.00637/8 [=========================>....] - ETA: 0s - loss: 0.00638/8 [==============================] - 0s 15ms/step - loss: 0.0065
1/8 [==>...........................] - ETA: 0s - loss: 0.00433/8 [==========>...................] - ETA: 0s - loss: 0.00494/8 [==============>...............] - ETA: 0s - loss: 0.00506/8 [=====================>........] - ETA: 0s - loss: 0.00558/8 [==============================] - ETA: 0s - loss: 0.00548/8 [==============================] - 0s 40ms/step - loss: 0.0054
1/8 [==>...........................] - ETA: 0s - loss: 0.00224/8 [==============>...............] - ETA: 0s - loss: 0.00266/8 [=====================>........] - ETA: 0s - loss: 0.00258/8 [==============================] - 0s 18ms/step - loss: 0.0024
1/8 [==>...........................] - ETA: 0s - loss: 0.00833/8 [==========>...................] - ETA: 0s - loss: 0.00764/8 [==============>...............] - ETA: 0s - loss: 0.00765/8 [=================>............] - ETA: 0s - loss: 0.00837/8 [=========================>....] - ETA: 0s - loss: 0.00798/8 [==============================] - 0s 37ms/step - loss: 0.0082
1/8 [==>...........................] - ETA: 0s - loss: 0.00503/8 [==========>...................] - ETA: 0s - loss: 0.00545/8 [=================>............] - ETA: 0s - loss: 0.00607/8 [=========================>....] - ETA: 0s - loss: 0.00598/8 [==============================] - 0s 25ms/step - loss: 0.0061
1/8 [==>...........................] - ETA: 0s - loss: 0.00383/8 [==========>...................] - ETA: 0s - loss: 0.00585/8 [=================>............] - ETA: 0s - loss: 0.00427/8 [=========================>....] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 30ms/step - loss: 0.0052
1/8 [==>...........................] - ETA: 0s - loss: 0.00172/8 [======>.......................] - ETA: 0s - loss: 0.00174/8 [==============>...............] - ETA: 0s - loss: 0.00206/8 [=====================>........] - ETA: 0s - loss: 0.00248/8 [==============================] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 34ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 9.5179e-043/8 [==========>...................] - ETA: 0s - loss: 0.0029    5/8 [=================>............] - ETA: 0s - loss: 0.00257/8 [=========================>....] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 39ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.00783/8 [==========>...................] - ETA: 0s - loss: 0.00736/8 [=====================>........] - ETA: 0s - loss: 0.00778/8 [==============================] - 0s 20ms/step - loss: 0.0079
1/8 [==>...........................] - ETA: 0s - loss: 0.00603/8 [==========>...................] - ETA: 0s - loss: 0.00675/8 [=================>............] - ETA: 0s - loss: 0.00747/8 [=========================>....] - ETA: 0s - loss: 0.00738/8 [==============================] - 0s 31ms/step - loss: 0.0076
1/8 [==>...........................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00157/8 [=========================>....] - ETA: 0s - loss: 0.00168/8 [==============================] - 0s 27ms/step - loss: 0.0017
1/8 [==>...........................] - ETA: 0s - loss: 0.00233/8 [==========>...................] - ETA: 0s - loss: 0.00255/8 [=================>............] - ETA: 0s - loss: 0.00317/8 [=========================>....] - ETA: 0s - loss: 0.00308/8 [==============================] - 0s 32ms/step - loss: 0.0031
1/8 [==>...........................] - ETA: 0s - loss: 0.02572/8 [======>.......................] - ETA: 0s - loss: 0.02754/8 [==============>...............] - ETA: 0s - loss: 0.03905/8 [=================>............] - ETA: 0s - loss: 0.03906/8 [=====================>........] - ETA: 0s - loss: 0.03977/8 [=========================>....] - ETA: 0s - loss: 0.03978/8 [==============================] - ETA: 0s - loss: 0.04028/8 [==============================] - 1s 103ms/step - loss: 0.0402
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.004843656532466411:
Train Score: 0.00242 MSE 0.04922 RMSE
Test Score: 0.00284 MSE 0.05331 RMSE
Deviation Min [7.31816419e-05], Max [0.28540563]
Deviation 99.5th pctile [0.14360685]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1648,    8]))
Confusion matrix 
[[1644    4]
 [   3    5]]
precision 0.55556, recall 0.62500, f1 0.58824
Time to train: 981392 ms
Saving model models/A3Benchmark/A3Benchmark-TS16.csv.h5
Total Time to proces all the selected files : 989325 ms
A3Benchmark : Avg precision 0.55556 recall 0.62500 f1 0.58824 time to train 981392.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS16.csv  --epochs 20 --n_iter 3 --patience 3 :: took 996 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS17.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 04:20:39 PM MST
2020-11-30 16:20:45.291296: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 16:20:45.312029: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 16:20:45.312811: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55fbd9bfd8e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 16:20:45.312837: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 16:20:45.312980: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS17.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00954/8 [==============>...............] - ETA: 0s - loss: 0.00917/8 [=========================>....] - ETA: 0s - loss: 0.00858/8 [==============================] - 0s 18ms/step - loss: 0.0085
1/8 [==>...........................] - ETA: 0s - loss: 0.00495/8 [=================>............] - ETA: 0s - loss: 0.00648/8 [==============================] - 0s 14ms/step - loss: 0.0068
1/8 [==>...........................] - ETA: 0s - loss: 0.00684/8 [==============>...............] - ETA: 0s - loss: 0.00957/8 [=========================>....] - ETA: 0s - loss: 0.01048/8 [==============================] - 0s 17ms/step - loss: 0.0110
1/8 [==>...........................] - ETA: 0s - loss: 0.00255/8 [=================>............] - ETA: 0s - loss: 7.9686e-048/8 [==============================] - 0s 14ms/step - loss: 6.3412e-04
1/8 [==>...........................] - ETA: 0s - loss: 2.6317e-044/8 [==============>...............] - ETA: 0s - loss: 5.8347e-047/8 [=========================>....] - ETA: 0s - loss: 5.3021e-048/8 [==============================] - 0s 17ms/step - loss: 5.7203e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00773/8 [==========>...................] - ETA: 0s - loss: 0.00825/8 [=================>............] - ETA: 0s - loss: 0.00857/8 [=========================>....] - ETA: 0s - loss: 0.00808/8 [==============================] - 0s 32ms/step - loss: 0.0081
1/8 [==>...........................] - ETA: 0s - loss: 4.3723e-043/8 [==========>...................] - ETA: 0s - loss: 5.0811e-044/8 [==============>...............] - ETA: 0s - loss: 8.1927e-045/8 [=================>............] - ETA: 0s - loss: 8.7865e-046/8 [=====================>........] - ETA: 0s - loss: 8.5084e-047/8 [=========================>....] - ETA: 0s - loss: 7.9976e-048/8 [==============================] - ETA: 0s - loss: 7.8195e-048/8 [==============================] - 1s 99ms/step - loss: 7.8195e-04
1/8 [==>...........................] - ETA: 0s - loss: 6.8324e-043/8 [==========>...................] - ETA: 0s - loss: 7.3362e-045/8 [=================>............] - ETA: 0s - loss: 6.4802e-046/8 [=====================>........] - ETA: 0s - loss: 6.1637e-047/8 [=========================>....] - ETA: 0s - loss: 6.4676e-048/8 [==============================] - ETA: 0s - loss: 6.3814e-048/8 [==============================] - 0s 61ms/step - loss: 6.3814e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00313/8 [==========>...................] - ETA: 0s - loss: 0.00125/8 [=================>............] - ETA: 0s - loss: 0.00127/8 [=========================>....] - ETA: 0s - loss: 0.00108/8 [==============================] - 0s 33ms/step - loss: 9.8435e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00113/8 [==========>...................] - ETA: 0s - loss: 6.4364e-045/8 [=================>............] - ETA: 0s - loss: 0.0010    7/8 [=========================>....] - ETA: 0s - loss: 0.00128/8 [==============================] - 0s 29ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 0.00505/8 [=================>............] - ETA: 0s - loss: 0.00458/8 [==============================] - 0s 13ms/step - loss: 0.0041
1/8 [==>...........................] - ETA: 0s - loss: 0.00465/8 [=================>............] - ETA: 0s - loss: 0.00608/8 [==============================] - 0s 14ms/step - loss: 0.0064
1/8 [==>...........................] - ETA: 0s - loss: 2.8751e-044/8 [==============>...............] - ETA: 0s - loss: 3.0590e-047/8 [=========================>....] - ETA: 0s - loss: 3.3146e-048/8 [==============================] - 0s 17ms/step - loss: 3.1758e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00785/8 [=================>............] - ETA: 0s - loss: 0.00698/8 [==============================] - 0s 12ms/step - loss: 0.0072
1/8 [==>...........................] - ETA: 0s - loss: 6.7754e-043/8 [==========>...................] - ETA: 0s - loss: 5.3788e-045/8 [=================>............] - ETA: 0s - loss: 8.5833e-048/8 [==============================] - ETA: 0s - loss: 0.0011    8/8 [==============================] - 0s 25ms/step - loss: 0.0011
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.002327878505457193:
Train Score: 0.00102 MSE 0.03201 RMSE
Test Score: 0.00321 MSE 0.05662 RMSE
Deviation Min [1.27356047e-05], Max [0.27438093]
Deviation 99.5th pctile [0.10410061]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1655,    1]))
Confusion matrix 
[[1647    8]
 [   0    1]]
precision 0.11111, recall 1.00000, f1 0.20000
Time to train: 900254 ms
Saving model models/A3Benchmark/A3Benchmark-TS17.csv.h5
Total Time to proces all the selected files : 909207 ms
A3Benchmark : Avg precision 0.11111 recall 1.00000 f1 0.20000 time to train 900254.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS17.csv  --epochs 20 --n_iter 3 --patience 3 :: took 915 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS18.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 04:35:59 PM MST
2020-11-30 16:36:06.286557: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 16:36:06.305240: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 16:36:06.306566: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55b3494b3d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 16:36:06.306610: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 16:36:06.306801: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS18.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00733/8 [==========>...................] - ETA: 0s - loss: 0.00724/8 [==============>...............] - ETA: 0s - loss: 0.00706/8 [=====================>........] - ETA: 0s - loss: 0.00717/8 [=========================>....] - ETA: 0s - loss: 0.00758/8 [==============================] - ETA: 0s - loss: 0.00768/8 [==============================] - 1s 70ms/step - loss: 0.0076
1/8 [==>...........................] - ETA: 0s - loss: 0.00553/8 [==========>...................] - ETA: 0s - loss: 0.00704/8 [==============>...............] - ETA: 0s - loss: 0.00665/8 [=================>............] - ETA: 0s - loss: 0.00676/8 [=====================>........] - ETA: 0s - loss: 0.00707/8 [=========================>....] - ETA: 0s - loss: 0.00688/8 [==============================] - 1s 115ms/step - loss: 0.0070
1/8 [==>...........................] - ETA: 0s - loss: 0.00582/8 [======>.......................] - ETA: 0s - loss: 0.00674/8 [==============>...............] - ETA: 0s - loss: 0.00686/8 [=====================>........] - ETA: 0s - loss: 0.00708/8 [==============================] - ETA: 0s - loss: 0.00738/8 [==============================] - 0s 29ms/step - loss: 0.0073
1/8 [==>...........................] - ETA: 0s - loss: 0.00832/8 [======>.......................] - ETA: 0s - loss: 0.01063/8 [==========>...................] - ETA: 0s - loss: 0.00984/8 [==============>...............] - ETA: 0s - loss: 0.00965/8 [=================>............] - ETA: 0s - loss: 0.01016/8 [=====================>........] - ETA: 0s - loss: 0.00987/8 [=========================>....] - ETA: 0s - loss: 0.00998/8 [==============================] - ETA: 0s - loss: 0.01028/8 [==============================] - 1s 96ms/step - loss: 0.0102
1/8 [==>...........................] - ETA: 0s - loss: 0.01063/8 [==========>...................] - ETA: 0s - loss: 0.01175/8 [=================>............] - ETA: 0s - loss: 0.01277/8 [=========================>....] - ETA: 0s - loss: 0.01318/8 [==============================] - 0s 29ms/step - loss: 0.0136
1/8 [==>...........................] - ETA: 0s - loss: 0.00544/8 [==============>...............] - ETA: 0s - loss: 0.00497/8 [=========================>....] - ETA: 0s - loss: 0.00558/8 [==============================] - 0s 19ms/step - loss: 0.0056
1/8 [==>...........................] - ETA: 0s - loss: 0.00474/8 [==============>...............] - ETA: 0s - loss: 0.00577/8 [=========================>....] - ETA: 0s - loss: 0.00598/8 [==============================] - 0s 16ms/step - loss: 0.0060
1/8 [==>...........................] - ETA: 0s - loss: 0.00445/8 [=================>............] - ETA: 0s - loss: 0.00508/8 [==============================] - ETA: 0s - loss: 0.00548/8 [==============================] - 0s 14ms/step - loss: 0.0054
1/8 [==>...........................] - ETA: 0s - loss: 0.00493/8 [==========>...................] - ETA: 0s - loss: 0.00594/8 [==============>...............] - ETA: 0s - loss: 0.00565/8 [=================>............] - ETA: 0s - loss: 0.00588/8 [==============================] - ETA: 0s - loss: 0.00608/8 [==============================] - 0s 53ms/step - loss: 0.0060
1/8 [==>...........................] - ETA: 0s - loss: 0.00294/8 [==============>...............] - ETA: 0s - loss: 0.00377/8 [=========================>....] - ETA: 0s - loss: 0.00538/8 [==============================] - 0s 18ms/step - loss: 0.0058
1/8 [==>...........................] - ETA: 0s - loss: 0.00563/8 [==========>...................] - ETA: 0s - loss: 0.00526/8 [=====================>........] - ETA: 0s - loss: 0.00528/8 [==============================] - ETA: 0s - loss: 0.00568/8 [==============================] - 0s 24ms/step - loss: 0.0056
1/8 [==>...........................] - ETA: 0s - loss: 0.00385/8 [=================>............] - ETA: 0s - loss: 0.00468/8 [==============================] - 0s 14ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00475/8 [=================>............] - ETA: 0s - loss: 0.00558/8 [==============================] - 0s 14ms/step - loss: 0.0059
1/8 [==>...........................] - ETA: 0s - loss: 0.00204/8 [==============>...............] - ETA: 0s - loss: 0.00207/8 [=========================>....] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 18ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.00707/8 [=========================>....] - ETA: 0s - loss: 0.00878/8 [==============================] - 0s 8ms/step - loss: 0.0090
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.005489403614774346:
Train Score: 0.00675 MSE 0.08217 RMSE
Test Score: 0.01154 MSE 0.10741 RMSE
Deviation Min [0.00012983], Max [0.29495221]
Deviation 99.5th pctile [0.21344862]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1644,   12]))
Confusion matrix 
[[1639    5]
 [   8    4]]
precision 0.44444, recall 0.33333, f1 0.38095
Time to train: 471450 ms
Saving model models/A3Benchmark/A3Benchmark-TS18.csv.h5
Total Time to proces all the selected files : 474042 ms
A3Benchmark : Avg precision 0.44444 recall 0.33333 f1 0.38095 time to train 471450.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS18.csv  --epochs 20 --n_iter 3 --patience 3 :: took 481 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS19.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 04:44:05 PM MST
2020-11-30 16:44:12.092692: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 16:44:12.111241: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 16:44:12.112934: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5563505c1310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 16:44:12.112988: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 16:44:12.113204: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS19.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 8.2158e-045/8 [=================>............] - ETA: 0s - loss: 0.0013    8/8 [==============================] - 0s 11ms/step - loss: 0.0010
1/8 [==>...........................] - ETA: 0s - loss: 0.00584/8 [==============>...............] - ETA: 0s - loss: 0.00546/8 [=====================>........] - ETA: 0s - loss: 0.00557/8 [=========================>....] - ETA: 0s - loss: 0.00528/8 [==============================] - 0s 27ms/step - loss: 0.0053
1/8 [==>...........................] - ETA: 0s - loss: 0.00266/8 [=====================>........] - ETA: 0s - loss: 0.00258/8 [==============================] - 0s 11ms/step - loss: 0.0025
1/8 [==>...........................] - ETA: 0s - loss: 0.00365/8 [=================>............] - ETA: 0s - loss: 0.00428/8 [==============================] - 0s 12ms/step - loss: 0.0041
1/8 [==>...........................] - ETA: 0s - loss: 0.00655/8 [=================>............] - ETA: 0s - loss: 0.00748/8 [==============================] - ETA: 0s - loss: 0.00758/8 [==============================] - 0s 15ms/step - loss: 0.0075
1/8 [==>...........................] - ETA: 0s - loss: 0.00415/8 [=================>............] - ETA: 0s - loss: 0.00198/8 [==============================] - 0s 14ms/step - loss: 0.0020
1/8 [==>...........................] - ETA: 0s - loss: 0.00405/8 [=================>............] - ETA: 0s - loss: 0.00288/8 [==============================] - 0s 13ms/step - loss: 0.0027
1/8 [==>...........................] - ETA: 0s - loss: 0.00264/8 [==============>...............] - ETA: 0s - loss: 0.00236/8 [=====================>........] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 19ms/step - loss: 0.0025
1/8 [==>...........................] - ETA: 0s - loss: 0.00324/8 [==============>...............] - ETA: 0s - loss: 0.00317/8 [=========================>....] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 18ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.00555/8 [=================>............] - ETA: 0s - loss: 0.00548/8 [==============================] - 0s 13ms/step - loss: 0.0058
1/8 [==>...........................] - ETA: 0s - loss: 0.00562/8 [======>.......................] - ETA: 0s - loss: 0.00493/8 [==========>...................] - ETA: 0s - loss: 0.00427/8 [=========================>....] - ETA: 0s - loss: 0.00448/8 [==============================] - 0s 27ms/step - loss: 0.0044
1/8 [==>...........................] - ETA: 0s - loss: 0.00442/8 [======>.......................] - ETA: 0s - loss: 0.00475/8 [=================>............] - ETA: 0s - loss: 0.00398/8 [==============================] - ETA: 0s - loss: 0.00408/8 [==============================] - 0s 24ms/step - loss: 0.0040
1/8 [==>...........................] - ETA: 0s - loss: 0.00223/8 [==========>...................] - ETA: 0s - loss: 0.00226/8 [=====================>........] - ETA: 0s - loss: 0.00207/8 [=========================>....] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 40ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.00314/8 [==============>...............] - ETA: 0s - loss: 0.00327/8 [=========================>....] - ETA: 0s - loss: 0.00378/8 [==============================] - 0s 20ms/step - loss: 0.0038
1/8 [==>...........................] - ETA: 0s - loss: 0.00465/8 [=================>............] - ETA: 0s - loss: 0.00418/8 [==============================] - 0s 14ms/step - loss: 0.0045
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0033354693092405795:
Train Score: 0.00283 MSE 0.05317 RMSE
Test Score: 0.00531 MSE 0.07286 RMSE
Deviation Min [6.75119136e-05], Max [0.31659919]
Deviation 99.5th pctile [0.19826603]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1646,   10]))
Confusion matrix 
[[1646    0]
 [   1    9]]
precision 1.00000, recall 0.90000, f1 0.94737
Time to train: 643905 ms
Saving model models/A3Benchmark/A3Benchmark-TS19.csv.h5
Total Time to proces all the selected files : 647842 ms
A3Benchmark : Avg precision 1.00000 recall 0.90000 f1 0.94737 time to train 643905.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS19.csv  --epochs 20 --n_iter 3 --patience 3 :: took 655 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS1.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 04:55:05 PM MST
2020-11-30 16:55:11.165935: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 16:55:11.184259: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 16:55:11.185167: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55ff5b24d8e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 16:55:11.185195: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 16:55:11.185315: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS1.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00733/8 [==========>...................] - ETA: 0s - loss: 0.00974/8 [==============>...............] - ETA: 0s - loss: 0.00915/8 [=================>............] - ETA: 0s - loss: 0.00896/8 [=====================>........] - ETA: 0s - loss: 0.00887/8 [=========================>....] - ETA: 0s - loss: 0.00848/8 [==============================] - ETA: 0s - loss: 0.00848/8 [==============================] - 1s 72ms/step - loss: 0.0084
1/8 [==>...........................] - ETA: 0s - loss: 0.00743/8 [==========>...................] - ETA: 0s - loss: 0.00965/8 [=================>............] - ETA: 0s - loss: 0.00917/8 [=========================>....] - ETA: 0s - loss: 0.00878/8 [==============================] - 0s 28ms/step - loss: 0.0090
1/8 [==>...........................] - ETA: 0s - loss: 0.00582/8 [======>.......................] - ETA: 0s - loss: 0.00624/8 [==============>...............] - ETA: 0s - loss: 0.00576/8 [=====================>........] - ETA: 0s - loss: 0.00648/8 [==============================] - ETA: 0s - loss: 0.00638/8 [==============================] - 0s 44ms/step - loss: 0.0063
1/8 [==>...........................] - ETA: 0s - loss: 0.00983/8 [==========>...................] - ETA: 0s - loss: 0.01025/8 [=================>............] - ETA: 0s - loss: 0.01017/8 [=========================>....] - ETA: 0s - loss: 0.01038/8 [==============================] - 0s 36ms/step - loss: 0.0104
1/8 [==>...........................] - ETA: 0s - loss: 0.01472/8 [======>.......................] - ETA: 0s - loss: 0.01403/8 [==========>...................] - ETA: 0s - loss: 0.01294/8 [==============>...............] - ETA: 0s - loss: 0.01215/8 [=================>............] - ETA: 0s - loss: 0.01286/8 [=====================>........] - ETA: 0s - loss: 0.01347/8 [=========================>....] - ETA: 0s - loss: 0.01378/8 [==============================] - ETA: 0s - loss: 0.01398/8 [==============================] - 1s 159ms/step - loss: 0.0139
1/8 [==>...........................] - ETA: 0s - loss: 0.00722/8 [======>.......................] - ETA: 0s - loss: 0.00913/8 [==========>...................] - ETA: 0s - loss: 0.00814/8 [==============>...............] - ETA: 0s - loss: 0.00755/8 [=================>............] - ETA: 0s - loss: 0.00746/8 [=====================>........] - ETA: 0s - loss: 0.00777/8 [=========================>....] - ETA: 0s - loss: 0.00748/8 [==============================] - ETA: 0s - loss: 0.00748/8 [==============================] - 1s 91ms/step - loss: 0.0074
1/8 [==>...........................] - ETA: 0s - loss: 0.00713/8 [==========>...................] - ETA: 0s - loss: 0.00965/8 [=================>............] - ETA: 0s - loss: 0.00917/8 [=========================>....] - ETA: 0s - loss: 0.00888/8 [==============================] - 0s 34ms/step - loss: 0.0090
1/8 [==>...........................] - ETA: 0s - loss: 0.00754/8 [==============>...............] - ETA: 0s - loss: 0.00736/8 [=====================>........] - ETA: 0s - loss: 0.00728/8 [==============================] - ETA: 0s - loss: 0.00758/8 [==============================] - 0s 27ms/step - loss: 0.0075
1/8 [==>...........................] - ETA: 0s - loss: 0.00992/8 [======>.......................] - ETA: 0s - loss: 0.01023/8 [==========>...................] - ETA: 0s - loss: 0.01034/8 [==============>...............] - ETA: 0s - loss: 0.01025/8 [=================>............] - ETA: 0s - loss: 0.01006/8 [=====================>........] - ETA: 0s - loss: 0.01058/8 [==============================] - ETA: 0s - loss: 0.01038/8 [==============================] - 1s 109ms/step - loss: 0.0103
1/8 [==>...........................] - ETA: 0s - loss: 0.01313/8 [==========>...................] - ETA: 0s - loss: 0.01174/8 [==============>...............] - ETA: 0s - loss: 0.01106/8 [=====================>........] - ETA: 0s - loss: 0.01217/8 [=========================>....] - ETA: 0s - loss: 0.01228/8 [==============================] - 0s 56ms/step - loss: 0.0124
1/8 [==>...........................] - ETA: 0s - loss: 0.00362/8 [======>.......................] - ETA: 0s - loss: 0.00484/8 [==============>...............] - ETA: 0s - loss: 0.00375/8 [=================>............] - ETA: 0s - loss: 0.00338/8 [==============================] - ETA: 0s - loss: 0.00318/8 [==============================] - 0s 50ms/step - loss: 0.0031
1/8 [==>...........................] - ETA: 0s - loss: 0.00703/8 [==========>...................] - ETA: 0s - loss: 0.00976/8 [=====================>........] - ETA: 0s - loss: 0.00928/8 [==============================] - ETA: 0s - loss: 0.00928/8 [==============================] - 0s 23ms/step - loss: 0.0092
1/8 [==>...........................] - ETA: 0s - loss: 0.00812/8 [======>.......................] - ETA: 0s - loss: 0.00873/8 [==========>...................] - ETA: 0s - loss: 0.00824/8 [==============>...............] - ETA: 0s - loss: 0.00785/8 [=================>............] - ETA: 0s - loss: 0.00917/8 [=========================>....] - ETA: 0s - loss: 0.00898/8 [==============================] - ETA: 0s - loss: 0.00908/8 [==============================] - 1s 85ms/step - loss: 0.0090
1/8 [==>...........................] - ETA: 0s - loss: 0.01002/8 [======>.......................] - ETA: 0s - loss: 0.01033/8 [==========>...................] - ETA: 0s - loss: 0.01044/8 [==============>...............] - ETA: 0s - loss: 0.01035/8 [=================>............] - ETA: 0s - loss: 0.01016/8 [=====================>........] - ETA: 0s - loss: 0.01067/8 [=========================>....] - ETA: 0s - loss: 0.01038/8 [==============================] - 1s 102ms/step - loss: 0.0104
1/8 [==>...........................] - ETA: 0s - loss: 0.01523/8 [==========>...................] - ETA: 0s - loss: 0.01335/8 [=================>............] - ETA: 0s - loss: 0.01357/8 [=========================>....] - ETA: 0s - loss: 0.01428/8 [==============================] - 0s 25ms/step - loss: 0.0144
Best parameters {'n_units': 48, 'n_hidden': 2} best score 0.009204619424417615:
Train Score: 0.00893 MSE 0.09451 RMSE
Test Score: 0.00971 MSE 0.09854 RMSE
Deviation Min [0.00013087], Max [0.41756272]
Deviation 99.5th pctile [0.24576296]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1645,   11]))
Confusion matrix 
[[1644    1]
 [   3    8]]
precision 0.88889, recall 0.72727, f1 0.80000
Time to train: 756005 ms
Saving model models/A3Benchmark/A3Benchmark-TS1.csv.h5
Total Time to proces all the selected files : 763061 ms
A3Benchmark : Avg precision 0.88889 recall 0.72727 f1 0.80000 time to train 756005.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS1.csv  --epochs 20 --n_iter 3 --patience 3 :: took 769 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS20.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 05:07:59 PM MST
2020-11-30 17:08:05.705115: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 17:08:05.724284: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 17:08:05.725912: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d50b9718e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 17:08:05.725968: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 17:08:05.726190: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS20.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00475/8 [=================>............] - ETA: 0s - loss: 0.00568/8 [==============================] - 0s 15ms/step - loss: 0.0059
1/8 [==>...........................] - ETA: 0s - loss: 0.00293/8 [==========>...................] - ETA: 0s - loss: 0.00405/8 [=================>............] - ETA: 0s - loss: 0.00438/8 [==============================] - ETA: 0s - loss: 0.00428/8 [==============================] - 0s 31ms/step - loss: 0.0042
1/8 [==>...........................] - ETA: 0s - loss: 0.00362/8 [======>.......................] - ETA: 0s - loss: 0.00463/8 [==========>...................] - ETA: 0s - loss: 0.00495/8 [=================>............] - ETA: 0s - loss: 0.00457/8 [=========================>....] - ETA: 0s - loss: 0.00458/8 [==============================] - 0s 34ms/step - loss: 0.0047
1/8 [==>...........................] - ETA: 0s - loss: 0.00525/8 [=================>............] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 14ms/step - loss: 0.0050
1/8 [==>...........................] - ETA: 0s - loss: 0.00632/8 [======>.......................] - ETA: 0s - loss: 0.00644/8 [==============>...............] - ETA: 0s - loss: 0.00605/8 [=================>............] - ETA: 0s - loss: 0.00657/8 [=========================>....] - ETA: 0s - loss: 0.00698/8 [==============================] - 0s 59ms/step - loss: 0.0070
1/8 [==>...........................] - ETA: 0s - loss: 0.00494/8 [==============>...............] - ETA: 0s - loss: 0.00436/8 [=====================>........] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 18ms/step - loss: 0.0050
1/8 [==>...........................] - ETA: 0s - loss: 0.00365/8 [=================>............] - ETA: 0s - loss: 0.00468/8 [==============================] - 0s 12ms/step - loss: 0.0046
1/8 [==>...........................] - ETA: 0s - loss: 0.00354/8 [==============>...............] - ETA: 0s - loss: 0.00436/8 [=====================>........] - ETA: 0s - loss: 0.00468/8 [==============================] - 0s 19ms/step - loss: 0.0046
1/8 [==>...........................] - ETA: 0s - loss: 0.00515/8 [=================>............] - ETA: 0s - loss: 0.00498/8 [==============================] - 0s 11ms/step - loss: 0.0051
1/8 [==>...........................] - ETA: 0s - loss: 0.00764/8 [==============>...............] - ETA: 0s - loss: 0.00708/8 [==============================] - ETA: 0s - loss: 0.00828/8 [==============================] - 0s 14ms/step - loss: 0.0082
1/8 [==>...........................] - ETA: 0s - loss: 0.00542/8 [======>.......................] - ETA: 0s - loss: 0.00623/8 [==========>...................] - ETA: 0s - loss: 0.00635/8 [=================>............] - ETA: 0s - loss: 0.00636/8 [=====================>........] - ETA: 0s - loss: 0.00637/8 [=========================>....] - ETA: 0s - loss: 0.00628/8 [==============================] - ETA: 0s - loss: 0.00658/8 [==============================] - 0s 52ms/step - loss: 0.0065
1/8 [==>...........................] - ETA: 0s - loss: 0.00423/8 [==========>...................] - ETA: 0s - loss: 0.00544/8 [==============>...............] - ETA: 0s - loss: 0.00536/8 [=====================>........] - ETA: 0s - loss: 0.00557/8 [=========================>....] - ETA: 0s - loss: 0.00538/8 [==============================] - 0s 39ms/step - loss: 0.0055
1/8 [==>...........................] - ETA: 0s - loss: 0.00423/8 [==========>...................] - ETA: 0s - loss: 0.00564/8 [==============>...............] - ETA: 0s - loss: 0.00526/8 [=====================>........] - ETA: 0s - loss: 0.00548/8 [==============================] - ETA: 0s - loss: 0.00548/8 [==============================] - 0s 36ms/step - loss: 0.0054
1/8 [==>...........................] - ETA: 0s - loss: 0.00603/8 [==========>...................] - ETA: 0s - loss: 0.00565/8 [=================>............] - ETA: 0s - loss: 0.00527/8 [=========================>....] - ETA: 0s - loss: 0.00538/8 [==============================] - 0s 28ms/step - loss: 0.0054
1/8 [==>...........................] - ETA: 0s - loss: 0.00882/8 [======>.......................] - ETA: 0s - loss: 0.00873/8 [==========>...................] - ETA: 0s - loss: 0.00794/8 [==============>...............] - ETA: 0s - loss: 0.00806/8 [=====================>........] - ETA: 0s - loss: 0.00918/8 [==============================] - ETA: 0s - loss: 0.00938/8 [==============================] - 1s 91ms/step - loss: 0.0093
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.005347646679729224:
Train Score: 0.00532 MSE 0.07297 RMSE
Test Score: 0.01164 MSE 0.10789 RMSE
Deviation Min [0.00025918], Max [0.27047728]
Deviation 99.5th pctile [0.21404782]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1644,   12]))
Confusion matrix 
[[1639    5]
 [   8    4]]
precision 0.44444, recall 0.33333, f1 0.38095
Time to train: 414111 ms
Saving model models/A3Benchmark/A3Benchmark-TS20.csv.h5
Total Time to proces all the selected files : 419199 ms
A3Benchmark : Avg precision 0.44444 recall 0.33333 f1 0.38095 time to train 414111.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS20.csv  --epochs 20 --n_iter 3 --patience 3 :: took 426 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS21.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 05:15:10 PM MST
2020-11-30 17:15:16.228033: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 17:15:16.251065: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 17:15:16.252165: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55e0c3dedc00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 17:15:16.252202: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 17:15:16.252343: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS21.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 5.1890e-043/8 [==========>...................] - ETA: 0s - loss: 4.5196e-045/8 [=================>............] - ETA: 0s - loss: 3.7906e-047/8 [=========================>....] - ETA: 0s - loss: 3.1977e-048/8 [==============================] - 0s 40ms/step - loss: 3.1300e-04
1/8 [==>...........................] - ETA: 0s - loss: 1.4251e-042/8 [======>.......................] - ETA: 0s - loss: 1.6313e-044/8 [==============>...............] - ETA: 0s - loss: 1.5914e-045/8 [=================>............] - ETA: 0s - loss: 1.6434e-046/8 [=====================>........] - ETA: 0s - loss: 1.6669e-047/8 [=========================>....] - ETA: 0s - loss: 1.7039e-048/8 [==============================] - ETA: 0s - loss: 1.7333e-048/8 [==============================] - 1s 78ms/step - loss: 1.7333e-04
1/8 [==>...........................] - ETA: 0s - loss: 1.5445e-043/8 [==========>...................] - ETA: 0s - loss: 1.6877e-046/8 [=====================>........] - ETA: 0s - loss: 1.6521e-047/8 [=========================>....] - ETA: 0s - loss: 1.6475e-048/8 [==============================] - 0s 24ms/step - loss: 1.6976e-04
1/8 [==>...........................] - ETA: 0s - loss: 2.5900e-044/8 [==============>...............] - ETA: 0s - loss: 3.0060e-047/8 [=========================>....] - ETA: 0s - loss: 3.0771e-048/8 [==============================] - 0s 17ms/step - loss: 3.0869e-04
1/8 [==>...........................] - ETA: 0s - loss: 6.9574e-043/8 [==========>...................] - ETA: 0s - loss: 0.0011    4/8 [==============>...............] - ETA: 0s - loss: 0.00156/8 [=====================>........] - ETA: 0s - loss: 0.00278/8 [==============================] - 0s 26ms/step - loss: 0.0038
1/8 [==>...........................] - ETA: 0s - loss: 9.7992e-043/8 [==========>...................] - ETA: 0s - loss: 7.8865e-045/8 [=================>............] - ETA: 0s - loss: 6.3688e-047/8 [=========================>....] - ETA: 0s - loss: 5.1014e-048/8 [==============================] - 0s 33ms/step - loss: 4.9335e-04
1/8 [==>...........................] - ETA: 0s - loss: 1.6346e-043/8 [==========>...................] - ETA: 0s - loss: 1.9028e-045/8 [=================>............] - ETA: 0s - loss: 1.8816e-046/8 [=====================>........] - ETA: 0s - loss: 1.9346e-047/8 [=========================>....] - ETA: 0s - loss: 2.0178e-048/8 [==============================] - 0s 40ms/step - loss: 2.0588e-04
1/8 [==>...........................] - ETA: 0s - loss: 1.6738e-043/8 [==========>...................] - ETA: 0s - loss: 1.8821e-045/8 [=================>............] - ETA: 0s - loss: 1.8151e-047/8 [=========================>....] - ETA: 0s - loss: 1.9395e-048/8 [==============================] - 0s 26ms/step - loss: 2.0148e-04
1/8 [==>...........................] - ETA: 0s - loss: 3.1896e-043/8 [==========>...................] - ETA: 0s - loss: 3.2242e-045/8 [=================>............] - ETA: 0s - loss: 3.4392e-047/8 [=========================>....] - ETA: 0s - loss: 3.4142e-048/8 [==============================] - ETA: 0s - loss: 3.3959e-048/8 [==============================] - 0s 42ms/step - loss: 3.3959e-04
1/8 [==>...........................] - ETA: 0s - loss: 2.7568e-042/8 [======>.......................] - ETA: 0s - loss: 3.1693e-043/8 [==========>...................] - ETA: 0s - loss: 3.4097e-044/8 [==============>...............] - ETA: 0s - loss: 4.3555e-045/8 [=================>............] - ETA: 0s - loss: 5.8403e-047/8 [=========================>....] - ETA: 0s - loss: 8.3369e-048/8 [==============================] - 0s 53ms/step - loss: 9.0241e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00124/8 [==============>...............] - ETA: 0s - loss: 9.6609e-045/8 [=================>............] - ETA: 0s - loss: 9.0299e-047/8 [=========================>....] - ETA: 0s - loss: 7.5610e-048/8 [==============================] - ETA: 0s - loss: 7.3239e-048/8 [==============================] - 0s 39ms/step - loss: 7.3239e-04
1/8 [==>...........................] - ETA: 0s - loss: 1.4792e-043/8 [==========>...................] - ETA: 0s - loss: 1.7368e-044/8 [==============>...............] - ETA: 0s - loss: 1.6990e-045/8 [=================>............] - ETA: 0s - loss: 1.7586e-047/8 [=========================>....] - ETA: 0s - loss: 1.8089e-048/8 [==============================] - 0s 37ms/step - loss: 1.8470e-04
1/8 [==>...........................] - ETA: 0s - loss: 2.3481e-042/8 [======>.......................] - ETA: 0s - loss: 2.2572e-043/8 [==========>...................] - ETA: 0s - loss: 2.4102e-044/8 [==============>...............] - ETA: 0s - loss: 2.2878e-046/8 [=====================>........] - ETA: 0s - loss: 2.2744e-048/8 [==============================] - ETA: 0s - loss: 2.3344e-048/8 [==============================] - 1s 65ms/step - loss: 2.3344e-04
1/8 [==>...........................] - ETA: 0s - loss: 2.6681e-044/8 [==============>...............] - ETA: 0s - loss: 3.0291e-047/8 [=========================>....] - ETA: 0s - loss: 3.0622e-048/8 [==============================] - 0s 17ms/step - loss: 3.0668e-04
1/8 [==>...........................] - ETA: 0s - loss: 7.3014e-042/8 [======>.......................] - ETA: 0s - loss: 8.7266e-044/8 [==============>...............] - ETA: 0s - loss: 0.0013    7/8 [=========================>....] - ETA: 0s - loss: 0.00248/8 [==============================] - ETA: 0s - loss: 0.00268/8 [==============================] - 0s 41ms/step - loss: 0.0026
Best parameters {'n_units': 72, 'n_hidden': 2} best score 0.0004285434522898868:
Train Score: 0.00030 MSE 0.01737 RMSE
Test Score: 0.00574 MSE 0.07575 RMSE
Deviation Min [2.24912622e-05], Max [0.1384168]
Deviation 99.5th pctile [0.12538896]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1644,   12]))
Confusion matrix 
[[1636    8]
 [  11    1]]
precision 0.11111, recall 0.08333, f1 0.09524
Time to train: 631946 ms
Saving model models/A3Benchmark/A3Benchmark-TS21.csv.h5
Total Time to proces all the selected files : 638257 ms
A3Benchmark : Avg precision 0.11111 recall 0.08333 f1 0.09524 time to train 631946.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS21.csv  --epochs 20 --n_iter 3 --patience 3 :: took 644 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS22.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 05:25:59 PM MST
2020-11-30 17:26:05.813781: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 17:26:05.833987: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 17:26:05.834734: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d60c82ed30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 17:26:05.834759: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 17:26:05.834893: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS22.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00495/8 [=================>............] - ETA: 0s - loss: 0.00548/8 [==============================] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 16ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00152/8 [======>.......................] - ETA: 0s - loss: 0.00173/8 [==========>...................] - ETA: 0s - loss: 0.00176/8 [=====================>........] - ETA: 0s - loss: 0.00198/8 [==============================] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 40ms/step - loss: 0.0018
1/8 [==>...........................] - ETA: 0s - loss: 0.00964/8 [==============>...............] - ETA: 0s - loss: 0.01596/8 [=====================>........] - ETA: 0s - loss: 0.01558/8 [==============================] - ETA: 0s - loss: 0.01688/8 [==============================] - 0s 26ms/step - loss: 0.0168
1/8 [==>...........................] - ETA: 0s - loss: 0.00514/8 [==============>...............] - ETA: 0s - loss: 0.00247/8 [=========================>....] - ETA: 0s - loss: 0.00248/8 [==============================] - 0s 16ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.00203/8 [==========>...................] - ETA: 0s - loss: 0.00735/8 [=================>............] - ETA: 0s - loss: 0.00737/8 [=========================>....] - ETA: 0s - loss: 0.00648/8 [==============================] - 0s 31ms/step - loss: 0.0065
1/8 [==>...........................] - ETA: 0s - loss: 0.01172/8 [======>.......................] - ETA: 0s - loss: 0.01353/8 [==========>...................] - ETA: 0s - loss: 0.01354/8 [==============>...............] - ETA: 0s - loss: 0.01375/8 [=================>............] - ETA: 0s - loss: 0.01446/8 [=====================>........] - ETA: 0s - loss: 0.01417/8 [=========================>....] - ETA: 0s - loss: 0.01358/8 [==============================] - ETA: 0s - loss: 0.01378/8 [==============================] - 1s 103ms/step - loss: 0.0137
1/8 [==>...........................] - ETA: 0s - loss: 9.1911e-042/8 [======>.......................] - ETA: 0s - loss: 0.0010    3/8 [==========>...................] - ETA: 0s - loss: 0.00114/8 [==============>...............] - ETA: 0s - loss: 0.00195/8 [=================>............] - ETA: 0s - loss: 0.00206/8 [=====================>........] - ETA: 0s - loss: 0.00197/8 [=========================>....] - ETA: 0s - loss: 0.00188/8 [==============================] - ETA: 0s - loss: 0.00178/8 [==============================] - 1s 122ms/step - loss: 0.0017
1/8 [==>...........................] - ETA: 0s - loss: 0.00143/8 [==========>...................] - ETA: 0s - loss: 0.00275/8 [=================>............] - ETA: 0s - loss: 0.00267/8 [=========================>....] - ETA: 0s - loss: 0.00268/8 [==============================] - 0s 36ms/step - loss: 0.0027
1/8 [==>...........................] - ETA: 0s - loss: 0.00383/8 [==========>...................] - ETA: 0s - loss: 0.00315/8 [=================>............] - ETA: 0s - loss: 0.00237/8 [=========================>....] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 27ms/step - loss: 0.0022
1/8 [==>...........................] - ETA: 0s - loss: 9.3487e-043/8 [==========>...................] - ETA: 0s - loss: 0.0038    4/8 [==============>...............] - ETA: 0s - loss: 0.00375/8 [=================>............] - ETA: 0s - loss: 0.00336/8 [=====================>........] - ETA: 0s - loss: 0.00287/8 [=========================>....] - ETA: 0s - loss: 0.00268/8 [==============================] - 1s 70ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 0.01023/8 [==========>...................] - ETA: 0s - loss: 0.01285/8 [=================>............] - ETA: 0s - loss: 0.01297/8 [=========================>....] - ETA: 0s - loss: 0.01268/8 [==============================] - 0s 30ms/step - loss: 0.0131
1/8 [==>...........................] - ETA: 0s - loss: 0.00973/8 [==========>...................] - ETA: 0s - loss: 0.01165/8 [=================>............] - ETA: 0s - loss: 0.01217/8 [=========================>....] - ETA: 0s - loss: 0.01228/8 [==============================] - 0s 30ms/step - loss: 0.0127
1/8 [==>...........................] - ETA: 0s - loss: 0.00983/8 [==========>...................] - ETA: 0s - loss: 0.01585/8 [=================>............] - ETA: 0s - loss: 0.01467/8 [=========================>....] - ETA: 0s - loss: 0.01518/8 [==============================] - 0s 29ms/step - loss: 0.0162
1/8 [==>...........................] - ETA: 0s - loss: 0.01883/8 [==========>...................] - ETA: 0s - loss: 0.01895/8 [=================>............] - ETA: 0s - loss: 0.01877/8 [=========================>....] - ETA: 0s - loss: 0.02158/8 [==============================] - 0s 26ms/step - loss: 0.0218
1/8 [==>...........................] - ETA: 0s - loss: 0.01983/8 [==========>...................] - ETA: 0s - loss: 0.02937/8 [=========================>....] - ETA: 0s - loss: 0.03168/8 [==============================] - 0s 21ms/step - loss: 0.0318
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.004626361676491797:
Train Score: 0.00196 MSE 0.04431 RMSE
Test Score: 0.00258 MSE 0.05081 RMSE
Deviation Min [1.37749754e-05], Max [0.32195966]
Deviation 99.5th pctile [0.12847129]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1652,    4]))
Confusion matrix 
[[1647    5]
 [   0    4]]
precision 0.44444, recall 1.00000, f1 0.61538
Time to train: 793690 ms
Saving model models/A3Benchmark/A3Benchmark-TS22.csv.h5
Total Time to proces all the selected files : 801527 ms
A3Benchmark : Avg precision 0.44444 recall 1.00000 f1 0.61538 time to train 793690.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS22.csv  --epochs 20 --n_iter 3 --patience 3 :: took 808 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS23.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 05:39:32 PM MST
2020-11-30 17:39:38.442643: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 17:39:38.460979: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 17:39:38.461784: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x562fc4197c00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 17:39:38.461812: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 17:39:38.461956: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS23.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00702/8 [======>.......................] - ETA: 0s - loss: 0.00493/8 [==========>...................] - ETA: 0s - loss: 0.00404/8 [==============>...............] - ETA: 0s - loss: 0.00375/8 [=================>............] - ETA: 0s - loss: 0.00346/8 [=====================>........] - ETA: 0s - loss: 0.00328/8 [==============================] - ETA: 0s - loss: 0.00338/8 [==============================] - 0s 62ms/step - loss: 0.0033
1/8 [==>...........................] - ETA: 0s - loss: 0.00592/8 [======>.......................] - ETA: 0s - loss: 0.00494/8 [==============>...............] - ETA: 0s - loss: 0.00376/8 [=====================>........] - ETA: 0s - loss: 0.00338/8 [==============================] - ETA: 0s - loss: 0.00348/8 [==============================] - 0s 33ms/step - loss: 0.0034
1/8 [==>...........................] - ETA: 0s - loss: 0.00313/8 [==========>...................] - ETA: 0s - loss: 0.00635/8 [=================>............] - ETA: 0s - loss: 0.00487/8 [=========================>....] - ETA: 0s - loss: 0.00498/8 [==============================] - 0s 32ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00222/8 [======>.......................] - ETA: 0s - loss: 0.00233/8 [==========>...................] - ETA: 0s - loss: 0.00394/8 [==============>...............] - ETA: 0s - loss: 0.00465/8 [=================>............] - ETA: 0s - loss: 0.00496/8 [=====================>........] - ETA: 0s - loss: 0.00517/8 [=========================>....] - ETA: 0s - loss: 0.00608/8 [==============================] - 1s 65ms/step - loss: 0.0059
1/8 [==>...........................] - ETA: 0s - loss: 0.00502/8 [======>.......................] - ETA: 0s - loss: 0.00513/8 [==========>...................] - ETA: 0s - loss: 0.00594/8 [==============>...............] - ETA: 0s - loss: 0.00505/8 [=================>............] - ETA: 0s - loss: 0.00456/8 [=====================>........] - ETA: 0s - loss: 0.00447/8 [=========================>....] - ETA: 0s - loss: 0.00418/8 [==============================] - ETA: 0s - loss: 0.00408/8 [==============================] - 1s 133ms/step - loss: 0.0040
1/8 [==>...........................] - ETA: 0s - loss: 0.00594/8 [==============>...............] - ETA: 0s - loss: 0.00347/8 [=========================>....] - ETA: 0s - loss: 0.00318/8 [==============================] - 0s 18ms/step - loss: 0.0030
1/8 [==>...........................] - ETA: 0s - loss: 0.00594/8 [==============>...............] - ETA: 0s - loss: 0.00437/8 [=========================>....] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 17ms/step - loss: 0.0040
1/8 [==>...........................] - ETA: 0s - loss: 0.00395/8 [=================>............] - ETA: 0s - loss: 0.00628/8 [==============================] - 0s 14ms/step - loss: 0.0058
1/8 [==>...........................] - ETA: 0s - loss: 0.00194/8 [==============>...............] - ETA: 0s - loss: 0.00426/8 [=====================>........] - ETA: 0s - loss: 0.00427/8 [=========================>....] - ETA: 0s - loss: 0.00498/8 [==============================] - 0s 32ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00402/8 [======>.......................] - ETA: 0s - loss: 0.00455/8 [=================>............] - ETA: 0s - loss: 0.00498/8 [==============================] - 0s 23ms/step - loss: 0.0042
1/8 [==>...........................] - ETA: 0s - loss: 0.00774/8 [==============>...............] - ETA: 0s - loss: 0.00367/8 [=========================>....] - ETA: 0s - loss: 0.00328/8 [==============================] - 0s 17ms/step - loss: 0.0031
1/8 [==>...........................] - ETA: 0s - loss: 0.00815/8 [=================>............] - ETA: 0s - loss: 0.00458/8 [==============================] - 0s 13ms/step - loss: 0.0046
1/8 [==>...........................] - ETA: 0s - loss: 0.00334/8 [==============>...............] - ETA: 0s - loss: 0.00707/8 [=========================>....] - ETA: 0s - loss: 0.00608/8 [==============================] - 0s 16ms/step - loss: 0.0059
1/8 [==>...........................] - ETA: 0s - loss: 0.00354/8 [==============>...............] - ETA: 0s - loss: 0.00497/8 [=========================>....] - ETA: 0s - loss: 0.00558/8 [==============================] - 0s 18ms/step - loss: 0.0053
1/8 [==>...........................] - ETA: 0s - loss: 0.00705/8 [=================>............] - ETA: 0s - loss: 0.00728/8 [==============================] - 0s 17ms/step - loss: 0.0070
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.004282098356634378:
Train Score: 0.00361 MSE 0.06005 RMSE
Test Score: 0.00478 MSE 0.06913 RMSE
Deviation Min [3.09031428e-05], Max [0.49887071]
Deviation 99.5th pctile [0.33443536]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1642,   14]))
Confusion matrix 
[[1642    0]
 [   5    9]]
precision 1.00000, recall 0.64286, f1 0.78261
Time to train: 886674 ms
Saving model models/A3Benchmark/A3Benchmark-TS23.csv.h5
Total Time to proces all the selected files : 898658 ms
A3Benchmark : Avg precision 1.00000 recall 0.64286 f1 0.78261 time to train 886674.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS23.csv  --epochs 20 --n_iter 3 --patience 3 :: took 905 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS24.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 05:54:42 PM MST
2020-11-30 17:54:48.690270: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 17:54:48.707993: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 17:54:48.708833: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d67d4978e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 17:54:48.708870: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 17:54:48.708998: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS24.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00644/8 [==============>...............] - ETA: 0s - loss: 0.00667/8 [=========================>....] - ETA: 0s - loss: 0.00618/8 [==============================] - 0s 17ms/step - loss: 0.0058
1/8 [==>...........................] - ETA: 0s - loss: 0.01423/8 [==========>...................] - ETA: 0s - loss: 0.00976/8 [=====================>........] - ETA: 0s - loss: 0.00648/8 [==============================] - ETA: 0s - loss: 0.00688/8 [==============================] - 0s 31ms/step - loss: 0.0068
1/8 [==>...........................] - ETA: 0s - loss: 0.00556/8 [=====================>........] - ETA: 0s - loss: 0.00778/8 [==============================] - 0s 11ms/step - loss: 0.0078
1/8 [==>...........................] - ETA: 0s - loss: 0.00505/8 [=================>............] - ETA: 0s - loss: 0.00918/8 [==============================] - 0s 15ms/step - loss: 0.0074
1/8 [==>...........................] - ETA: 0s - loss: 0.00985/8 [=================>............] - ETA: 0s - loss: 0.00588/8 [==============================] - 0s 12ms/step - loss: 0.0051
1/8 [==>...........................] - ETA: 0s - loss: 0.00694/8 [==============>...............] - ETA: 0s - loss: 0.00687/8 [=========================>....] - ETA: 0s - loss: 0.00658/8 [==============================] - 0s 19ms/step - loss: 0.0062
1/8 [==>...........................] - ETA: 0s - loss: 0.01244/8 [==============>...............] - ETA: 0s - loss: 0.00697/8 [=========================>....] - ETA: 0s - loss: 0.00588/8 [==============================] - 0s 18ms/step - loss: 0.0059
1/8 [==>...........................] - ETA: 0s - loss: 0.00295/8 [=================>............] - ETA: 0s - loss: 0.00638/8 [==============================] - 0s 13ms/step - loss: 0.0058
1/8 [==>...........................] - ETA: 0s - loss: 0.00164/8 [==============>...............] - ETA: 0s - loss: 0.00786/8 [=====================>........] - ETA: 0s - loss: 0.00568/8 [==============================] - ETA: 0s - loss: 0.00538/8 [==============================] - 0s 32ms/step - loss: 0.0053
1/8 [==>...........................] - ETA: 0s - loss: 0.01034/8 [==============>...............] - ETA: 0s - loss: 0.00587/8 [=========================>....] - ETA: 0s - loss: 0.00468/8 [==============================] - 0s 16ms/step - loss: 0.0045
1/8 [==>...........................] - ETA: 0s - loss: 0.00463/8 [==========>...................] - ETA: 0s - loss: 0.00594/8 [==============>...............] - ETA: 0s - loss: 0.00525/8 [=================>............] - ETA: 0s - loss: 0.00466/8 [=====================>........] - ETA: 0s - loss: 0.00457/8 [=========================>....] - ETA: 0s - loss: 0.00448/8 [==============================] - ETA: 0s - loss: 0.00428/8 [==============================] - 1s 65ms/step - loss: 0.0042
1/8 [==>...........................] - ETA: 0s - loss: 0.00873/8 [==========>...................] - ETA: 0s - loss: 0.00437/8 [=========================>....] - ETA: 0s - loss: 0.00368/8 [==============================] - ETA: 0s - loss: 0.00348/8 [==============================] - 0s 28ms/step - loss: 0.0034
1/8 [==>...........................] - ETA: 0s - loss: 0.00273/8 [==========>...................] - ETA: 0s - loss: 0.00525/8 [=================>............] - ETA: 0s - loss: 0.00727/8 [=========================>....] - ETA: 0s - loss: 0.00738/8 [==============================] - 0s 32ms/step - loss: 0.0072
1/8 [==>...........................] - ETA: 0s - loss: 0.00323/8 [==========>...................] - ETA: 0s - loss: 0.01005/8 [=================>............] - ETA: 0s - loss: 0.00827/8 [=========================>....] - ETA: 0s - loss: 0.00678/8 [==============================] - 0s 35ms/step - loss: 0.0064
1/8 [==>...........................] - ETA: 0s - loss: 0.01173/8 [==========>...................] - ETA: 0s - loss: 0.00535/8 [=================>............] - ETA: 0s - loss: 0.00447/8 [=========================>....] - ETA: 0s - loss: 0.00428/8 [==============================] - 0s 29ms/step - loss: 0.0040
Best parameters {'n_units': 72, 'n_hidden': 2} best score 0.005068458802998066:
Train Score: 0.00729 MSE 0.08538 RMSE
Test Score: 0.00685 MSE 0.08278 RMSE
Deviation Min [4.29165752e-06], Max [0.52316176]
Deviation 99.5th pctile [0.31641129]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1648,    8]))
Confusion matrix 
[[1647    1]
 [   0    8]]
precision 0.88889, recall 1.00000, f1 0.94118
Time to train: 1057759 ms
Saving model models/A3Benchmark/A3Benchmark-TS24.csv.h5
Total Time to proces all the selected files : 1063906 ms
A3Benchmark : Avg precision 0.88889 recall 1.00000 f1 0.94118 time to train 1057759.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS24.csv  --epochs 20 --n_iter 3 --patience 3 :: took 1070 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS25.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 06:12:38 PM MST
2020-11-30 18:12:44.420796: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 18:12:44.439243: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 18:12:44.440127: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x562436b3a310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 18:12:44.440155: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 18:12:44.440274: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS25.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00572/8 [======>.......................] - ETA: 0s - loss: 0.00603/8 [==========>...................] - ETA: 0s - loss: 0.00585/8 [=================>............] - ETA: 0s - loss: 0.00606/8 [=====================>........] - ETA: 0s - loss: 0.00597/8 [=========================>....] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 57ms/step - loss: 0.0058
1/8 [==>...........................] - ETA: 0s - loss: 4.2171e-045/8 [=================>............] - ETA: 0s - loss: 7.7395e-048/8 [==============================] - ETA: 0s - loss: 6.8236e-048/8 [==============================] - 0s 15ms/step - loss: 6.8236e-04
1/8 [==>...........................] - ETA: 0s - loss: 5.6970e-042/8 [======>.......................] - ETA: 0s - loss: 5.7509e-043/8 [==========>...................] - ETA: 0s - loss: 5.3885e-044/8 [==============>...............] - ETA: 0s - loss: 5.7859e-045/8 [=================>............] - ETA: 0s - loss: 6.6770e-046/8 [=====================>........] - ETA: 0s - loss: 6.2580e-048/8 [==============================] - 1s 71ms/step - loss: 6.3407e-04
1/8 [==>...........................] - ETA: 0s - loss: 2.9317e-042/8 [======>.......................] - ETA: 0s - loss: 5.0659e-043/8 [==========>...................] - ETA: 0s - loss: 5.8307e-044/8 [==============>...............] - ETA: 0s - loss: 5.1164e-046/8 [=====================>........] - ETA: 0s - loss: 4.3782e-048/8 [==============================] - ETA: 0s - loss: 5.1304e-048/8 [==============================] - 0s 49ms/step - loss: 5.1304e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.01954/8 [==============>...............] - ETA: 0s - loss: 0.02466/8 [=====================>........] - ETA: 0s - loss: 0.02547/8 [=========================>....] - ETA: 0s - loss: 0.02548/8 [==============================] - ETA: 0s - loss: 0.02578/8 [==============================] - 0s 51ms/step - loss: 0.0257
1/8 [==>...........................] - ETA: 0s - loss: 0.00645/8 [=================>............] - ETA: 0s - loss: 0.00648/8 [==============================] - 0s 13ms/step - loss: 0.0062
1/8 [==>...........................] - ETA: 0s - loss: 0.00263/8 [==========>...................] - ETA: 0s - loss: 0.00324/8 [==============>...............] - ETA: 0s - loss: 0.00317/8 [=========================>....] - ETA: 0s - loss: 0.00298/8 [==============================] - ETA: 0s - loss: 0.00308/8 [==============================] - 0s 60ms/step - loss: 0.0030
1/8 [==>...........................] - ETA: 0s - loss: 0.00464/8 [==============>...............] - ETA: 0s - loss: 0.00577/8 [=========================>....] - ETA: 0s - loss: 0.00598/8 [==============================] - 0s 25ms/step - loss: 0.0061
1/8 [==>...........................] - ETA: 0s - loss: 0.00593/8 [==========>...................] - ETA: 0s - loss: 0.00557/8 [=========================>....] - ETA: 0s - loss: 0.00618/8 [==============================] - 0s 17ms/step - loss: 0.0061
1/8 [==>...........................] - ETA: 0s - loss: 0.00735/8 [=================>............] - ETA: 0s - loss: 0.00638/8 [==============================] - 0s 13ms/step - loss: 0.0064
1/8 [==>...........................] - ETA: 0s - loss: 0.00682/8 [======>.......................] - ETA: 0s - loss: 0.00743/8 [==========>...................] - ETA: 0s - loss: 0.00724/8 [==============>...............] - ETA: 0s - loss: 0.00725/8 [=================>............] - ETA: 0s - loss: 0.00766/8 [=====================>........] - ETA: 0s - loss: 0.00737/8 [=========================>....] - ETA: 0s - loss: 0.00718/8 [==============================] - ETA: 0s - loss: 0.00718/8 [==============================] - 1s 104ms/step - loss: 0.0071
1/8 [==>...........................] - ETA: 0s - loss: 0.00173/8 [==========>...................] - ETA: 0s - loss: 0.00135/8 [=================>............] - ETA: 0s - loss: 0.00117/8 [=========================>....] - ETA: 0s - loss: 0.00148/8 [==============================] - 0s 25ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 8.7387e-043/8 [==========>...................] - ETA: 0s - loss: 0.0014    5/8 [=================>............] - ETA: 0s - loss: 9.2812e-047/8 [=========================>....] - ETA: 0s - loss: 0.0010    8/8 [==============================] - 0s 27ms/step - loss: 0.0011
1/8 [==>...........................] - ETA: 0s - loss: 0.00233/8 [==========>...................] - ETA: 0s - loss: 0.00375/8 [=================>............] - ETA: 0s - loss: 0.00347/8 [=========================>....] - ETA: 0s - loss: 0.00338/8 [==============================] - 0s 26ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.00783/8 [==========>...................] - ETA: 0s - loss: 0.00815/8 [=================>............] - ETA: 0s - loss: 0.00737/8 [=========================>....] - ETA: 0s - loss: 0.00738/8 [==============================] - 0s 31ms/step - loss: 0.0074
Best parameters {'n_units': 72, 'n_hidden': 2} best score 0.004108634684234858:
Train Score: 0.00085 MSE 0.02913 RMSE
Test Score: 0.00174 MSE 0.04174 RMSE
Deviation Min [3.99298905e-07], Max [0.27800709]
Deviation 99.5th pctile [0.10030478]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1654,    2]))
Confusion matrix 
[[1647    7]
 [   0    2]]
precision 0.22222, recall 1.00000, f1 0.36364
Time to train: 823189 ms
Saving model models/A3Benchmark/A3Benchmark-TS25.csv.h5
Total Time to proces all the selected files : 830017 ms
A3Benchmark : Avg precision 0.22222 recall 1.00000 f1 0.36364 time to train 823189.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS25.csv  --epochs 20 --n_iter 3 --patience 3 :: took 836 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS26.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 06:26:39 PM MST
2020-11-30 18:26:46.125571: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 18:26:46.144236: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 18:26:46.145746: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55703d77d310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 18:26:46.145798: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 18:26:46.146023: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS26.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00372/8 [======>.......................] - ETA: 0s - loss: 0.00423/8 [==========>...................] - ETA: 0s - loss: 0.00424/8 [==============>...............] - ETA: 0s - loss: 0.00445/8 [=================>............] - ETA: 0s - loss: 0.00456/8 [=====================>........] - ETA: 0s - loss: 0.00447/8 [=========================>....] - ETA: 0s - loss: 0.00438/8 [==============================] - ETA: 0s - loss: 0.00438/8 [==============================] - 1s 110ms/step - loss: 0.0043
1/8 [==>...........................] - ETA: 0s - loss: 0.00443/8 [==========>...................] - ETA: 0s - loss: 0.00455/8 [=================>............] - ETA: 0s - loss: 0.00437/8 [=========================>....] - ETA: 0s - loss: 0.00448/8 [==============================] - 0s 33ms/step - loss: 0.0045
1/8 [==>...........................] - ETA: 0s - loss: 0.00372/8 [======>.......................] - ETA: 0s - loss: 0.00413/8 [==========>...................] - ETA: 0s - loss: 0.00484/8 [==============>...............] - ETA: 0s - loss: 0.00446/8 [=====================>........] - ETA: 0s - loss: 0.00477/8 [=========================>....] - ETA: 0s - loss: 0.00468/8 [==============================] - 0s 51ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00523/8 [==========>...................] - ETA: 0s - loss: 0.00575/8 [=================>............] - ETA: 0s - loss: 0.00587/8 [=========================>....] - ETA: 0s - loss: 0.00628/8 [==============================] - 0s 27ms/step - loss: 0.0063
1/8 [==>...........................] - ETA: 0s - loss: 0.00393/8 [==========>...................] - ETA: 0s - loss: 0.00475/8 [=================>............] - ETA: 0s - loss: 0.00447/8 [=========================>....] - ETA: 0s - loss: 0.00438/8 [==============================] - 0s 25ms/step - loss: 0.0044
1/8 [==>...........................] - ETA: 0s - loss: 0.00313/8 [==========>...................] - ETA: 0s - loss: 0.00354/8 [==============>...............] - ETA: 0s - loss: 0.00355/8 [=================>............] - ETA: 0s - loss: 0.00366/8 [=====================>........] - ETA: 0s - loss: 0.00357/8 [=========================>....] - ETA: 0s - loss: 0.00358/8 [==============================] - ETA: 0s - loss: 0.00358/8 [==============================] - 1s 83ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.00352/8 [======>.......................] - ETA: 0s - loss: 0.00374/8 [==============>...............] - ETA: 0s - loss: 0.00336/8 [=====================>........] - ETA: 0s - loss: 0.00337/8 [=========================>....] - ETA: 0s - loss: 0.00348/8 [==============================] - 0s 41ms/step - loss: 0.0034
1/8 [==>...........................] - ETA: 0s - loss: 0.00933/8 [==========>...................] - ETA: 0s - loss: 0.01384/8 [==============>...............] - ETA: 0s - loss: 0.01375/8 [=================>............] - ETA: 0s - loss: 0.01336/8 [=====================>........] - ETA: 0s - loss: 0.01388/8 [==============================] - ETA: 0s - loss: 0.01538/8 [==============================] - 0s 44ms/step - loss: 0.0153
1/8 [==>...........................] - ETA: 0s - loss: 0.01304/8 [==============>...............] - ETA: 0s - loss: 0.01257/8 [=========================>....] - ETA: 0s - loss: 0.01488/8 [==============================] - 0s 15ms/step - loss: 0.0150
1/8 [==>...........................] - ETA: 0s - loss: 0.00203/8 [==========>...................] - ETA: 0s - loss: 0.00215/8 [=================>............] - ETA: 0s - loss: 0.00256/8 [=====================>........] - ETA: 0s - loss: 0.00257/8 [=========================>....] - ETA: 0s - loss: 0.00238/8 [==============================] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 55ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.00333/8 [==========>...................] - ETA: 0s - loss: 0.00365/8 [=================>............] - ETA: 0s - loss: 0.00386/8 [=====================>........] - ETA: 0s - loss: 0.00378/8 [==============================] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 47ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.00413/8 [==========>...................] - ETA: 0s - loss: 0.00405/8 [=================>............] - ETA: 0s - loss: 0.00457/8 [=========================>....] - ETA: 0s - loss: 0.00478/8 [==============================] - 0s 31ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00523/8 [==========>...................] - ETA: 0s - loss: 0.00796/8 [=====================>........] - ETA: 0s - loss: 0.00798/8 [==============================] - ETA: 0s - loss: 0.00878/8 [==============================] - 0s 25ms/step - loss: 0.0087
1/8 [==>...........................] - ETA: 0s - loss: 0.01524/8 [==============>...............] - ETA: 0s - loss: 0.01446/8 [=====================>........] - ETA: 0s - loss: 0.01708/8 [==============================] - 0s 20ms/step - loss: 0.0176
1/8 [==>...........................] - ETA: 0s - loss: 0.01885/8 [=================>............] - ETA: 0s - loss: 0.02398/8 [==============================] - 0s 12ms/step - loss: 0.0250
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.004865968134254217:
Train Score: 0.00507 MSE 0.07121 RMSE
Test Score: 0.00520 MSE 0.07211 RMSE
Deviation Min [3.4984396e-05], Max [0.21402566]
Deviation 99.5th pctile [0.16844983]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1646,   10]))
Confusion matrix 
[[1641    5]
 [   6    4]]
precision 0.44444, recall 0.40000, f1 0.42105
Time to train: 561204 ms
Saving model models/A3Benchmark/A3Benchmark-TS26.csv.h5
Total Time to proces all the selected files : 568998 ms
A3Benchmark : Avg precision 0.44444 recall 0.40000 f1 0.42105 time to train 561204.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS26.csv  --epochs 20 --n_iter 3 --patience 3 :: took 576 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS27.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 06:36:20 PM MST
2020-11-30 18:36:26.310254: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 18:36:26.329055: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 18:36:26.330254: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5610fcb07c00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 18:36:26.330290: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 18:36:26.330472: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS27.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00412/8 [======>.......................] - ETA: 0s - loss: 0.00423/8 [==========>...................] - ETA: 0s - loss: 0.00355/8 [=================>............] - ETA: 0s - loss: 0.00306/8 [=====================>........] - ETA: 0s - loss: 0.00347/8 [=========================>....] - ETA: 0s - loss: 0.00378/8 [==============================] - ETA: 0s - loss: 0.00378/8 [==============================] - 1s 95ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.00673/8 [==========>...................] - ETA: 0s - loss: 0.00855/8 [=================>............] - ETA: 0s - loss: 0.00837/8 [=========================>....] - ETA: 0s - loss: 0.00848/8 [==============================] - 0s 28ms/step - loss: 0.0087
1/8 [==>...........................] - ETA: 0s - loss: 0.00183/8 [==========>...................] - ETA: 0s - loss: 9.7435e-045/8 [=================>............] - ETA: 0s - loss: 0.0015    7/8 [=========================>....] - ETA: 0s - loss: 0.00148/8 [==============================] - 0s 29ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 5.0255e-042/8 [======>.......................] - ETA: 0s - loss: 4.7846e-043/8 [==========>...................] - ETA: 0s - loss: 4.7596e-044/8 [==============>...............] - ETA: 0s - loss: 4.9432e-046/8 [=====================>........] - ETA: 0s - loss: 7.3028e-047/8 [=========================>....] - ETA: 0s - loss: 6.9759e-048/8 [==============================] - ETA: 0s - loss: 6.8030e-048/8 [==============================] - 0s 62ms/step - loss: 6.8030e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00192/8 [======>.......................] - ETA: 0s - loss: 0.00143/8 [==========>...................] - ETA: 0s - loss: 0.00134/8 [==============>...............] - ETA: 0s - loss: 0.00135/8 [=================>............] - ETA: 0s - loss: 0.00146/8 [=====================>........] - ETA: 0s - loss: 0.00137/8 [=========================>....] - ETA: 0s - loss: 0.00128/8 [==============================] - ETA: 0s - loss: 0.00138/8 [==============================] - 1s 149ms/step - loss: 0.0013
1/8 [==>...........................] - ETA: 0s - loss: 0.01083/8 [==========>...................] - ETA: 0s - loss: 0.01005/8 [=================>............] - ETA: 0s - loss: 0.01047/8 [=========================>....] - ETA: 0s - loss: 0.00948/8 [==============================] - 0s 25ms/step - loss: 0.0095
1/8 [==>...........................] - ETA: 0s - loss: 0.00122/8 [======>.......................] - ETA: 0s - loss: 0.00163/8 [==========>...................] - ETA: 0s - loss: 0.00134/8 [==============>...............] - ETA: 0s - loss: 0.00115/8 [=================>............] - ETA: 0s - loss: 9.1545e-046/8 [=====================>........] - ETA: 0s - loss: 0.0011    7/8 [=========================>....] - ETA: 0s - loss: 0.00128/8 [==============================] - ETA: 0s - loss: 0.00138/8 [==============================] - 1s 140ms/step - loss: 0.0013
1/8 [==>...........................] - ETA: 0s - loss: 0.00843/8 [==========>...................] - ETA: 0s - loss: 0.00995/8 [=================>............] - ETA: 0s - loss: 0.00937/8 [=========================>....] - ETA: 0s - loss: 0.00938/8 [==============================] - 0s 24ms/step - loss: 0.0098
1/8 [==>...........................] - ETA: 0s - loss: 0.01343/8 [==========>...................] - ETA: 0s - loss: 0.01435/8 [=================>............] - ETA: 0s - loss: 0.01437/8 [=========================>....] - ETA: 0s - loss: 0.01638/8 [==============================] - 0s 35ms/step - loss: 0.0165
1/8 [==>...........................] - ETA: 0s - loss: 0.00583/8 [==========>...................] - ETA: 0s - loss: 0.00825/8 [=================>............] - ETA: 0s - loss: 0.00817/8 [=========================>....] - ETA: 0s - loss: 0.00818/8 [==============================] - 0s 37ms/step - loss: 0.0082
1/8 [==>...........................] - ETA: 0s - loss: 0.00794/8 [==============>...............] - ETA: 0s - loss: 0.00737/8 [=========================>....] - ETA: 0s - loss: 0.00688/8 [==============================] - 0s 18ms/step - loss: 0.0068
1/8 [==>...........................] - ETA: 0s - loss: 0.00524/8 [==============>...............] - ETA: 0s - loss: 0.00657/8 [=========================>....] - ETA: 0s - loss: 0.00748/8 [==============================] - 0s 17ms/step - loss: 0.0076
1/8 [==>...........................] - ETA: 0s - loss: 0.00725/8 [=================>............] - ETA: 0s - loss: 0.00768/8 [==============================] - 0s 11ms/step - loss: 0.0080
1/8 [==>...........................] - ETA: 0s - loss: 0.00114/8 [==============>...............] - ETA: 0s - loss: 9.3362e-047/8 [=========================>....] - ETA: 0s - loss: 0.0013    8/8 [==============================] - 0s 25ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 0.00215/8 [=================>............] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 12ms/step - loss: 0.0016
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.003128437511622906:
Train Score: 0.00198 MSE 0.04451 RMSE
Test Score: 0.00193 MSE 0.04394 RMSE
Deviation Min [6.68005197e-05], Max [0.19924938]
Deviation 99.5th pctile [0.14969284]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Confusion matrix 
[[1646    1]
 [   1    8]]
precision 0.88889, recall 0.88889, f1 0.88889
Time to train: 927023 ms
Saving model models/A3Benchmark/A3Benchmark-TS27.csv.h5
Total Time to proces all the selected files : 933802 ms
A3Benchmark : Avg precision 0.88889 recall 0.88889 f1 0.88889 time to train 927023.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS27.csv  --epochs 20 --n_iter 3 --patience 3 :: took 940 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS28.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 06:52:05 PM MST
2020-11-30 18:52:11.782633: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 18:52:11.801229: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 18:52:11.802662: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5576a30dfc00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 18:52:11.802713: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 18:52:11.802925: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS28.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00732/8 [======>.......................] - ETA: 0s - loss: 0.00554/8 [==============>...............] - ETA: 0s - loss: 0.00345/8 [=================>............] - ETA: 0s - loss: 0.00317/8 [=========================>....] - ETA: 0s - loss: 0.00458/8 [==============================] - 0s 59ms/step - loss: 0.0043
1/8 [==>...........................] - ETA: 0s - loss: 0.00525/8 [=================>............] - ETA: 0s - loss: 0.00788/8 [==============================] - 0s 13ms/step - loss: 0.0077
1/8 [==>...........................] - ETA: 0s - loss: 0.00955/8 [=================>............] - ETA: 0s - loss: 0.01088/8 [==============================] - ETA: 0s - loss: 0.01138/8 [==============================] - 0s 15ms/step - loss: 0.0113
1/8 [==>...........................] - ETA: 0s - loss: 0.00574/8 [==============>...............] - ETA: 0s - loss: 0.00797/8 [=========================>....] - ETA: 0s - loss: 0.00808/8 [==============================] - 0s 18ms/step - loss: 0.0083
1/8 [==>...........................] - ETA: 0s - loss: 0.00365/8 [=================>............] - ETA: 0s - loss: 0.00348/8 [==============================] - 0s 14ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.01913/8 [==========>...................] - ETA: 0s - loss: 0.02185/8 [=================>............] - ETA: 0s - loss: 0.02107/8 [=========================>....] - ETA: 0s - loss: 0.02098/8 [==============================] - 0s 33ms/step - loss: 0.0214
1/8 [==>...........................] - ETA: 0s - loss: 0.00202/8 [======>.......................] - ETA: 0s - loss: 0.00214/8 [==============>...............] - ETA: 0s - loss: 0.00336/8 [=====================>........] - ETA: 0s - loss: 0.00328/8 [==============================] - ETA: 0s - loss: 0.00308/8 [==============================] - 0s 36ms/step - loss: 0.0030
1/8 [==>...........................] - ETA: 0s - loss: 0.01913/8 [==========>...................] - ETA: 0s - loss: 0.02125/8 [=================>............] - ETA: 0s - loss: 0.02347/8 [=========================>....] - ETA: 0s - loss: 0.02248/8 [==============================] - 0s 27ms/step - loss: 0.0230
1/8 [==>...........................] - ETA: 0s - loss: 0.01482/8 [======>.......................] - ETA: 0s - loss: 0.02114/8 [==============>...............] - ETA: 0s - loss: 0.02086/8 [=====================>........] - ETA: 0s - loss: 0.02108/8 [==============================] - ETA: 0s - loss: 0.02148/8 [==============================] - 0s 47ms/step - loss: 0.0214
1/8 [==>...........................] - ETA: 0s - loss: 0.01803/8 [==========>...................] - ETA: 0s - loss: 0.01675/8 [=================>............] - ETA: 0s - loss: 0.01677/8 [=========================>....] - ETA: 0s - loss: 0.01768/8 [==============================] - 0s 25ms/step - loss: 0.0179
1/8 [==>...........................] - ETA: 0s - loss: 0.00112/8 [======>.......................] - ETA: 0s - loss: 9.7325e-043/8 [==========>...................] - ETA: 0s - loss: 0.0011    5/8 [=================>............] - ETA: 0s - loss: 0.00118/8 [==============================] - ETA: 0s - loss: 0.00168/8 [==============================] - 0s 36ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 0.00153/8 [==========>...................] - ETA: 0s - loss: 0.00215/8 [=================>............] - ETA: 0s - loss: 0.00467/8 [=========================>....] - ETA: 0s - loss: 0.00388/8 [==============================] - ETA: 0s - loss: 0.00378/8 [==============================] - 0s 62ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.00743/8 [==========>...................] - ETA: 0s - loss: 0.01015/8 [=================>............] - ETA: 0s - loss: 0.00667/8 [=========================>....] - ETA: 0s - loss: 0.00728/8 [==============================] - 0s 36ms/step - loss: 0.0075
1/8 [==>...........................] - ETA: 0s - loss: 0.01523/8 [==========>...................] - ETA: 0s - loss: 0.02275/8 [=================>............] - ETA: 0s - loss: 0.02227/8 [=========================>....] - ETA: 0s - loss: 0.02158/8 [==============================] - 0s 38ms/step - loss: 0.0225
1/8 [==>...........................] - ETA: 0s - loss: 0.02422/8 [======>.......................] - ETA: 0s - loss: 0.02473/8 [==========>...................] - ETA: 0s - loss: 0.02344/8 [==============>...............] - ETA: 0s - loss: 0.02245/8 [=================>............] - ETA: 0s - loss: 0.02386/8 [=====================>........] - ETA: 0s - loss: 0.02457/8 [=========================>....] - ETA: 0s - loss: 0.02448/8 [==============================] - ETA: 0s - loss: 0.02478/8 [==============================] - 1s 95ms/step - loss: 0.0247
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.007035362534224987:
Train Score: 0.00265 MSE 0.05153 RMSE
Test Score: 0.00410 MSE 0.06403 RMSE
Deviation Min [2.65872304e-05], Max [0.38667631]
Deviation 99.5th pctile [0.15123778]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1654,    2]))
Confusion matrix 
[[1647    7]
 [   0    2]]
precision 0.22222, recall 1.00000, f1 0.36364
Time to train: 818195 ms
Saving model models/A3Benchmark/A3Benchmark-TS28.csv.h5
Total Time to proces all the selected files : 821204 ms
A3Benchmark : Avg precision 0.22222 recall 1.00000 f1 0.36364 time to train 818195.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS28.csv  --epochs 20 --n_iter 3 --patience 3 :: took 828 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS29.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 07:05:58 PM MST
2020-11-30 19:06:04.869443: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 19:06:04.888231: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 19:06:04.889717: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55dcbb005d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 19:06:04.889770: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 19:06:04.889999: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS29.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00943/8 [==========>...................] - ETA: 0s - loss: 0.00975/8 [=================>............] - ETA: 0s - loss: 0.00987/8 [=========================>....] - ETA: 0s - loss: 0.00918/8 [==============================] - ETA: 0s - loss: 0.00918/8 [==============================] - 1s 87ms/step - loss: 0.0091
1/8 [==>...........................] - ETA: 0s - loss: 0.00602/8 [======>.......................] - ETA: 0s - loss: 0.00693/8 [==========>...................] - ETA: 0s - loss: 0.00764/8 [==============>...............] - ETA: 0s - loss: 0.00755/8 [=================>............] - ETA: 0s - loss: 0.00776/8 [=====================>........] - ETA: 0s - loss: 0.00787/8 [=========================>....] - ETA: 0s - loss: 0.00768/8 [==============================] - ETA: 0s - loss: 0.00788/8 [==============================] - 1s 133ms/step - loss: 0.0078
1/8 [==>...........................] - ETA: 0s - loss: 5.9815e-043/8 [==========>...................] - ETA: 0s - loss: 6.7472e-045/8 [=================>............] - ETA: 0s - loss: 8.5181e-047/8 [=========================>....] - ETA: 0s - loss: 8.5478e-048/8 [==============================] - 0s 27ms/step - loss: 8.2585e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00133/8 [==========>...................] - ETA: 0s - loss: 0.00155/8 [=================>............] - ETA: 0s - loss: 0.00147/8 [=========================>....] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 42ms/step - loss: 0.0017
1/8 [==>...........................] - ETA: 0s - loss: 0.00103/8 [==========>...................] - ETA: 0s - loss: 0.00145/8 [=================>............] - ETA: 0s - loss: 0.00127/8 [=========================>....] - ETA: 0s - loss: 0.00148/8 [==============================] - 0s 29ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 0.00935/8 [=================>............] - ETA: 0s - loss: 0.00908/8 [==============================] - 0s 13ms/step - loss: 0.0081
1/8 [==>...........................] - ETA: 0s - loss: 7.6455e-044/8 [==============>...............] - ETA: 0s - loss: 7.1718e-047/8 [=========================>....] - ETA: 0s - loss: 6.9173e-048/8 [==============================] - 0s 16ms/step - loss: 6.9155e-04
1/8 [==>...........................] - ETA: 0s - loss: 5.9603e-044/8 [==============>...............] - ETA: 0s - loss: 7.1318e-047/8 [=========================>....] - ETA: 0s - loss: 7.5585e-048/8 [==============================] - 0s 17ms/step - loss: 7.2706e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00664/8 [==============>...............] - ETA: 0s - loss: 0.00797/8 [=========================>....] - ETA: 0s - loss: 0.00858/8 [==============================] - 0s 19ms/step - loss: 0.0087
1/8 [==>...........................] - ETA: 0s - loss: 8.7561e-045/8 [=================>............] - ETA: 0s - loss: 8.3527e-046/8 [=====================>........] - ETA: 0s - loss: 0.0012    8/8 [==============================] - ETA: 0s - loss: 0.00118/8 [==============================] - 0s 21ms/step - loss: 0.0011
1/8 [==>...........................] - ETA: 0s - loss: 0.01054/8 [==============>...............] - ETA: 0s - loss: 0.00976/8 [=====================>........] - ETA: 0s - loss: 0.00928/8 [==============================] - 0s 17ms/step - loss: 0.0088
1/8 [==>...........................] - ETA: 0s - loss: 6.6904e-044/8 [==============>...............] - ETA: 0s - loss: 6.7021e-048/8 [==============================] - ETA: 0s - loss: 8.0614e-048/8 [==============================] - 0s 14ms/step - loss: 8.0614e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00195/8 [=================>............] - ETA: 0s - loss: 0.00168/8 [==============================] - ETA: 0s - loss: 0.00178/8 [==============================] - 0s 15ms/step - loss: 0.0017
1/8 [==>...........................] - ETA: 0s - loss: 0.00134/8 [==============>...............] - ETA: 0s - loss: 9.2362e-047/8 [=========================>....] - ETA: 0s - loss: 0.0013    8/8 [==============================] - 0s 16ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 0.00145/8 [=================>............] - ETA: 0s - loss: 0.00198/8 [==============================] - 0s 14ms/step - loss: 0.0021
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.002924171567428857:
Train Score: 0.00089 MSE 0.02976 RMSE
Test Score: 0.00175 MSE 0.04180 RMSE
Deviation Min [1.48102022e-05], Max [0.25274917]
Deviation 99.5th pctile [0.10856265]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1652,    4]))
Confusion matrix 
[[1647    5]
 [   0    4]]
precision 0.44444, recall 1.00000, f1 0.61538
Time to train: 869430 ms
Saving model models/A3Benchmark/A3Benchmark-TS29.csv.h5
Total Time to proces all the selected files : 874768 ms
A3Benchmark : Avg precision 0.44444 recall 1.00000 f1 0.61538 time to train 869430.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS29.csv  --epochs 20 --n_iter 3 --patience 3 :: took 882 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS2.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 07:20:45 PM MST
2020-11-30 19:20:50.878217: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 19:20:50.897027: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 19:20:50.898230: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55b2f7412d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 19:20:50.898267: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 19:20:50.898433: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS2.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00414/8 [==============>...............] - ETA: 0s - loss: 0.00447/8 [=========================>....] - ETA: 0s - loss: 0.00428/8 [==============================] - 0s 17ms/step - loss: 0.0042
1/8 [==>...........................] - ETA: 0s - loss: 0.00285/8 [=================>............] - ETA: 0s - loss: 0.00438/8 [==============================] - 0s 13ms/step - loss: 0.0042
1/8 [==>...........................] - ETA: 0s - loss: 0.00365/8 [=================>............] - ETA: 0s - loss: 0.00478/8 [==============================] - 0s 13ms/step - loss: 0.0049
1/8 [==>...........................] - ETA: 0s - loss: 0.00306/8 [=====================>........] - ETA: 0s - loss: 0.00358/8 [==============================] - 0s 11ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.00504/8 [==============>...............] - ETA: 0s - loss: 0.00407/8 [=========================>....] - ETA: 0s - loss: 0.00398/8 [==============================] - 0s 16ms/step - loss: 0.0039
1/8 [==>...........................] - ETA: 0s - loss: 0.00593/8 [==========>...................] - ETA: 0s - loss: 0.00605/8 [=================>............] - ETA: 0s - loss: 0.00597/8 [=========================>....] - ETA: 0s - loss: 0.00538/8 [==============================] - 0s 30ms/step - loss: 0.0053
1/8 [==>...........................] - ETA: 0s - loss: 0.00313/8 [==========>...................] - ETA: 0s - loss: 0.00525/8 [=================>............] - ETA: 0s - loss: 0.00478/8 [==============================] - ETA: 0s - loss: 0.00458/8 [==============================] - 0s 24ms/step - loss: 0.0045
1/8 [==>...........................] - ETA: 0s - loss: 0.00383/8 [==========>...................] - ETA: 0s - loss: 0.00515/8 [=================>............] - ETA: 0s - loss: 0.00478/8 [==============================] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 24ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00335/8 [=================>............] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 12ms/step - loss: 0.0041
1/8 [==>...........................] - ETA: 0s - loss: 0.00584/8 [==============>...............] - ETA: 0s - loss: 0.00516/8 [=====================>........] - ETA: 0s - loss: 0.00518/8 [==============================] - 0s 22ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00363/8 [==========>...................] - ETA: 0s - loss: 0.00425/8 [=================>............] - ETA: 0s - loss: 0.00438/8 [==============================] - ETA: 0s - loss: 0.00418/8 [==============================] - 0s 27ms/step - loss: 0.0041
1/8 [==>...........................] - ETA: 0s - loss: 0.00323/8 [==========>...................] - ETA: 0s - loss: 0.00535/8 [=================>............] - ETA: 0s - loss: 0.00487/8 [=========================>....] - ETA: 0s - loss: 0.00478/8 [==============================] - 0s 27ms/step - loss: 0.0047
1/8 [==>...........................] - ETA: 0s - loss: 0.00353/8 [==========>...................] - ETA: 0s - loss: 0.00495/8 [=================>............] - ETA: 0s - loss: 0.00466/8 [=====================>........] - ETA: 0s - loss: 0.00458/8 [==============================] - 0s 28ms/step - loss: 0.0046
1/8 [==>...........................] - ETA: 0s - loss: 0.00372/8 [======>.......................] - ETA: 0s - loss: 0.00374/8 [==============>...............] - ETA: 0s - loss: 0.00385/8 [=================>............] - ETA: 0s - loss: 0.00416/8 [=====================>........] - ETA: 0s - loss: 0.00437/8 [=========================>....] - ETA: 0s - loss: 0.00448/8 [==============================] - ETA: 0s - loss: 0.00448/8 [==============================] - 1s 83ms/step - loss: 0.0044
1/8 [==>...........................] - ETA: 0s - loss: 0.00573/8 [==========>...................] - ETA: 0s - loss: 0.00465/8 [=================>............] - ETA: 0s - loss: 0.00507/8 [=========================>....] - ETA: 0s - loss: 0.00468/8 [==============================] - 0s 25ms/step - loss: 0.0046
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.004150211205706:
Train Score: 0.00422 MSE 0.06493 RMSE
Test Score: 0.01032 MSE 0.10158 RMSE
Deviation Min [7.61539207e-05], Max [0.33428011]
Deviation 99.5th pctile [0.22424444]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1640,   16]))
Confusion matrix 
[[1640    0]
 [   7    9]]
precision 1.00000, recall 0.56250, f1 0.72000
Time to train: 693979 ms
Saving model models/A3Benchmark/A3Benchmark-TS2.csv.h5
Total Time to proces all the selected files : 698748 ms
A3Benchmark : Avg precision 1.00000 recall 0.56250 f1 0.72000 time to train 693979.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS2.csv  --epochs 20 --n_iter 3 --patience 3 :: took 705 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS30.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 07:32:35 PM MST
2020-11-30 19:32:40.923758: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 19:32:40.942006: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 19:32:40.942856: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55b4620878e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 19:32:40.942889: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 19:32:40.943035: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS30.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00213/8 [==========>...................] - ETA: 0s - loss: 0.00215/8 [=================>............] - ETA: 0s - loss: 0.00226/8 [=====================>........] - ETA: 0s - loss: 0.00207/8 [=========================>....] - ETA: 0s - loss: 0.00198/8 [==============================] - 0s 31ms/step - loss: 0.0019
1/8 [==>...........................] - ETA: 0s - loss: 9.4450e-044/8 [==============>...............] - ETA: 0s - loss: 0.0012    7/8 [=========================>....] - ETA: 0s - loss: 0.00128/8 [==============================] - ETA: 0s - loss: 0.00128/8 [==============================] - 0s 47ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 0.00106/8 [=====================>........] - ETA: 0s - loss: 0.00148/8 [==============================] - 0s 8ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 8.4002e-045/8 [=================>............] - ETA: 0s - loss: 0.0011    8/8 [==============================] - 0s 14ms/step - loss: 0.0011
1/8 [==>...........................] - ETA: 0s - loss: 9.1922e-042/8 [======>.......................] - ETA: 0s - loss: 0.0010    3/8 [==========>...................] - ETA: 0s - loss: 0.00104/8 [==============>...............] - ETA: 0s - loss: 0.00116/8 [=====================>........] - ETA: 0s - loss: 0.00137/8 [=========================>....] - ETA: 0s - loss: 0.00138/8 [==============================] - 1s 79ms/step - loss: 0.0013
1/8 [==>...........................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00134/8 [==============>...............] - ETA: 0s - loss: 0.00136/8 [=====================>........] - ETA: 0s - loss: 0.00148/8 [==============================] - ETA: 0s - loss: 0.00148/8 [==============================] - 0s 33ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 0.00112/8 [======>.......................] - ETA: 0s - loss: 0.00133/8 [==========>...................] - ETA: 0s - loss: 0.00154/8 [==============>...............] - ETA: 0s - loss: 0.00145/8 [=================>............] - ETA: 0s - loss: 0.00146/8 [=====================>........] - ETA: 0s - loss: 0.00147/8 [=========================>....] - ETA: 0s - loss: 0.00148/8 [==============================] - ETA: 0s - loss: 0.00148/8 [==============================] - 1s 118ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 0.00103/8 [==========>...................] - ETA: 0s - loss: 0.00135/8 [=================>............] - ETA: 0s - loss: 0.00147/8 [=========================>....] - ETA: 0s - loss: 0.00138/8 [==============================] - 0s 32ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 9.6317e-043/8 [==========>...................] - ETA: 0s - loss: 0.0013    5/8 [=================>............] - ETA: 0s - loss: 0.00137/8 [=========================>....] - ETA: 0s - loss: 0.00138/8 [==============================] - 0s 26ms/step - loss: 0.0013
1/8 [==>...........................] - ETA: 0s - loss: 0.00114/8 [==============>...............] - ETA: 0s - loss: 0.00148/8 [==============================] - ETA: 0s - loss: 0.00208/8 [==============================] - 0s 15ms/step - loss: 0.0020
1/8 [==>...........................] - ETA: 0s - loss: 0.00393/8 [==========>...................] - ETA: 0s - loss: 0.00355/8 [=================>............] - ETA: 0s - loss: 0.00377/8 [=========================>....] - ETA: 0s - loss: 0.00318/8 [==============================] - 0s 30ms/step - loss: 0.0030
1/8 [==>...........................] - ETA: 0s - loss: 0.00113/8 [==========>...................] - ETA: 0s - loss: 0.00155/8 [=================>............] - ETA: 0s - loss: 0.00147/8 [=========================>....] - ETA: 0s - loss: 0.00148/8 [==============================] - 0s 23ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 0.00112/8 [======>.......................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00145/8 [=================>............] - ETA: 0s - loss: 0.00146/8 [=====================>........] - ETA: 0s - loss: 0.00147/8 [=========================>....] - ETA: 0s - loss: 0.00148/8 [==============================] - 1s 79ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 9.7624e-042/8 [======>.......................] - ETA: 0s - loss: 0.0013    4/8 [==============>...............] - ETA: 0s - loss: 0.00136/8 [=====================>........] - ETA: 0s - loss: 0.00138/8 [==============================] - ETA: 0s - loss: 0.00148/8 [==============================] - 0s 29ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 0.00113/8 [==========>...................] - ETA: 0s - loss: 0.00145/8 [=================>............] - ETA: 0s - loss: 0.00147/8 [=========================>....] - ETA: 0s - loss: 0.00148/8 [==============================] - 0s 33ms/step - loss: 0.0015
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.00138888587243855:
Train Score: 0.00127 MSE 0.03564 RMSE
Test Score: 0.00189 MSE 0.04349 RMSE
Deviation Min [2.1113586e-05], Max [0.14647496]
Deviation 99.5th pctile [0.09300234]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1648,    8]))
Confusion matrix 
[[1642    6]
 [   5    3]]
precision 0.33333, recall 0.37500, f1 0.35294
Time to train: 706969 ms
Saving model models/A3Benchmark/A3Benchmark-TS30.csv.h5
Total Time to proces all the selected files : 709299 ms
A3Benchmark : Avg precision 0.33333 recall 0.37500 f1 0.35294 time to train 706969.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS30.csv  --epochs 20 --n_iter 3 --patience 3 :: took 715 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS31.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 07:44:35 PM MST
2020-11-30 19:44:42.187358: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 19:44:42.206247: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 19:44:42.207720: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55ee8dba4d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 19:44:42.207768: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 19:44:42.207981: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS31.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 8.8672e-048/8 [==============================] - 0s 13ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.00144/8 [==============>...............] - ETA: 0s - loss: 0.00135/8 [=================>............] - ETA: 0s - loss: 0.00147/8 [=========================>....] - ETA: 0s - loss: 0.00128/8 [==============================] - 0s 34ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 0.00114/8 [==============>...............] - ETA: 0s - loss: 0.00417/8 [=========================>....] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 19ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 0.00173/8 [==========>...................] - ETA: 0s - loss: 0.00156/8 [=====================>........] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 17ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 0.00224/8 [==============>...............] - ETA: 0s - loss: 0.00227/8 [=========================>....] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 14ms/step - loss: 0.0022
1/8 [==>...........................] - ETA: 0s - loss: 0.00304/8 [==============>...............] - ETA: 0s - loss: 0.00227/8 [=========================>....] - ETA: 0s - loss: 0.00308/8 [==============================] - 0s 21ms/step - loss: 0.0033
1/8 [==>...........................] - ETA: 0s - loss: 0.00124/8 [==============>...............] - ETA: 0s - loss: 0.00128/8 [==============================] - ETA: 0s - loss: 0.00118/8 [==============================] - 0s 15ms/step - loss: 0.0011
1/8 [==>...........................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00398/8 [==============================] - 0s 14ms/step - loss: 0.0032
1/8 [==>...........................] - ETA: 0s - loss: 0.00125/8 [=================>............] - ETA: 0s - loss: 0.00148/8 [==============================] - 0s 14ms/step - loss: 0.0026
1/8 [==>...........................] - ETA: 0s - loss: 0.00205/8 [=================>............] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 14ms/step - loss: 0.0022
1/8 [==>...........................] - ETA: 0s - loss: 0.00365/8 [=================>............] - ETA: 0s - loss: 0.00288/8 [==============================] - 0s 13ms/step - loss: 0.0041
1/8 [==>...........................] - ETA: 0s - loss: 0.00293/8 [==========>...................] - ETA: 0s - loss: 0.00287/8 [=========================>....] - ETA: 0s - loss: 0.00288/8 [==============================] - 0s 20ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00235/8 [=================>............] - ETA: 0s - loss: 0.00478/8 [==============================] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 15ms/step - loss: 0.0038
1/8 [==>...........................] - ETA: 0s - loss: 0.00243/8 [==========>...................] - ETA: 0s - loss: 0.00244/8 [==============>...............] - ETA: 0s - loss: 0.00266/8 [=====================>........] - ETA: 0s - loss: 0.00348/8 [==============================] - ETA: 0s - loss: 0.00408/8 [==============================] - 0s 47ms/step - loss: 0.0040
1/8 [==>...........................] - ETA: 0s - loss: 0.00184/8 [==============>...............] - ETA: 0s - loss: 0.00207/8 [=========================>....] - ETA: 0s - loss: 0.00208/8 [==============================] - 0s 16ms/step - loss: 0.0020
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.002231649309396744:
Train Score: 0.00153 MSE 0.03917 RMSE
Test Score: 0.00133 MSE 0.03640 RMSE
Deviation Min [2.97262953e-05], Max [0.40706116]
Deviation 99.5th pctile [0.13065375]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1649,    7]))
Confusion matrix 
[[1647    2]
 [   0    7]]
precision 0.77778, recall 1.00000, f1 0.87500
Time to train: 634672 ms
Saving model models/A3Benchmark/A3Benchmark-TS31.csv.h5
Total Time to proces all the selected files : 640577 ms
A3Benchmark : Avg precision 0.77778 recall 1.00000 f1 0.87500 time to train 634672.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS31.csv  --epochs 20 --n_iter 3 --patience 3 :: took 648 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS32.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 07:55:28 PM MST
2020-11-30 19:55:34.100338: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 19:55:34.122058: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 19:55:34.123189: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x564059738d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 19:55:34.123229: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 19:55:34.123398: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS32.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00243/8 [==========>...................] - ETA: 0s - loss: 0.00265/8 [=================>............] - ETA: 0s - loss: 0.00307/8 [=========================>....] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 34ms/step - loss: 0.0027
1/8 [==>...........................] - ETA: 0s - loss: 0.00743/8 [==========>...................] - ETA: 0s - loss: 0.00534/8 [==============>...............] - ETA: 0s - loss: 0.00496/8 [=====================>........] - ETA: 0s - loss: 0.00438/8 [==============================] - ETA: 0s - loss: 0.00418/8 [==============================] - 0s 33ms/step - loss: 0.0041
1/8 [==>...........................] - ETA: 0s - loss: 0.00233/8 [==========>...................] - ETA: 0s - loss: 0.00464/8 [==============>...............] - ETA: 0s - loss: 0.00445/8 [=================>............] - ETA: 0s - loss: 0.00498/8 [==============================] - ETA: 0s - loss: 0.00608/8 [==============================] - 0s 34ms/step - loss: 0.0060
1/8 [==>...........................] - ETA: 0s - loss: 0.00392/8 [======>.......................] - ETA: 0s - loss: 0.00554/8 [==============>...............] - ETA: 0s - loss: 0.00445/8 [=================>............] - ETA: 0s - loss: 0.00417/8 [=========================>....] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 43ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.01185/8 [=================>............] - ETA: 0s - loss: 0.01128/8 [==============================] - 0s 14ms/step - loss: 0.0112
1/8 [==>...........................] - ETA: 0s - loss: 0.00283/8 [==========>...................] - ETA: 0s - loss: 0.00325/8 [=================>............] - ETA: 0s - loss: 0.00347/8 [=========================>....] - ETA: 0s - loss: 0.00338/8 [==============================] - 0s 27ms/step - loss: 0.0032
1/8 [==>...........................] - ETA: 0s - loss: 0.00632/8 [======>.......................] - ETA: 0s - loss: 0.00593/8 [==========>...................] - ETA: 0s - loss: 0.00494/8 [==============>...............] - ETA: 0s - loss: 0.00455/8 [=================>............] - ETA: 0s - loss: 0.00416/8 [=====================>........] - ETA: 0s - loss: 0.00397/8 [=========================>....] - ETA: 0s - loss: 0.00378/8 [==============================] - 1s 71ms/step - loss: 0.0038
1/8 [==>...........................] - ETA: 0s - loss: 0.00243/8 [==========>...................] - ETA: 0s - loss: 0.00415/8 [=================>............] - ETA: 0s - loss: 0.00497/8 [=========================>....] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 34ms/step - loss: 0.0061
1/8 [==>...........................] - ETA: 0s - loss: 0.00422/8 [======>.......................] - ETA: 0s - loss: 0.00573/8 [==========>...................] - ETA: 0s - loss: 0.00664/8 [==============>...............] - ETA: 0s - loss: 0.00555/8 [=================>............] - ETA: 0s - loss: 0.00527/8 [=========================>....] - ETA: 0s - loss: 0.00468/8 [==============================] - 1s 90ms/step - loss: 0.0045
1/8 [==>...........................] - ETA: 0s - loss: 0.00612/8 [======>.......................] - ETA: 0s - loss: 0.00463/8 [==========>...................] - ETA: 0s - loss: 0.00384/8 [==============>...............] - ETA: 0s - loss: 0.00395/8 [=================>............] - ETA: 0s - loss: 0.00366/8 [=====================>........] - ETA: 0s - loss: 0.00437/8 [=========================>....] - ETA: 0s - loss: 0.00418/8 [==============================] - 1s 73ms/step - loss: 0.0040
1/8 [==>...........................] - ETA: 0s - loss: 0.00323/8 [==========>...................] - ETA: 0s - loss: 0.00404/8 [==============>...............] - ETA: 0s - loss: 0.00376/8 [=====================>........] - ETA: 0s - loss: 0.00367/8 [=========================>....] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 38ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.00782/8 [======>.......................] - ETA: 0s - loss: 0.00753/8 [==========>...................] - ETA: 0s - loss: 0.00614/8 [==============>...............] - ETA: 0s - loss: 0.00595/8 [=================>............] - ETA: 0s - loss: 0.00576/8 [=====================>........] - ETA: 0s - loss: 0.00577/8 [=========================>....] - ETA: 0s - loss: 0.00528/8 [==============================] - 1s 102ms/step - loss: 0.0053
1/8 [==>...........................] - ETA: 0s - loss: 0.00263/8 [==========>...................] - ETA: 0s - loss: 0.00444/8 [==============>...............] - ETA: 0s - loss: 0.00505/8 [=================>............] - ETA: 0s - loss: 0.00556/8 [=====================>........] - ETA: 0s - loss: 0.00678/8 [==============================] - ETA: 0s - loss: 0.00688/8 [==============================] - 0s 42ms/step - loss: 0.0068
1/8 [==>...........................] - ETA: 0s - loss: 0.00443/8 [==========>...................] - ETA: 0s - loss: 0.00565/8 [=================>............] - ETA: 0s - loss: 0.00467/8 [=========================>....] - ETA: 0s - loss: 0.00448/8 [==============================] - 0s 39ms/step - loss: 0.0042
1/8 [==>...........................] - ETA: 0s - loss: 0.00663/8 [==========>...................] - ETA: 0s - loss: 0.00425/8 [=================>............] - ETA: 0s - loss: 0.00417/8 [=========================>....] - ETA: 0s - loss: 0.00438/8 [==============================] - 0s 34ms/step - loss: 0.0042
Best parameters {'n_units': 72, 'n_hidden': 2} best score 0.0042943784035742285:
Train Score: 0.00395 MSE 0.06283 RMSE
Test Score: 0.00417 MSE 0.06457 RMSE
Deviation Min [3.80656926e-07], Max [0.3770321]
Deviation 99.5th pctile [0.27989759]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1643,   13]))
Confusion matrix 
[[1643    0]
 [   4    9]]
precision 1.00000, recall 0.69231, f1 0.81818
Time to train: 1038891 ms
Saving model models/A3Benchmark/A3Benchmark-TS32.csv.h5
Total Time to proces all the selected files : 1049212 ms
A3Benchmark : Avg precision 1.00000 recall 0.69231 f1 0.81818 time to train 1038891.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS32.csv  --epochs 20 --n_iter 3 --patience 3 :: took 1055 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS33.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 08:13:08 PM MST
2020-11-30 20:13:15.159625: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 20:13:15.178267: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 20:13:15.179715: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55c01e7fd0b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 20:13:15.179759: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 20:13:15.179975: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS33.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.01132/8 [======>.......................] - ETA: 0s - loss: 0.01773/8 [==========>...................] - ETA: 0s - loss: 0.01664/8 [==============>...............] - ETA: 0s - loss: 0.01565/8 [=================>............] - ETA: 0s - loss: 0.01566/8 [=====================>........] - ETA: 0s - loss: 0.01507/8 [=========================>....] - ETA: 0s - loss: 0.01448/8 [==============================] - ETA: 0s - loss: 0.01478/8 [==============================] - 1s 81ms/step - loss: 0.0147
1/8 [==>...........................] - ETA: 0s - loss: 0.00913/8 [==========>...................] - ETA: 0s - loss: 0.01295/8 [=================>............] - ETA: 0s - loss: 0.01267/8 [=========================>....] - ETA: 0s - loss: 0.01268/8 [==============================] - 0s 32ms/step - loss: 0.0129
1/8 [==>...........................] - ETA: 0s - loss: 0.01243/8 [==========>...................] - ETA: 0s - loss: 0.01755/8 [=================>............] - ETA: 0s - loss: 0.01566/8 [=====================>........] - ETA: 0s - loss: 0.01507/8 [=========================>....] - ETA: 0s - loss: 0.01448/8 [==============================] - 0s 37ms/step - loss: 0.0151
1/8 [==>...........................] - ETA: 0s - loss: 0.01172/8 [======>.......................] - ETA: 0s - loss: 0.01414/8 [==============>...............] - ETA: 0s - loss: 0.01416/8 [=====================>........] - ETA: 0s - loss: 0.01508/8 [==============================] - ETA: 0s - loss: 0.01478/8 [==============================] - 0s 35ms/step - loss: 0.0147
1/8 [==>...........................] - ETA: 0s - loss: 0.00443/8 [==========>...................] - ETA: 0s - loss: 0.00515/8 [=================>............] - ETA: 0s - loss: 0.00487/8 [=========================>....] - ETA: 0s - loss: 0.00458/8 [==============================] - 0s 37ms/step - loss: 0.0045
1/8 [==>...........................] - ETA: 0s - loss: 0.00464/8 [==============>...............] - ETA: 0s - loss: 0.00597/8 [=========================>....] - ETA: 0s - loss: 0.00548/8 [==============================] - 0s 19ms/step - loss: 0.0053
1/8 [==>...........................] - ETA: 0s - loss: 0.00325/8 [=================>............] - ETA: 0s - loss: 0.00378/8 [==============================] - ETA: 0s - loss: 0.00348/8 [==============================] - 0s 16ms/step - loss: 0.0034
1/8 [==>...........................] - ETA: 0s - loss: 0.00353/8 [==========>...................] - ETA: 0s - loss: 0.00544/8 [==============>...............] - ETA: 0s - loss: 0.00477/8 [=========================>....] - ETA: 0s - loss: 0.00438/8 [==============================] - 0s 26ms/step - loss: 0.0044
1/8 [==>...........................] - ETA: 0s - loss: 0.00282/8 [======>.......................] - ETA: 0s - loss: 0.00364/8 [==============>...............] - ETA: 0s - loss: 0.00366/8 [=====================>........] - ETA: 0s - loss: 0.00417/8 [=========================>....] - ETA: 0s - loss: 0.00398/8 [==============================] - 0s 42ms/step - loss: 0.0040
1/8 [==>...........................] - ETA: 0s - loss: 0.00475/8 [=================>............] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 12ms/step - loss: 0.0034
1/8 [==>...........................] - ETA: 0s - loss: 0.00533/8 [==========>...................] - ETA: 0s - loss: 0.00595/8 [=================>............] - ETA: 0s - loss: 0.00467/8 [=========================>....] - ETA: 0s - loss: 0.00468/8 [==============================] - 0s 25ms/step - loss: 0.0045
1/8 [==>...........................] - ETA: 0s - loss: 0.00333/8 [==========>...................] - ETA: 0s - loss: 0.00354/8 [==============>...............] - ETA: 0s - loss: 0.00355/8 [=================>............] - ETA: 0s - loss: 0.00336/8 [=====================>........] - ETA: 0s - loss: 0.00307/8 [=========================>....] - ETA: 0s - loss: 0.00318/8 [==============================] - ETA: 0s - loss: 0.00318/8 [==============================] - 0s 59ms/step - loss: 0.0031
1/8 [==>...........................] - ETA: 0s - loss: 0.01243/8 [==========>...................] - ETA: 0s - loss: 0.01815/8 [=================>............] - ETA: 0s - loss: 0.01597/8 [=========================>....] - ETA: 0s - loss: 0.01478/8 [==============================] - 0s 24ms/step - loss: 0.0155
1/8 [==>...........................] - ETA: 0s - loss: 0.00362/8 [======>.......................] - ETA: 0s - loss: 0.00444/8 [==============>...............] - ETA: 0s - loss: 0.00436/8 [=====================>........] - ETA: 0s - loss: 0.00507/8 [=========================>....] - ETA: 0s - loss: 0.00498/8 [==============================] - 0s 51ms/step - loss: 0.0049
1/8 [==>...........................] - ETA: 0s - loss: 0.00492/8 [======>.......................] - ETA: 0s - loss: 0.00413/8 [==========>...................] - ETA: 0s - loss: 0.00474/8 [==============>...............] - ETA: 0s - loss: 0.00455/8 [=================>............] - ETA: 0s - loss: 0.00417/8 [=========================>....] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 56ms/step - loss: 0.0039
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.00409310357645154:
Train Score: 0.00433 MSE 0.06583 RMSE
Test Score: 0.00438 MSE 0.06617 RMSE
Deviation Min [5.61968592e-05], Max [0.46434066]
Deviation 99.5th pctile [0.18878155]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1648,    8]))
Confusion matrix 
[[1647    1]
 [   0    8]]
precision 0.88889, recall 1.00000, f1 0.94118
Time to train: 868183 ms
Saving model models/A3Benchmark/A3Benchmark-TS33.csv.h5
Total Time to proces all the selected files : 873676 ms
A3Benchmark : Avg precision 0.88889 recall 1.00000 f1 0.94118 time to train 868183.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS33.csv  --epochs 20 --n_iter 3 --patience 3 :: took 881 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS34.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 08:27:54 PM MST
2020-11-30 20:28:00.312690: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 20:28:00.331021: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 20:28:00.331808: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55fc5af288e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 20:28:00.331836: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 20:28:00.331983: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS34.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00444/8 [==============>...............] - ETA: 0s - loss: 0.00527/8 [=========================>....] - ETA: 0s - loss: 0.00478/8 [==============================] - 0s 16ms/step - loss: 0.0046
1/8 [==>...........................] - ETA: 0s - loss: 0.00185/8 [=================>............] - ETA: 0s - loss: 0.00348/8 [==============================] - 0s 11ms/step - loss: 0.0033
1/8 [==>...........................] - ETA: 0s - loss: 0.00215/8 [=================>............] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 14ms/step - loss: 0.0020
1/8 [==>...........................] - ETA: 0s - loss: 0.00235/8 [=================>............] - ETA: 0s - loss: 0.00258/8 [==============================] - 0s 13ms/step - loss: 0.0024
1/8 [==>...........................] - ETA: 0s - loss: 0.00384/8 [==============>...............] - ETA: 0s - loss: 0.00646/8 [=====================>........] - ETA: 0s - loss: 0.00568/8 [==============================] - ETA: 0s - loss: 0.00568/8 [==============================] - 0s 23ms/step - loss: 0.0056
1/8 [==>...........................] - ETA: 0s - loss: 0.01074/8 [==============>...............] - ETA: 0s - loss: 0.01256/8 [=====================>........] - ETA: 0s - loss: 0.01258/8 [==============================] - ETA: 0s - loss: 0.01318/8 [==============================] - 0s 23ms/step - loss: 0.0131
1/8 [==>...........................] - ETA: 0s - loss: 0.00863/8 [==========>...................] - ETA: 0s - loss: 0.01195/8 [=================>............] - ETA: 0s - loss: 0.01257/8 [=========================>....] - ETA: 0s - loss: 0.01258/8 [==============================] - 0s 29ms/step - loss: 0.0129
1/8 [==>...........................] - ETA: 0s - loss: 0.01133/8 [==========>...................] - ETA: 0s - loss: 0.01555/8 [=================>............] - ETA: 0s - loss: 0.01467/8 [=========================>....] - ETA: 0s - loss: 0.01528/8 [==============================] - 0s 29ms/step - loss: 0.0160
1/8 [==>...........................] - ETA: 0s - loss: 0.02343/8 [==========>...................] - ETA: 0s - loss: 0.02125/8 [=================>............] - ETA: 0s - loss: 0.02207/8 [=========================>....] - ETA: 0s - loss: 0.02498/8 [==============================] - ETA: 0s - loss: 0.02528/8 [==============================] - 0s 36ms/step - loss: 0.0252
1/8 [==>...........................] - ETA: 0s - loss: 0.01512/8 [======>.......................] - ETA: 0s - loss: 0.01974/8 [==============>...............] - ETA: 0s - loss: 0.02685/8 [=================>............] - ETA: 0s - loss: 0.02606/8 [=====================>........] - ETA: 0s - loss: 0.02657/8 [=========================>....] - ETA: 0s - loss: 0.02608/8 [==============================] - ETA: 0s - loss: 0.02618/8 [==============================] - 1s 129ms/step - loss: 0.0261
1/8 [==>...........................] - ETA: 0s - loss: 0.01143/8 [==========>...................] - ETA: 0s - loss: 0.01365/8 [=================>............] - ETA: 0s - loss: 0.01317/8 [=========================>....] - ETA: 0s - loss: 0.01258/8 [==============================] - 0s 27ms/step - loss: 0.0128
1/8 [==>...........................] - ETA: 0s - loss: 0.01003/8 [==========>...................] - ETA: 0s - loss: 0.01355/8 [=================>............] - ETA: 0s - loss: 0.01297/8 [=========================>....] - ETA: 0s - loss: 0.01248/8 [==============================] - 0s 27ms/step - loss: 0.0128
1/8 [==>...........................] - ETA: 0s - loss: 0.01293/8 [==========>...................] - ETA: 0s - loss: 0.01875/8 [=================>............] - ETA: 0s - loss: 0.01757/8 [=========================>....] - ETA: 0s - loss: 0.01848/8 [==============================] - 0s 34ms/step - loss: 0.0195
1/8 [==>...........................] - ETA: 0s - loss: 0.01754/8 [==============>...............] - ETA: 0s - loss: 0.01676/8 [=====================>........] - ETA: 0s - loss: 0.01988/8 [==============================] - 0s 20ms/step - loss: 0.0195
1/8 [==>...........................] - ETA: 0s - loss: 0.01263/8 [==========>...................] - ETA: 0s - loss: 0.02325/8 [=================>............] - ETA: 0s - loss: 0.02257/8 [=========================>....] - ETA: 0s - loss: 0.02258/8 [==============================] - 0s 34ms/step - loss: 0.0227
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0035894084721803665:
Train Score: 0.00235 MSE 0.04846 RMSE
Test Score: 0.00332 MSE 0.05761 RMSE
Deviation Min [5.11170108e-05], Max [0.35016593]
Deviation 99.5th pctile [0.14584924]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1655,    1]))
Confusion matrix 
[[1647    8]
 [   0    1]]
precision 0.11111, recall 1.00000, f1 0.20000
Time to train: 529268 ms
Saving model models/A3Benchmark/A3Benchmark-TS34.csv.h5
Total Time to proces all the selected files : 531626 ms
A3Benchmark : Avg precision 0.11111 recall 1.00000 f1 0.20000 time to train 529268.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS34.csv  --epochs 20 --n_iter 3 --patience 3 :: took 538 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS35.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 08:36:57 PM MST
2020-11-30 20:37:03.551458: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 20:37:03.570246: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 20:37:03.571592: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x555a2284b8e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 20:37:03.571637: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 20:37:03.571817: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS35.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00174/8 [==============>...............] - ETA: 0s - loss: 0.00137/8 [=========================>....] - ETA: 0s - loss: 0.00138/8 [==============================] - 0s 18ms/step - loss: 0.0013
1/8 [==>...........................] - ETA: 0s - loss: 0.00164/8 [==============>...............] - ETA: 0s - loss: 0.00337/8 [=========================>....] - ETA: 0s - loss: 0.00258/8 [==============================] - 0s 18ms/step - loss: 0.0025
1/8 [==>...........................] - ETA: 0s - loss: 0.01664/8 [==============>...............] - ETA: 0s - loss: 0.01967/8 [=========================>....] - ETA: 0s - loss: 0.02088/8 [==============================] - 0s 18ms/step - loss: 0.0216
1/8 [==>...........................] - ETA: 0s - loss: 0.00284/8 [==============>...............] - ETA: 0s - loss: 0.00218/8 [==============================] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 15ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.00255/8 [=================>............] - ETA: 0s - loss: 0.00378/8 [==============================] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 16ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.01683/8 [==========>...................] - ETA: 0s - loss: 0.02145/8 [=================>............] - ETA: 0s - loss: 0.02167/8 [=========================>....] - ETA: 0s - loss: 0.02168/8 [==============================] - 0s 23ms/step - loss: 0.0221
1/8 [==>...........................] - ETA: 0s - loss: 0.01703/8 [==========>...................] - ETA: 0s - loss: 0.02416/8 [=====================>........] - ETA: 0s - loss: 0.02278/8 [==============================] - ETA: 0s - loss: 0.02268/8 [==============================] - 0s 30ms/step - loss: 0.0226
1/8 [==>...........................] - ETA: 0s - loss: 0.02033/8 [==========>...................] - ETA: 0s - loss: 0.02705/8 [=================>............] - ETA: 0s - loss: 0.02547/8 [=========================>....] - ETA: 0s - loss: 0.02698/8 [==============================] - 0s 27ms/step - loss: 0.0280
1/8 [==>...........................] - ETA: 0s - loss: 0.01863/8 [==========>...................] - ETA: 0s - loss: 0.02355/8 [=================>............] - ETA: 0s - loss: 0.02267/8 [=========================>....] - ETA: 0s - loss: 0.02398/8 [==============================] - ETA: 0s - loss: 0.02478/8 [==============================] - 0s 55ms/step - loss: 0.0247
1/8 [==>...........................] - ETA: 0s - loss: 0.02723/8 [==========>...................] - ETA: 0s - loss: 0.03445/8 [=================>............] - ETA: 0s - loss: 0.03307/8 [=========================>....] - ETA: 0s - loss: 0.03408/8 [==============================] - 0s 27ms/step - loss: 0.0341
1/8 [==>...........................] - ETA: 0s - loss: 0.01642/8 [======>.......................] - ETA: 1s - loss: 0.02093/8 [==========>...................] - ETA: 1s - loss: 0.02084/8 [==============>...............] - ETA: 1s - loss: 0.02025/8 [=================>............] - ETA: 0s - loss: 0.02116/8 [=====================>........] - ETA: 0s - loss: 0.02118/8 [==============================] - ETA: 0s - loss: 0.02158/8 [==============================] - 1s 169ms/step - loss: 0.0215
1/8 [==>...........................] - ETA: 0s - loss: 0.00232/8 [======>.......................] - ETA: 0s - loss: 0.00463/8 [==========>...................] - ETA: 0s - loss: 0.00404/8 [==============>...............] - ETA: 0s - loss: 0.00426/8 [=====================>........] - ETA: 0s - loss: 0.00388/8 [==============================] - ETA: 0s - loss: 0.00358/8 [==============================] - 0s 59ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.00113/8 [==========>...................] - ETA: 0s - loss: 0.00155/8 [=================>............] - ETA: 0s - loss: 0.00167/8 [=========================>....] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 38ms/step - loss: 0.0022
1/8 [==>...........................] - ETA: 0s - loss: 0.01932/8 [======>.......................] - ETA: 0s - loss: 0.02043/8 [==========>...................] - ETA: 0s - loss: 0.02324/8 [==============>...............] - ETA: 0s - loss: 0.02246/8 [=====================>........] - ETA: 0s - loss: 0.02468/8 [==============================] - ETA: 0s - loss: 0.02518/8 [==============================] - 0s 56ms/step - loss: 0.0251
1/8 [==>...........................] - ETA: 0s - loss: 0.00363/8 [==========>...................] - ETA: 0s - loss: 0.00295/8 [=================>............] - ETA: 0s - loss: 0.00337/8 [=========================>....] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 29ms/step - loss: 0.0038
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.006228099204599857:
Train Score: 0.00223 MSE 0.04717 RMSE
Test Score: 0.00385 MSE 0.06202 RMSE
Deviation Min [6.98102869e-05], Max [0.43694728]
Deviation 99.5th pctile [0.13529157]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1653,    3]))
Confusion matrix 
[[1647    6]
 [   0    3]]
precision 0.33333, recall 1.00000, f1 0.50000
Time to train: 740151 ms
Saving model models/A3Benchmark/A3Benchmark-TS35.csv.h5
Total Time to proces all the selected files : 744738 ms
A3Benchmark : Avg precision 0.33333 recall 1.00000 f1 0.50000 time to train 740151.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS35.csv  --epochs 20 --n_iter 3 --patience 3 :: took 751 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS36.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 08:49:33 PM MST
2020-11-30 20:49:39.920755: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 20:49:39.939247: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 20:49:39.940120: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55c417f3cd30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 20:49:39.940148: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 20:49:39.940271: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS36.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00674/8 [==============>...............] - ETA: 0s - loss: 0.00706/8 [=====================>........] - ETA: 0s - loss: 0.00727/8 [=========================>....] - ETA: 0s - loss: 0.00718/8 [==============================] - 0s 44ms/step - loss: 0.0072
1/8 [==>...........................] - ETA: 0s - loss: 0.00525/8 [=================>............] - ETA: 0s - loss: 0.00758/8 [==============================] - 0s 14ms/step - loss: 0.0072
1/8 [==>...........................] - ETA: 0s - loss: 8.4993e-045/8 [=================>............] - ETA: 0s - loss: 0.0016    8/8 [==============================] - 0s 13ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 0.01334/8 [==============>...............] - ETA: 0s - loss: 0.01327/8 [=========================>....] - ETA: 0s - loss: 0.01518/8 [==============================] - 0s 17ms/step - loss: 0.0155
1/8 [==>...........................] - ETA: 0s - loss: 6.9020e-044/8 [==============>...............] - ETA: 0s - loss: 0.0014    7/8 [=========================>....] - ETA: 0s - loss: 0.00198/8 [==============================] - 0s 16ms/step - loss: 0.0026
1/8 [==>...........................] - ETA: 0s - loss: 0.01062/8 [======>.......................] - ETA: 0s - loss: 0.01143/8 [==========>...................] - ETA: 0s - loss: 0.01094/8 [==============>...............] - ETA: 0s - loss: 0.01135/8 [=================>............] - ETA: 0s - loss: 0.01206/8 [=====================>........] - ETA: 0s - loss: 0.01177/8 [=========================>....] - ETA: 0s - loss: 0.01138/8 [==============================] - 1s 119ms/step - loss: 0.0115
1/8 [==>...........................] - ETA: 0s - loss: 0.00843/8 [==========>...................] - ETA: 0s - loss: 0.01104/8 [==============>...............] - ETA: 0s - loss: 0.01085/8 [=================>............] - ETA: 0s - loss: 0.01186/8 [=====================>........] - ETA: 0s - loss: 0.01228/8 [==============================] - ETA: 0s - loss: 0.01208/8 [==============================] - 0s 48ms/step - loss: 0.0120
1/8 [==>...........................] - ETA: 0s - loss: 0.00133/8 [==========>...................] - ETA: 0s - loss: 0.00315/8 [=================>............] - ETA: 0s - loss: 0.00267/8 [=========================>....] - ETA: 0s - loss: 0.00248/8 [==============================] - 0s 37ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 9.7915e-043/8 [==========>...................] - ETA: 0s - loss: 0.0025    5/8 [=================>............] - ETA: 0s - loss: 0.00217/8 [=========================>....] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 35ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 6.2450e-043/8 [==========>...................] - ETA: 0s - loss: 0.0035    5/8 [=================>............] - ETA: 0s - loss: 0.00317/8 [=========================>....] - ETA: 0s - loss: 0.00328/8 [==============================] - 0s 33ms/step - loss: 0.0039
1/8 [==>...........................] - ETA: 0s - loss: 0.00824/8 [==============>...............] - ETA: 0s - loss: 0.00908/8 [==============================] - ETA: 0s - loss: 0.00948/8 [==============================] - 0s 13ms/step - loss: 0.0094
1/8 [==>...........................] - ETA: 0s - loss: 0.00114/8 [==============>...............] - ETA: 0s - loss: 0.00136/8 [=====================>........] - ETA: 0s - loss: 0.00168/8 [==============================] - ETA: 0s - loss: 0.00168/8 [==============================] - 0s 25ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 0.00124/8 [==============>...............] - ETA: 0s - loss: 0.00247/8 [=========================>....] - ETA: 0s - loss: 0.00208/8 [==============================] - 0s 19ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 4.5213e-044/8 [==============>...............] - ETA: 0s - loss: 7.6651e-048/8 [==============================] - ETA: 0s - loss: 7.7698e-048/8 [==============================] - 0s 15ms/step - loss: 7.7698e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.01153/8 [==========>...................] - ETA: 0s - loss: 0.01935/8 [=================>............] - ETA: 0s - loss: 0.01907/8 [=========================>....] - ETA: 0s - loss: 0.01998/8 [==============================] - ETA: 0s - loss: 0.02048/8 [==============================] - 0s 37ms/step - loss: 0.0204
Best parameters {'n_units': 72, 'n_hidden': 2} best score 0.006398149486631155:
Train Score: 0.00236 MSE 0.04855 RMSE
Test Score: 0.00180 MSE 0.04248 RMSE
Deviation Min [9.15670249e-06], Max [0.35172563]
Deviation 99.5th pctile [0.11720039]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1652,    4]))
Confusion matrix 
[[1647    5]
 [   0    4]]
precision 0.44444, recall 1.00000, f1 0.61538
Time to train: 786812 ms
Saving model models/A3Benchmark/A3Benchmark-TS36.csv.h5
Total Time to proces all the selected files : 791684 ms
A3Benchmark : Avg precision 0.44444 recall 1.00000 f1 0.61538 time to train 786812.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS36.csv  --epochs 20 --n_iter 3 --patience 3 :: took 798 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS37.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 09:02:56 PM MST
2020-11-30 21:03:03.019016: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 21:03:03.025748: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 21:03:03.026518: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55ce08a3dd30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 21:03:03.026540: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 21:03:03.026653: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS37.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00342/8 [======>.......................] - ETA: 0s - loss: 0.00325/8 [=================>............] - ETA: 0s - loss: 0.00398/8 [==============================] - ETA: 0s - loss: 0.00458/8 [==============================] - 0s 26ms/step - loss: 0.0045
1/8 [==>...........................] - ETA: 0s - loss: 0.00274/8 [==============>...............] - ETA: 0s - loss: 0.00457/8 [=========================>....] - ETA: 0s - loss: 0.00438/8 [==============================] - 0s 15ms/step - loss: 0.0042
1/8 [==>...........................] - ETA: 0s - loss: 0.00204/8 [==============>...............] - ETA: 0s - loss: 0.00197/8 [=========================>....] - ETA: 0s - loss: 0.00268/8 [==============================] - 0s 18ms/step - loss: 0.0025
1/8 [==>...........................] - ETA: 0s - loss: 0.00242/8 [======>.......................] - ETA: 0s - loss: 0.00244/8 [==============>...............] - ETA: 0s - loss: 0.00306/8 [=====================>........] - ETA: 0s - loss: 0.00317/8 [=========================>....] - ETA: 0s - loss: 0.00308/8 [==============================] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 50ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00262/8 [======>.......................] - ETA: 0s - loss: 0.00274/8 [==============>...............] - ETA: 0s - loss: 0.00275/8 [=================>............] - ETA: 0s - loss: 0.00266/8 [=====================>........] - ETA: 0s - loss: 0.00258/8 [==============================] - ETA: 0s - loss: 0.00298/8 [==============================] - 1s 88ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00233/8 [==========>...................] - ETA: 0s - loss: 0.00274/8 [==============>...............] - ETA: 0s - loss: 0.00365/8 [=================>............] - ETA: 0s - loss: 0.00386/8 [=====================>........] - ETA: 0s - loss: 0.00468/8 [==============================] - ETA: 0s - loss: 0.00438/8 [==============================] - 0s 54ms/step - loss: 0.0043
1/8 [==>...........................] - ETA: 0s - loss: 0.00293/8 [==========>...................] - ETA: 0s - loss: 0.00325/8 [=================>............] - ETA: 0s - loss: 0.00386/8 [=====================>........] - ETA: 0s - loss: 0.00428/8 [==============================] - ETA: 0s - loss: 0.00408/8 [==============================] - 0s 39ms/step - loss: 0.0040
1/8 [==>...........................] - ETA: 0s - loss: 0.01282/8 [======>.......................] - ETA: 0s - loss: 0.01443/8 [==========>...................] - ETA: 0s - loss: 0.01564/8 [==============>...............] - ETA: 0s - loss: 0.01466/8 [=====================>........] - ETA: 0s - loss: 0.01548/8 [==============================] - 0s 49ms/step - loss: 0.0156
1/8 [==>...........................] - ETA: 0s - loss: 0.00403/8 [==========>...................] - ETA: 0s - loss: 0.00255/8 [=================>............] - ETA: 0s - loss: 0.00367/8 [=========================>....] - ETA: 0s - loss: 0.00358/8 [==============================] - 0s 27ms/step - loss: 0.0034
1/8 [==>...........................] - ETA: 0s - loss: 0.00313/8 [==========>...................] - ETA: 0s - loss: 0.00385/8 [=================>............] - ETA: 0s - loss: 0.00357/8 [=========================>....] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 30ms/step - loss: 0.0038
1/8 [==>...........................] - ETA: 0s - loss: 0.00353/8 [==========>...................] - ETA: 0s - loss: 0.00365/8 [=================>............] - ETA: 0s - loss: 0.00447/8 [=========================>....] - ETA: 0s - loss: 0.00538/8 [==============================] - 0s 34ms/step - loss: 0.0050
1/8 [==>...........................] - ETA: 0s - loss: 0.01312/8 [======>.......................] - ETA: 0s - loss: 0.01563/8 [==========>...................] - ETA: 0s - loss: 0.01544/8 [==============>...............] - ETA: 0s - loss: 0.01745/8 [=================>............] - ETA: 0s - loss: 0.01717/8 [=========================>....] - ETA: 0s - loss: 0.01668/8 [==============================] - 1s 71ms/step - loss: 0.0166
1/8 [==>...........................] - ETA: 0s - loss: 0.00173/8 [==========>...................] - ETA: 0s - loss: 0.00255/8 [=================>............] - ETA: 0s - loss: 0.00247/8 [=========================>....] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 25ms/step - loss: 0.0030
1/8 [==>...........................] - ETA: 0s - loss: 0.00303/8 [==========>...................] - ETA: 0s - loss: 0.00235/8 [=================>............] - ETA: 0s - loss: 0.00337/8 [=========================>....] - ETA: 0s - loss: 0.00328/8 [==============================] - 0s 30ms/step - loss: 0.0031
1/8 [==>...........................] - ETA: 0s - loss: 0.00323/8 [==========>...................] - ETA: 0s - loss: 0.00385/8 [=================>............] - ETA: 0s - loss: 0.00357/8 [=========================>....] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 32ms/step - loss: 0.0038
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0034144827630370857:
Train Score: 0.00365 MSE 0.06043 RMSE
Test Score: 0.00433 MSE 0.06582 RMSE
Deviation Min [5.1186284e-05], Max [0.42719674]
Deviation 99.5th pctile [0.25503369]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1646,   10]))
Confusion matrix 
[[1645    1]
 [   2    8]]
precision 0.88889, recall 0.80000, f1 0.84211
Time to train: 1113604 ms
Saving model models/A3Benchmark/A3Benchmark-TS37.csv.h5
Total Time to proces all the selected files : 1116191 ms
A3Benchmark : Avg precision 0.88889 recall 0.80000 f1 0.84211 time to train 1113604.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS37.csv  --epochs 20 --n_iter 3 --patience 3 :: took 1122 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS38.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 09:21:44 PM MST
2020-11-30 21:21:50.899560: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 21:21:50.918207: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 21:21:50.919613: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55c244f27c00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 21:21:50.919660: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 21:21:50.919961: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS38.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00354/8 [==============>...............] - ETA: 0s - loss: 0.00377/8 [=========================>....] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 19ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.00234/8 [==============>...............] - ETA: 0s - loss: 0.00287/8 [=========================>....] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 18ms/step - loss: 0.0030
1/8 [==>...........................] - ETA: 0s - loss: 0.00265/8 [=================>............] - ETA: 0s - loss: 0.00338/8 [==============================] - 0s 14ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.00335/8 [=================>............] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 13ms/step - loss: 0.0040
1/8 [==>...........................] - ETA: 0s - loss: 0.00234/8 [==============>...............] - ETA: 0s - loss: 0.00297/8 [=========================>....] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 24ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00366/8 [=====================>........] - ETA: 0s - loss: 0.00358/8 [==============================] - 0s 10ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.00254/8 [==============>...............] - ETA: 0s - loss: 0.00308/8 [==============================] - ETA: 0s - loss: 0.00318/8 [==============================] - 0s 18ms/step - loss: 0.0031
1/8 [==>...........................] - ETA: 0s - loss: 0.00263/8 [==========>...................] - ETA: 0s - loss: 0.00376/8 [=====================>........] - ETA: 0s - loss: 0.00358/8 [==============================] - 0s 29ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.00282/8 [======>.......................] - ETA: 0s - loss: 0.00275/8 [=================>............] - ETA: 0s - loss: 0.00338/8 [==============================] - 0s 26ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 8.5235e-044/8 [==============>...............] - ETA: 0s - loss: 0.0013    7/8 [=========================>....] - ETA: 0s - loss: 0.00128/8 [==============================] - 0s 15ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 0.00533/8 [==========>...................] - ETA: 0s - loss: 0.00495/8 [=================>............] - ETA: 0s - loss: 0.00557/8 [=========================>....] - ETA: 0s - loss: 0.00508/8 [==============================] - 0s 33ms/step - loss: 0.0050
1/8 [==>...........................] - ETA: 0s - loss: 0.00323/8 [==========>...................] - ETA: 0s - loss: 0.00385/8 [=================>............] - ETA: 0s - loss: 0.00378/8 [==============================] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 24ms/step - loss: 0.0038
1/8 [==>...........................] - ETA: 0s - loss: 0.00332/8 [======>.......................] - ETA: 0s - loss: 0.00383/8 [==========>...................] - ETA: 0s - loss: 0.00405/8 [=================>............] - ETA: 0s - loss: 0.00376/8 [=====================>........] - ETA: 0s - loss: 0.00388/8 [==============================] - ETA: 0s - loss: 0.00398/8 [==============================] - 1s 67ms/step - loss: 0.0039
1/8 [==>...........................] - ETA: 0s - loss: 0.00283/8 [==========>...................] - ETA: 0s - loss: 0.00345/8 [=================>............] - ETA: 0s - loss: 0.00347/8 [=========================>....] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 28ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.00342/8 [======>.......................] - ETA: 0s - loss: 0.00393/8 [==========>...................] - ETA: 0s - loss: 0.00494/8 [==============>...............] - ETA: 0s - loss: 0.00455/8 [=================>............] - ETA: 0s - loss: 0.00437/8 [=========================>....] - ETA: 0s - loss: 0.00438/8 [==============================] - ETA: 0s - loss: 0.00438/8 [==============================] - 1s 109ms/step - loss: 0.0043
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.003023598296567798:
Train Score: 0.00293 MSE 0.05412 RMSE
Test Score: 0.00260 MSE 0.05099 RMSE
Deviation Min [8.00740447e-05], Max [0.19427462]
Deviation 99.5th pctile [0.12609416]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1653,    3]))
Confusion matrix 
[[1646    7]
 [   1    2]]
precision 0.22222, recall 0.66667, f1 0.33333
Time to train: 573802 ms
Saving model models/A3Benchmark/A3Benchmark-TS38.csv.h5
Total Time to proces all the selected files : 576353 ms
A3Benchmark : Avg precision 0.22222 recall 0.66667 f1 0.33333 time to train 573802.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS38.csv  --epochs 20 --n_iter 3 --patience 3 :: took 583 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS39.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 09:31:32 PM MST
2020-11-30 21:31:39.435311: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 21:31:39.454220: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 21:31:39.455297: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x564e98cd5c00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 21:31:39.455343: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 21:31:39.455517: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS39.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00214/8 [==============>...............] - ETA: 0s - loss: 0.00197/8 [=========================>....] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 18ms/step - loss: 0.0018
1/8 [==>...........................] - ETA: 0s - loss: 0.00134/8 [==============>...............] - ETA: 0s - loss: 0.00168/8 [==============================] - ETA: 0s - loss: 0.00168/8 [==============================] - 0s 15ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 0.00194/8 [==============>...............] - ETA: 0s - loss: 0.00197/8 [=========================>....] - ETA: 0s - loss: 0.00208/8 [==============================] - 0s 15ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.00154/8 [==============>...............] - ETA: 0s - loss: 0.00187/8 [=========================>....] - ETA: 0s - loss: 0.00198/8 [==============================] - 0s 16ms/step - loss: 0.0019
1/8 [==>...........................] - ETA: 0s - loss: 0.00134/8 [==============>...............] - ETA: 0s - loss: 0.00188/8 [==============================] - ETA: 0s - loss: 0.00208/8 [==============================] - 0s 16ms/step - loss: 0.0020
1/8 [==>...........................] - ETA: 0s - loss: 0.00183/8 [==========>...................] - ETA: 0s - loss: 0.00195/8 [=================>............] - ETA: 0s - loss: 0.00207/8 [=========================>....] - ETA: 0s - loss: 0.00198/8 [==============================] - ETA: 0s - loss: 0.00198/8 [==============================] - 0s 37ms/step - loss: 0.0019
1/8 [==>...........................] - ETA: 0s - loss: 0.00173/8 [==========>...................] - ETA: 0s - loss: 0.00215/8 [=================>............] - ETA: 0s - loss: 0.00207/8 [=========================>....] - ETA: 0s - loss: 0.00198/8 [==============================] - 0s 30ms/step - loss: 0.0020
1/8 [==>...........................] - ETA: 0s - loss: 0.00302/8 [======>.......................] - ETA: 0s - loss: 0.00323/8 [==========>...................] - ETA: 0s - loss: 0.00354/8 [==============>...............] - ETA: 0s - loss: 0.00315/8 [=================>............] - ETA: 0s - loss: 0.00296/8 [=====================>........] - ETA: 0s - loss: 0.00317/8 [=========================>....] - ETA: 0s - loss: 0.00318/8 [==============================] - ETA: 0s - loss: 0.00328/8 [==============================] - 1s 82ms/step - loss: 0.0032
1/8 [==>...........................] - ETA: 0s - loss: 0.00163/8 [==========>...................] - ETA: 0s - loss: 0.00194/8 [==============>...............] - ETA: 0s - loss: 0.00195/8 [=================>............] - ETA: 0s - loss: 0.00196/8 [=====================>........] - ETA: 0s - loss: 0.00217/8 [=========================>....] - ETA: 0s - loss: 0.00208/8 [==============================] - ETA: 0s - loss: 0.00208/8 [==============================] - 1s 76ms/step - loss: 0.0020
1/8 [==>...........................] - ETA: 0s - loss: 0.00162/8 [======>.......................] - ETA: 0s - loss: 0.00184/8 [==============>...............] - ETA: 0s - loss: 0.00215/8 [=================>............] - ETA: 0s - loss: 0.00216/8 [=====================>........] - ETA: 0s - loss: 0.00207/8 [=========================>....] - ETA: 0s - loss: 0.00208/8 [==============================] - ETA: 0s - loss: 0.00208/8 [==============================] - 1s 91ms/step - loss: 0.0020
1/8 [==>...........................] - ETA: 0s - loss: 0.00682/8 [======>.......................] - ETA: 0s - loss: 0.00563/8 [==========>...................] - ETA: 0s - loss: 0.00534/8 [==============>...............] - ETA: 0s - loss: 0.00535/8 [=================>............] - ETA: 0s - loss: 0.00536/8 [=====================>........] - ETA: 0s - loss: 0.00487/8 [=========================>....] - ETA: 0s - loss: 0.00448/8 [==============================] - ETA: 0s - loss: 0.00428/8 [==============================] - 1s 101ms/step - loss: 0.0042
1/8 [==>...........................] - ETA: 0s - loss: 0.00153/8 [==========>...................] - ETA: 0s - loss: 0.00205/8 [=================>............] - ETA: 0s - loss: 0.00197/8 [=========================>....] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 30ms/step - loss: 0.0019
1/8 [==>...........................] - ETA: 0s - loss: 0.00173/8 [==========>...................] - ETA: 0s - loss: 0.00215/8 [=================>............] - ETA: 0s - loss: 0.00217/8 [=========================>....] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 26ms/step - loss: 0.0022
1/8 [==>...........................] - ETA: 0s - loss: 0.00182/8 [======>.......................] - ETA: 0s - loss: 0.00184/8 [==============>...............] - ETA: 0s - loss: 0.00215/8 [=================>............] - ETA: 0s - loss: 0.00216/8 [=====================>........] - ETA: 0s - loss: 0.00237/8 [=========================>....] - ETA: 0s - loss: 0.00228/8 [==============================] - 1s 90ms/step - loss: 0.0022
1/8 [==>...........................] - ETA: 0s - loss: 0.00163/8 [==========>...................] - ETA: 0s - loss: 0.00235/8 [=================>............] - ETA: 0s - loss: 0.00217/8 [=========================>....] - ETA: 0s - loss: 0.00208/8 [==============================] - 0s 33ms/step - loss: 0.0020
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0018832465168088675:
Train Score: 0.00160 MSE 0.04004 RMSE
Test Score: 0.00294 MSE 0.05419 RMSE
Deviation Min [2.90481827e-06], Max [0.15556237]
Deviation 99.5th pctile [0.11245244]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1644,   12]))
Confusion matrix 
[[1639    5]
 [   8    4]]
precision 0.44444, recall 0.33333, f1 0.38095
Time to train: 675966 ms
Saving model models/A3Benchmark/A3Benchmark-TS39.csv.h5
Total Time to proces all the selected files : 681074 ms
A3Benchmark : Avg precision 0.44444 recall 0.33333 f1 0.38095 time to train 675966.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS39.csv  --epochs 20 --n_iter 3 --patience 3 :: took 688 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS3.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 09:43:05 PM MST
2020-11-30 21:43:11.952717: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 21:43:11.971318: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 21:43:11.972879: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55572ceddd30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 21:43:11.972933: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 21:43:11.973161: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS3.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00763/8 [==========>...................] - ETA: 0s - loss: 0.00725/8 [=================>............] - ETA: 0s - loss: 0.00807/8 [=========================>....] - ETA: 0s - loss: 0.00728/8 [==============================] - 0s 24ms/step - loss: 0.0072
1/8 [==>...........................] - ETA: 0s - loss: 0.00443/8 [==========>...................] - ETA: 0s - loss: 0.00575/8 [=================>............] - ETA: 0s - loss: 0.00567/8 [=========================>....] - ETA: 0s - loss: 0.00558/8 [==============================] - 0s 34ms/step - loss: 0.0057
1/8 [==>...........................] - ETA: 0s - loss: 0.00493/8 [==========>...................] - ETA: 0s - loss: 0.00614/8 [==============>...............] - ETA: 0s - loss: 0.00575/8 [=================>............] - ETA: 0s - loss: 0.00587/8 [=========================>....] - ETA: 0s - loss: 0.00598/8 [==============================] - 0s 53ms/step - loss: 0.0060
1/8 [==>...........................] - ETA: 0s - loss: 0.00573/8 [==========>...................] - ETA: 0s - loss: 0.00654/8 [==============>...............] - ETA: 0s - loss: 0.00656/8 [=====================>........] - ETA: 0s - loss: 0.00718/8 [==============================] - ETA: 0s - loss: 0.00698/8 [==============================] - 0s 47ms/step - loss: 0.0069
1/8 [==>...........................] - ETA: 0s - loss: 8.8273e-043/8 [==========>...................] - ETA: 0s - loss: 8.5505e-045/8 [=================>............] - ETA: 0s - loss: 0.0011    7/8 [=========================>....] - ETA: 0s - loss: 0.00138/8 [==============================] - 0s 31ms/step - loss: 0.0013
1/8 [==>...........................] - ETA: 0s - loss: 0.00573/8 [==========>...................] - ETA: 0s - loss: 0.00625/8 [=================>............] - ETA: 0s - loss: 0.00697/8 [=========================>....] - ETA: 0s - loss: 0.00648/8 [==============================] - 0s 32ms/step - loss: 0.0065
1/8 [==>...........................] - ETA: 0s - loss: 0.00223/8 [==========>...................] - ETA: 0s - loss: 0.00245/8 [=================>............] - ETA: 0s - loss: 0.00177/8 [=========================>....] - ETA: 0s - loss: 0.00208/8 [==============================] - 0s 30ms/step - loss: 0.0020
1/8 [==>...........................] - ETA: 0s - loss: 0.00502/8 [======>.......................] - ETA: 0s - loss: 0.00583/8 [==========>...................] - ETA: 0s - loss: 0.00614/8 [==============>...............] - ETA: 0s - loss: 0.00585/8 [=================>............] - ETA: 0s - loss: 0.00606/8 [=====================>........] - ETA: 0s - loss: 0.00617/8 [=========================>....] - ETA: 0s - loss: 0.00598/8 [==============================] - ETA: 0s - loss: 0.00608/8 [==============================] - 1s 107ms/step - loss: 0.0060
1/8 [==>...........................] - ETA: 0s - loss: 0.00673/8 [==========>...................] - ETA: 0s - loss: 0.00734/8 [==============>...............] - ETA: 0s - loss: 0.00735/8 [=================>............] - ETA: 0s - loss: 0.00756/8 [=====================>........] - ETA: 0s - loss: 0.00828/8 [==============================] - ETA: 0s - loss: 0.00808/8 [==============================] - 0s 44ms/step - loss: 0.0080
1/8 [==>...........................] - ETA: 0s - loss: 0.00352/8 [======>.......................] - ETA: 0s - loss: 0.00354/8 [==============>...............] - ETA: 0s - loss: 0.00336/8 [=====================>........] - ETA: 0s - loss: 0.00387/8 [=========================>....] - ETA: 0s - loss: 0.00398/8 [==============================] - ETA: 0s - loss: 0.00398/8 [==============================] - 0s 48ms/step - loss: 0.0039
1/8 [==>...........................] - ETA: 0s - loss: 0.00554/8 [==============>...............] - ETA: 0s - loss: 0.00607/8 [=========================>....] - ETA: 0s - loss: 0.00568/8 [==============================] - 0s 19ms/step - loss: 0.0056
1/8 [==>...........................] - ETA: 0s - loss: 0.00304/8 [==============>...............] - ETA: 0s - loss: 0.00386/8 [=====================>........] - ETA: 0s - loss: 0.00398/8 [==============================] - 0s 22ms/step - loss: 0.0038
1/8 [==>...........................] - ETA: 0s - loss: 0.00494/8 [==============>...............] - ETA: 0s - loss: 0.00588/8 [==============================] - 0s 13ms/step - loss: 0.0061
1/8 [==>...........................] - ETA: 0s - loss: 0.00565/8 [=================>............] - ETA: 0s - loss: 0.00628/8 [==============================] - 0s 13ms/step - loss: 0.0065
1/8 [==>...........................] - ETA: 0s - loss: 2.3529e-044/8 [==============>...............] - ETA: 0s - loss: 5.5219e-048/8 [==============================] - ETA: 0s - loss: 6.8133e-048/8 [==============================] - 0s 16ms/step - loss: 6.8133e-04
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.004552192578557879:
Train Score: 0.00487 MSE 0.06979 RMSE
Test Score: 0.00497 MSE 0.07052 RMSE
Deviation Min [4.90909331e-05], Max [0.26473239]
Deviation 99.5th pctile [0.15307877]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1650,    6]))
Confusion matrix 
[[1645    5]
 [   2    4]]
precision 0.44444, recall 0.66667, f1 0.53333
Time to train: 988790 ms
Saving model models/A3Benchmark/A3Benchmark-TS3.csv.h5
Total Time to proces all the selected files : 993120 ms
A3Benchmark : Avg precision 0.44444 recall 0.66667 f1 0.53333 time to train 988790.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS3.csv  --epochs 20 --n_iter 3 --patience 3 :: took 1000 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS40.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 09:59:50 PM MST
2020-11-30 21:59:56.866512: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 21:59:56.885088: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 21:59:56.885812: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f5b9602d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 21:59:56.885838: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 21:59:56.885969: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS40.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00343/8 [==========>...................] - ETA: 0s - loss: 0.00375/8 [=================>............] - ETA: 0s - loss: 0.00366/8 [=====================>........] - ETA: 0s - loss: 0.00378/8 [==============================] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 34ms/step - loss: 0.0038
1/8 [==>...........................] - ETA: 0s - loss: 0.00214/8 [==============>...............] - ETA: 0s - loss: 0.00306/8 [=====================>........] - ETA: 0s - loss: 0.00318/8 [==============================] - ETA: 0s - loss: 0.00308/8 [==============================] - 0s 22ms/step - loss: 0.0030
1/8 [==>...........................] - ETA: 0s - loss: 0.00303/8 [==========>...................] - ETA: 0s - loss: 0.00395/8 [=================>............] - ETA: 0s - loss: 0.00347/8 [=========================>....] - ETA: 0s - loss: 0.00338/8 [==============================] - 0s 28ms/step - loss: 0.0034
1/8 [==>...........................] - ETA: 0s - loss: 0.00224/8 [==============>...............] - ETA: 0s - loss: 0.00286/8 [=====================>........] - ETA: 0s - loss: 0.00308/8 [==============================] - 0s 23ms/step - loss: 0.0032
1/8 [==>...........................] - ETA: 0s - loss: 0.00523/8 [==========>...................] - ETA: 0s - loss: 0.00535/8 [=================>............] - ETA: 0s - loss: 0.00647/8 [=========================>....] - ETA: 0s - loss: 0.00708/8 [==============================] - 0s 30ms/step - loss: 0.0072
1/8 [==>...........................] - ETA: 0s - loss: 0.00224/8 [==============>...............] - ETA: 0s - loss: 0.00237/8 [=========================>....] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 17ms/step - loss: 0.0024
1/8 [==>...........................] - ETA: 0s - loss: 0.00194/8 [==============>...............] - ETA: 0s - loss: 0.00277/8 [=========================>....] - ETA: 0s - loss: 0.00278/8 [==============================] - 0s 17ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 0.00172/8 [======>.......................] - ETA: 0s - loss: 0.00193/8 [==========>...................] - ETA: 0s - loss: 0.00254/8 [==============>...............] - ETA: 0s - loss: 0.00235/8 [=================>............] - ETA: 0s - loss: 0.00236/8 [=====================>........] - ETA: 0s - loss: 0.00238/8 [==============================] - ETA: 0s - loss: 0.00238/8 [==============================] - 1s 83ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.00172/8 [======>.......................] - ETA: 0s - loss: 0.00204/8 [==============>...............] - ETA: 0s - loss: 0.00206/8 [=====================>........] - ETA: 0s - loss: 0.00227/8 [=========================>....] - ETA: 0s - loss: 0.00238/8 [==============================] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 59ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.00544/8 [==============>...............] - ETA: 0s - loss: 0.00587/8 [=========================>....] - ETA: 0s - loss: 0.00698/8 [==============================] - 0s 18ms/step - loss: 0.0070
1/8 [==>...........................] - ETA: 0s - loss: 0.00264/8 [==============>...............] - ETA: 0s - loss: 0.00277/8 [=========================>....] - ETA: 0s - loss: 0.00288/8 [==============================] - 0s 15ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00193/8 [==========>...................] - ETA: 0s - loss: 0.00255/8 [=================>............] - ETA: 0s - loss: 0.00297/8 [=========================>....] - ETA: 0s - loss: 0.00288/8 [==============================] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 40ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00175/8 [=================>............] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 13ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.00285/8 [=================>............] - ETA: 0s - loss: 0.00398/8 [==============================] - ETA: 0s - loss: 0.00428/8 [==============================] - 0s 16ms/step - loss: 0.0042
1/8 [==>...........................] - ETA: 0s - loss: 0.00434/8 [==============>...............] - ETA: 0s - loss: 0.00487/8 [=========================>....] - ETA: 0s - loss: 0.00588/8 [==============================] - 0s 17ms/step - loss: 0.0060
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0033598096575587987:
Train Score: 0.00284 MSE 0.05331 RMSE
Test Score: 0.00845 MSE 0.09194 RMSE
Deviation Min [6.94259351e-05], Max [0.20588407]
Deviation 99.5th pctile [0.15926393]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1646,   10]))
Confusion matrix 
[[1641    5]
 [   6    4]]
precision 0.44444, recall 0.40000, f1 0.42105
Time to train: 386800 ms
Saving model models/A3Benchmark/A3Benchmark-TS40.csv.h5
Total Time to proces all the selected files : 389531 ms
A3Benchmark : Avg precision 0.44444 recall 0.40000 f1 0.42105 time to train 386800.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS40.csv  --epochs 20 --n_iter 3 --patience 3 :: took 396 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS41.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 10:06:31 PM MST
2020-11-30 22:06:37.989915: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 22:06:38.008233: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 22:06:38.009693: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55783cd66d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 22:06:38.009742: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 22:06:38.009945: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS41.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.01843/8 [==========>...................] - ETA: 0s - loss: 0.02565/8 [=================>............] - ETA: 0s - loss: 0.02527/8 [=========================>....] - ETA: 0s - loss: 0.02348/8 [==============================] - 0s 28ms/step - loss: 0.0239
1/8 [==>...........................] - ETA: 0s - loss: 0.00202/8 [======>.......................] - ETA: 0s - loss: 0.00294/8 [==============>...............] - ETA: 0s - loss: 0.00336/8 [=====================>........] - ETA: 0s - loss: 0.00308/8 [==============================] - ETA: 0s - loss: 0.00308/8 [==============================] - 0s 30ms/step - loss: 0.0030
1/8 [==>...........................] - ETA: 0s - loss: 0.01763/8 [==========>...................] - ETA: 0s - loss: 0.02195/8 [=================>............] - ETA: 0s - loss: 0.02237/8 [=========================>....] - ETA: 0s - loss: 0.02168/8 [==============================] - 0s 34ms/step - loss: 0.0226
1/8 [==>...........................] - ETA: 0s - loss: 0.00683/8 [==========>...................] - ETA: 0s - loss: 0.00595/8 [=================>............] - ETA: 0s - loss: 0.00497/8 [=========================>....] - ETA: 0s - loss: 0.00528/8 [==============================] - 0s 26ms/step - loss: 0.0050
1/8 [==>...........................] - ETA: 0s - loss: 0.00263/8 [==========>...................] - ETA: 0s - loss: 0.00255/8 [=================>............] - ETA: 0s - loss: 0.00217/8 [=========================>....] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 26ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 0.01833/8 [==========>...................] - ETA: 0s - loss: 0.02534/8 [==============>...............] - ETA: 0s - loss: 0.02485/8 [=================>............] - ETA: 0s - loss: 0.02506/8 [=====================>........] - ETA: 0s - loss: 0.02427/8 [=========================>....] - ETA: 0s - loss: 0.02328/8 [==============================] - ETA: 0s - loss: 0.02368/8 [==============================] - 1s 78ms/step - loss: 0.0236
1/8 [==>...........................] - ETA: 0s - loss: 0.00172/8 [======>.......................] - ETA: 0s - loss: 0.00223/8 [==========>...................] - ETA: 0s - loss: 0.00284/8 [==============>...............] - ETA: 0s - loss: 0.00415/8 [=================>............] - ETA: 0s - loss: 0.00436/8 [=====================>........] - ETA: 0s - loss: 0.00387/8 [=========================>....] - ETA: 0s - loss: 0.00368/8 [==============================] - ETA: 0s - loss: 0.00368/8 [==============================] - 1s 131ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.00163/8 [==========>...................] - ETA: 0s - loss: 0.00365/8 [=================>............] - ETA: 0s - loss: 0.00377/8 [=========================>....] - ETA: 0s - loss: 0.00388/8 [==============================] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 35ms/step - loss: 0.0038
1/8 [==>...........................] - ETA: 0s - loss: 0.01853/8 [==========>...................] - ETA: 0s - loss: 0.02145/8 [=================>............] - ETA: 0s - loss: 0.02058/8 [==============================] - ETA: 0s - loss: 0.02198/8 [==============================] - 0s 40ms/step - loss: 0.0219
1/8 [==>...........................] - ETA: 0s - loss: 0.01762/8 [======>.......................] - ETA: 0s - loss: 0.01913/8 [==========>...................] - ETA: 0s - loss: 0.02254/8 [==============>...............] - ETA: 0s - loss: 0.02145/8 [=================>............] - ETA: 0s - loss: 0.02156/8 [=====================>........] - ETA: 0s - loss: 0.02197/8 [=========================>....] - ETA: 0s - loss: 0.02208/8 [==============================] - ETA: 0s - loss: 0.02238/8 [==============================] - 1s 143ms/step - loss: 0.0223
1/8 [==>...........................] - ETA: 0s - loss: 0.00354/8 [==============>...............] - ETA: 0s - loss: 0.00627/8 [=========================>....] - ETA: 0s - loss: 0.00548/8 [==============================] - 0s 18ms/step - loss: 0.0052
1/8 [==>...........................] - ETA: 0s - loss: 0.01424/8 [==============>...............] - ETA: 0s - loss: 0.01798/8 [==============================] - ETA: 0s - loss: 0.01898/8 [==============================] - 0s 15ms/step - loss: 0.0189
1/8 [==>...........................] - ETA: 0s - loss: 0.00565/8 [=================>............] - ETA: 0s - loss: 0.00738/8 [==============================] - 0s 13ms/step - loss: 0.0072
1/8 [==>...........................] - ETA: 0s - loss: 0.00846/8 [=====================>........] - ETA: 0s - loss: 0.00418/8 [==============================] - 0s 11ms/step - loss: 0.0043
1/8 [==>...........................] - ETA: 0s - loss: 0.00465/8 [=================>............] - ETA: 0s - loss: 0.00487/8 [=========================>....] - ETA: 0s - loss: 0.00588/8 [==============================] - 0s 24ms/step - loss: 0.0059
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.008292983938008546:
Train Score: 0.00336 MSE 0.05797 RMSE
Test Score: 0.00417 MSE 0.06459 RMSE
Deviation Min [6.44349449e-05], Max [0.44010259]
Deviation 99.5th pctile [0.35229233]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1642,   14]))
Confusion matrix 
[[1642    0]
 [   5    9]]
precision 1.00000, recall 0.64286, f1 0.78261
Time to train: 953650 ms
Saving model models/A3Benchmark/A3Benchmark-TS41.csv.h5
Total Time to proces all the selected files : 957753 ms
A3Benchmark : Avg precision 1.00000 recall 0.64286 f1 0.78261 time to train 953650.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS41.csv  --epochs 20 --n_iter 3 --patience 3 :: took 965 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS42.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 10:22:41 PM MST
2020-11-30 22:22:47.257201: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 22:22:47.276225: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 22:22:47.277168: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x560c9e5b3310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 22:22:47.277193: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 22:22:47.277315: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS42.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00463/8 [==========>...................] - ETA: 0s - loss: 0.00475/8 [=================>............] - ETA: 0s - loss: 0.00477/8 [=========================>....] - ETA: 0s - loss: 0.00508/8 [==============================] - 0s 33ms/step - loss: 0.0053
1/8 [==>...........................] - ETA: 0s - loss: 0.00303/8 [==========>...................] - ETA: 0s - loss: 0.00375/8 [=================>............] - ETA: 0s - loss: 0.00417/8 [=========================>....] - ETA: 0s - loss: 0.00398/8 [==============================] - 0s 33ms/step - loss: 0.0040
1/8 [==>...........................] - ETA: 0s - loss: 0.00313/8 [==========>...................] - ETA: 0s - loss: 0.00395/8 [=================>............] - ETA: 0s - loss: 0.00367/8 [=========================>....] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 29ms/step - loss: 0.0038
1/8 [==>...........................] - ETA: 0s - loss: 0.00283/8 [==========>...................] - ETA: 0s - loss: 0.00425/8 [=================>............] - ETA: 0s - loss: 0.00417/8 [=========================>....] - ETA: 0s - loss: 0.00428/8 [==============================] - 0s 24ms/step - loss: 0.0045
1/8 [==>...........................] - ETA: 0s - loss: 0.00723/8 [==========>...................] - ETA: 0s - loss: 0.00635/8 [=================>............] - ETA: 0s - loss: 0.00707/8 [=========================>....] - ETA: 0s - loss: 0.00808/8 [==============================] - 0s 23ms/step - loss: 0.0081
1/8 [==>...........................] - ETA: 0s - loss: 0.00274/8 [==============>...............] - ETA: 0s - loss: 0.00337/8 [=========================>....] - ETA: 0s - loss: 0.00358/8 [==============================] - 0s 15ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.00255/8 [=================>............] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 14ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.00254/8 [==============>...............] - ETA: 0s - loss: 0.00306/8 [=====================>........] - ETA: 0s - loss: 0.00318/8 [==============================] - ETA: 0s - loss: 0.00318/8 [==============================] - 0s 21ms/step - loss: 0.0031
1/8 [==>...........................] - ETA: 0s - loss: 0.00282/8 [======>.......................] - ETA: 0s - loss: 0.00373/8 [==========>...................] - ETA: 0s - loss: 0.00375/8 [=================>............] - ETA: 0s - loss: 0.00377/8 [=========================>....] - ETA: 0s - loss: 0.00378/8 [==============================] - 0s 42ms/step - loss: 0.0039
1/8 [==>...........................] - ETA: 0s - loss: 0.00444/8 [==============>...............] - ETA: 0s - loss: 0.00386/8 [=====================>........] - ETA: 0s - loss: 0.00468/8 [==============================] - 0s 23ms/step - loss: 0.0049
1/8 [==>...........................] - ETA: 0s - loss: 0.00372/8 [======>.......................] - ETA: 0s - loss: 0.00423/8 [==========>...................] - ETA: 0s - loss: 0.00404/8 [==============>...............] - ETA: 0s - loss: 0.00405/8 [=================>............] - ETA: 0s - loss: 0.00416/8 [=====================>........] - ETA: 0s - loss: 0.00447/8 [=========================>....] - ETA: 0s - loss: 0.00448/8 [==============================] - ETA: 0s - loss: 0.00468/8 [==============================] - 1s 86ms/step - loss: 0.0046
1/8 [==>...........................] - ETA: 0s - loss: 0.00293/8 [==========>...................] - ETA: 0s - loss: 0.00365/8 [=================>............] - ETA: 0s - loss: 0.00396/8 [=====================>........] - ETA: 0s - loss: 0.00398/8 [==============================] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 36ms/step - loss: 0.0038
1/8 [==>...........................] - ETA: 0s - loss: 0.00293/8 [==========>...................] - ETA: 0s - loss: 0.00345/8 [=================>............] - ETA: 0s - loss: 0.00397/8 [=========================>....] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 28ms/step - loss: 0.0039
1/8 [==>...........................] - ETA: 0s - loss: 0.00322/8 [======>.......................] - ETA: 0s - loss: 0.00483/8 [==========>...................] - ETA: 0s - loss: 0.00484/8 [==============>...............] - ETA: 0s - loss: 0.00475/8 [=================>............] - ETA: 0s - loss: 0.00486/8 [=====================>........] - ETA: 0s - loss: 0.00477/8 [=========================>....] - ETA: 0s - loss: 0.00488/8 [==============================] - ETA: 0s - loss: 0.00518/8 [==============================] - 1s 82ms/step - loss: 0.0051
1/8 [==>...........................] - ETA: 0s - loss: 0.01353/8 [==========>...................] - ETA: 0s - loss: 0.01205/8 [=================>............] - ETA: 0s - loss: 0.01307/8 [=========================>....] - ETA: 0s - loss: 0.01448/8 [==============================] - 0s 27ms/step - loss: 0.0146
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.003810232738032937:
Train Score: 0.00361 MSE 0.06010 RMSE
Test Score: 0.00961 MSE 0.09804 RMSE
Deviation Min [4.30434674e-05], Max [0.23614973]
Deviation 99.5th pctile [0.18623036]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1640,   16]))
Confusion matrix 
[[1634    6]
 [  13    3]]
precision 0.33333, recall 0.18750, f1 0.24000
Time to train: 453586 ms
Saving model models/A3Benchmark/A3Benchmark-TS42.csv.h5
Total Time to proces all the selected files : 456056 ms
A3Benchmark : Avg precision 0.33333 recall 0.18750 f1 0.24000 time to train 453586.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS42.csv  --epochs 20 --n_iter 3 --patience 3 :: took 462 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS43.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 10:30:28 PM MST
2020-11-30 22:30:34.538035: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 22:30:34.556063: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 22:30:34.556844: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5608dc116310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 22:30:34.556892: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 22:30:34.557009: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS43.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00162/8 [======>.......................] - ETA: 0s - loss: 0.00193/8 [==========>...................] - ETA: 0s - loss: 0.00224/8 [==============>...............] - ETA: 0s - loss: 0.00216/8 [=====================>........] - ETA: 0s - loss: 0.00247/8 [=========================>....] - ETA: 0s - loss: 0.00308/8 [==============================] - ETA: 0s - loss: 0.00348/8 [==============================] - 1s 94ms/step - loss: 0.0034
1/8 [==>...........................] - ETA: 0s - loss: 0.00232/8 [======>.......................] - ETA: 0s - loss: 0.00214/8 [==============>...............] - ETA: 0s - loss: 0.00185/8 [=================>............] - ETA: 0s - loss: 0.00187/8 [=========================>....] - ETA: 0s - loss: 0.00198/8 [==============================] - 1s 70ms/step - loss: 0.0019
1/8 [==>...........................] - ETA: 0s - loss: 0.00173/8 [==========>...................] - ETA: 0s - loss: 0.00244/8 [==============>...............] - ETA: 0s - loss: 0.00225/8 [=================>............] - ETA: 0s - loss: 0.00226/8 [=====================>........] - ETA: 0s - loss: 0.00237/8 [=========================>....] - ETA: 0s - loss: 0.00238/8 [==============================] - 1s 65ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.00215/8 [=================>............] - ETA: 0s - loss: 0.00238/8 [==============================] - ETA: 0s - loss: 0.00258/8 [==============================] - 0s 17ms/step - loss: 0.0025
1/8 [==>...........................] - ETA: 0s - loss: 0.00162/8 [======>.......................] - ETA: 0s - loss: 0.00194/8 [==============>...............] - ETA: 0s - loss: 0.00196/8 [=====================>........] - ETA: 0s - loss: 0.00218/8 [==============================] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 60ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.00405/8 [=================>............] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 13ms/step - loss: 0.0032
1/8 [==>...........................] - ETA: 0s - loss: 0.00244/8 [==============>...............] - ETA: 0s - loss: 0.00197/8 [=========================>....] - ETA: 0s - loss: 0.00198/8 [==============================] - 0s 16ms/step - loss: 0.0019
1/8 [==>...........................] - ETA: 0s - loss: 0.00174/8 [==============>...............] - ETA: 0s - loss: 0.00247/8 [=========================>....] - ETA: 0s - loss: 0.00248/8 [==============================] - 0s 16ms/step - loss: 0.0025
1/8 [==>...........................] - ETA: 0s - loss: 0.00154/8 [==============>...............] - ETA: 0s - loss: 0.00187/8 [=========================>....] - ETA: 0s - loss: 0.00198/8 [==============================] - 0s 15ms/step - loss: 0.0020
1/8 [==>...........................] - ETA: 0s - loss: 0.00175/8 [=================>............] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 14ms/step - loss: 0.0024
1/8 [==>...........................] - ETA: 0s - loss: 0.00223/8 [==========>...................] - ETA: 0s - loss: 0.00255/8 [=================>............] - ETA: 0s - loss: 0.00247/8 [=========================>....] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 27ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.00283/8 [==========>...................] - ETA: 0s - loss: 0.00246/8 [=====================>........] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 25ms/step - loss: 0.0022
1/8 [==>...........................] - ETA: 0s - loss: 0.00173/8 [==========>...................] - ETA: 0s - loss: 0.00255/8 [=================>............] - ETA: 0s - loss: 0.00227/8 [=========================>....] - ETA: 0s - loss: 0.00248/8 [==============================] - 0s 33ms/step - loss: 0.0024
1/8 [==>...........................] - ETA: 0s - loss: 0.00183/8 [==========>...................] - ETA: 0s - loss: 0.00225/8 [=================>............] - ETA: 0s - loss: 0.00207/8 [=========================>....] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 32ms/step - loss: 0.0022
1/8 [==>...........................] - ETA: 0s - loss: 0.00183/8 [==========>...................] - ETA: 0s - loss: 0.00245/8 [=================>............] - ETA: 0s - loss: 0.00227/8 [=========================>....] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 26ms/step - loss: 0.0022
Best parameters {'n_units': 72, 'n_hidden': 2} best score 0.002280263928696513:
Train Score: 0.00234 MSE 0.04841 RMSE
Test Score: 0.00345 MSE 0.05870 RMSE
Deviation Min [0.00012777], Max [0.18100889]
Deviation 99.5th pctile [0.1251078]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1641,   15]))
Confusion matrix 
[[1637    4]
 [  10    5]]
precision 0.55556, recall 0.33333, f1 0.41667
Time to train: 514651 ms
Saving model models/A3Benchmark/A3Benchmark-TS43.csv.h5
Total Time to proces all the selected files : 520143 ms
A3Benchmark : Avg precision 0.55556 recall 0.33333 f1 0.41667 time to train 514651.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS43.csv  --epochs 20 --n_iter 3 --patience 3 :: took 527 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS44.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 10:39:20 PM MST
2020-11-30 22:39:26.251555: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 22:39:26.270280: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 22:39:26.271514: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55721c89ed30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 22:39:26.271557: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 22:39:26.271727: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS44.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00405/8 [=================>............] - ETA: 0s - loss: 0.00268/8 [==============================] - 0s 14ms/step - loss: 0.0027
1/8 [==>...........................] - ETA: 0s - loss: 0.00445/8 [=================>............] - ETA: 0s - loss: 0.00548/8 [==============================] - ETA: 0s - loss: 0.00428/8 [==============================] - 0s 16ms/step - loss: 0.0042
1/8 [==>...........................] - ETA: 0s - loss: 0.00403/8 [==========>...................] - ETA: 0s - loss: 0.00624/8 [==============>...............] - ETA: 0s - loss: 0.00595/8 [=================>............] - ETA: 0s - loss: 0.00556/8 [=====================>........] - ETA: 0s - loss: 0.00527/8 [=========================>....] - ETA: 0s - loss: 0.00548/8 [==============================] - ETA: 0s - loss: 0.00548/8 [==============================] - 0s 52ms/step - loss: 0.0054
1/8 [==>...........................] - ETA: 0s - loss: 0.00173/8 [==========>...................] - ETA: 0s - loss: 0.00175/8 [=================>............] - ETA: 0s - loss: 0.00437/8 [=========================>....] - ETA: 0s - loss: 0.00488/8 [==============================] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 40ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00485/8 [=================>............] - ETA: 0s - loss: 0.00388/8 [==============================] - ETA: 0s - loss: 0.00328/8 [==============================] - 0s 14ms/step - loss: 0.0032
1/8 [==>...........................] - ETA: 0s - loss: 0.00483/8 [==========>...................] - ETA: 0s - loss: 0.00355/8 [=================>............] - ETA: 0s - loss: 0.00326/8 [=====================>........] - ETA: 0s - loss: 0.00337/8 [=========================>....] - ETA: 0s - loss: 0.00368/8 [==============================] - ETA: 0s - loss: 0.00358/8 [==============================] - 1s 90ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.00383/8 [==========>...................] - ETA: 0s - loss: 0.00415/8 [=================>............] - ETA: 0s - loss: 0.00467/8 [=========================>....] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 37ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.00223/8 [==========>...................] - ETA: 0s - loss: 0.00435/8 [=================>............] - ETA: 0s - loss: 0.00467/8 [=========================>....] - ETA: 0s - loss: 0.00408/8 [==============================] - 0s 34ms/step - loss: 0.0039
1/8 [==>...........................] - ETA: 0s - loss: 0.00253/8 [==========>...................] - ETA: 0s - loss: 0.00264/8 [==============>...............] - ETA: 0s - loss: 0.00316/8 [=====================>........] - ETA: 0s - loss: 0.00648/8 [==============================] - ETA: 0s - loss: 0.00658/8 [==============================] - 0s 37ms/step - loss: 0.0065
1/8 [==>...........................] - ETA: 0s - loss: 0.00753/8 [==========>...................] - ETA: 0s - loss: 0.00455/8 [=================>............] - ETA: 0s - loss: 0.00437/8 [=========================>....] - ETA: 0s - loss: 0.00398/8 [==============================] - 0s 29ms/step - loss: 0.0038
1/8 [==>...........................] - ETA: 0s - loss: 0.00265/8 [=================>............] - ETA: 0s - loss: 0.00188/8 [==============================] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 17ms/step - loss: 0.0018
1/8 [==>...........................] - ETA: 0s - loss: 0.00425/8 [=================>............] - ETA: 0s - loss: 0.00478/8 [==============================] - 0s 14ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.00185/8 [=================>............] - ETA: 0s - loss: 0.00358/8 [==============================] - 0s 13ms/step - loss: 0.0031
1/8 [==>...........................] - ETA: 0s - loss: 0.00214/8 [==============>...............] - ETA: 0s - loss: 0.00287/8 [=========================>....] - ETA: 0s - loss: 0.00528/8 [==============================] - 0s 21ms/step - loss: 0.0052
1/8 [==>...........................] - ETA: 0s - loss: 0.00565/8 [=================>............] - ETA: 0s - loss: 0.00398/8 [==============================] - 0s 13ms/step - loss: 0.0034
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0034014522563666104:
Train Score: 0.00270 MSE 0.05192 RMSE
Test Score: 0.00213 MSE 0.04616 RMSE
Deviation Min [5.86633461e-05], Max [0.38535658]
Deviation 99.5th pctile [0.31622432]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1641,   15]))
Confusion matrix 
[[1641    0]
 [   6    9]]
precision 1.00000, recall 0.60000, f1 0.75000
Time to train: 973105 ms
Saving model models/A3Benchmark/A3Benchmark-TS44.csv.h5
Total Time to proces all the selected files : 975719 ms
A3Benchmark : Avg precision 1.00000 recall 0.60000 f1 0.75000 time to train 973105.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS44.csv  --epochs 20 --n_iter 3 --patience 3 :: took 982 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS45.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 10:55:47 PM MST
2020-11-30 22:55:54.215108: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 22:55:54.233207: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 22:55:54.234753: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55ece511fc00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 22:55:54.234804: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 22:55:54.235028: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS45.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00833/8 [==========>...................] - ETA: 0s - loss: 0.00555/8 [=================>............] - ETA: 0s - loss: 0.00447/8 [=========================>....] - ETA: 0s - loss: 0.00528/8 [==============================] - 0s 30ms/step - loss: 0.0052
1/8 [==>...........................] - ETA: 0s - loss: 0.00363/8 [==========>...................] - ETA: 0s - loss: 0.00455/8 [=================>............] - ETA: 0s - loss: 0.00517/8 [=========================>....] - ETA: 0s - loss: 0.00458/8 [==============================] - 0s 40ms/step - loss: 0.0045
1/8 [==>...........................] - ETA: 0s - loss: 0.00474/8 [==============>...............] - ETA: 0s - loss: 0.00446/8 [=====================>........] - ETA: 0s - loss: 0.00478/8 [==============================] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 26ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00543/8 [==========>...................] - ETA: 0s - loss: 0.00625/8 [=================>............] - ETA: 0s - loss: 0.00657/8 [=========================>....] - ETA: 0s - loss: 0.00588/8 [==============================] - 0s 27ms/step - loss: 0.0059
1/8 [==>...........................] - ETA: 0s - loss: 0.00332/8 [======>.......................] - ETA: 0s - loss: 0.00344/8 [==============>...............] - ETA: 0s - loss: 0.00496/8 [=====================>........] - ETA: 0s - loss: 0.00658/8 [==============================] - ETA: 0s - loss: 0.00688/8 [==============================] - 0s 41ms/step - loss: 0.0068
1/8 [==>...........................] - ETA: 0s - loss: 0.00862/8 [======>.......................] - ETA: 0s - loss: 0.00744/8 [==============>...............] - ETA: 0s - loss: 0.00506/8 [=====================>........] - ETA: 0s - loss: 0.00508/8 [==============================] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 37ms/step - loss: 0.0057
1/8 [==>...........................] - ETA: 0s - loss: 0.00353/8 [==========>...................] - ETA: 0s - loss: 0.00445/8 [=================>............] - ETA: 0s - loss: 0.00457/8 [=========================>....] - ETA: 0s - loss: 0.00418/8 [==============================] - 0s 29ms/step - loss: 0.0042
1/8 [==>...........................] - ETA: 0s - loss: 0.01963/8 [==========>...................] - ETA: 0s - loss: 0.02714/8 [==============>...............] - ETA: 0s - loss: 0.02635/8 [=================>............] - ETA: 0s - loss: 0.02646/8 [=====================>........] - ETA: 0s - loss: 0.02668/8 [==============================] - ETA: 0s - loss: 0.02758/8 [==============================] - 1s 79ms/step - loss: 0.0275
1/8 [==>...........................] - ETA: 0s - loss: 0.00502/8 [======>.......................] - ETA: 0s - loss: 0.00483/8 [==========>...................] - ETA: 0s - loss: 0.00444/8 [==============>...............] - ETA: 0s - loss: 0.00445/8 [=================>............] - ETA: 0s - loss: 0.00526/8 [=====================>........] - ETA: 0s - loss: 0.00507/8 [=========================>....] - ETA: 0s - loss: 0.00478/8 [==============================] - ETA: 0s - loss: 0.00488/8 [==============================] - 1s 173ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00293/8 [==========>...................] - ETA: 0s - loss: 0.00394/8 [==============>...............] - ETA: 0s - loss: 0.00445/8 [=================>............] - ETA: 0s - loss: 0.00497/8 [=========================>....] - ETA: 0s - loss: 0.00588/8 [==============================] - 0s 42ms/step - loss: 0.0061
1/8 [==>...........................] - ETA: 0s - loss: 0.00532/8 [======>.......................] - ETA: 0s - loss: 0.00443/8 [==========>...................] - ETA: 0s - loss: 0.00404/8 [==============>...............] - ETA: 0s - loss: 0.00415/8 [=================>............] - ETA: 0s - loss: 0.00456/8 [=====================>........] - ETA: 0s - loss: 0.00447/8 [=========================>....] - ETA: 0s - loss: 0.00478/8 [==============================] - ETA: 0s - loss: 0.00468/8 [==============================] - 1s 164ms/step - loss: 0.0046
1/8 [==>...........................] - ETA: 0s - loss: 0.00393/8 [==========>...................] - ETA: 0s - loss: 0.00435/8 [=================>............] - ETA: 0s - loss: 0.00517/8 [=========================>....] - ETA: 0s - loss: 0.00458/8 [==============================] - 0s 27ms/step - loss: 0.0045
1/8 [==>...........................] - ETA: 0s - loss: 0.00793/8 [==========>...................] - ETA: 0s - loss: 0.00995/8 [=================>............] - ETA: 0s - loss: 0.00967/8 [=========================>....] - ETA: 0s - loss: 0.00958/8 [==============================] - 0s 26ms/step - loss: 0.0097
1/8 [==>...........................] - ETA: 0s - loss: 0.00713/8 [==========>...................] - ETA: 0s - loss: 0.00525/8 [=================>............] - ETA: 0s - loss: 0.00747/8 [=========================>....] - ETA: 0s - loss: 0.00658/8 [==============================] - ETA: 0s - loss: 0.00648/8 [==============================] - 0s 32ms/step - loss: 0.0064
1/8 [==>...........................] - ETA: 0s - loss: 0.00234/8 [==============>...............] - ETA: 0s - loss: 0.00786/8 [=====================>........] - ETA: 0s - loss: 0.00838/8 [==============================] - ETA: 0s - loss: 0.00838/8 [==============================] - 0s 24ms/step - loss: 0.0083
Best parameters {'n_units': 72, 'n_hidden': 2} best score 0.005444420874118805:
Train Score: 0.00484 MSE 0.06955 RMSE
Test Score: 0.00519 MSE 0.07205 RMSE
Deviation Min [0.00013499], Max [0.40765038]
Deviation 99.5th pctile [0.19288605]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1651,    5]))
Confusion matrix 
[[1647    4]
 [   0    5]]
precision 0.55556, recall 1.00000, f1 0.71429
Time to train: 1402703 ms
Saving model models/A3Benchmark/A3Benchmark-TS45.csv.h5
Total Time to proces all the selected files : 1413134 ms
A3Benchmark : Avg precision 0.55556 recall 1.00000 f1 0.71429 time to train 1402703.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS45.csv  --epochs 20 --n_iter 3 --patience 3 :: took 1420 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS46.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 11:19:32 PM MST
2020-11-30 23:19:38.689620: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 23:19:38.712062: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 23:19:38.713199: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56088d7108e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 23:19:38.713237: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 23:19:38.713408: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS46.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00465/8 [=================>............] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 12ms/step - loss: 0.0051
1/8 [==>...........................] - ETA: 0s - loss: 0.00345/8 [=================>............] - ETA: 0s - loss: 0.00468/8 [==============================] - ETA: 0s - loss: 0.00458/8 [==============================] - 0s 15ms/step - loss: 0.0045
1/8 [==>...........................] - ETA: 0s - loss: 0.00483/8 [==========>...................] - ETA: 0s - loss: 0.00615/8 [=================>............] - ETA: 0s - loss: 0.00556/8 [=====================>........] - ETA: 0s - loss: 0.00557/8 [=========================>....] - ETA: 0s - loss: 0.00548/8 [==============================] - 0s 57ms/step - loss: 0.0056
1/8 [==>...........................] - ETA: 0s - loss: 0.00325/8 [=================>............] - ETA: 0s - loss: 0.00458/8 [==============================] - 0s 13ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00643/8 [==========>...................] - ETA: 0s - loss: 0.00635/8 [=================>............] - ETA: 0s - loss: 0.00667/8 [=========================>....] - ETA: 0s - loss: 0.00728/8 [==============================] - 0s 29ms/step - loss: 0.0074
1/8 [==>...........................] - ETA: 0s - loss: 0.00603/8 [==========>...................] - ETA: 0s - loss: 0.00635/8 [=================>............] - ETA: 0s - loss: 0.00627/8 [=========================>....] - ETA: 0s - loss: 0.00628/8 [==============================] - ETA: 0s - loss: 0.00638/8 [==============================] - 0s 36ms/step - loss: 0.0063
1/8 [==>...........................] - ETA: 0s - loss: 0.00433/8 [==========>...................] - ETA: 0s - loss: 0.00625/8 [=================>............] - ETA: 0s - loss: 0.00607/8 [=========================>....] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 30ms/step - loss: 0.0059
1/8 [==>...........................] - ETA: 0s - loss: 0.00453/8 [==========>...................] - ETA: 0s - loss: 0.00595/8 [=================>............] - ETA: 0s - loss: 0.00577/8 [=========================>....] - ETA: 0s - loss: 0.00568/8 [==============================] - 0s 32ms/step - loss: 0.0058
1/8 [==>...........................] - ETA: 0s - loss: 0.00412/8 [======>.......................] - ETA: 0s - loss: 0.00573/8 [==========>...................] - ETA: 0s - loss: 0.00574/8 [==============>...............] - ETA: 0s - loss: 0.00556/8 [=====================>........] - ETA: 0s - loss: 0.00577/8 [=========================>....] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 48ms/step - loss: 0.0059
1/8 [==>...........................] - ETA: 0s - loss: 0.01003/8 [==========>...................] - ETA: 0s - loss: 0.00955/8 [=================>............] - ETA: 0s - loss: 0.01007/8 [=========================>....] - ETA: 0s - loss: 0.01088/8 [==============================] - 0s 35ms/step - loss: 0.0110
1/8 [==>...........................] - ETA: 0s - loss: 0.00416/8 [=====================>........] - ETA: 0s - loss: 0.00458/8 [==============================] - 0s 11ms/step - loss: 0.0045
1/8 [==>...........................] - ETA: 0s - loss: 0.00355/8 [=================>............] - ETA: 0s - loss: 0.00498/8 [==============================] - 0s 14ms/step - loss: 0.0047
1/8 [==>...........................] - ETA: 0s - loss: 0.00355/8 [=================>............] - ETA: 0s - loss: 0.00468/8 [==============================] - 0s 14ms/step - loss: 0.0046
1/8 [==>...........................] - ETA: 0s - loss: 0.00284/8 [==============>...............] - ETA: 0s - loss: 0.00297/8 [=========================>....] - ETA: 0s - loss: 0.00308/8 [==============================] - 0s 15ms/step - loss: 0.0031
1/8 [==>...........................] - ETA: 0s - loss: 0.00295/8 [=================>............] - ETA: 0s - loss: 0.00338/8 [==============================] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 14ms/step - loss: 0.0036
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.004096607537940144:
Train Score: 0.00495 MSE 0.07032 RMSE
Test Score: 0.00930 MSE 0.09643 RMSE
Deviation Min [0.00026901], Max [0.2814532]
Deviation 99.5th pctile [0.19060028]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1653,    3]))
Confusion matrix 
[[1646    7]
 [   1    2]]
precision 0.22222, recall 0.66667, f1 0.33333
Time to train: 451012 ms
Saving model models/A3Benchmark/A3Benchmark-TS46.csv.h5
Total Time to proces all the selected files : 455566 ms
A3Benchmark : Avg precision 0.22222 recall 0.66667 f1 0.33333 time to train 451012.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS46.csv  --epochs 20 --n_iter 3 --patience 3 :: took 462 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS47.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 11:27:19 PM MST
2020-11-30 23:27:25.489733: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 23:27:25.508238: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 23:27:25.509141: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55af869ccc00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 23:27:25.509169: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 23:27:25.509289: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS47.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00894/8 [==============>...............] - ETA: 0s - loss: 0.00907/8 [=========================>....] - ETA: 0s - loss: 0.00828/8 [==============================] - 0s 18ms/step - loss: 0.0083
1/8 [==>...........................] - ETA: 0s - loss: 0.00115/8 [=================>............] - ETA: 0s - loss: 0.00278/8 [==============================] - 0s 13ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.00372/8 [======>.......................] - ETA: 0s - loss: 0.00286/8 [=====================>........] - ETA: 0s - loss: 0.00268/8 [==============================] - 0s 25ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.01002/8 [======>.......................] - ETA: 0s - loss: 0.01043/8 [==========>...................] - ETA: 0s - loss: 0.01255/8 [=================>............] - ETA: 0s - loss: 0.01306/8 [=====================>........] - ETA: 0s - loss: 0.01468/8 [==============================] - ETA: 0s - loss: 0.01448/8 [==============================] - 1s 67ms/step - loss: 0.0144
1/8 [==>...........................] - ETA: 0s - loss: 0.00115/8 [=================>............] - ETA: 0s - loss: 0.00168/8 [==============================] - ETA: 0s - loss: 0.00198/8 [==============================] - 0s 17ms/step - loss: 0.0019
1/8 [==>...........................] - ETA: 0s - loss: 0.00634/8 [==============>...............] - ETA: 0s - loss: 0.00737/8 [=========================>....] - ETA: 0s - loss: 0.00688/8 [==============================] - 0s 17ms/step - loss: 0.0070
1/8 [==>...........................] - ETA: 0s - loss: 0.00254/8 [==============>...............] - ETA: 0s - loss: 0.00377/8 [=========================>....] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 16ms/step - loss: 0.0038
1/8 [==>...........................] - ETA: 0s - loss: 0.00385/8 [=================>............] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 13ms/step - loss: 0.0020
1/8 [==>...........................] - ETA: 0s - loss: 0.05445/8 [=================>............] - ETA: 0s - loss: 0.05528/8 [==============================] - 0s 12ms/step - loss: 0.0621
1/8 [==>...........................] - ETA: 0s - loss: 0.00204/8 [==============>...............] - ETA: 0s - loss: 0.00517/8 [=========================>....] - ETA: 0s - loss: 0.00878/8 [==============================] - 0s 16ms/step - loss: 0.0093
1/8 [==>...........................] - ETA: 0s - loss: 0.00923/8 [==========>...................] - ETA: 0s - loss: 0.00885/8 [=================>............] - ETA: 0s - loss: 0.00917/8 [=========================>....] - ETA: 0s - loss: 0.00868/8 [==============================] - 0s 36ms/step - loss: 0.0088
1/8 [==>...........................] - ETA: 0s - loss: 0.00653/8 [==========>...................] - ETA: 0s - loss: 0.00875/8 [=================>............] - ETA: 0s - loss: 0.00927/8 [=========================>....] - ETA: 0s - loss: 0.00898/8 [==============================] - 0s 27ms/step - loss: 0.0093
1/8 [==>...........................] - ETA: 0s - loss: 0.00993/8 [==========>...................] - ETA: 0s - loss: 0.00945/8 [=================>............] - ETA: 0s - loss: 0.00887/8 [=========================>....] - ETA: 0s - loss: 0.00908/8 [==============================] - 0s 34ms/step - loss: 0.0092
1/8 [==>...........................] - ETA: 0s - loss: 0.00124/8 [==============>...............] - ETA: 0s - loss: 0.00236/8 [=====================>........] - ETA: 0s - loss: 0.00228/8 [==============================] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 22ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 9.7888e-043/8 [==========>...................] - ETA: 0s - loss: 0.0014    4/8 [==============>...............] - ETA: 0s - loss: 0.00156/8 [=====================>........] - ETA: 0s - loss: 0.00147/8 [=========================>....] - ETA: 0s - loss: 0.00148/8 [==============================] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 42ms/step - loss: 0.0018
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.005859473836608231:
Train Score: 0.00208 MSE 0.04558 RMSE
Test Score: 0.00348 MSE 0.05898 RMSE
Deviation Min [4.3722971e-05], Max [0.29981082]
Deviation 99.5th pctile [0.22617898]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1641,   15]))
Confusion matrix 
[[1641    0]
 [   6    9]]
precision 1.00000, recall 0.60000, f1 0.75000
Time to train: 781793 ms
Saving model models/A3Benchmark/A3Benchmark-TS47.csv.h5
Total Time to proces all the selected files : 788568 ms
A3Benchmark : Avg precision 1.00000 recall 0.60000 f1 0.75000 time to train 781793.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS47.csv  --epochs 20 --n_iter 3 --patience 3 :: took 795 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS48.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 11:40:39 PM MST
2020-11-30 23:40:45.577784: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 23:40:45.600043: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 23:40:45.601091: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55b36bb388e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 23:40:45.601122: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 23:40:45.601274: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS48.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00383/8 [==========>...................] - ETA: 0s - loss: 0.00306/8 [=====================>........] - ETA: 0s - loss: 0.00328/8 [==============================] - ETA: 0s - loss: 0.00318/8 [==============================] - 0s 32ms/step - loss: 0.0031
1/8 [==>...........................] - ETA: 0s - loss: 0.01165/8 [=================>............] - ETA: 0s - loss: 0.01398/8 [==============================] - 0s 13ms/step - loss: 0.0156
1/8 [==>...........................] - ETA: 0s - loss: 0.00402/8 [======>.......................] - ETA: 0s - loss: 0.00413/8 [==========>...................] - ETA: 0s - loss: 0.00474/8 [==============>...............] - ETA: 0s - loss: 0.00445/8 [=================>............] - ETA: 0s - loss: 0.00437/8 [=========================>....] - ETA: 0s - loss: 0.00448/8 [==============================] - 0s 54ms/step - loss: 0.0047
1/8 [==>...........................] - ETA: 0s - loss: 0.00313/8 [==========>...................] - ETA: 0s - loss: 0.00375/8 [=================>............] - ETA: 0s - loss: 0.00377/8 [=========================>....] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 27ms/step - loss: 0.0041
1/8 [==>...........................] - ETA: 0s - loss: 0.00332/8 [======>.......................] - ETA: 0s - loss: 0.00363/8 [==========>...................] - ETA: 0s - loss: 0.00434/8 [==============>...............] - ETA: 0s - loss: 0.00395/8 [=================>............] - ETA: 0s - loss: 0.00416/8 [=====================>........] - ETA: 0s - loss: 0.00427/8 [=========================>....] - ETA: 0s - loss: 0.00408/8 [==============================] - 1s 66ms/step - loss: 0.0040
1/8 [==>...........................] - ETA: 0s - loss: 0.00443/8 [==========>...................] - ETA: 0s - loss: 0.00415/8 [=================>............] - ETA: 0s - loss: 0.00427/8 [=========================>....] - ETA: 0s - loss: 0.00438/8 [==============================] - 0s 26ms/step - loss: 0.0043
1/8 [==>...........................] - ETA: 0s - loss: 0.00423/8 [==========>...................] - ETA: 0s - loss: 0.00475/8 [=================>............] - ETA: 0s - loss: 0.00497/8 [=========================>....] - ETA: 0s - loss: 0.00478/8 [==============================] - 0s 27ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00433/8 [==========>...................] - ETA: 0s - loss: 0.00525/8 [=================>............] - ETA: 0s - loss: 0.00477/8 [=========================>....] - ETA: 0s - loss: 0.00498/8 [==============================] - 0s 33ms/step - loss: 0.0051
1/8 [==>...........................] - ETA: 0s - loss: 0.00363/8 [==========>...................] - ETA: 0s - loss: 0.00435/8 [=================>............] - ETA: 0s - loss: 0.00447/8 [=========================>....] - ETA: 0s - loss: 0.00458/8 [==============================] - 0s 40ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00393/8 [==========>...................] - ETA: 0s - loss: 0.00605/8 [=================>............] - ETA: 0s - loss: 0.00537/8 [=========================>....] - ETA: 0s - loss: 0.00528/8 [==============================] - 0s 29ms/step - loss: 0.0053
1/8 [==>...........................] - ETA: 0s - loss: 0.00482/8 [======>.......................] - ETA: 0s - loss: 0.00463/8 [==========>...................] - ETA: 0s - loss: 0.00444/8 [==============>...............] - ETA: 0s - loss: 0.00465/8 [=================>............] - ETA: 0s - loss: 0.00486/8 [=====================>........] - ETA: 0s - loss: 0.00478/8 [==============================] - ETA: 0s - loss: 0.00468/8 [==============================] - 1s 96ms/step - loss: 0.0046
1/8 [==>...........................] - ETA: 0s - loss: 0.00403/8 [==========>...................] - ETA: 0s - loss: 0.00445/8 [=================>............] - ETA: 0s - loss: 0.00517/8 [=========================>....] - ETA: 0s - loss: 0.00538/8 [==============================] - 0s 25ms/step - loss: 0.0053
1/8 [==>...........................] - ETA: 0s - loss: 0.00412/8 [======>.......................] - ETA: 0s - loss: 0.00433/8 [==========>...................] - ETA: 0s - loss: 0.00484/8 [==============>...............] - ETA: 0s - loss: 0.00465/8 [=================>............] - ETA: 0s - loss: 0.00457/8 [=========================>....] - ETA: 0s - loss: 0.00468/8 [==============================] - 1s 69ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00353/8 [==========>...................] - ETA: 0s - loss: 0.00435/8 [=================>............] - ETA: 0s - loss: 0.00447/8 [=========================>....] - ETA: 0s - loss: 0.00448/8 [==============================] - 0s 33ms/step - loss: 0.0047
1/8 [==>...........................] - ETA: 0s - loss: 0.00403/8 [==========>...................] - ETA: 0s - loss: 0.00635/8 [=================>............] - ETA: 0s - loss: 0.00567/8 [=========================>....] - ETA: 0s - loss: 0.00558/8 [==============================] - 0s 26ms/step - loss: 0.0056
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.004867654107511043:
Train Score: 0.00467 MSE 0.06837 RMSE
Test Score: 0.00459 MSE 0.06779 RMSE
Deviation Min [6.00478031e-05], Max [0.25712371]
Deviation 99.5th pctile [0.15662056]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1643,   13]))
Confusion matrix 
[[1639    4]
 [   8    5]]
precision 0.55556, recall 0.38462, f1 0.45455
Time to train: 748878 ms
Saving model models/A3Benchmark/A3Benchmark-TS48.csv.h5
Total Time to proces all the selected files : 755117 ms
A3Benchmark : Avg precision 0.55556 recall 0.38462 f1 0.45455 time to train 748878.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS48.csv  --epochs 20 --n_iter 3 --patience 3 :: took 762 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS49.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Mon 30 Nov 2020 11:53:26 PM MST
2020-11-30 23:53:32.137532: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-11-30 23:53:32.156216: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-11-30 23:53:32.157090: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55cf03623d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-30 23:53:32.157118: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-30 23:53:32.157240: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS49.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00592/8 [======>.......................] - ETA: 0s - loss: 0.00653/8 [==========>...................] - ETA: 0s - loss: 0.00594/8 [==============>...............] - ETA: 0s - loss: 0.00545/8 [=================>............] - ETA: 0s - loss: 0.00536/8 [=====================>........] - ETA: 0s - loss: 0.00607/8 [=========================>....] - ETA: 0s - loss: 0.00628/8 [==============================] - ETA: 0s - loss: 0.00628/8 [==============================] - 1s 117ms/step - loss: 0.0062
1/8 [==>...........................] - ETA: 0s - loss: 0.00672/8 [======>.......................] - ETA: 0s - loss: 0.00723/8 [==========>...................] - ETA: 0s - loss: 0.00634/8 [==============>...............] - ETA: 0s - loss: 0.00695/8 [=================>............] - ETA: 0s - loss: 0.00746/8 [=====================>........] - ETA: 0s - loss: 0.00748/8 [==============================] - ETA: 0s - loss: 0.00678/8 [==============================] - 1s 78ms/step - loss: 0.0067
1/8 [==>...........................] - ETA: 0s - loss: 0.00373/8 [==========>...................] - ETA: 0s - loss: 0.00415/8 [=================>............] - ETA: 0s - loss: 0.00387/8 [=========================>....] - ETA: 0s - loss: 0.00548/8 [==============================] - 0s 24ms/step - loss: 0.0053
1/8 [==>...........................] - ETA: 0s - loss: 0.00543/8 [==========>...................] - ETA: 0s - loss: 0.00535/8 [=================>............] - ETA: 0s - loss: 0.00557/8 [=========================>....] - ETA: 0s - loss: 0.00648/8 [==============================] - 0s 26ms/step - loss: 0.0063
1/8 [==>...........................] - ETA: 0s - loss: 0.00852/8 [======>.......................] - ETA: 0s - loss: 0.00903/8 [==========>...................] - ETA: 0s - loss: 0.00744/8 [==============>...............] - ETA: 0s - loss: 0.00756/8 [=====================>........] - ETA: 0s - loss: 0.00757/8 [=========================>....] - ETA: 0s - loss: 0.00788/8 [==============================] - 1s 92ms/step - loss: 0.0076
1/8 [==>...........................] - ETA: 0s - loss: 0.00816/8 [=====================>........] - ETA: 0s - loss: 0.00657/8 [=========================>....] - ETA: 0s - loss: 0.00678/8 [==============================] - ETA: 0s - loss: 0.00648/8 [==============================] - 0s 23ms/step - loss: 0.0064
1/8 [==>...........................] - ETA: 0s - loss: 0.00604/8 [==============>...............] - ETA: 0s - loss: 0.00477/8 [=========================>....] - ETA: 0s - loss: 0.00428/8 [==============================] - 0s 16ms/step - loss: 0.0042
1/8 [==>...........................] - ETA: 0s - loss: 0.00612/8 [======>.......................] - ETA: 0s - loss: 0.00575/8 [=================>............] - ETA: 0s - loss: 0.00548/8 [==============================] - 0s 21ms/step - loss: 0.0071
1/8 [==>...........................] - ETA: 0s - loss: 0.00393/8 [==========>...................] - ETA: 0s - loss: 0.00544/8 [==============>...............] - ETA: 0s - loss: 0.00485/8 [=================>............] - ETA: 0s - loss: 0.00476/8 [=====================>........] - ETA: 0s - loss: 0.00498/8 [==============================] - ETA: 0s - loss: 0.00508/8 [==============================] - 1s 69ms/step - loss: 0.0050
1/8 [==>...........................] - ETA: 0s - loss: 0.00444/8 [==============>...............] - ETA: 0s - loss: 0.00718/8 [==============================] - 0s 12ms/step - loss: 0.0065
1/8 [==>...........................] - ETA: 0s - loss: 0.00635/8 [=================>............] - ETA: 0s - loss: 0.00518/8 [==============================] - 0s 12ms/step - loss: 0.0055
1/8 [==>...........................] - ETA: 0s - loss: 0.00615/8 [=================>............] - ETA: 0s - loss: 0.00498/8 [==============================] - 0s 14ms/step - loss: 0.0045
1/8 [==>...........................] - ETA: 0s - loss: 0.00875/8 [=================>............] - ETA: 0s - loss: 0.00758/8 [==============================] - 0s 14ms/step - loss: 0.0090
1/8 [==>...........................] - ETA: 0s - loss: 0.00563/8 [==========>...................] - ETA: 0s - loss: 0.00525/8 [=================>............] - ETA: 0s - loss: 0.00537/8 [=========================>....] - ETA: 0s - loss: 0.00548/8 [==============================] - 0s 27ms/step - loss: 0.0053
1/8 [==>...........................] - ETA: 0s - loss: 0.00984/8 [==============>...............] - ETA: 0s - loss: 0.01467/8 [=========================>....] - ETA: 0s - loss: 0.01378/8 [==============================] - 0s 16ms/step - loss: 0.0138
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.005816851742565632:
Train Score: 0.00546 MSE 0.07388 RMSE
Test Score: 0.00497 MSE 0.07050 RMSE
Deviation Min [3.07521657e-05], Max [0.46101678]
Deviation 99.5th pctile [0.35406989]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1640,   16]))
Confusion matrix 
[[1640    0]
 [   7    9]]
precision 1.00000, recall 0.56250, f1 0.72000
Time to train: 899295 ms
Saving model models/A3Benchmark/A3Benchmark-TS49.csv.h5
Total Time to proces all the selected files : 904965 ms
A3Benchmark : Avg precision 1.00000 recall 0.56250 f1 0.72000 time to train 899295.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS49.csv  --epochs 20 --n_iter 3 --patience 3 :: took 911 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS4.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 12:08:42 AM MST
2020-12-01 00:08:48.558227: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 00:08:48.577012: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 00:08:48.577752: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55851532fc00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 00:08:48.577777: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 00:08:48.577917: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS4.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00474/8 [==============>...............] - ETA: 0s - loss: 0.00517/8 [=========================>....] - ETA: 0s - loss: 0.00498/8 [==============================] - 0s 16ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00134/8 [==============>...............] - ETA: 0s - loss: 0.00176/8 [=====================>........] - ETA: 0s - loss: 0.00158/8 [==============================] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 24ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 0.00114/8 [==============>...............] - ETA: 0s - loss: 0.00127/8 [=========================>....] - ETA: 0s - loss: 0.00158/8 [==============================] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 20ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 0.00115/8 [=================>............] - ETA: 0s - loss: 0.00118/8 [==============================] - ETA: 0s - loss: 0.00108/8 [==============================] - 0s 15ms/step - loss: 0.0010
1/8 [==>...........................] - ETA: 0s - loss: 0.00236/8 [=====================>........] - ETA: 0s - loss: 0.02998/8 [==============================] - 0s 10ms/step - loss: 0.0246
1/8 [==>...........................] - ETA: 0s - loss: 0.00675/8 [=================>............] - ETA: 0s - loss: 0.00848/8 [==============================] - 0s 14ms/step - loss: 0.0082
1/8 [==>...........................] - ETA: 0s - loss: 0.00115/8 [=================>............] - ETA: 0s - loss: 0.00118/8 [==============================] - 0s 13ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00158/8 [==============================] - ETA: 0s - loss: 0.00198/8 [==============================] - 0s 14ms/step - loss: 0.0019
1/8 [==>...........................] - ETA: 0s - loss: 0.00122/8 [======>.......................] - ETA: 0s - loss: 9.5549e-044/8 [==============>...............] - ETA: 0s - loss: 9.7286e-045/8 [=================>............] - ETA: 0s - loss: 0.0013    6/8 [=====================>........] - ETA: 0s - loss: 0.00137/8 [=========================>....] - ETA: 0s - loss: 0.00128/8 [==============================] - ETA: 0s - loss: 0.00128/8 [==============================] - 1s 86ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 0.01235/8 [=================>............] - ETA: 0s - loss: 0.02108/8 [==============================] - ETA: 0s - loss: 0.02168/8 [==============================] - 0s 15ms/step - loss: 0.0216
1/8 [==>...........................] - ETA: 0s - loss: 0.01083/8 [==========>...................] - ETA: 0s - loss: 0.01115/8 [=================>............] - ETA: 0s - loss: 0.01316/8 [=====================>........] - ETA: 0s - loss: 0.01248/8 [==============================] - ETA: 0s - loss: 0.01178/8 [==============================] - 0s 44ms/step - loss: 0.0117
1/8 [==>...........................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00287/8 [=========================>....] - ETA: 0s - loss: 0.00248/8 [==============================] - 0s 24ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.00773/8 [==========>...................] - ETA: 0s - loss: 0.01175/8 [=================>............] - ETA: 0s - loss: 0.01067/8 [=========================>....] - ETA: 0s - loss: 0.01138/8 [==============================] - 0s 25ms/step - loss: 0.0121
1/8 [==>...........................] - ETA: 0s - loss: 0.00773/8 [==========>...................] - ETA: 0s - loss: 0.00995/8 [=================>............] - ETA: 0s - loss: 0.00987/8 [=========================>....] - ETA: 0s - loss: 0.01038/8 [==============================] - 0s 28ms/step - loss: 0.0105
1/8 [==>...........................] - ETA: 0s - loss: 0.00112/8 [======>.......................] - ETA: 0s - loss: 0.00263/8 [==========>...................] - ETA: 0s - loss: 0.00455/8 [=================>............] - ETA: 0s - loss: 0.00427/8 [=========================>....] - ETA: 0s - loss: 0.00378/8 [==============================] - ETA: 0s - loss: 0.00398/8 [==============================] - 0s 47ms/step - loss: 0.0039
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.00667330869473517:
Train Score: 0.00165 MSE 0.04064 RMSE
Test Score: 0.00617 MSE 0.07857 RMSE
Deviation Min [5.37705471e-05], Max [0.46271796]
Deviation 99.5th pctile [0.2752931]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1650,    6]))
Confusion matrix 
[[1643    7]
 [   4    2]]
precision 0.22222, recall 0.33333, f1 0.26667
Time to train: 718166 ms
Saving model models/A3Benchmark/A3Benchmark-TS4.csv.h5
Total Time to proces all the selected files : 720747 ms
A3Benchmark : Avg precision 0.22222 recall 0.33333 f1 0.26667 time to train 718166.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS4.csv  --epochs 20 --n_iter 3 --patience 3 :: took 727 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS50.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 12:20:54 AM MST
2020-12-01 00:21:00.832964: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 00:21:00.851183: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 00:21:00.852676: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55b91f1afd30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 00:21:00.852724: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 00:21:00.852940: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS50.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 3.9344e-042/8 [======>.......................] - ETA: 0s - loss: 3.6490e-044/8 [==============>...............] - ETA: 0s - loss: 3.4080e-046/8 [=====================>........] - ETA: 0s - loss: 2.9955e-047/8 [=========================>....] - ETA: 0s - loss: 2.8168e-048/8 [==============================] - 0s 43ms/step - loss: 2.8359e-04
1/8 [==>...........................] - ETA: 0s - loss: 1.6848e-043/8 [==========>...................] - ETA: 0s - loss: 2.1868e-044/8 [==============>...............] - ETA: 0s - loss: 2.1755e-047/8 [=========================>....] - ETA: 0s - loss: 2.3089e-048/8 [==============================] - 0s 27ms/step - loss: 2.4005e-04
1/8 [==>...........................] - ETA: 0s - loss: 1.4837e-044/8 [==============>...............] - ETA: 0s - loss: 2.0823e-047/8 [=========================>....] - ETA: 0s - loss: 2.2503e-048/8 [==============================] - 0s 18ms/step - loss: 2.3489e-04
1/8 [==>...........................] - ETA: 0s - loss: 2.8977e-042/8 [======>.......................] - ETA: 0s - loss: 2.9386e-043/8 [==========>...................] - ETA: 0s - loss: 3.4490e-044/8 [==============>...............] - ETA: 0s - loss: 3.5894e-045/8 [=================>............] - ETA: 0s - loss: 3.5653e-046/8 [=====================>........] - ETA: 0s - loss: 3.8185e-047/8 [=========================>....] - ETA: 0s - loss: 3.6046e-048/8 [==============================] - ETA: 0s - loss: 3.5818e-048/8 [==============================] - 1s 102ms/step - loss: 3.5818e-04
1/8 [==>...........................] - ETA: 0s - loss: 6.2889e-043/8 [==========>...................] - ETA: 0s - loss: 7.3827e-046/8 [=====================>........] - ETA: 0s - loss: 0.0013    8/8 [==============================] - 0s 21ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 0.00113/8 [==========>...................] - ETA: 0s - loss: 9.1070e-044/8 [==============>...............] - ETA: 0s - loss: 8.5529e-047/8 [=========================>....] - ETA: 0s - loss: 6.3028e-048/8 [==============================] - 0s 30ms/step - loss: 6.1190e-04
1/8 [==>...........................] - ETA: 0s - loss: 1.9587e-042/8 [======>.......................] - ETA: 0s - loss: 2.2794e-044/8 [==============>...............] - ETA: 0s - loss: 2.2282e-045/8 [=================>............] - ETA: 0s - loss: 2.3864e-046/8 [=====================>........] - ETA: 0s - loss: 2.4772e-047/8 [=========================>....] - ETA: 0s - loss: 2.5013e-048/8 [==============================] - 0s 58ms/step - loss: 2.5810e-04
1/8 [==>...........................] - ETA: 0s - loss: 1.5258e-044/8 [==============>...............] - ETA: 0s - loss: 2.0872e-048/8 [==============================] - ETA: 0s - loss: 2.4845e-048/8 [==============================] - 0s 14ms/step - loss: 2.4845e-04
1/8 [==>...........................] - ETA: 0s - loss: 3.9872e-045/8 [=================>............] - ETA: 0s - loss: 4.3876e-048/8 [==============================] - 0s 14ms/step - loss: 4.2377e-04
1/8 [==>...........................] - ETA: 0s - loss: 4.5821e-044/8 [==============>...............] - ETA: 0s - loss: 6.0257e-047/8 [=========================>....] - ETA: 0s - loss: 8.6688e-048/8 [==============================] - 0s 19ms/step - loss: 9.0917e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00323/8 [==========>...................] - ETA: 0s - loss: 0.00265/8 [=================>............] - ETA: 0s - loss: 0.00237/8 [=========================>....] - ETA: 0s - loss: 0.00198/8 [==============================] - 0s 32ms/step - loss: 0.0018
1/8 [==>...........................] - ETA: 0s - loss: 1.8503e-043/8 [==========>...................] - ETA: 0s - loss: 2.4427e-045/8 [=================>............] - ETA: 0s - loss: 2.5596e-046/8 [=====================>........] - ETA: 0s - loss: 2.6057e-048/8 [==============================] - ETA: 0s - loss: 2.6511e-048/8 [==============================] - 0s 33ms/step - loss: 2.6511e-04
1/8 [==>...........................] - ETA: 0s - loss: 1.8054e-043/8 [==========>...................] - ETA: 0s - loss: 2.7617e-045/8 [=================>............] - ETA: 0s - loss: 2.7476e-047/8 [=========================>....] - ETA: 0s - loss: 3.0214e-048/8 [==============================] - 0s 34ms/step - loss: 3.2128e-04
1/8 [==>...........................] - ETA: 0s - loss: 3.0863e-042/8 [======>.......................] - ETA: 0s - loss: 3.1537e-043/8 [==========>...................] - ETA: 0s - loss: 3.7126e-045/8 [=================>............] - ETA: 0s - loss: 3.8663e-047/8 [=========================>....] - ETA: 0s - loss: 3.9607e-048/8 [==============================] - 0s 36ms/step - loss: 3.9437e-04
1/8 [==>...........................] - ETA: 0s - loss: 2.3789e-043/8 [==========>...................] - ETA: 0s - loss: 2.6321e-045/8 [=================>............] - ETA: 0s - loss: 3.5944e-047/8 [=========================>....] - ETA: 0s - loss: 4.2335e-048/8 [==============================] - 0s 28ms/step - loss: 4.5227e-04
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0004902794840745628:
Train Score: 0.00036 MSE 0.01902 RMSE
Test Score: 0.00163 MSE 0.04036 RMSE
Deviation Min [6.22315624e-06], Max [0.10918835]
Deviation 99.5th pctile [0.07845147]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1650,    6]))
Confusion matrix 
[[1643    7]
 [   4    2]]
precision 0.22222, recall 0.33333, f1 0.26667
Time to train: 610285 ms
Saving model models/A3Benchmark/A3Benchmark-TS50.csv.h5
Total Time to proces all the selected files : 612801 ms
A3Benchmark : Avg precision 0.22222 recall 0.33333 f1 0.26667 time to train 610285.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS50.csv  --epochs 20 --n_iter 3 --patience 3 :: took 620 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS51.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 12:31:19 AM MST
2020-12-01 00:31:25.423036: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 00:31:25.441258: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 00:31:25.442677: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5642aef7cc00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 00:31:25.442725: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 00:31:25.442911: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS51.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00515/8 [=================>............] - ETA: 0s - loss: 0.00668/8 [==============================] - ETA: 0s - loss: 0.00678/8 [==============================] - 0s 14ms/step - loss: 0.0067
1/8 [==>...........................] - ETA: 0s - loss: 0.00517/8 [=========================>....] - ETA: 0s - loss: 0.00598/8 [==============================] - 0s 10ms/step - loss: 0.0061
1/8 [==>...........................] - ETA: 0s - loss: 0.00597/8 [=========================>....] - ETA: 0s - loss: 0.00928/8 [==============================] - 0s 9ms/step - loss: 0.0098
1/8 [==>...........................] - ETA: 0s - loss: 0.01392/8 [======>.......................] - ETA: 0s - loss: 0.01304/8 [==============>...............] - ETA: 0s - loss: 0.01465/8 [=================>............] - ETA: 0s - loss: 0.01446/8 [=====================>........] - ETA: 0s - loss: 0.01637/8 [=========================>....] - ETA: 0s - loss: 0.01638/8 [==============================] - 0s 58ms/step - loss: 0.0164
1/8 [==>...........................] - ETA: 0s - loss: 0.01404/8 [==============>...............] - ETA: 0s - loss: 0.02027/8 [=========================>....] - ETA: 0s - loss: 0.02088/8 [==============================] - 0s 18ms/step - loss: 0.0211
1/8 [==>...........................] - ETA: 0s - loss: 0.00792/8 [======>.......................] - ETA: 0s - loss: 0.01013/8 [==========>...................] - ETA: 0s - loss: 0.00915/8 [=================>............] - ETA: 0s - loss: 0.00946/8 [=====================>........] - ETA: 0s - loss: 0.00897/8 [=========================>....] - ETA: 0s - loss: 0.00858/8 [==============================] - 0s 62ms/step - loss: 0.0085
1/8 [==>...........................] - ETA: 0s - loss: 6.1413e-043/8 [==========>...................] - ETA: 0s - loss: 0.0013    5/8 [=================>............] - ETA: 0s - loss: 0.00137/8 [=========================>....] - ETA: 0s - loss: 0.00118/8 [==============================] - 0s 33ms/step - loss: 0.0011
1/8 [==>...........................] - ETA: 0s - loss: 6.9928e-043/8 [==========>...................] - ETA: 0s - loss: 0.0020    5/8 [=================>............] - ETA: 0s - loss: 0.00208/8 [==============================] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 27ms/step - loss: 0.0018
1/8 [==>...........................] - ETA: 0s - loss: 0.01633/8 [==========>...................] - ETA: 0s - loss: 0.01635/8 [=================>............] - ETA: 0s - loss: 0.01657/8 [=========================>....] - ETA: 0s - loss: 0.01908/8 [==============================] - 0s 31ms/step - loss: 0.0191
1/8 [==>...........................] - ETA: 0s - loss: 0.01402/8 [======>.......................] - ETA: 0s - loss: 0.01513/8 [==========>...................] - ETA: 0s - loss: 0.02014/8 [==============>...............] - ETA: 0s - loss: 0.02115/8 [=================>............] - ETA: 0s - loss: 0.02106/8 [=====================>........] - ETA: 0s - loss: 0.02167/8 [=========================>....] - ETA: 0s - loss: 0.02178/8 [==============================] - ETA: 0s - loss: 0.02208/8 [==============================] - 1s 122ms/step - loss: 0.0220
1/8 [==>...........................] - ETA: 0s - loss: 0.00635/8 [=================>............] - ETA: 0s - loss: 0.00768/8 [==============================] - 0s 13ms/step - loss: 0.0071
1/8 [==>...........................] - ETA: 0s - loss: 0.00486/8 [=====================>........] - ETA: 0s - loss: 0.00678/8 [==============================] - 0s 10ms/step - loss: 0.0066
1/8 [==>...........................] - ETA: 0s - loss: 0.00273/8 [==========>...................] - ETA: 0s - loss: 0.00394/8 [==============>...............] - ETA: 0s - loss: 0.00387/8 [=========================>....] - ETA: 0s - loss: 0.00358/8 [==============================] - 0s 34ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 3.6071e-044/8 [==============>...............] - ETA: 0s - loss: 0.0014    8/8 [==============================] - 0s 11ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 0.01835/8 [=================>............] - ETA: 0s - loss: 0.02538/8 [==============================] - 0s 13ms/step - loss: 0.0261
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.00899851203430444:
Train Score: 0.00276 MSE 0.05258 RMSE
Test Score: 0.01563 MSE 0.12503 RMSE
Deviation Min [4.71135719e-05], Max [0.4428595]
Deviation 99.5th pctile [0.33788211]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1643,   13]))
Confusion matrix 
[[1634    9]
 [  13    0]]
precision 0.00000, recall 0.00000, f1 0.00000
Time to train: 478367 ms
Saving model models/A3Benchmark/A3Benchmark-TS51.csv.h5
Total Time to proces all the selected files : 482411 ms
A3Benchmark : Avg precision 0.00000 recall 0.00000 f1 0.00000 time to train 478367.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS51.csv  --epochs 20 --n_iter 3 --patience 3 :: took 489 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS52.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 12:39:33 AM MST
2020-12-01 00:39:39.660584: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 00:39:39.679005: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 00:39:39.680019: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x555df3d2ac00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 00:39:39.680054: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 00:39:39.680189: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS52.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00613/8 [==========>...................] - ETA: 0s - loss: 0.00395/8 [=================>............] - ETA: 0s - loss: 0.00648/8 [==============================] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 22ms/step - loss: 0.0057
1/8 [==>...........................] - ETA: 0s - loss: 0.00113/8 [==========>...................] - ETA: 0s - loss: 0.00135/8 [=================>............] - ETA: 0s - loss: 0.00276/8 [=====================>........] - ETA: 0s - loss: 0.00268/8 [==============================] - 0s 29ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.00223/8 [==========>...................] - ETA: 0s - loss: 0.00215/8 [=================>............] - ETA: 0s - loss: 0.00327/8 [=========================>....] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 23ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.00263/8 [==========>...................] - ETA: 0s - loss: 0.00335/8 [=================>............] - ETA: 0s - loss: 0.00387/8 [=========================>....] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 25ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.00493/8 [==========>...................] - ETA: 0s - loss: 0.00395/8 [=================>............] - ETA: 0s - loss: 0.00377/8 [=========================>....] - ETA: 0s - loss: 0.00408/8 [==============================] - 0s 33ms/step - loss: 0.0039
1/8 [==>...........................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00125/8 [=================>............] - ETA: 0s - loss: 0.00417/8 [=========================>....] - ETA: 0s - loss: 0.00338/8 [==============================] - 0s 28ms/step - loss: 0.0031
1/8 [==>...........................] - ETA: 0s - loss: 0.00133/8 [==========>...................] - ETA: 0s - loss: 0.00135/8 [=================>............] - ETA: 0s - loss: 0.00227/8 [=========================>....] - ETA: 0s - loss: 0.00208/8 [==============================] - 0s 29ms/step - loss: 0.0020
1/8 [==>...........................] - ETA: 0s - loss: 0.00263/8 [==========>...................] - ETA: 0s - loss: 0.00305/8 [=================>............] - ETA: 0s - loss: 0.00387/8 [=========================>....] - ETA: 0s - loss: 0.00458/8 [==============================] - 0s 34ms/step - loss: 0.0045
1/8 [==>...........................] - ETA: 0s - loss: 0.00233/8 [==========>...................] - ETA: 0s - loss: 0.00375/8 [=================>............] - ETA: 0s - loss: 0.00477/8 [=========================>....] - ETA: 0s - loss: 0.00418/8 [==============================] - 0s 34ms/step - loss: 0.0040
1/8 [==>...........................] - ETA: 0s - loss: 0.00203/8 [==========>...................] - ETA: 0s - loss: 0.00305/8 [=================>............] - ETA: 0s - loss: 0.00307/8 [=========================>....] - ETA: 0s - loss: 0.00288/8 [==============================] - 0s 28ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 0.00234/8 [==============>...............] - ETA: 0s - loss: 0.00497/8 [=========================>....] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 20ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00186/8 [=====================>........] - ETA: 0s - loss: 0.00208/8 [==============================] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 23ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.00404/8 [==============>...............] - ETA: 0s - loss: 0.00286/8 [=====================>........] - ETA: 0s - loss: 0.00458/8 [==============================] - ETA: 0s - loss: 0.00448/8 [==============================] - 0s 24ms/step - loss: 0.0044
1/8 [==>...........................] - ETA: 0s - loss: 0.00273/8 [==========>...................] - ETA: 0s - loss: 0.00375/8 [=================>............] - ETA: 0s - loss: 0.00397/8 [=========================>....] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 27ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.00243/8 [==========>...................] - ETA: 0s - loss: 0.00294/8 [==============>...............] - ETA: 0s - loss: 0.00305/8 [=================>............] - ETA: 0s - loss: 0.00286/8 [=====================>........] - ETA: 0s - loss: 0.00287/8 [=========================>....] - ETA: 0s - loss: 0.00288/8 [==============================] - 0s 51ms/step - loss: 0.0028
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.0033076086547225714:
Train Score: 0.00295 MSE 0.05435 RMSE
Test Score: 0.00199 MSE 0.04466 RMSE
Deviation Min [6.67135672e-06], Max [0.45858711]
Deviation 99.5th pctile [0.16773599]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1651,    5]))
Confusion matrix 
[[1647    4]
 [   0    5]]
precision 0.55556, recall 1.00000, f1 0.71429
Time to train: 1310032 ms
Saving model models/A3Benchmark/A3Benchmark-TS52.csv.h5
Total Time to proces all the selected files : 1315963 ms
A3Benchmark : Avg precision 0.55556 recall 1.00000 f1 0.71429 time to train 1310032.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS52.csv  --epochs 20 --n_iter 3 --patience 3 :: took 1323 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS53.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 01:01:41 AM MST
2020-12-01 01:01:47.934765: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 01:01:47.953298: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 01:01:47.954212: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55bb8ec3a8e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 01:01:47.954241: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 01:01:47.954370: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS53.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00943/8 [==========>...................] - ETA: 0s - loss: 0.01055/8 [=================>............] - ETA: 0s - loss: 0.01096/8 [=====================>........] - ETA: 0s - loss: 0.01087/8 [=========================>....] - ETA: 0s - loss: 0.01058/8 [==============================] - ETA: 0s - loss: 0.01078/8 [==============================] - 0s 41ms/step - loss: 0.0107
1/8 [==>...........................] - ETA: 0s - loss: 0.01013/8 [==========>...................] - ETA: 0s - loss: 0.01215/8 [=================>............] - ETA: 0s - loss: 0.01397/8 [=========================>....] - ETA: 0s - loss: 0.01428/8 [==============================] - 0s 25ms/step - loss: 0.0145
1/8 [==>...........................] - ETA: 0s - loss: 0.00922/8 [======>.......................] - ETA: 0s - loss: 0.01053/8 [==========>...................] - ETA: 0s - loss: 0.01237/8 [=========================>....] - ETA: 0s - loss: 0.01178/8 [==============================] - 0s 28ms/step - loss: 0.0122
1/8 [==>...........................] - ETA: 0s - loss: 0.01973/8 [==========>...................] - ETA: 0s - loss: 0.01975/8 [=================>............] - ETA: 0s - loss: 0.02037/8 [=========================>....] - ETA: 0s - loss: 0.02288/8 [==============================] - 0s 35ms/step - loss: 0.0230
1/8 [==>...........................] - ETA: 0s - loss: 0.02443/8 [==========>...................] - ETA: 0s - loss: 0.03195/8 [=================>............] - ETA: 0s - loss: 0.03167/8 [=========================>....] - ETA: 0s - loss: 0.03248/8 [==============================] - 0s 27ms/step - loss: 0.0326
1/8 [==>...........................] - ETA: 0s - loss: 0.00873/8 [==========>...................] - ETA: 0s - loss: 0.01055/8 [=================>............] - ETA: 0s - loss: 0.01007/8 [=========================>....] - ETA: 0s - loss: 0.01048/8 [==============================] - 0s 50ms/step - loss: 0.0108
1/8 [==>...........................] - ETA: 0s - loss: 0.00775/8 [=================>............] - ETA: 0s - loss: 0.01078/8 [==============================] - 0s 14ms/step - loss: 0.0109
1/8 [==>...........................] - ETA: 0s - loss: 0.00884/8 [==============>...............] - ETA: 0s - loss: 0.01107/8 [=========================>....] - ETA: 0s - loss: 0.01108/8 [==============================] - 0s 17ms/step - loss: 0.0115
1/8 [==>...........................] - ETA: 0s - loss: 0.01124/8 [==============>...............] - ETA: 0s - loss: 0.01207/8 [=========================>....] - ETA: 0s - loss: 0.01438/8 [==============================] - 0s 16ms/step - loss: 0.0145
1/8 [==>...........................] - ETA: 0s - loss: 0.02113/8 [==========>...................] - ETA: 0s - loss: 0.02796/8 [=====================>........] - ETA: 0s - loss: 0.02917/8 [=========================>....] - ETA: 0s - loss: 0.02868/8 [==============================] - 0s 31ms/step - loss: 0.0288
1/8 [==>...........................] - ETA: 0s - loss: 0.00855/8 [=================>............] - ETA: 0s - loss: 0.00978/8 [==============================] - 0s 14ms/step - loss: 0.0094
1/8 [==>...........................] - ETA: 0s - loss: 0.00263/8 [==========>...................] - ETA: 0s - loss: 0.00345/8 [=================>............] - ETA: 0s - loss: 0.00438/8 [==============================] - ETA: 0s - loss: 0.00408/8 [==============================] - 1s 74ms/step - loss: 0.0040
1/8 [==>...........................] - ETA: 0s - loss: 0.00805/8 [=================>............] - ETA: 0s - loss: 0.00978/8 [==============================] - 0s 13ms/step - loss: 0.0101
1/8 [==>...........................] - ETA: 0s - loss: 0.01015/8 [=================>............] - ETA: 0s - loss: 0.01198/8 [==============================] - 0s 14ms/step - loss: 0.0133
1/8 [==>...........................] - ETA: 0s - loss: 0.00347/8 [=========================>....] - ETA: 0s - loss: 0.00348/8 [==============================] - 0s 9ms/step - loss: 0.0033
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.00804191678762436:
Train Score: 0.00352 MSE 0.05936 RMSE
Test Score: 0.00313 MSE 0.05597 RMSE
Deviation Min [6.41320837e-05], Max [0.36766598]
Deviation 99.5th pctile [0.2512868]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1641,   15]))
Confusion matrix 
[[1641    0]
 [   6    9]]
precision 1.00000, recall 0.60000, f1 0.75000
Time to train: 362831 ms
Saving model models/A3Benchmark/A3Benchmark-TS53.csv.h5
Total Time to proces all the selected files : 368089 ms
A3Benchmark : Avg precision 1.00000 recall 0.60000 f1 0.75000 time to train 362831.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS53.csv  --epochs 20 --n_iter 3 --patience 3 :: took 375 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS54.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 01:08:01 AM MST
2020-12-01 01:08:07.860532: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 01:08:07.883038: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 01:08:07.884159: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5566aba578e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 01:08:07.884207: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 01:08:07.884370: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS54.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00762/8 [======>.......................] - ETA: 0s - loss: 0.00603/8 [==========>...................] - ETA: 0s - loss: 0.00564/8 [==============>...............] - ETA: 0s - loss: 0.00495/8 [=================>............] - ETA: 0s - loss: 0.00446/8 [=====================>........] - ETA: 0s - loss: 0.00537/8 [=========================>....] - ETA: 0s - loss: 0.00578/8 [==============================] - ETA: 0s - loss: 0.00548/8 [==============================] - 1s 105ms/step - loss: 0.0054
1/8 [==>...........................] - ETA: 0s - loss: 0.00693/8 [==========>...................] - ETA: 0s - loss: 0.01085/8 [=================>............] - ETA: 0s - loss: 0.00947/8 [=========================>....] - ETA: 0s - loss: 0.00938/8 [==============================] - 0s 27ms/step - loss: 0.0093
1/8 [==>...........................] - ETA: 0s - loss: 0.01173/8 [==========>...................] - ETA: 0s - loss: 0.01395/8 [=================>............] - ETA: 0s - loss: 0.01437/8 [=========================>....] - ETA: 0s - loss: 0.01398/8 [==============================] - 0s 30ms/step - loss: 0.0142
1/8 [==>...........................] - ETA: 0s - loss: 0.01073/8 [==========>...................] - ETA: 0s - loss: 0.01365/8 [=================>............] - ETA: 0s - loss: 0.01377/8 [=========================>....] - ETA: 0s - loss: 0.01388/8 [==============================] - 0s 29ms/step - loss: 0.0143
1/8 [==>...........................] - ETA: 0s - loss: 0.01683/8 [==========>...................] - ETA: 0s - loss: 0.01595/8 [=================>............] - ETA: 0s - loss: 0.01587/8 [=========================>....] - ETA: 0s - loss: 0.01618/8 [==============================] - 0s 33ms/step - loss: 0.0160
1/8 [==>...........................] - ETA: 0s - loss: 0.00294/8 [==============>...............] - ETA: 0s - loss: 0.00277/8 [=========================>....] - ETA: 0s - loss: 0.00308/8 [==============================] - 0s 18ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 0.00194/8 [==============>...............] - ETA: 0s - loss: 0.00387/8 [=========================>....] - ETA: 0s - loss: 0.00338/8 [==============================] - 0s 17ms/step - loss: 0.0032
1/8 [==>...........................] - ETA: 0s - loss: 0.00214/8 [==============>...............] - ETA: 0s - loss: 0.00227/8 [=========================>....] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 19ms/step - loss: 0.0022
1/8 [==>...........................] - ETA: 0s - loss: 0.00273/8 [==========>...................] - ETA: 0s - loss: 0.00275/8 [=================>............] - ETA: 0s - loss: 0.00307/8 [=========================>....] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 23ms/step - loss: 0.0030
1/8 [==>...........................] - ETA: 0s - loss: 0.00614/8 [==============>...............] - ETA: 0s - loss: 0.00327/8 [=========================>....] - ETA: 0s - loss: 0.00418/8 [==============================] - 0s 18ms/step - loss: 0.0041
1/8 [==>...........................] - ETA: 0s - loss: 0.01193/8 [==========>...................] - ETA: 0s - loss: 0.01445/8 [=================>............] - ETA: 0s - loss: 0.01426/8 [=====================>........] - ETA: 0s - loss: 0.01398/8 [==============================] - ETA: 0s - loss: 0.01408/8 [==============================] - 0s 51ms/step - loss: 0.0140
1/8 [==>...........................] - ETA: 0s - loss: 0.01303/8 [==========>...................] - ETA: 0s - loss: 0.01805/8 [=================>............] - ETA: 0s - loss: 0.01647/8 [=========================>....] - ETA: 0s - loss: 0.01688/8 [==============================] - 0s 29ms/step - loss: 0.0169
1/8 [==>...........................] - ETA: 0s - loss: 0.01183/8 [==========>...................] - ETA: 0s - loss: 0.01435/8 [=================>............] - ETA: 0s - loss: 0.01437/8 [=========================>....] - ETA: 0s - loss: 0.01398/8 [==============================] - 0s 26ms/step - loss: 0.0143
1/8 [==>...........................] - ETA: 0s - loss: 0.01023/8 [==========>...................] - ETA: 0s - loss: 0.01315/8 [=================>............] - ETA: 0s - loss: 0.01337/8 [=========================>....] - ETA: 0s - loss: 0.01348/8 [==============================] - 0s 27ms/step - loss: 0.0139
1/8 [==>...........................] - ETA: 0s - loss: 0.00743/8 [==========>...................] - ETA: 0s - loss: 0.00665/8 [=================>............] - ETA: 0s - loss: 0.00617/8 [=========================>....] - ETA: 0s - loss: 0.00608/8 [==============================] - 0s 34ms/step - loss: 0.0061
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0030380149837583303:
Train Score: 0.00773 MSE 0.08792 RMSE
Test Score: 0.00915 MSE 0.09563 RMSE
Deviation Min [0.00014956], Max [0.41945601]
Deviation 99.5th pctile [0.31176535]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1640,   16]))
Confusion matrix 
[[1640    0]
 [   7    9]]
precision 1.00000, recall 0.56250, f1 0.72000
Time to train: 801639 ms
Saving model models/A3Benchmark/A3Benchmark-TS54.csv.h5
Total Time to proces all the selected files : 807124 ms
A3Benchmark : Avg precision 1.00000 recall 0.56250 f1 0.72000 time to train 801639.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS54.csv  --epochs 20 --n_iter 3 --patience 3 :: took 814 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS55.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 01:21:40 AM MST
2020-12-01 01:21:46.365266: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 01:21:46.384012: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 01:21:46.384842: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56281c865c00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 01:21:46.384876: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 01:21:46.385013: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS55.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00282/8 [======>.......................] - ETA: 0s - loss: 0.00323/8 [==========>...................] - ETA: 0s - loss: 0.00335/8 [=================>............] - ETA: 0s - loss: 0.00396/8 [=====================>........] - ETA: 0s - loss: 0.00397/8 [=========================>....] - ETA: 0s - loss: 0.00388/8 [==============================] - ETA: 0s - loss: 0.00398/8 [==============================] - 1s 98ms/step - loss: 0.0039
1/8 [==>...........................] - ETA: 0s - loss: 0.00623/8 [==========>...................] - ETA: 0s - loss: 0.00794/8 [==============>...............] - ETA: 0s - loss: 0.00765/8 [=================>............] - ETA: 0s - loss: 0.00786/8 [=====================>........] - ETA: 0s - loss: 0.00797/8 [=========================>....] - ETA: 0s - loss: 0.00838/8 [==============================] - ETA: 0s - loss: 0.00858/8 [==============================] - 1s 87ms/step - loss: 0.0085
1/8 [==>...........................] - ETA: 0s - loss: 0.00594/8 [==============>...............] - ETA: 0s - loss: 0.00636/8 [=====================>........] - ETA: 0s - loss: 0.00628/8 [==============================] - 0s 22ms/step - loss: 0.0061
1/8 [==>...........................] - ETA: 0s - loss: 0.00245/8 [=================>............] - ETA: 0s - loss: 0.00277/8 [=========================>....] - ETA: 0s - loss: 0.00288/8 [==============================] - 0s 17ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 0.00272/8 [======>.......................] - ETA: 0s - loss: 0.00463/8 [==========>...................] - ETA: 0s - loss: 0.00384/8 [==============>...............] - ETA: 0s - loss: 0.00345/8 [=================>............] - ETA: 0s - loss: 0.00356/8 [=====================>........] - ETA: 0s - loss: 0.00377/8 [=========================>....] - ETA: 0s - loss: 0.00458/8 [==============================] - ETA: 0s - loss: 0.00468/8 [==============================] - 1s 121ms/step - loss: 0.0046
1/8 [==>...........................] - ETA: 0s - loss: 0.00673/8 [==========>...................] - ETA: 0s - loss: 0.00735/8 [=================>............] - ETA: 0s - loss: 0.00797/8 [=========================>....] - ETA: 0s - loss: 0.00798/8 [==============================] - 0s 35ms/step - loss: 0.0081
1/8 [==>...........................] - ETA: 0s - loss: 0.00873/8 [==========>...................] - ETA: 0s - loss: 0.01055/8 [=================>............] - ETA: 0s - loss: 0.01047/8 [=========================>....] - ETA: 0s - loss: 0.01098/8 [==============================] - 0s 37ms/step - loss: 0.0112
1/8 [==>...........................] - ETA: 0s - loss: 0.00562/8 [======>.......................] - ETA: 0s - loss: 0.00543/8 [==========>...................] - ETA: 0s - loss: 0.00624/8 [==============>...............] - ETA: 0s - loss: 0.00575/8 [=================>............] - ETA: 0s - loss: 0.00516/8 [=====================>........] - ETA: 0s - loss: 0.00507/8 [=========================>....] - ETA: 0s - loss: 0.00508/8 [==============================] - ETA: 0s - loss: 0.00508/8 [==============================] - 1s 68ms/step - loss: 0.0050
1/8 [==>...........................] - ETA: 0s - loss: 4.4994e-043/8 [==========>...................] - ETA: 0s - loss: 3.0702e-044/8 [==============>...............] - ETA: 0s - loss: 3.3942e-046/8 [=====================>........] - ETA: 0s - loss: 4.1358e-047/8 [=========================>....] - ETA: 0s - loss: 4.0444e-048/8 [==============================] - ETA: 0s - loss: 3.9833e-048/8 [==============================] - 1s 77ms/step - loss: 3.9833e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.01433/8 [==========>...................] - ETA: 0s - loss: 0.01715/8 [=================>............] - ETA: 0s - loss: 0.01706/8 [=====================>........] - ETA: 0s - loss: 0.01718/8 [==============================] - ETA: 0s - loss: 0.01808/8 [==============================] - 0s 47ms/step - loss: 0.0180
1/8 [==>...........................] - ETA: 0s - loss: 0.00273/8 [==========>...................] - ETA: 0s - loss: 0.00314/8 [==============>...............] - ETA: 0s - loss: 0.00316/8 [=====================>........] - ETA: 0s - loss: 0.00408/8 [==============================] - ETA: 0s - loss: 0.00408/8 [==============================] - 0s 41ms/step - loss: 0.0040
1/8 [==>...........................] - ETA: 0s - loss: 0.00177/8 [=========================>....] - ETA: 0s - loss: 0.00328/8 [==============================] - 0s 7ms/step - loss: 0.0032
1/8 [==>...........................] - ETA: 0s - loss: 0.00606/8 [=====================>........] - ETA: 0s - loss: 0.00528/8 [==============================] - 0s 11ms/step - loss: 0.0051
1/8 [==>...........................] - ETA: 0s - loss: 0.00183/8 [==========>...................] - ETA: 0s - loss: 0.00174/8 [==============>...............] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 32ms/step - loss: 0.0019
1/8 [==>...........................] - ETA: 0s - loss: 0.00412/8 [======>.......................] - ETA: 0s - loss: 0.00684/8 [==============>...............] - ETA: 0s - loss: 0.00546/8 [=====================>........] - ETA: 0s - loss: 0.00568/8 [==============================] - ETA: 0s - loss: 0.00628/8 [==============================] - 0s 46ms/step - loss: 0.0062
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.004079636186361313:
Train Score: 0.00647 MSE 0.08043 RMSE
Test Score: 0.00905 MSE 0.09515 RMSE
Deviation Min [1.5623332e-05], Max [0.40106652]
Deviation 99.5th pctile [0.19781839]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1645,   11]))
Confusion matrix 
[[1643    2]
 [   4    7]]
precision 0.77778, recall 0.63636, f1 0.70000
Time to train: 846197 ms
Saving model models/A3Benchmark/A3Benchmark-TS55.csv.h5
Total Time to proces all the selected files : 848706 ms
A3Benchmark : Avg precision 0.77778 recall 0.63636 f1 0.70000 time to train 846197.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS55.csv  --epochs 20 --n_iter 3 --patience 3 :: took 855 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS56.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 01:36:00 AM MST
2020-12-01 01:36:07.061397: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 01:36:07.080224: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 01:36:07.081154: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5556058aff70 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 01:36:07.081181: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 01:36:07.081296: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS56.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.01133/8 [==========>...................] - ETA: 0s - loss: 0.01015/8 [=================>............] - ETA: 0s - loss: 0.01077/8 [=========================>....] - ETA: 0s - loss: 0.00968/8 [==============================] - 0s 34ms/step - loss: 0.0096
1/8 [==>...........................] - ETA: 0s - loss: 0.00593/8 [==========>...................] - ETA: 0s - loss: 0.00695/8 [=================>............] - ETA: 0s - loss: 0.00757/8 [=========================>....] - ETA: 0s - loss: 0.00798/8 [==============================] - 0s 32ms/step - loss: 0.0081
1/8 [==>...........................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00175/8 [=================>............] - ETA: 0s - loss: 0.00127/8 [=========================>....] - ETA: 0s - loss: 0.00138/8 [==============================] - 0s 27ms/step - loss: 0.0013
1/8 [==>...........................] - ETA: 0s - loss: 0.01113/8 [==========>...................] - ETA: 0s - loss: 0.01244/8 [==============>...............] - ETA: 0s - loss: 0.01236/8 [=====================>........] - ETA: 0s - loss: 0.01388/8 [==============================] - ETA: 0s - loss: 0.01358/8 [==============================] - 0s 44ms/step - loss: 0.0135
1/8 [==>...........................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00135/8 [=================>............] - ETA: 0s - loss: 0.00147/8 [=========================>....] - ETA: 0s - loss: 0.00148/8 [==============================] - 0s 32ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 0.00743/8 [==========>...................] - ETA: 0s - loss: 0.00765/8 [=================>............] - ETA: 0s - loss: 0.00807/8 [=========================>....] - ETA: 0s - loss: 0.00748/8 [==============================] - 0s 39ms/step - loss: 0.0075
1/8 [==>...........................] - ETA: 0s - loss: 5.1966e-043/8 [==========>...................] - ETA: 0s - loss: 6.1525e-045/8 [=================>............] - ETA: 0s - loss: 9.2264e-047/8 [=========================>....] - ETA: 0s - loss: 8.7564e-048/8 [==============================] - 0s 28ms/step - loss: 8.4371e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00133/8 [==========>...................] - ETA: 0s - loss: 0.00175/8 [=================>............] - ETA: 0s - loss: 0.00137/8 [=========================>....] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 34ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 5.6833e-043/8 [==========>...................] - ETA: 0s - loss: 7.5626e-045/8 [=================>............] - ETA: 0s - loss: 6.5511e-047/8 [=========================>....] - ETA: 0s - loss: 9.5511e-048/8 [==============================] - 0s 30ms/step - loss: 9.4258e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00203/8 [==========>...................] - ETA: 0s - loss: 0.00155/8 [=================>............] - ETA: 0s - loss: 0.00227/8 [=========================>....] - ETA: 0s - loss: 0.00248/8 [==============================] - 0s 27ms/step - loss: 0.0024
1/8 [==>...........................] - ETA: 0s - loss: 0.00765/8 [=================>............] - ETA: 0s - loss: 0.00758/8 [==============================] - 0s 14ms/step - loss: 0.0070
1/8 [==>...........................] - ETA: 0s - loss: 0.00112/8 [======>.......................] - ETA: 0s - loss: 0.00143/8 [==========>...................] - ETA: 0s - loss: 0.00114/8 [==============>...............] - ETA: 0s - loss: 0.00106/8 [=====================>........] - ETA: 0s - loss: 0.00108/8 [==============================] - ETA: 0s - loss: 0.00108/8 [==============================] - 0s 54ms/step - loss: 0.0010
1/8 [==>...........................] - ETA: 0s - loss: 8.1389e-043/8 [==========>...................] - ETA: 0s - loss: 9.2070e-044/8 [==============>...............] - ETA: 0s - loss: 8.0757e-046/8 [=====================>........] - ETA: 0s - loss: 6.8917e-047/8 [=========================>....] - ETA: 0s - loss: 7.4465e-048/8 [==============================] - ETA: 0s - loss: 7.1824e-048/8 [==============================] - 1s 108ms/step - loss: 7.1824e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00144/8 [==============>...............] - ETA: 0s - loss: 0.00107/8 [=========================>....] - ETA: 0s - loss: 0.00148/8 [==============================] - 0s 18ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 0.00525/8 [=================>............] - ETA: 0s - loss: 0.00608/8 [==============================] - 0s 14ms/step - loss: 0.0060
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.002635527541860938:
Train Score: 0.00107 MSE 0.03270 RMSE
Test Score: 0.00113 MSE 0.03356 RMSE
Deviation Min [3.47310186e-05], Max [0.24985321]
Deviation 99.5th pctile [0.08633488]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1655,    1]))
Confusion matrix 
[[1647    8]
 [   0    1]]
precision 0.11111, recall 1.00000, f1 0.20000
Time to train: 1025471 ms
Saving model models/A3Benchmark/A3Benchmark-TS56.csv.h5
Total Time to proces all the selected files : 1032028 ms
A3Benchmark : Avg precision 0.11111 recall 1.00000 f1 0.20000 time to train 1025471.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS56.csv  --epochs 20 --n_iter 3 --patience 3 :: took 1039 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS57.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 01:53:24 AM MST
2020-12-01 01:53:31.037997: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 01:53:31.056235: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 01:53:31.057123: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56011278dc00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 01:53:31.057151: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 01:53:31.057267: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS57.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00675/8 [=================>............] - ETA: 0s - loss: 0.00688/8 [==============================] - 0s 13ms/step - loss: 0.0066
1/8 [==>...........................] - ETA: 0s - loss: 0.00124/8 [==============>...............] - ETA: 0s - loss: 0.00227/8 [=========================>....] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 19ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.00485/8 [=================>............] - ETA: 0s - loss: 0.00468/8 [==============================] - 0s 13ms/step - loss: 0.0049
1/8 [==>...........................] - ETA: 0s - loss: 0.00532/8 [======>.......................] - ETA: 0s - loss: 0.00633/8 [==========>...................] - ETA: 0s - loss: 0.00654/8 [==============>...............] - ETA: 0s - loss: 0.00635/8 [=================>............] - ETA: 0s - loss: 0.00646/8 [=====================>........] - ETA: 0s - loss: 0.00667/8 [=========================>....] - ETA: 0s - loss: 0.00658/8 [==============================] - 1s 86ms/step - loss: 0.0066
1/8 [==>...........................] - ETA: 0s - loss: 0.00322/8 [======>.......................] - ETA: 0s - loss: 0.00373/8 [==========>...................] - ETA: 0s - loss: 0.00354/8 [==============>...............] - ETA: 0s - loss: 0.00335/8 [=================>............] - ETA: 0s - loss: 0.00366/8 [=====================>........] - ETA: 0s - loss: 0.00377/8 [=========================>....] - ETA: 0s - loss: 0.00398/8 [==============================] - ETA: 0s - loss: 0.00408/8 [==============================] - 1s 143ms/step - loss: 0.0040
1/8 [==>...........................] - ETA: 0s - loss: 0.00325/8 [=================>............] - ETA: 0s - loss: 0.00228/8 [==============================] - ETA: 0s - loss: 0.00258/8 [==============================] - 0s 14ms/step - loss: 0.0025
1/8 [==>...........................] - ETA: 0s - loss: 0.00213/8 [==========>...................] - ETA: 0s - loss: 0.00335/8 [=================>............] - ETA: 0s - loss: 0.00347/8 [=========================>....] - ETA: 0s - loss: 0.00338/8 [==============================] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 57ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.00475/8 [=================>............] - ETA: 0s - loss: 0.00648/8 [==============================] - 0s 12ms/step - loss: 0.0066
1/8 [==>...........................] - ETA: 0s - loss: 0.00534/8 [==============>...............] - ETA: 0s - loss: 0.00658/8 [==============================] - ETA: 0s - loss: 0.00698/8 [==============================] - 0s 17ms/step - loss: 0.0069
1/8 [==>...........................] - ETA: 0s - loss: 0.00384/8 [==============>...............] - ETA: 0s - loss: 0.00377/8 [=========================>....] - ETA: 0s - loss: 0.00498/8 [==============================] - 0s 20ms/step - loss: 0.0050
1/8 [==>...........................] - ETA: 0s - loss: 0.00674/8 [==============>...............] - ETA: 0s - loss: 0.00697/8 [=========================>....] - ETA: 0s - loss: 0.00678/8 [==============================] - 0s 16ms/step - loss: 0.0068
1/8 [==>...........................] - ETA: 0s - loss: 0.00583/8 [==========>...................] - ETA: 0s - loss: 0.00825/8 [=================>............] - ETA: 0s - loss: 0.00787/8 [=========================>....] - ETA: 0s - loss: 0.00768/8 [==============================] - ETA: 0s - loss: 0.00808/8 [==============================] - 1s 63ms/step - loss: 0.0080
1/8 [==>...........................] - ETA: 0s - loss: 0.00496/8 [=====================>........] - ETA: 0s - loss: 0.00668/8 [==============================] - 0s 10ms/step - loss: 0.0068
1/8 [==>...........................] - ETA: 0s - loss: 0.00305/8 [=================>............] - ETA: 0s - loss: 0.00318/8 [==============================] - 0s 11ms/step - loss: 0.0031
1/8 [==>...........................] - ETA: 0s - loss: 0.00903/8 [==========>...................] - ETA: 0s - loss: 0.00865/8 [=================>............] - ETA: 0s - loss: 0.00908/8 [==============================] - ETA: 0s - loss: 0.00948/8 [==============================] - 0s 30ms/step - loss: 0.0094
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.00489465887658298:
Train Score: 0.00342 MSE 0.05852 RMSE
Test Score: 0.00853 MSE 0.09238 RMSE
Deviation Min [2.26090828e-05], Max [0.25328826]
Deviation 99.5th pctile [0.20763552]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Confusion matrix 
[[1643    4]
 [   4    5]]
precision 0.55556, recall 0.55556, f1 0.55556
Time to train: 484252 ms
Saving model models/A3Benchmark/A3Benchmark-TS57.csv.h5
Total Time to proces all the selected files : 489015 ms
A3Benchmark : Avg precision 0.55556 recall 0.55556 f1 0.55556 time to train 484252.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS57.csv  --epochs 20 --n_iter 3 --patience 3 :: took 496 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS58.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 02:01:45 AM MST
2020-12-01 02:01:51.261616: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 02:01:51.282007: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 02:01:51.282932: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55aea7883d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 02:01:51.282959: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 02:01:51.283095: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS58.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.01673/8 [==========>...................] - ETA: 0s - loss: 0.00965/8 [=================>............] - ETA: 0s - loss: 0.00847/8 [=========================>....] - ETA: 0s - loss: 0.00888/8 [==============================] - ETA: 0s - loss: 0.00848/8 [==============================] - 0s 39ms/step - loss: 0.0084
1/8 [==>...........................] - ETA: 0s - loss: 0.00462/8 [======>.......................] - ETA: 1s - loss: 0.00583/8 [==========>...................] - ETA: 1s - loss: 0.00504/8 [==============>...............] - ETA: 0s - loss: 0.00575/8 [=================>............] - ETA: 0s - loss: 0.00586/8 [=====================>........] - ETA: 0s - loss: 0.00547/8 [=========================>....] - ETA: 0s - loss: 0.00538/8 [==============================] - 1s 145ms/step - loss: 0.0052
1/8 [==>...........................] - ETA: 0s - loss: 0.00432/8 [======>.......................] - ETA: 0s - loss: 0.00803/8 [==========>...................] - ETA: 0s - loss: 0.00724/8 [==============>...............] - ETA: 0s - loss: 0.00745/8 [=================>............] - ETA: 0s - loss: 0.00746/8 [=====================>........] - ETA: 0s - loss: 0.00667/8 [=========================>....] - ETA: 0s - loss: 0.00798/8 [==============================] - ETA: 0s - loss: 0.00858/8 [==============================] - 1s 110ms/step - loss: 0.0085
1/8 [==>...........................] - ETA: 0s - loss: 0.00323/8 [==========>...................] - ETA: 0s - loss: 0.00465/8 [=================>............] - ETA: 0s - loss: 0.00497/8 [=========================>....] - ETA: 0s - loss: 0.00518/8 [==============================] - 0s 30ms/step - loss: 0.0052
1/8 [==>...........................] - ETA: 0s - loss: 0.00522/8 [======>.......................] - ETA: 0s - loss: 0.00414/8 [==============>...............] - ETA: 0s - loss: 0.00356/8 [=====================>........] - ETA: 0s - loss: 0.00608/8 [==============================] - ETA: 0s - loss: 0.00568/8 [==============================] - 0s 41ms/step - loss: 0.0056
1/8 [==>...........................] - ETA: 0s - loss: 0.01135/8 [=================>............] - ETA: 0s - loss: 0.00768/8 [==============================] - 0s 12ms/step - loss: 0.0063
1/8 [==>...........................] - ETA: 0s - loss: 0.00444/8 [==============>...............] - ETA: 0s - loss: 0.00477/8 [=========================>....] - ETA: 0s - loss: 0.00468/8 [==============================] - 0s 18ms/step - loss: 0.0045
1/8 [==>...........................] - ETA: 0s - loss: 0.00614/8 [==============>...............] - ETA: 0s - loss: 0.00577/8 [=========================>....] - ETA: 0s - loss: 0.00778/8 [==============================] - 0s 19ms/step - loss: 0.0075
1/8 [==>...........................] - ETA: 0s - loss: 0.01065/8 [=================>............] - ETA: 0s - loss: 0.00718/8 [==============================] - 0s 13ms/step - loss: 0.0073
1/8 [==>...........................] - ETA: 0s - loss: 0.01802/8 [======>.......................] - ETA: 0s - loss: 0.01953/8 [==========>...................] - ETA: 0s - loss: 0.02244/8 [==============>...............] - ETA: 0s - loss: 0.02167/8 [=========================>....] - ETA: 0s - loss: 0.02218/8 [==============================] - 0s 43ms/step - loss: 0.0225
1/8 [==>...........................] - ETA: 0s - loss: 0.01344/8 [==============>...............] - ETA: 0s - loss: 0.00776/8 [=====================>........] - ETA: 0s - loss: 0.00697/8 [=========================>....] - ETA: 0s - loss: 0.00688/8 [==============================] - 0s 37ms/step - loss: 0.0065
1/8 [==>...........................] - ETA: 0s - loss: 0.00363/8 [==========>...................] - ETA: 0s - loss: 0.00475/8 [=================>............] - ETA: 0s - loss: 0.00547/8 [=========================>....] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 26ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00754/8 [==============>...............] - ETA: 0s - loss: 0.00727/8 [=========================>....] - ETA: 0s - loss: 0.00898/8 [==============================] - 0s 17ms/step - loss: 0.0089
1/8 [==>...........................] - ETA: 0s - loss: 0.00284/8 [==============>...............] - ETA: 0s - loss: 0.00366/8 [=====================>........] - ETA: 0s - loss: 0.00398/8 [==============================] - 0s 24ms/step - loss: 0.0039
1/8 [==>...........................] - ETA: 0s - loss: 0.00414/8 [==============>...............] - ETA: 0s - loss: 0.00438/8 [==============================] - ETA: 0s - loss: 0.00558/8 [==============================] - 0s 15ms/step - loss: 0.0055
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.005922665959224105:
Train Score: 0.00533 MSE 0.07298 RMSE
Test Score: 0.00476 MSE 0.06901 RMSE
Deviation Min [2.06907276e-05], Max [0.52909662]
Deviation 99.5th pctile [0.2063216]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1653,    3]))
Confusion matrix 
[[1647    6]
 [   0    3]]
precision 0.33333, recall 1.00000, f1 0.50000
Time to train: 1041684 ms
Saving model models/A3Benchmark/A3Benchmark-TS58.csv.h5
Total Time to proces all the selected files : 1044482 ms
A3Benchmark : Avg precision 0.33333 recall 1.00000 f1 0.50000 time to train 1041684.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS58.csv  --epochs 20 --n_iter 3 --patience 3 :: took 1051 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS59.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 02:19:21 AM MST
2020-12-01 02:19:27.323721: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 02:19:27.342200: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 02:19:27.343776: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55ce071a7310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 02:19:27.343828: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 02:19:27.344062: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS59.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00522/8 [======>.......................] - ETA: 0s - loss: 0.00663/8 [==========>...................] - ETA: 0s - loss: 0.00734/8 [==============>...............] - ETA: 0s - loss: 0.00735/8 [=================>............] - ETA: 0s - loss: 0.00736/8 [=====================>........] - ETA: 0s - loss: 0.00747/8 [=========================>....] - ETA: 0s - loss: 0.00778/8 [==============================] - ETA: 0s - loss: 0.00818/8 [==============================] - 1s 85ms/step - loss: 0.0081
1/8 [==>...........................] - ETA: 0s - loss: 0.00613/8 [==========>...................] - ETA: 0s - loss: 0.00755/8 [=================>............] - ETA: 0s - loss: 0.00927/8 [=========================>....] - ETA: 0s - loss: 0.01008/8 [==============================] - 0s 34ms/step - loss: 0.0104
1/8 [==>...........................] - ETA: 0s - loss: 0.00922/8 [======>.......................] - ETA: 0s - loss: 0.01054/8 [==============>...............] - ETA: 0s - loss: 0.01225/8 [=================>............] - ETA: 0s - loss: 0.01186/8 [=====================>........] - ETA: 0s - loss: 0.01248/8 [==============================] - ETA: 0s - loss: 0.01388/8 [==============================] - 1s 65ms/step - loss: 0.0138
1/8 [==>...........................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00125/8 [=================>............] - ETA: 0s - loss: 0.00217/8 [=========================>....] - ETA: 0s - loss: 0.00208/8 [==============================] - 0s 34ms/step - loss: 0.0020
1/8 [==>...........................] - ETA: 0s - loss: 0.00282/8 [======>.......................] - ETA: 0s - loss: 0.00444/8 [==============>...............] - ETA: 0s - loss: 0.00596/8 [=====================>........] - ETA: 0s - loss: 0.00517/8 [=========================>....] - ETA: 0s - loss: 0.00538/8 [==============================] - ETA: 0s - loss: 0.00538/8 [==============================] - 0s 47ms/step - loss: 0.0053
1/8 [==>...........................] - ETA: 0s - loss: 0.00975/8 [=================>............] - ETA: 0s - loss: 0.01368/8 [==============================] - ETA: 0s - loss: 0.01758/8 [==============================] - 0s 14ms/step - loss: 0.0175
1/8 [==>...........................] - ETA: 0s - loss: 0.00325/8 [=================>............] - ETA: 0s - loss: 0.00467/8 [=========================>....] - ETA: 0s - loss: 0.00478/8 [==============================] - 0s 22ms/step - loss: 0.0050
1/8 [==>...........................] - ETA: 0s - loss: 0.00762/8 [======>.......................] - ETA: 0s - loss: 0.00823/8 [==========>...................] - ETA: 0s - loss: 0.00885/8 [=================>............] - ETA: 0s - loss: 0.00816/8 [=====================>........] - ETA: 0s - loss: 0.00848/8 [==============================] - ETA: 0s - loss: 0.00888/8 [==============================] - 1s 63ms/step - loss: 0.0088
1/8 [==>...........................] - ETA: 0s - loss: 0.00112/8 [======>.......................] - ETA: 0s - loss: 9.8109e-045/8 [=================>............] - ETA: 0s - loss: 0.0022    8/8 [==============================] - 0s 18ms/step - loss: 0.0020
1/8 [==>...........................] - ETA: 0s - loss: 0.05474/8 [==============>...............] - ETA: 0s - loss: 0.07297/8 [=========================>....] - ETA: 0s - loss: 0.07438/8 [==============================] - 0s 16ms/step - loss: 0.0748
1/8 [==>...........................] - ETA: 0s - loss: 0.00795/8 [=================>............] - ETA: 0s - loss: 0.00958/8 [==============================] - 0s 14ms/step - loss: 0.0089
1/8 [==>...........................] - ETA: 0s - loss: 0.00114/8 [==============>...............] - ETA: 0s - loss: 0.00187/8 [=========================>....] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 18ms/step - loss: 0.0020
1/8 [==>...........................] - ETA: 0s - loss: 0.00352/8 [======>.......................] - ETA: 0s - loss: 0.00364/8 [==============>...............] - ETA: 0s - loss: 0.00315/8 [=================>............] - ETA: 0s - loss: 0.00288/8 [==============================] - ETA: 0s - loss: 0.00348/8 [==============================] - 0s 46ms/step - loss: 0.0034
1/8 [==>...........................] - ETA: 0s - loss: 7.5499e-044/8 [==============>...............] - ETA: 0s - loss: 0.0011    7/8 [=========================>....] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 22ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 13ms/step - loss: 0.0023
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.003595019457861781:
Train Score: 0.00217 MSE 0.04660 RMSE
Test Score: 0.00195 MSE 0.04421 RMSE
Deviation Min [3.37486223e-05], Max [0.2623078]
Deviation 99.5th pctile [0.21129832]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1645,   11]))
Confusion matrix 
[[1645    0]
 [   2    9]]
precision 1.00000, recall 0.81818, f1 0.90000
Time to train: 674701 ms
Saving model models/A3Benchmark/A3Benchmark-TS59.csv.h5
Total Time to proces all the selected files : 677698 ms
A3Benchmark : Avg precision 1.00000 recall 0.81818 f1 0.90000 time to train 674701.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS59.csv  --epochs 20 --n_iter 3 --patience 3 :: took 684 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS5.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 02:30:50 AM MST
2020-12-01 02:30:56.857457: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 02:30:56.876261: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 02:30:56.877672: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5634b2310310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 02:30:56.877722: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 02:30:56.877927: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS5.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00933/8 [==========>...................] - ETA: 0s - loss: 0.01056/8 [=====================>........] - ETA: 0s - loss: 0.01068/8 [==============================] - 0s 22ms/step - loss: 0.0105
1/8 [==>...........................] - ETA: 0s - loss: 0.00484/8 [==============>...............] - ETA: 0s - loss: 0.00627/8 [=========================>....] - ETA: 0s - loss: 0.00598/8 [==============================] - 0s 20ms/step - loss: 0.0060
1/8 [==>...........................] - ETA: 0s - loss: 0.00182/8 [======>.......................] - ETA: 0s - loss: 0.00213/8 [==========>...................] - ETA: 0s - loss: 0.00284/8 [==============>...............] - ETA: 0s - loss: 0.00235/8 [=================>............] - ETA: 0s - loss: 0.00207/8 [=========================>....] - ETA: 0s - loss: 0.00188/8 [==============================] - 1s 97ms/step - loss: 0.0018
1/8 [==>...........................] - ETA: 0s - loss: 5.7997e-043/8 [==========>...................] - ETA: 0s - loss: 0.0019    5/8 [=================>............] - ETA: 0s - loss: 0.00147/8 [=========================>....] - ETA: 0s - loss: 0.00148/8 [==============================] - 0s 26ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 0.00273/8 [==========>...................] - ETA: 0s - loss: 0.00225/8 [=================>............] - ETA: 0s - loss: 0.00317/8 [=========================>....] - ETA: 0s - loss: 0.00358/8 [==============================] - 0s 24ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.00845/8 [=================>............] - ETA: 0s - loss: 0.00968/8 [==============================] - ETA: 0s - loss: 0.00938/8 [==============================] - 0s 15ms/step - loss: 0.0093
1/8 [==>...........................] - ETA: 0s - loss: 3.9059e-045/8 [=================>............] - ETA: 0s - loss: 2.6447e-048/8 [==============================] - 0s 13ms/step - loss: 2.9336e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00245/8 [=================>............] - ETA: 0s - loss: 0.00288/8 [==============================] - 0s 14ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 4.2271e-045/8 [=================>............] - ETA: 0s - loss: 5.4612e-048/8 [==============================] - 0s 13ms/step - loss: 4.8805e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.01954/8 [==============>...............] - ETA: 0s - loss: 0.02727/8 [=========================>....] - ETA: 0s - loss: 0.02798/8 [==============================] - 0s 18ms/step - loss: 0.0284
1/8 [==>...........................] - ETA: 0s - loss: 0.00774/8 [==============>...............] - ETA: 0s - loss: 0.00857/8 [=========================>....] - ETA: 0s - loss: 0.00838/8 [==============================] - 0s 18ms/step - loss: 0.0084
1/8 [==>...........................] - ETA: 0s - loss: 0.00795/8 [=================>............] - ETA: 0s - loss: 0.00978/8 [==============================] - 0s 13ms/step - loss: 0.0101
1/8 [==>...........................] - ETA: 0s - loss: 8.8957e-045/8 [=================>............] - ETA: 0s - loss: 0.0014    8/8 [==============================] - 0s 14ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 0.00785/8 [=================>............] - ETA: 0s - loss: 0.00768/8 [==============================] - 0s 13ms/step - loss: 0.0080
1/8 [==>...........................] - ETA: 0s - loss: 0.01404/8 [==============>...............] - ETA: 0s - loss: 0.01897/8 [=========================>....] - ETA: 0s - loss: 0.01908/8 [==============================] - 0s 18ms/step - loss: 0.0194
Best parameters {'n_units': 48, 'n_hidden': 2} best score 0.004670470068231225:
Train Score: 0.01154 MSE 0.10742 RMSE
Test Score: 0.01226 MSE 0.11075 RMSE
Deviation Min [0.00011513], Max [0.25393841]
Deviation 99.5th pctile [0.24105944]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1654,    2]))
Confusion matrix 
[[1645    9]
 [   2    0]]
precision 0.00000, recall 0.00000, f1 0.00000
Time to train: 834163 ms
Saving model models/A3Benchmark/A3Benchmark-TS5.csv.h5
Total Time to proces all the selected files : 839490 ms
A3Benchmark : Avg precision 0.00000 recall 0.00000 f1 0.00000 time to train 834163.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS5.csv  --epochs 20 --n_iter 3 --patience 3 :: took 846 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS60.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 02:45:01 AM MST
2020-12-01 02:45:08.189760: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 02:45:08.209026: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 02:45:08.209887: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5577dfaa7d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 02:45:08.209914: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 02:45:08.210032: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS60.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00303/8 [==========>...................] - ETA: 0s - loss: 0.00355/8 [=================>............] - ETA: 0s - loss: 0.00347/8 [=========================>....] - ETA: 0s - loss: 0.00358/8 [==============================] - 0s 24ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.00243/8 [==========>...................] - ETA: 0s - loss: 0.00365/8 [=================>............] - ETA: 0s - loss: 0.00367/8 [=========================>....] - ETA: 0s - loss: 0.00348/8 [==============================] - 0s 34ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.00243/8 [==========>...................] - ETA: 0s - loss: 0.00325/8 [=================>............] - ETA: 0s - loss: 0.00307/8 [=========================>....] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 33ms/step - loss: 0.0030
1/8 [==>...........................] - ETA: 0s - loss: 0.00204/8 [==============>...............] - ETA: 0s - loss: 0.00327/8 [=========================>....] - ETA: 0s - loss: 0.00338/8 [==============================] - 0s 15ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.01003/8 [==========>...................] - ETA: 0s - loss: 0.00905/8 [=================>............] - ETA: 0s - loss: 0.00977/8 [=========================>....] - ETA: 0s - loss: 0.01088/8 [==============================] - 0s 29ms/step - loss: 0.0111
1/8 [==>...........................] - ETA: 0s - loss: 0.00234/8 [==============>...............] - ETA: 0s - loss: 0.00268/8 [==============================] - ETA: 0s - loss: 0.00278/8 [==============================] - 0s 15ms/step - loss: 0.0027
1/8 [==>...........................] - ETA: 0s - loss: 0.00194/8 [==============>...............] - ETA: 0s - loss: 0.00267/8 [=========================>....] - ETA: 0s - loss: 0.00258/8 [==============================] - 0s 17ms/step - loss: 0.0025
1/8 [==>...........................] - ETA: 0s - loss: 0.00334/8 [==============>...............] - ETA: 0s - loss: 0.00377/8 [=========================>....] - ETA: 0s - loss: 0.00348/8 [==============================] - 0s 17ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.00175/8 [=================>............] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 13ms/step - loss: 0.0025
1/8 [==>...........................] - ETA: 0s - loss: 0.00554/8 [==============>...............] - ETA: 0s - loss: 0.00485/8 [=================>............] - ETA: 0s - loss: 0.00557/8 [=========================>....] - ETA: 0s - loss: 0.00638/8 [==============================] - 0s 23ms/step - loss: 0.0064
1/8 [==>...........................] - ETA: 0s - loss: 0.00293/8 [==========>...................] - ETA: 0s - loss: 0.00345/8 [=================>............] - ETA: 0s - loss: 0.00337/8 [=========================>....] - ETA: 0s - loss: 0.00338/8 [==============================] - 0s 40ms/step - loss: 0.0034
1/8 [==>...........................] - ETA: 0s - loss: 0.00233/8 [==========>...................] - ETA: 0s - loss: 0.00344/8 [==============>...............] - ETA: 0s - loss: 0.00336/8 [=====================>........] - ETA: 0s - loss: 0.00347/8 [=========================>....] - ETA: 0s - loss: 0.00328/8 [==============================] - 0s 44ms/step - loss: 0.0033
1/8 [==>...........................] - ETA: 0s - loss: 0.00233/8 [==========>...................] - ETA: 0s - loss: 0.00305/8 [=================>............] - ETA: 0s - loss: 0.00297/8 [=========================>....] - ETA: 0s - loss: 0.00288/8 [==============================] - 0s 39ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00203/8 [==========>...................] - ETA: 0s - loss: 0.00284/8 [==============>...............] - ETA: 0s - loss: 0.00276/8 [=====================>........] - ETA: 0s - loss: 0.00287/8 [=========================>....] - ETA: 0s - loss: 0.00288/8 [==============================] - ETA: 0s - loss: 0.00298/8 [==============================] - 1s 92ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00433/8 [==========>...................] - ETA: 0s - loss: 0.00405/8 [=================>............] - ETA: 0s - loss: 0.00447/8 [=========================>....] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 35ms/step - loss: 0.0050
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.0034857478458434343:
Train Score: 0.00329 MSE 0.05736 RMSE
Test Score: 0.00762 MSE 0.08728 RMSE
Deviation Min [2.75991959e-05], Max [0.18719352]
Deviation 99.5th pctile [0.16723765]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1644,   12]))
Confusion matrix 
[[1636    8]
 [  11    1]]
precision 0.11111, recall 0.08333, f1 0.09524
Time to train: 511999 ms
Saving model models/A3Benchmark/A3Benchmark-TS60.csv.h5
Total Time to proces all the selected files : 519047 ms
A3Benchmark : Avg precision 0.11111 recall 0.08333 f1 0.09524 time to train 511999.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS60.csv  --epochs 20 --n_iter 3 --patience 3 :: took 526 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS61.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 02:53:52 AM MST
2020-12-01 02:53:59.163677: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 02:53:59.182181: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 02:53:59.183009: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56048bc0dd30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 02:53:59.183037: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 02:53:59.183159: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS61.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00613/8 [==========>...................] - ETA: 0s - loss: 0.00694/8 [==============>...............] - ETA: 0s - loss: 0.00686/8 [=====================>........] - ETA: 0s - loss: 0.00707/8 [=========================>....] - ETA: 0s - loss: 0.00768/8 [==============================] - ETA: 0s - loss: 0.00768/8 [==============================] - 0s 50ms/step - loss: 0.0076
1/8 [==>...........................] - ETA: 0s - loss: 0.00586/8 [=====================>........] - ETA: 0s - loss: 0.00588/8 [==============================] - 0s 12ms/step - loss: 0.0051
1/8 [==>...........................] - ETA: 0s - loss: 0.00775/8 [=================>............] - ETA: 0s - loss: 0.00878/8 [==============================] - ETA: 0s - loss: 0.00978/8 [==============================] - 0s 15ms/step - loss: 0.0097
1/8 [==>...........................] - ETA: 0s - loss: 0.00274/8 [==============>...............] - ETA: 0s - loss: 0.00247/8 [=========================>....] - ETA: 0s - loss: 0.00288/8 [==============================] - 0s 17ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.00594/8 [==============>...............] - ETA: 0s - loss: 0.00785/8 [=================>............] - ETA: 0s - loss: 0.00788/8 [==============================] - ETA: 0s - loss: 0.00888/8 [==============================] - 0s 25ms/step - loss: 0.0088
1/8 [==>...........................] - ETA: 0s - loss: 0.00435/8 [=================>............] - ETA: 0s - loss: 0.00288/8 [==============================] - 0s 14ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.00925/8 [=================>............] - ETA: 0s - loss: 0.01187/8 [=========================>....] - ETA: 0s - loss: 0.01188/8 [==============================] - 0s 18ms/step - loss: 0.0120
1/8 [==>...........................] - ETA: 0s - loss: 0.00493/8 [==========>...................] - ETA: 0s - loss: 0.00574/8 [==============>...............] - ETA: 0s - loss: 0.00526/8 [=====================>........] - ETA: 0s - loss: 0.00488/8 [==============================] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 38ms/step - loss: 0.0057
1/8 [==>...........................] - ETA: 0s - loss: 0.00254/8 [==============>...............] - ETA: 0s - loss: 0.00277/8 [=========================>....] - ETA: 0s - loss: 0.00308/8 [==============================] - 0s 17ms/step - loss: 0.0038
1/8 [==>...........................] - ETA: 0s - loss: 0.00594/8 [==============>...............] - ETA: 0s - loss: 0.00747/8 [=========================>....] - ETA: 0s - loss: 0.00878/8 [==============================] - 0s 18ms/step - loss: 0.0087
1/8 [==>...........................] - ETA: 0s - loss: 0.01013/8 [==========>...................] - ETA: 0s - loss: 0.01205/8 [=================>............] - ETA: 0s - loss: 0.01207/8 [=========================>....] - ETA: 0s - loss: 0.01248/8 [==============================] - 0s 33ms/step - loss: 0.0127
1/8 [==>...........................] - ETA: 0s - loss: 0.00973/8 [==========>...................] - ETA: 0s - loss: 0.01234/8 [==============>...............] - ETA: 0s - loss: 0.01245/8 [=================>............] - ETA: 0s - loss: 0.01316/8 [=====================>........] - ETA: 0s - loss: 0.01377/8 [=========================>....] - ETA: 0s - loss: 0.01328/8 [==============================] - ETA: 0s - loss: 0.01358/8 [==============================] - 1s 105ms/step - loss: 0.0135
1/8 [==>...........................] - ETA: 0s - loss: 0.00852/8 [======>.......................] - ETA: 0s - loss: 0.01023/8 [==========>...................] - ETA: 0s - loss: 0.01104/8 [==============>...............] - ETA: 0s - loss: 0.01055/8 [=================>............] - ETA: 0s - loss: 0.01116/8 [=====================>........] - ETA: 0s - loss: 0.01127/8 [=========================>....] - ETA: 0s - loss: 0.01158/8 [==============================] - ETA: 0s - loss: 0.01188/8 [==============================] - 2s 199ms/step - loss: 0.0118
1/8 [==>...........................] - ETA: 0s - loss: 0.00373/8 [==========>...................] - ETA: 0s - loss: 0.00345/8 [=================>............] - ETA: 0s - loss: 0.00427/8 [=========================>....] - ETA: 0s - loss: 0.00448/8 [==============================] - 0s 26ms/step - loss: 0.0051
1/8 [==>...........................] - ETA: 0s - loss: 0.01272/8 [======>.......................] - ETA: 0s - loss: 0.01783/8 [==========>...................] - ETA: 0s - loss: 0.01774/8 [==============>...............] - ETA: 0s - loss: 0.01635/8 [=================>............] - ETA: 0s - loss: 0.01676/8 [=====================>........] - ETA: 0s - loss: 0.01777/8 [=========================>....] - ETA: 0s - loss: 0.01768/8 [==============================] - ETA: 0s - loss: 0.01768/8 [==============================] - 1s 136ms/step - loss: 0.0176
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0067454766482114795:
Train Score: 0.01025 MSE 0.10125 RMSE
Test Score: 0.01195 MSE 0.10931 RMSE
Deviation Min [7.56549033e-06], Max [0.4764174]
Deviation 99.5th pctile [0.27453286]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1643,   13]))
Confusion matrix 
[[1642    1]
 [   5    8]]
precision 0.88889, recall 0.61538, f1 0.72727
Time to train: 620885 ms
Saving model models/A3Benchmark/A3Benchmark-TS61.csv.h5
Total Time to proces all the selected files : 625655 ms
A3Benchmark : Avg precision 0.88889 recall 0.61538 f1 0.72727 time to train 620885.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS61.csv  --epochs 20 --n_iter 3 --patience 3 :: took 633 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS62.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 03:04:30 AM MST
2020-12-01 03:04:36.265932: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 03:04:36.284013: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 03:04:36.284814: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55957f06cd30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 03:04:36.284843: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 03:04:36.285010: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS62.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00316/8 [=====================>........] - ETA: 0s - loss: 0.00208/8 [==============================] - 0s 11ms/step - loss: 0.0018
1/8 [==>...........................] - ETA: 0s - loss: 2.0809e-046/8 [=====================>........] - ETA: 0s - loss: 2.8959e-048/8 [==============================] - 0s 12ms/step - loss: 2.9049e-04
1/8 [==>...........................] - ETA: 0s - loss: 2.3520e-044/8 [==============>...............] - ETA: 0s - loss: 2.5295e-048/8 [==============================] - 0s 12ms/step - loss: 2.8567e-04
1/8 [==>...........................] - ETA: 0s - loss: 4.3467e-044/8 [==============>...............] - ETA: 0s - loss: 4.7530e-047/8 [=========================>....] - ETA: 0s - loss: 4.5308e-048/8 [==============================] - 0s 16ms/step - loss: 4.5610e-04
1/8 [==>...........................] - ETA: 0s - loss: 7.6519e-045/8 [=================>............] - ETA: 0s - loss: 0.0017    8/8 [==============================] - 0s 12ms/step - loss: 0.0024
1/8 [==>...........................] - ETA: 0s - loss: 0.00183/8 [==========>...................] - ETA: 0s - loss: 0.00155/8 [=================>............] - ETA: 0s - loss: 0.00137/8 [=========================>....] - ETA: 0s - loss: 0.00118/8 [==============================] - 0s 30ms/step - loss: 0.0011
1/8 [==>...........................] - ETA: 0s - loss: 2.5180e-043/8 [==========>...................] - ETA: 0s - loss: 3.3256e-044/8 [==============>...............] - ETA: 0s - loss: 3.1957e-046/8 [=====================>........] - ETA: 0s - loss: 3.4457e-048/8 [==============================] - ETA: 0s - loss: 3.3838e-048/8 [==============================] - 0s 40ms/step - loss: 3.3838e-04
1/8 [==>...........................] - ETA: 0s - loss: 2.6993e-043/8 [==========>...................] - ETA: 0s - loss: 3.2720e-045/8 [=================>............] - ETA: 0s - loss: 3.0777e-047/8 [=========================>....] - ETA: 0s - loss: 3.3318e-048/8 [==============================] - 0s 29ms/step - loss: 3.4980e-04
1/8 [==>...........................] - ETA: 0s - loss: 2.8965e-043/8 [==========>...................] - ETA: 0s - loss: 3.4926e-045/8 [=================>............] - ETA: 0s - loss: 3.3946e-047/8 [=========================>....] - ETA: 0s - loss: 3.3894e-048/8 [==============================] - 0s 28ms/step - loss: 3.5173e-04
1/8 [==>...........................] - ETA: 0s - loss: 3.7150e-042/8 [======>.......................] - ETA: 0s - loss: 3.2130e-044/8 [==============>...............] - ETA: 0s - loss: 3.3376e-046/8 [=====================>........] - ETA: 0s - loss: 3.8611e-048/8 [==============================] - ETA: 0s - loss: 4.0552e-048/8 [==============================] - 0s 31ms/step - loss: 4.0552e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00644/8 [==============>...............] - ETA: 0s - loss: 0.00468/8 [==============================] - ETA: 0s - loss: 0.00328/8 [==============================] - 0s 14ms/step - loss: 0.0032
1/8 [==>...........................] - ETA: 0s - loss: 2.3857e-044/8 [==============>...............] - ETA: 0s - loss: 2.7739e-047/8 [=========================>....] - ETA: 0s - loss: 2.9418e-048/8 [==============================] - 0s 18ms/step - loss: 3.0018e-04
1/8 [==>...........................] - ETA: 0s - loss: 2.7709e-045/8 [=================>............] - ETA: 0s - loss: 3.0462e-048/8 [==============================] - 0s 13ms/step - loss: 3.5672e-04
1/8 [==>...........................] - ETA: 0s - loss: 2.5323e-044/8 [==============>...............] - ETA: 0s - loss: 2.9399e-047/8 [=========================>....] - ETA: 0s - loss: 2.9688e-048/8 [==============================] - 0s 15ms/step - loss: 3.0546e-04
1/8 [==>...........................] - ETA: 0s - loss: 7.2424e-044/8 [==============>...............] - ETA: 0s - loss: 0.0011    8/8 [==============================] - ETA: 0s - loss: 0.00198/8 [==============================] - 0s 15ms/step - loss: 0.0019
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.0005011921457480639:
Train Score: 0.00039 MSE 0.01986 RMSE
Test Score: 0.00257 MSE 0.05069 RMSE
Deviation Min [2.189957e-06], Max [0.11399184]
Deviation 99.5th pctile [0.09272942]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1644,   12]))
Confusion matrix 
[[1636    8]
 [  11    1]]
precision 0.11111, recall 0.08333, f1 0.09524
Time to train: 712877 ms
Saving model models/A3Benchmark/A3Benchmark-TS62.csv.h5
Total Time to proces all the selected files : 719073 ms
A3Benchmark : Avg precision 0.11111 recall 0.08333 f1 0.09524 time to train 712877.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS62.csv  --epochs 20 --n_iter 3 --patience 3 :: took 725 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS63.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 03:16:40 AM MST
2020-12-01 03:16:46.927394: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 03:16:46.946236: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 03:16:46.947151: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d0e54ff8e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 03:16:46.947176: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 03:16:46.947285: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS63.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00424/8 [==============>...............] - ETA: 0s - loss: 0.00507/8 [=========================>....] - ETA: 0s - loss: 0.00478/8 [==============================] - 0s 23ms/step - loss: 0.0047
1/8 [==>...........................] - ETA: 0s - loss: 2.4627e-045/8 [=================>............] - ETA: 0s - loss: 4.1893e-048/8 [==============================] - 0s 12ms/step - loss: 4.1319e-04
1/8 [==>...........................] - ETA: 0s - loss: 9.5211e-045/8 [=================>............] - ETA: 0s - loss: 0.0014    8/8 [==============================] - ETA: 0s - loss: 0.00148/8 [==============================] - 0s 14ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 6.3735e-044/8 [==============>...............] - ETA: 0s - loss: 5.1334e-047/8 [=========================>....] - ETA: 0s - loss: 0.0012    8/8 [==============================] - 0s 17ms/step - loss: 0.0011
1/8 [==>...........................] - ETA: 0s - loss: 3.9133e-045/8 [=================>............] - ETA: 0s - loss: 7.0004e-048/8 [==============================] - 0s 13ms/step - loss: 6.7321e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00672/8 [======>.......................] - ETA: 0s - loss: 0.00734/8 [==============>...............] - ETA: 0s - loss: 0.00775/8 [=================>............] - ETA: 0s - loss: 0.00806/8 [=====================>........] - ETA: 0s - loss: 0.00767/8 [=========================>....] - ETA: 0s - loss: 0.00738/8 [==============================] - ETA: 0s - loss: 0.00738/8 [==============================] - 1s 70ms/step - loss: 0.0073
1/8 [==>...........................] - ETA: 0s - loss: 9.9541e-043/8 [==========>...................] - ETA: 0s - loss: 0.0012    5/8 [=================>............] - ETA: 0s - loss: 0.00167/8 [=========================>....] - ETA: 0s - loss: 0.00148/8 [==============================] - 0s 25ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 0.00563/8 [==========>...................] - ETA: 0s - loss: 0.00775/8 [=================>............] - ETA: 0s - loss: 0.00727/8 [=========================>....] - ETA: 0s - loss: 0.00728/8 [==============================] - 0s 28ms/step - loss: 0.0075
1/8 [==>...........................] - ETA: 0s - loss: 0.00112/8 [======>.......................] - ETA: 0s - loss: 8.1927e-043/8 [==========>...................] - ETA: 0s - loss: 7.0853e-044/8 [==============>...............] - ETA: 0s - loss: 7.5883e-045/8 [=================>............] - ETA: 0s - loss: 9.7518e-046/8 [=====================>........] - ETA: 0s - loss: 0.0017    8/8 [==============================] - ETA: 0s - loss: 0.00158/8 [==============================] - 1s 80ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 0.00823/8 [==========>...................] - ETA: 0s - loss: 0.01116/8 [=====================>........] - ETA: 0s - loss: 0.01068/8 [==============================] - ETA: 0s - loss: 0.01068/8 [==============================] - 0s 23ms/step - loss: 0.0106
1/8 [==>...........................] - ETA: 0s - loss: 0.00622/8 [======>.......................] - ETA: 0s - loss: 0.00713/8 [==========>...................] - ETA: 0s - loss: 0.00715/8 [=================>............] - ETA: 0s - loss: 0.00797/8 [=========================>....] - ETA: 0s - loss: 0.00738/8 [==============================] - 0s 54ms/step - loss: 0.0073
1/8 [==>...........................] - ETA: 0s - loss: 0.00503/8 [==========>...................] - ETA: 0s - loss: 0.00685/8 [=================>............] - ETA: 0s - loss: 0.00697/8 [=========================>....] - ETA: 0s - loss: 0.00698/8 [==============================] - 0s 33ms/step - loss: 0.0071
1/8 [==>...........................] - ETA: 0s - loss: 0.00553/8 [==========>...................] - ETA: 0s - loss: 0.00725/8 [=================>............] - ETA: 0s - loss: 0.00667/8 [=========================>....] - ETA: 0s - loss: 0.00678/8 [==============================] - 0s 40ms/step - loss: 0.0069
1/8 [==>...........................] - ETA: 0s - loss: 0.00873/8 [==========>...................] - ETA: 0s - loss: 0.00905/8 [=================>............] - ETA: 0s - loss: 0.00916/8 [=====================>........] - ETA: 0s - loss: 0.01047/8 [=========================>....] - ETA: 0s - loss: 0.01028/8 [==============================] - 0s 51ms/step - loss: 0.0104
1/8 [==>...........................] - ETA: 0s - loss: 6.1602e-043/8 [==========>...................] - ETA: 0s - loss: 0.0015    5/8 [=================>............] - ETA: 0s - loss: 0.00177/8 [=========================>....] - ETA: 0s - loss: 0.00178/8 [==============================] - 0s 27ms/step - loss: 0.0018
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0016615472093690186:
Train Score: 0.00096 MSE 0.03106 RMSE
Test Score: 0.00163 MSE 0.04037 RMSE
Deviation Min [4.38550113e-06], Max [0.26621613]
Deviation 99.5th pctile [0.19144295]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1646,   10]))
Confusion matrix 
[[1646    0]
 [   1    9]]
precision 1.00000, recall 0.90000, f1 0.94737
Time to train: 911066 ms
Saving model models/A3Benchmark/A3Benchmark-TS63.csv.h5
Total Time to proces all the selected files : 915467 ms
A3Benchmark : Avg precision 1.00000 recall 0.90000 f1 0.94737 time to train 911066.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS63.csv  --epochs 20 --n_iter 3 --patience 3 :: took 922 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS64.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 03:32:08 AM MST
2020-12-01 03:32:14.027639: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 03:32:14.046188: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 03:32:14.047628: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x558bf6e180b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 03:32:14.047667: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 03:32:14.047821: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS64.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00222/8 [======>.......................] - ETA: 0s - loss: 0.00183/8 [==========>...................] - ETA: 0s - loss: 0.00155/8 [=================>............] - ETA: 0s - loss: 0.00147/8 [=========================>....] - ETA: 0s - loss: 0.00158/8 [==============================] - ETA: 0s - loss: 0.00148/8 [==============================] - 0s 61ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 9.0332e-044/8 [==============>...............] - ETA: 0s - loss: 0.0038    7/8 [=========================>....] - ETA: 0s - loss: 0.00278/8 [==============================] - 0s 19ms/step - loss: 0.0027
1/8 [==>...........................] - ETA: 0s - loss: 0.00473/8 [==========>...................] - ETA: 0s - loss: 0.00547/8 [=========================>....] - ETA: 0s - loss: 0.00548/8 [==============================] - 0s 17ms/step - loss: 0.0055
1/8 [==>...........................] - ETA: 0s - loss: 8.8388e-044/8 [==============>...............] - ETA: 0s - loss: 8.9510e-046/8 [=====================>........] - ETA: 0s - loss: 0.0010    8/8 [==============================] - 0s 18ms/step - loss: 9.7105e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00804/8 [==============>...............] - ETA: 0s - loss: 0.01038/8 [==============================] - ETA: 0s - loss: 0.00988/8 [==============================] - 0s 14ms/step - loss: 0.0098
1/8 [==>...........................] - ETA: 0s - loss: 0.00863/8 [==========>...................] - ETA: 0s - loss: 0.00985/8 [=================>............] - ETA: 0s - loss: 0.00987/8 [=========================>....] - ETA: 0s - loss: 0.00978/8 [==============================] - 0s 29ms/step - loss: 0.0099
1/8 [==>...........................] - ETA: 0s - loss: 0.00792/8 [======>.......................] - ETA: 0s - loss: 0.00993/8 [==========>...................] - ETA: 0s - loss: 0.01104/8 [==============>...............] - ETA: 0s - loss: 0.01195/8 [=================>............] - ETA: 0s - loss: 0.01176/8 [=====================>........] - ETA: 0s - loss: 0.01167/8 [=========================>....] - ETA: 0s - loss: 0.01128/8 [==============================] - ETA: 0s - loss: 0.01138/8 [==============================] - 1s 145ms/step - loss: 0.0113
1/8 [==>...........................] - ETA: 0s - loss: 0.00863/8 [==========>...................] - ETA: 0s - loss: 0.01025/8 [=================>............] - ETA: 0s - loss: 0.01027/8 [=========================>....] - ETA: 0s - loss: 0.01018/8 [==============================] - 0s 28ms/step - loss: 0.0103
1/8 [==>...........................] - ETA: 0s - loss: 0.00873/8 [==========>...................] - ETA: 0s - loss: 0.00974/8 [==============>...............] - ETA: 0s - loss: 0.00965/8 [=================>............] - ETA: 0s - loss: 0.00956/8 [=====================>........] - ETA: 0s - loss: 0.00997/8 [=========================>....] - ETA: 0s - loss: 0.00978/8 [==============================] - 1s 97ms/step - loss: 0.0099
1/8 [==>...........................] - ETA: 0s - loss: 0.00863/8 [==========>...................] - ETA: 0s - loss: 0.01225/8 [=================>............] - ETA: 0s - loss: 0.01117/8 [=========================>....] - ETA: 0s - loss: 0.01078/8 [==============================] - 0s 27ms/step - loss: 0.0108
1/8 [==>...........................] - ETA: 0s - loss: 0.00177/8 [=========================>....] - ETA: 0s - loss: 0.00128/8 [==============================] - 0s 9ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 6.6526e-044/8 [==============>...............] - ETA: 0s - loss: 0.0033    7/8 [=========================>....] - ETA: 0s - loss: 0.00238/8 [==============================] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 29ms/step - loss: 0.0022
1/8 [==>...........................] - ETA: 0s - loss: 0.00134/8 [==============>...............] - ETA: 0s - loss: 0.00127/8 [=========================>....] - ETA: 0s - loss: 0.00138/8 [==============================] - 0s 17ms/step - loss: 0.0013
1/8 [==>...........................] - ETA: 0s - loss: 0.00125/8 [=================>............] - ETA: 0s - loss: 0.00118/8 [==============================] - 0s 14ms/step - loss: 0.0011
1/8 [==>...........................] - ETA: 0s - loss: 0.00185/8 [=================>............] - ETA: 0s - loss: 0.00356/8 [=====================>........] - ETA: 0s - loss: 0.00328/8 [==============================] - 0s 20ms/step - loss: 0.0031
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0017770236125215888:
Train Score: 0.00253 MSE 0.05026 RMSE
Test Score: 0.00339 MSE 0.05819 RMSE
Deviation Min [1.72851008e-05], Max [0.42884701]
Deviation 99.5th pctile [0.12766332]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1648,    8]))
Confusion matrix 
[[1647    1]
 [   0    8]]
precision 0.88889, recall 1.00000, f1 0.94118
Time to train: 594535 ms
Saving model models/A3Benchmark/A3Benchmark-TS64.csv.h5
Total Time to proces all the selected files : 597323 ms
A3Benchmark : Avg precision 0.88889 recall 1.00000 f1 0.94118 time to train 594535.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS64.csv  --epochs 20 --n_iter 3 --patience 3 :: took 603 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS65.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 03:42:16 AM MST
2020-12-01 03:42:22.988381: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 03:42:23.007276: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 03:42:23.008823: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x562eade88d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 03:42:23.008892: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 03:42:23.009122: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS65.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00515/8 [=================>............] - ETA: 0s - loss: 0.00338/8 [==============================] - 0s 13ms/step - loss: 0.0042
1/8 [==>...........................] - ETA: 0s - loss: 0.00195/8 [=================>............] - ETA: 0s - loss: 0.00418/8 [==============================] - 0s 13ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.00374/8 [==============>...............] - ETA: 0s - loss: 0.00568/8 [==============================] - ETA: 0s - loss: 0.00518/8 [==============================] - 0s 15ms/step - loss: 0.0051
1/8 [==>...........................] - ETA: 0s - loss: 0.00322/8 [======>.......................] - ETA: 0s - loss: 0.00397/8 [=========================>....] - ETA: 0s - loss: 0.00478/8 [==============================] - 0s 20ms/step - loss: 0.0047
1/8 [==>...........................] - ETA: 0s - loss: 9.6448e-045/8 [=================>............] - ETA: 0s - loss: 0.0011    8/8 [==============================] - 0s 12ms/step - loss: 0.0031
1/8 [==>...........................] - ETA: 0s - loss: 0.00565/8 [=================>............] - ETA: 0s - loss: 0.00328/8 [==============================] - ETA: 0s - loss: 0.00428/8 [==============================] - 0s 14ms/step - loss: 0.0042
1/8 [==>...........................] - ETA: 0s - loss: 0.00254/8 [==============>...............] - ETA: 0s - loss: 0.00387/8 [=========================>....] - ETA: 0s - loss: 0.00328/8 [==============================] - 0s 15ms/step - loss: 0.0032
1/8 [==>...........................] - ETA: 0s - loss: 0.00132/8 [======>.......................] - ETA: 0s - loss: 0.00483/8 [==========>...................] - ETA: 0s - loss: 0.00344/8 [==============>...............] - ETA: 0s - loss: 0.00285/8 [=================>............] - ETA: 0s - loss: 0.00256/8 [=====================>........] - ETA: 0s - loss: 0.00237/8 [=========================>....] - ETA: 0s - loss: 0.00238/8 [==============================] - ETA: 0s - loss: 0.00238/8 [==============================] - 1s 114ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.00154/8 [==============>...............] - ETA: 0s - loss: 0.00277/8 [=========================>....] - ETA: 0s - loss: 0.00248/8 [==============================] - 0s 17ms/step - loss: 0.0024
1/8 [==>...........................] - ETA: 0s - loss: 0.00384/8 [==============>...............] - ETA: 0s - loss: 0.00547/8 [=========================>....] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 18ms/step - loss: 0.0059
1/8 [==>...........................] - ETA: 0s - loss: 0.00565/8 [=================>............] - ETA: 0s - loss: 0.00288/8 [==============================] - 0s 12ms/step - loss: 0.0039
1/8 [==>...........................] - ETA: 0s - loss: 0.00105/8 [=================>............] - ETA: 0s - loss: 0.00418/8 [==============================] - 0s 14ms/step - loss: 0.0033
1/8 [==>...........................] - ETA: 0s - loss: 0.00273/8 [==========>...................] - ETA: 0s - loss: 0.00475/8 [=================>............] - ETA: 0s - loss: 0.00377/8 [=========================>....] - ETA: 0s - loss: 0.00358/8 [==============================] - 0s 27ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.00143/8 [==========>...................] - ETA: 0s - loss: 0.00166/8 [=====================>........] - ETA: 0s - loss: 0.00258/8 [==============================] - 0s 25ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.00814/8 [==============>...............] - ETA: 0s - loss: 0.00738/8 [==============================] - ETA: 0s - loss: 0.00848/8 [==============================] - 0s 14ms/step - loss: 0.0084
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0035923318937420845:
Train Score: 0.00220 MSE 0.04691 RMSE
Test Score: 0.00200 MSE 0.04472 RMSE
Deviation Min [1.95378969e-05], Max [0.429739]
Deviation 99.5th pctile [0.21705222]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1649,    7]))
Confusion matrix 
[[1647    2]
 [   0    7]]
precision 0.77778, recall 1.00000, f1 0.87500
Time to train: 667815 ms
Saving model models/A3Benchmark/A3Benchmark-TS65.csv.h5
Total Time to proces all the selected files : 670305 ms
A3Benchmark : Avg precision 0.77778 recall 1.00000 f1 0.87500 time to train 667815.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS65.csv  --epochs 20 --n_iter 3 --patience 3 :: took 677 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS66.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 03:53:38 AM MST
2020-12-01 03:53:44.939479: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 03:53:44.958307: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 03:53:44.959992: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x560b38e8cd30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 03:53:44.960065: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 03:53:44.960178: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS66.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00785/8 [=================>............] - ETA: 0s - loss: 0.00378/8 [==============================] - 0s 13ms/step - loss: 0.0041
1/8 [==>...........................] - ETA: 0s - loss: 0.00126/8 [=====================>........] - ETA: 0s - loss: 7.4855e-048/8 [==============================] - 0s 10ms/step - loss: 8.2875e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00115/8 [=================>............] - ETA: 0s - loss: 0.00188/8 [==============================] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 15ms/step - loss: 0.0018
1/8 [==>...........................] - ETA: 0s - loss: 9.4714e-045/8 [=================>............] - ETA: 0s - loss: 0.0021    7/8 [=========================>....] - ETA: 0s - loss: 0.00198/8 [==============================] - 0s 22ms/step - loss: 0.0020
1/8 [==>...........................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 12ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 0.00534/8 [==============>...............] - ETA: 0s - loss: 0.00348/8 [==============================] - ETA: 0s - loss: 0.00338/8 [==============================] - 0s 26ms/step - loss: 0.0033
1/8 [==>...........................] - ETA: 0s - loss: 0.00132/8 [======>.......................] - ETA: 0s - loss: 0.00204/8 [==============>...............] - ETA: 0s - loss: 0.00295/8 [=================>............] - ETA: 0s - loss: 0.00327/8 [=========================>....] - ETA: 0s - loss: 0.00278/8 [==============================] - 0s 50ms/step - loss: 0.0027
1/8 [==>...........................] - ETA: 0s - loss: 0.00323/8 [==========>...................] - ETA: 0s - loss: 0.00586/8 [=====================>........] - ETA: 0s - loss: 0.00407/8 [=========================>....] - ETA: 0s - loss: 0.00468/8 [==============================] - 0s 27ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00564/8 [==============>...............] - ETA: 0s - loss: 0.00507/8 [=========================>....] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 22ms/step - loss: 0.0056
1/8 [==>...........................] - ETA: 0s - loss: 0.00175/8 [=================>............] - ETA: 0s - loss: 0.00118/8 [==============================] - 0s 12ms/step - loss: 0.0011
1/8 [==>...........................] - ETA: 0s - loss: 0.00193/8 [==========>...................] - ETA: 0s - loss: 0.00105/8 [=================>............] - ETA: 0s - loss: 0.00107/8 [=========================>....] - ETA: 0s - loss: 0.00128/8 [==============================] - 0s 26ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 0.00373/8 [==========>...................] - ETA: 0s - loss: 0.00325/8 [=================>............] - ETA: 0s - loss: 0.00217/8 [=========================>....] - ETA: 0s - loss: 0.00268/8 [==============================] - 0s 31ms/step - loss: 0.0026
1/8 [==>...........................] - ETA: 0s - loss: 0.00203/8 [==========>...................] - ETA: 0s - loss: 0.00385/8 [=================>............] - ETA: 0s - loss: 0.00387/8 [=========================>....] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 35ms/step - loss: 0.0040
1/8 [==>...........................] - ETA: 0s - loss: 0.00172/8 [======>.......................] - ETA: 0s - loss: 0.00203/8 [==========>...................] - ETA: 0s - loss: 0.00244/8 [==============>...............] - ETA: 0s - loss: 0.00225/8 [=================>............] - ETA: 0s - loss: 0.00276/8 [=====================>........] - ETA: 0s - loss: 0.00267/8 [=========================>....] - ETA: 0s - loss: 0.00258/8 [==============================] - ETA: 0s - loss: 0.00268/8 [==============================] - 1s 94ms/step - loss: 0.0026
1/8 [==>...........................] - ETA: 0s - loss: 0.00423/8 [==========>...................] - ETA: 0s - loss: 0.00505/8 [=================>............] - ETA: 0s - loss: 0.00397/8 [=========================>....] - ETA: 0s - loss: 0.00378/8 [==============================] - 0s 30ms/step - loss: 0.0039
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.002051426109392196:
Train Score: 0.00196 MSE 0.04425 RMSE
Test Score: 0.00336 MSE 0.05794 RMSE
Deviation Min [2.42804424e-05], Max [0.58624184]
Deviation 99.5th pctile [0.11369665]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1655,    1]))
Confusion matrix 
[[1647    8]
 [   0    1]]
precision 0.11111, recall 1.00000, f1 0.20000
Time to train: 1086730 ms
Saving model models/A3Benchmark/A3Benchmark-TS66.csv.h5
Total Time to proces all the selected files : 1093092 ms
A3Benchmark : Avg precision 0.11111 recall 1.00000 f1 0.20000 time to train 1086730.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS66.csv  --epochs 20 --n_iter 3 --patience 3 :: took 1100 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS67.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 04:12:03 AM MST
2020-12-01 04:12:09.384120: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 04:12:09.402982: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 04:12:09.403983: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d5554bed30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 04:12:09.404009: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 04:12:09.404153: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS67.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00414/8 [==============>...............] - ETA: 0s - loss: 0.00407/8 [=========================>....] - ETA: 0s - loss: 0.00448/8 [==============================] - 0s 18ms/step - loss: 0.0045
1/8 [==>...........................] - ETA: 0s - loss: 0.00512/8 [======>.......................] - ETA: 0s - loss: 0.00883/8 [==========>...................] - ETA: 0s - loss: 0.00814/8 [==============>...............] - ETA: 0s - loss: 0.00735/8 [=================>............] - ETA: 0s - loss: 0.00747/8 [=========================>....] - ETA: 0s - loss: 0.00688/8 [==============================] - ETA: 0s - loss: 0.00758/8 [==============================] - 0s 56ms/step - loss: 0.0075
1/8 [==>...........................] - ETA: 0s - loss: 0.00484/8 [==============>...............] - ETA: 0s - loss: 0.00557/8 [=========================>....] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 18ms/step - loss: 0.0059
1/8 [==>...........................] - ETA: 0s - loss: 0.00404/8 [==============>...............] - ETA: 0s - loss: 0.00517/8 [=========================>....] - ETA: 0s - loss: 0.00588/8 [==============================] - 0s 18ms/step - loss: 0.0060
1/8 [==>...........................] - ETA: 0s - loss: 0.01124/8 [==============>...............] - ETA: 0s - loss: 0.01018/8 [==============================] - ETA: 0s - loss: 0.01258/8 [==============================] - 0s 15ms/step - loss: 0.0125
1/8 [==>...........................] - ETA: 0s - loss: 0.00702/8 [======>.......................] - ETA: 0s - loss: 0.00753/8 [==========>...................] - ETA: 0s - loss: 0.00725/8 [=================>............] - ETA: 0s - loss: 0.00706/8 [=====================>........] - ETA: 0s - loss: 0.00738/8 [==============================] - ETA: 0s - loss: 0.00728/8 [==============================] - 0s 42ms/step - loss: 0.0072
1/8 [==>...........................] - ETA: 0s - loss: 0.00533/8 [==========>...................] - ETA: 0s - loss: 0.00885/8 [=================>............] - ETA: 0s - loss: 0.00827/8 [=========================>....] - ETA: 0s - loss: 0.00758/8 [==============================] - 0s 32ms/step - loss: 0.0082
1/8 [==>...........................] - ETA: 0s - loss: 0.00563/8 [==========>...................] - ETA: 0s - loss: 0.00704/8 [==============>...............] - ETA: 0s - loss: 0.00646/8 [=====================>........] - ETA: 0s - loss: 0.00678/8 [==============================] - ETA: 0s - loss: 0.00678/8 [==============================] - 0s 39ms/step - loss: 0.0067
1/8 [==>...........................] - ETA: 0s - loss: 0.00603/8 [==========>...................] - ETA: 0s - loss: 0.00855/8 [=================>............] - ETA: 0s - loss: 0.00967/8 [=========================>....] - ETA: 0s - loss: 0.00918/8 [==============================] - 0s 32ms/step - loss: 0.0094
1/8 [==>...........................] - ETA: 0s - loss: 0.01063/8 [==========>...................] - ETA: 0s - loss: 0.01035/8 [=================>............] - ETA: 0s - loss: 0.01078/8 [==============================] - ETA: 0s - loss: 0.01198/8 [==============================] - 0s 26ms/step - loss: 0.0119
1/8 [==>...........................] - ETA: 0s - loss: 0.00693/8 [==========>...................] - ETA: 0s - loss: 0.00694/8 [==============>...............] - ETA: 0s - loss: 0.00665/8 [=================>............] - ETA: 0s - loss: 0.00666/8 [=====================>........] - ETA: 0s - loss: 0.00697/8 [=========================>....] - ETA: 0s - loss: 0.00678/8 [==============================] - ETA: 0s - loss: 0.00688/8 [==============================] - 1s 106ms/step - loss: 0.0068
1/8 [==>...........................] - ETA: 0s - loss: 0.00453/8 [==========>...................] - ETA: 0s - loss: 0.00776/8 [=====================>........] - ETA: 0s - loss: 0.00708/8 [==============================] - ETA: 0s - loss: 0.00728/8 [==============================] - 0s 30ms/step - loss: 0.0072
1/8 [==>...........................] - ETA: 0s - loss: 0.00488/8 [==============================] - ETA: 0s - loss: 0.00588/8 [==============================] - 0s 8ms/step - loss: 0.0058
1/8 [==>...........................] - ETA: 0s - loss: 0.00414/8 [==============>...............] - ETA: 0s - loss: 0.00557/8 [=========================>....] - ETA: 0s - loss: 0.00638/8 [==============================] - ETA: 0s - loss: 0.00658/8 [==============================] - 0s 36ms/step - loss: 0.0065
1/8 [==>...........................] - ETA: 0s - loss: 0.00503/8 [==========>...................] - ETA: 0s - loss: 0.00446/8 [=====================>........] - ETA: 0s - loss: 0.00478/8 [==============================] - 0s 28ms/step - loss: 0.0055
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.006364497262984515:
Train Score: 0.00388 MSE 0.06232 RMSE
Test Score: 0.00572 MSE 0.07566 RMSE
Deviation Min [2.55245731e-06], Max [0.32641947]
Deviation 99.5th pctile [0.23339004]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1640,   16]))
Confusion matrix 
[[1640    0]
 [   7    9]]
precision 1.00000, recall 0.56250, f1 0.72000
Time to train: 493213 ms
Saving model models/A3Benchmark/A3Benchmark-TS67.csv.h5
Total Time to proces all the selected files : 498096 ms
A3Benchmark : Avg precision 1.00000 recall 0.56250 f1 0.72000 time to train 493213.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS67.csv  --epochs 20 --n_iter 3 --patience 3 :: took 504 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS68.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 04:20:32 AM MST
2020-12-01 04:20:38.718293: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 04:20:38.737235: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 04:20:38.738760: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x560ce1ea4310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 04:20:38.738830: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 04:20:38.739061: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS68.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00295/8 [=================>............] - ETA: 0s - loss: 0.00178/8 [==============================] - 0s 13ms/step - loss: 0.0018
1/8 [==>...........................] - ETA: 0s - loss: 0.00672/8 [======>.......................] - ETA: 0s - loss: 0.00904/8 [==============>...............] - ETA: 0s - loss: 0.00855/8 [=================>............] - ETA: 0s - loss: 0.00906/8 [=====================>........] - ETA: 0s - loss: 0.00908/8 [==============================] - 0s 60ms/step - loss: 0.0091
1/8 [==>...........................] - ETA: 0s - loss: 0.00732/8 [======>.......................] - ETA: 0s - loss: 0.00933/8 [==========>...................] - ETA: 0s - loss: 0.00954/8 [==============>...............] - ETA: 0s - loss: 0.01025/8 [=================>............] - ETA: 0s - loss: 0.01046/8 [=====================>........] - ETA: 0s - loss: 0.01068/8 [==============================] - ETA: 0s - loss: 0.01038/8 [==============================] - 1s 67ms/step - loss: 0.0103
1/8 [==>...........................] - ETA: 0s - loss: 0.00462/8 [======>.......................] - ETA: 0s - loss: 0.00544/8 [==============>...............] - ETA: 0s - loss: 0.00667/8 [=========================>....] - ETA: 0s - loss: 0.00738/8 [==============================] - 0s 39ms/step - loss: 0.0073
1/8 [==>...........................] - ETA: 0s - loss: 0.01102/8 [======>.......................] - ETA: 0s - loss: 0.01264/8 [==============>...............] - ETA: 0s - loss: 0.01136/8 [=====================>........] - ETA: 0s - loss: 0.01187/8 [=========================>....] - ETA: 0s - loss: 0.01198/8 [==============================] - ETA: 0s - loss: 0.01208/8 [==============================] - 0s 47ms/step - loss: 0.0120
1/8 [==>...........................] - ETA: 0s - loss: 0.0102WARNING:tensorflow:Method (on_test_batch_end) is slow compared to the batch update (0.285460). Check your callbacks.
2/8 [======>.......................] - ETA: 0s - loss: 0.0117WARNING:tensorflow:Method (on_test_batch_end) is slow compared to the batch update (0.142847). Check your callbacks.
3/8 [==========>...................] - ETA: 0s - loss: 0.01084/8 [==============>...............] - ETA: 0s - loss: 0.01025/8 [=================>............] - ETA: 0s - loss: 0.01076/8 [=====================>........] - ETA: 0s - loss: 0.01068/8 [==============================] - ETA: 0s - loss: 0.01078/8 [==============================] - 1s 74ms/step - loss: 0.0107
1/8 [==>...........................] - ETA: 0s - loss: 0.00723/8 [==========>...................] - ETA: 0s - loss: 0.00965/8 [=================>............] - ETA: 0s - loss: 0.00977/8 [=========================>....] - ETA: 0s - loss: 0.00968/8 [==============================] - 0s 29ms/step - loss: 0.0098
1/8 [==>...........................] - ETA: 0s - loss: 0.00783/8 [==========>...................] - ETA: 0s - loss: 0.01065/8 [=================>............] - ETA: 0s - loss: 0.01137/8 [=========================>....] - ETA: 0s - loss: 0.01078/8 [==============================] - 0s 34ms/step - loss: 0.0111
1/8 [==>...........................] - ETA: 0s - loss: 0.00833/8 [==========>...................] - ETA: 0s - loss: 0.01075/8 [=================>............] - ETA: 0s - loss: 0.01127/8 [=========================>....] - ETA: 0s - loss: 0.01198/8 [==============================] - 0s 33ms/step - loss: 0.0121
1/8 [==>...........................] - ETA: 0s - loss: 0.01162/8 [======>.......................] - ETA: 0s - loss: 0.01364/8 [==============>...............] - ETA: 0s - loss: 0.01226/8 [=====================>........] - ETA: 0s - loss: 0.01308/8 [==============================] - ETA: 0s - loss: 0.01318/8 [==============================] - 0s 27ms/step - loss: 0.0131
1/8 [==>...........................] - ETA: 0s - loss: 0.00504/8 [==============>...............] - ETA: 0s - loss: 0.00277/8 [=========================>....] - ETA: 0s - loss: 0.00318/8 [==============================] - 0s 19ms/step - loss: 0.0030
1/8 [==>...........................] - ETA: 0s - loss: 0.00484/8 [==============>...............] - ETA: 0s - loss: 0.00647/8 [=========================>....] - ETA: 0s - loss: 0.00698/8 [==============================] - 0s 21ms/step - loss: 0.0069
1/8 [==>...........................] - ETA: 0s - loss: 0.00284/8 [==============>...............] - ETA: 0s - loss: 0.00418/8 [==============================] - ETA: 0s - loss: 0.00438/8 [==============================] - 0s 15ms/step - loss: 0.0043
1/8 [==>...........................] - ETA: 0s - loss: 0.00752/8 [======>.......................] - ETA: 0s - loss: 0.00893/8 [==========>...................] - ETA: 0s - loss: 0.00954/8 [==============>...............] - ETA: 0s - loss: 0.01025/8 [=================>............] - ETA: 0s - loss: 0.01026/8 [=====================>........] - ETA: 0s - loss: 0.01087/8 [=========================>....] - ETA: 0s - loss: 0.01088/8 [==============================] - ETA: 0s - loss: 0.01098/8 [==============================] - 1s 75ms/step - loss: 0.0109
1/8 [==>...........................] - ETA: 0s - loss: 0.01164/8 [==============>...............] - ETA: 0s - loss: 0.01186/8 [=====================>........] - ETA: 0s - loss: 0.01258/8 [==============================] - 0s 23ms/step - loss: 0.0127
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0075838595628738405:
Train Score: 0.00216 MSE 0.04642 RMSE
Test Score: 0.00288 MSE 0.05365 RMSE
Deviation Min [2.98750146e-05], Max [0.33641616]
Deviation 99.5th pctile [0.28288488]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1640,   16]))
Confusion matrix 
[[1640    0]
 [   7    9]]
precision 1.00000, recall 0.56250, f1 0.72000
Time to train: 504074 ms
Saving model models/A3Benchmark/A3Benchmark-TS68.csv.h5
Total Time to proces all the selected files : 509314 ms
A3Benchmark : Avg precision 1.00000 recall 0.56250 f1 0.72000 time to train 504074.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS68.csv  --epochs 20 --n_iter 3 --patience 3 :: took 516 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS69.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 04:29:13 AM MST
2020-12-01 04:29:19.537156: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 04:29:19.559051: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 04:29:19.560113: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55c683538d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 04:29:19.560142: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 04:29:19.560278: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS69.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00585/8 [=================>............] - ETA: 0s - loss: 0.00468/8 [==============================] - 0s 13ms/step - loss: 0.0045
1/8 [==>...........................] - ETA: 0s - loss: 0.00423/8 [==========>...................] - ETA: 0s - loss: 0.00374/8 [==============>...............] - ETA: 0s - loss: 0.00435/8 [=================>............] - ETA: 0s - loss: 0.00438/8 [==============================] - ETA: 0s - loss: 0.00568/8 [==============================] - 0s 45ms/step - loss: 0.0056
1/8 [==>...........................] - ETA: 0s - loss: 0.00324/8 [==============>...............] - ETA: 0s - loss: 0.00327/8 [=========================>....] - ETA: 0s - loss: 0.00638/8 [==============================] - 0s 15ms/step - loss: 0.0061
1/8 [==>...........................] - ETA: 0s - loss: 0.00283/8 [==========>...................] - ETA: 0s - loss: 0.00325/8 [=================>............] - ETA: 0s - loss: 0.00347/8 [=========================>....] - ETA: 0s - loss: 0.00338/8 [==============================] - 0s 26ms/step - loss: 0.0033
1/8 [==>...........................] - ETA: 0s - loss: 0.00695/8 [=================>............] - ETA: 0s - loss: 0.00458/8 [==============================] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 15ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00542/8 [======>.......................] - ETA: 0s - loss: 0.00474/8 [==============>...............] - ETA: 0s - loss: 0.00376/8 [=====================>........] - ETA: 0s - loss: 0.00368/8 [==============================] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 32ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.00502/8 [======>.......................] - ETA: 0s - loss: 0.00373/8 [==========>...................] - ETA: 0s - loss: 0.00334/8 [==============>...............] - ETA: 0s - loss: 0.00465/8 [=================>............] - ETA: 0s - loss: 0.00496/8 [=====================>........] - ETA: 0s - loss: 0.00537/8 [=========================>....] - ETA: 0s - loss: 0.00578/8 [==============================] - ETA: 0s - loss: 0.00548/8 [==============================] - 1s 121ms/step - loss: 0.0054
1/8 [==>...........................] - ETA: 0s - loss: 0.00322/8 [======>.......................] - ETA: 0s - loss: 0.00304/8 [==============>...............] - ETA: 0s - loss: 0.00296/8 [=====================>........] - ETA: 0s - loss: 0.00498/8 [==============================] - 0s 32ms/step - loss: 0.0057
1/8 [==>...........................] - ETA: 0s - loss: 0.00403/8 [==========>...................] - ETA: 0s - loss: 0.00375/8 [=================>............] - ETA: 0s - loss: 0.00386/8 [=====================>........] - ETA: 0s - loss: 0.00378/8 [==============================] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 35ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.00412/8 [======>.......................] - ETA: 0s - loss: 0.00344/8 [==============>...............] - ETA: 0s - loss: 0.00345/8 [=================>............] - ETA: 0s - loss: 0.00336/8 [=====================>........] - ETA: 0s - loss: 0.00327/8 [=========================>....] - ETA: 0s - loss: 0.00328/8 [==============================] - ETA: 0s - loss: 0.00338/8 [==============================] - 0s 54ms/step - loss: 0.0033
1/8 [==>...........................] - ETA: 0s - loss: 0.00573/8 [==========>...................] - ETA: 0s - loss: 0.00435/8 [=================>............] - ETA: 0s - loss: 0.00367/8 [=========================>....] - ETA: 0s - loss: 0.00378/8 [==============================] - 0s 26ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.00373/8 [==========>...................] - ETA: 0s - loss: 0.00365/8 [=================>............] - ETA: 0s - loss: 0.00397/8 [=========================>....] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 29ms/step - loss: 0.0055
1/8 [==>...........................] - ETA: 0s - loss: 0.00412/8 [======>.......................] - ETA: 0s - loss: 0.00383/8 [==========>...................] - ETA: 0s - loss: 0.00404/8 [==============>...............] - ETA: 0s - loss: 0.00375/8 [=================>............] - ETA: 0s - loss: 0.00476/8 [=====================>........] - ETA: 0s - loss: 0.00537/8 [=========================>....] - ETA: 0s - loss: 0.00678/8 [==============================] - ETA: 0s - loss: 0.00658/8 [==============================] - 1s 113ms/step - loss: 0.0065
1/8 [==>...........................] - ETA: 0s - loss: 0.00353/8 [==========>...................] - ETA: 0s - loss: 0.00354/8 [==============>...............] - ETA: 0s - loss: 0.00346/8 [=====================>........] - ETA: 0s - loss: 0.00338/8 [==============================] - ETA: 0s - loss: 0.00328/8 [==============================] - 0s 39ms/step - loss: 0.0032
1/8 [==>...........................] - ETA: 0s - loss: 0.00712/8 [======>.......................] - ETA: 0s - loss: 0.00484/8 [==============>...............] - ETA: 0s - loss: 0.00375/8 [=================>............] - ETA: 0s - loss: 0.00397/8 [=========================>....] - ETA: 0s - loss: 0.00428/8 [==============================] - 0s 36ms/step - loss: 0.0043
Best parameters {'n_units': 72, 'n_hidden': 2} best score 0.004304776526987552:
Train Score: 0.00578 MSE 0.07600 RMSE
Test Score: 0.00607 MSE 0.07788 RMSE
Deviation Min [2.9665361e-05], Max [0.46350344]
Deviation 99.5th pctile [0.24271033]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1649,    7]))
Confusion matrix 
[[1647    2]
 [   0    7]]
precision 0.77778, recall 1.00000, f1 0.87500
Time to train: 1193663 ms
Saving model models/A3Benchmark/A3Benchmark-TS69.csv.h5
Total Time to proces all the selected files : 1201000 ms
A3Benchmark : Avg precision 0.77778 recall 1.00000 f1 0.87500 time to train 1193663.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS69.csv  --epochs 20 --n_iter 3 --patience 3 :: took 1207 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS6.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 04:49:26 AM MST
2020-12-01 04:49:31.998301: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 04:49:32.017035: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 04:49:32.017913: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559f0f29e310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 04:49:32.017946: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 04:49:32.018079: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS6.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00695/8 [=================>............] - ETA: 0s - loss: 0.01028/8 [==============================] - 0s 13ms/step - loss: 0.0095
1/8 [==>...........................] - ETA: 0s - loss: 0.00184/8 [==============>...............] - ETA: 0s - loss: 0.00497/8 [=========================>....] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 16ms/step - loss: 0.0038
1/8 [==>...........................] - ETA: 0s - loss: 0.00185/8 [=================>............] - ETA: 0s - loss: 0.00178/8 [==============================] - 0s 14ms/step - loss: 0.0017
1/8 [==>...........................] - ETA: 0s - loss: 0.00146/8 [=====================>........] - ETA: 0s - loss: 0.00378/8 [==============================] - 0s 11ms/step - loss: 0.0032
1/8 [==>...........................] - ETA: 0s - loss: 0.00162/8 [======>.......................] - ETA: 0s - loss: 0.00173/8 [==========>...................] - ETA: 0s - loss: 0.00224/8 [==============>...............] - ETA: 0s - loss: 0.00225/8 [=================>............] - ETA: 0s - loss: 0.00206/8 [=====================>........] - ETA: 0s - loss: 0.00318/8 [==============================] - ETA: 0s - loss: 0.00308/8 [==============================] - 1s 89ms/step - loss: 0.0030
1/8 [==>...........................] - ETA: 0s - loss: 0.00333/8 [==========>...................] - ETA: 0s - loss: 0.00475/8 [=================>............] - ETA: 0s - loss: 0.00507/8 [=========================>....] - ETA: 0s - loss: 0.00528/8 [==============================] - 0s 31ms/step - loss: 0.0052
1/8 [==>...........................] - ETA: 0s - loss: 0.00142/8 [======>.......................] - ETA: 0s - loss: 0.00153/8 [==========>...................] - ETA: 0s - loss: 0.00174/8 [==============>...............] - ETA: 0s - loss: 0.00395/8 [=================>............] - ETA: 0s - loss: 0.00416/8 [=====================>........] - ETA: 0s - loss: 0.00367/8 [=========================>....] - ETA: 0s - loss: 0.00338/8 [==============================] - ETA: 0s - loss: 0.00338/8 [==============================] - 1s 119ms/step - loss: 0.0033
1/8 [==>...........................] - ETA: 0s - loss: 0.00142/8 [======>.......................] - ETA: 0s - loss: 0.00293/8 [==========>...................] - ETA: 0s - loss: 0.00334/8 [==============>...............] - ETA: 0s - loss: 0.00286/8 [=====================>........] - ETA: 0s - loss: 0.00247/8 [=========================>....] - ETA: 0s - loss: 0.00278/8 [==============================] - ETA: 0s - loss: 0.00288/8 [==============================] - 1s 69ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 0.00172/8 [======>.......................] - ETA: 0s - loss: 0.00223/8 [==========>...................] - ETA: 0s - loss: 0.00474/8 [==============>...............] - ETA: 0s - loss: 0.00535/8 [=================>............] - ETA: 0s - loss: 0.00477/8 [=========================>....] - ETA: 0s - loss: 0.00408/8 [==============================] - 0s 60ms/step - loss: 0.0039
1/8 [==>...........................] - ETA: 0s - loss: 0.01893/8 [==========>...................] - ETA: 0s - loss: 0.02235/8 [=================>............] - ETA: 0s - loss: 0.02137/8 [=========================>....] - ETA: 0s - loss: 0.02218/8 [==============================] - 0s 35ms/step - loss: 0.0223
1/8 [==>...........................] - ETA: 0s - loss: 0.01903/8 [==========>...................] - ETA: 0s - loss: 0.02295/8 [=================>............] - ETA: 0s - loss: 0.02277/8 [=========================>....] - ETA: 0s - loss: 0.02238/8 [==============================] - 0s 30ms/step - loss: 0.0228
1/8 [==>...........................] - ETA: 0s - loss: 0.01652/8 [======>.......................] - ETA: 0s - loss: 0.02033/8 [==========>...................] - ETA: 0s - loss: 0.02104/8 [==============>...............] - ETA: 0s - loss: 0.02235/8 [=================>............] - ETA: 0s - loss: 0.02256/8 [=====================>........] - ETA: 0s - loss: 0.02257/8 [=========================>....] - ETA: 0s - loss: 0.02188/8 [==============================] - ETA: 0s - loss: 0.02248/8 [==============================] - 1s 94ms/step - loss: 0.0224
1/8 [==>...........................] - ETA: 0s - loss: 0.00103/8 [==========>...................] - ETA: 0s - loss: 0.00175/8 [=================>............] - ETA: 0s - loss: 0.00177/8 [=========================>....] - ETA: 0s - loss: 0.00178/8 [==============================] - 0s 24ms/step - loss: 0.0018
1/8 [==>...........................] - ETA: 0s - loss: 0.00193/8 [==========>...................] - ETA: 0s - loss: 0.00365/8 [=================>............] - ETA: 0s - loss: 0.00407/8 [=========================>....] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 27ms/step - loss: 0.0034
1/8 [==>...........................] - ETA: 0s - loss: 7.3996e-044/8 [==============>...............] - ETA: 0s - loss: 0.0039    6/8 [=====================>........] - ETA: 0s - loss: 0.00398/8 [==============================] - 0s 22ms/step - loss: 0.0038
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.004259613226167858:
Train Score: 0.00263 MSE 0.05131 RMSE
Test Score: 0.00238 MSE 0.04877 RMSE
Deviation Min [9.7286113e-05], Max [0.45992094]
Deviation 99.5th pctile [0.19923382]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1650,    6]))
Confusion matrix 
[[1647    3]
 [   0    6]]
precision 0.66667, recall 1.00000, f1 0.80000
Time to train: 954141 ms
Saving model models/A3Benchmark/A3Benchmark-TS6.csv.h5
Total Time to proces all the selected files : 960153 ms
A3Benchmark : Avg precision 0.66667 recall 1.00000 f1 0.80000 time to train 954141.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS6.csv  --epochs 20 --n_iter 3 --patience 3 :: took 966 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS70.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 05:05:37 AM MST
2020-12-01 05:05:43.511539: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 05:05:43.529987: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 05:05:43.531082: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559f9894b310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 05:05:43.531115: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 05:05:43.531275: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS70.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00604/8 [==============>...............] - ETA: 0s - loss: 0.00707/8 [=========================>....] - ETA: 0s - loss: 0.00658/8 [==============================] - 0s 19ms/step - loss: 0.0064
1/8 [==>...........................] - ETA: 0s - loss: 0.00423/8 [==========>...................] - ETA: 0s - loss: 0.00515/8 [=================>............] - ETA: 0s - loss: 0.00516/8 [=====================>........] - ETA: 0s - loss: 0.00538/8 [==============================] - ETA: 0s - loss: 0.00558/8 [==============================] - 0s 49ms/step - loss: 0.0055
1/8 [==>...........................] - ETA: 0s - loss: 0.00122/8 [======>.......................] - ETA: 0s - loss: 0.00115/8 [=================>............] - ETA: 0s - loss: 0.00137/8 [=========================>....] - ETA: 0s - loss: 0.00148/8 [==============================] - 0s 21ms/step - loss: 0.0013
1/8 [==>...........................] - ETA: 0s - loss: 0.00404/8 [==============>...............] - ETA: 0s - loss: 0.00627/8 [=========================>....] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 18ms/step - loss: 0.0058
1/8 [==>...........................] - ETA: 0s - loss: 0.00162/8 [======>.......................] - ETA: 0s - loss: 0.00134/8 [==============>...............] - ETA: 0s - loss: 0.00146/8 [=====================>........] - ETA: 0s - loss: 0.00188/8 [==============================] - ETA: 0s - loss: 0.00208/8 [==============================] - 0s 34ms/step - loss: 0.0020
1/8 [==>...........................] - ETA: 0s - loss: 0.00304/8 [==============>...............] - ETA: 0s - loss: 0.00488/8 [==============================] - ETA: 0s - loss: 0.00558/8 [==============================] - 0s 15ms/step - loss: 0.0055
1/8 [==>...........................] - ETA: 0s - loss: 0.00654/8 [==============>...............] - ETA: 0s - loss: 0.00797/8 [=========================>....] - ETA: 0s - loss: 0.01068/8 [==============================] - 0s 16ms/step - loss: 0.0108
1/8 [==>...........................] - ETA: 0s - loss: 0.00545/8 [=================>............] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 13ms/step - loss: 0.0063
1/8 [==>...........................] - ETA: 0s - loss: 0.05924/8 [==============>...............] - ETA: 0s - loss: 0.06187/8 [=========================>....] - ETA: 0s - loss: 0.07108/8 [==============================] - 0s 17ms/step - loss: 0.0721
1/8 [==>...........................] - ETA: 0s - loss: 0.00475/8 [=================>............] - ETA: 0s - loss: 0.00548/8 [==============================] - ETA: 0s - loss: 0.00538/8 [==============================] - 0s 15ms/step - loss: 0.0053
1/8 [==>...........................] - ETA: 0s - loss: 0.00542/8 [======>.......................] - ETA: 0s - loss: 0.00694/8 [==============>...............] - ETA: 0s - loss: 0.00646/8 [=====================>........] - ETA: 0s - loss: 0.00628/8 [==============================] - ETA: 0s - loss: 0.00608/8 [==============================] - 0s 30ms/step - loss: 0.0060
1/8 [==>...........................] - ETA: 0s - loss: 0.00432/8 [======>.......................] - ETA: 0s - loss: 0.00573/8 [==========>...................] - ETA: 0s - loss: 0.00555/8 [=================>............] - ETA: 0s - loss: 0.00527/8 [=========================>....] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 56ms/step - loss: 0.0057
1/8 [==>...........................] - ETA: 0s - loss: 0.00563/8 [==========>...................] - ETA: 0s - loss: 0.00645/8 [=================>............] - ETA: 0s - loss: 0.00607/8 [=========================>....] - ETA: 0s - loss: 0.00648/8 [==============================] - 0s 26ms/step - loss: 0.0066
1/8 [==>...........................] - ETA: 0s - loss: 0.00393/8 [==========>...................] - ETA: 0s - loss: 0.00545/8 [=================>............] - ETA: 0s - loss: 0.00597/8 [=========================>....] - ETA: 0s - loss: 0.00598/8 [==============================] - 0s 26ms/step - loss: 0.0060
1/8 [==>...........................] - ETA: 0s - loss: 0.00542/8 [======>.......................] - ETA: 0s - loss: 0.00603/8 [==========>...................] - ETA: 0s - loss: 0.00715/8 [=================>............] - ETA: 0s - loss: 0.00647/8 [=========================>....] - ETA: 0s - loss: 0.00638/8 [==============================] - 0s 58ms/step - loss: 0.0064
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.004195814067497849:
Train Score: 0.00183 MSE 0.04283 RMSE
Test Score: 0.00127 MSE 0.03559 RMSE
Deviation Min [1.93012667e-05], Max [0.27842366]
Deviation 99.5th pctile [0.15264704]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Confusion matrix 
[[1647    0]
 [   0    9]]
precision 1.00000, recall 1.00000, f1 1.00000
Time to train: 581188 ms
Saving model models/A3Benchmark/A3Benchmark-TS70.csv.h5
Total Time to proces all the selected files : 584059 ms
A3Benchmark : Avg precision 1.00000 recall 1.00000 f1 1.00000 time to train 581188.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS70.csv  --epochs 20 --n_iter 3 --patience 3 :: took 591 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS71.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 05:15:33 AM MST
2020-12-01 05:15:39.039141: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 05:15:39.058214: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 05:15:39.059713: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f668261d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 05:15:39.059767: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 05:15:39.059999: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS71.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00342/8 [======>.......................] - ETA: 0s - loss: 0.00333/8 [==========>...................] - ETA: 0s - loss: 0.00325/8 [=================>............] - ETA: 0s - loss: 0.00336/8 [=====================>........] - ETA: 0s - loss: 0.00317/8 [=========================>....] - ETA: 0s - loss: 0.00308/8 [==============================] - 0s 55ms/step - loss: 0.0030
1/8 [==>...........................] - ETA: 0s - loss: 0.00133/8 [==========>...................] - ETA: 0s - loss: 0.00174/8 [==============>...............] - ETA: 0s - loss: 0.00186/8 [=====================>........] - ETA: 0s - loss: 0.00248/8 [==============================] - ETA: 0s - loss: 0.00248/8 [==============================] - 0s 55ms/step - loss: 0.0024
1/8 [==>...........................] - ETA: 0s - loss: 0.00175/8 [=================>............] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 14ms/step - loss: 0.0018
1/8 [==>...........................] - ETA: 0s - loss: 0.00195/8 [=================>............] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 14ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.00244/8 [==============>...............] - ETA: 0s - loss: 0.00227/8 [=========================>....] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 18ms/step - loss: 0.0022
1/8 [==>...........................] - ETA: 0s - loss: 0.00513/8 [==========>...................] - ETA: 0s - loss: 0.00405/8 [=================>............] - ETA: 0s - loss: 0.00407/8 [=========================>....] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 35ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.00163/8 [==========>...................] - ETA: 0s - loss: 0.00205/8 [=================>............] - ETA: 0s - loss: 0.00217/8 [=========================>....] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 35ms/step - loss: 0.0022
1/8 [==>...........................] - ETA: 0s - loss: 0.00243/8 [==========>...................] - ETA: 0s - loss: 0.00315/8 [=================>............] - ETA: 0s - loss: 0.00287/8 [=========================>....] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 28ms/step - loss: 0.0030
1/8 [==>...........................] - ETA: 0s - loss: 0.00153/8 [==========>...................] - ETA: 0s - loss: 0.00195/8 [=================>............] - ETA: 0s - loss: 0.00217/8 [=========================>....] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 38ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.00293/8 [==========>...................] - ETA: 0s - loss: 0.00285/8 [=================>............] - ETA: 0s - loss: 0.00277/8 [=========================>....] - ETA: 0s - loss: 0.00268/8 [==============================] - ETA: 0s - loss: 0.00268/8 [==============================] - 0s 54ms/step - loss: 0.0026
1/8 [==>...........................] - ETA: 0s - loss: 0.00342/8 [======>.......................] - ETA: 0s - loss: 0.00333/8 [==========>...................] - ETA: 0s - loss: 0.00314/8 [==============>...............] - ETA: 0s - loss: 0.00325/8 [=================>............] - ETA: 0s - loss: 0.00327/8 [=========================>....] - ETA: 0s - loss: 0.00308/8 [==============================] - 0s 48ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00154/8 [==============>...............] - ETA: 0s - loss: 0.00177/8 [=========================>....] - ETA: 0s - loss: 0.00178/8 [==============================] - 0s 18ms/step - loss: 0.0017
1/8 [==>...........................] - ETA: 0s - loss: 0.00185/8 [=================>............] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 14ms/step - loss: 0.0022
1/8 [==>...........................] - ETA: 0s - loss: 0.00724/8 [==============>...............] - ETA: 0s - loss: 0.00756/8 [=====================>........] - ETA: 0s - loss: 0.00878/8 [==============================] - ETA: 0s - loss: 0.00898/8 [==============================] - 0s 33ms/step - loss: 0.0089
1/8 [==>...........................] - ETA: 0s - loss: 0.00243/8 [==========>...................] - ETA: 0s - loss: 0.00226/8 [=====================>........] - ETA: 0s - loss: 0.00368/8 [==============================] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 38ms/step - loss: 0.0038
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.002349692420102656:
Train Score: 0.00166 MSE 0.04079 RMSE
Test Score: 0.00172 MSE 0.04143 RMSE
Deviation Min [1.42912717e-05], Max [0.17880946]
Deviation 99.5th pctile [0.10234025]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1641,   15]))
Confusion matrix 
[[1640    1]
 [   7    8]]
precision 0.88889, recall 0.53333, f1 0.66667
Time to train: 524703 ms
Saving model models/A3Benchmark/A3Benchmark-TS71.csv.h5
Total Time to proces all the selected files : 528136 ms
A3Benchmark : Avg precision 0.88889 recall 0.53333 f1 0.66667 time to train 524703.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS71.csv  --epochs 20 --n_iter 3 --patience 3 :: took 534 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS72.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 05:24:32 AM MST
2020-12-01 05:24:38.406676: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 05:24:38.425279: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 05:24:38.426761: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x555579e1b310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 05:24:38.426810: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 05:24:38.426993: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS72.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 3.9896e-044/8 [==============>...............] - ETA: 0s - loss: 2.9307e-047/8 [=========================>....] - ETA: 0s - loss: 2.9243e-048/8 [==============================] - 0s 17ms/step - loss: 3.0413e-04
1/8 [==>...........................] - ETA: 0s - loss: 1.6105e-045/8 [=================>............] - ETA: 0s - loss: 2.0376e-048/8 [==============================] - 0s 13ms/step - loss: 2.1504e-04
1/8 [==>...........................] - ETA: 0s - loss: 4.0438e-045/8 [=================>............] - ETA: 0s - loss: 3.4715e-047/8 [=========================>....] - ETA: 0s - loss: 3.1704e-048/8 [==============================] - 0s 22ms/step - loss: 3.1619e-04
1/8 [==>...........................] - ETA: 0s - loss: 1.4951e-044/8 [==============>...............] - ETA: 0s - loss: 1.6100e-046/8 [=====================>........] - ETA: 0s - loss: 1.6791e-048/8 [==============================] - ETA: 0s - loss: 1.8773e-048/8 [==============================] - 0s 25ms/step - loss: 1.8773e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00285/8 [=================>............] - ETA: 0s - loss: 0.00438/8 [==============================] - 0s 12ms/step - loss: 0.0057
1/8 [==>...........................] - ETA: 0s - loss: 6.6346e-043/8 [==========>...................] - ETA: 0s - loss: 8.4090e-045/8 [=================>............] - ETA: 0s - loss: 9.3391e-047/8 [=========================>....] - ETA: 0s - loss: 0.0010    8/8 [==============================] - 0s 34ms/step - loss: 0.0011
1/8 [==>...........................] - ETA: 0s - loss: 1.8116e-042/8 [======>.......................] - ETA: 0s - loss: 2.2354e-044/8 [==============>...............] - ETA: 0s - loss: 2.2916e-045/8 [=================>............] - ETA: 0s - loss: 2.2690e-046/8 [=====================>........] - ETA: 0s - loss: 2.2999e-047/8 [=========================>....] - ETA: 0s - loss: 2.1996e-048/8 [==============================] - ETA: 0s - loss: 2.2499e-048/8 [==============================] - 1s 91ms/step - loss: 2.2499e-04
1/8 [==>...........................] - ETA: 0s - loss: 1.8602e-043/8 [==========>...................] - ETA: 0s - loss: 2.0658e-045/8 [=================>............] - ETA: 0s - loss: 2.0240e-047/8 [=========================>....] - ETA: 0s - loss: 2.1350e-048/8 [==============================] - 0s 34ms/step - loss: 2.2740e-04
1/8 [==>...........................] - ETA: 0s - loss: 6.0175e-043/8 [==========>...................] - ETA: 0s - loss: 9.8941e-045/8 [=================>............] - ETA: 0s - loss: 0.0013    7/8 [=========================>....] - ETA: 0s - loss: 0.00168/8 [==============================] - 0s 29ms/step - loss: 0.0017
1/8 [==>...........................] - ETA: 0s - loss: 0.00213/8 [==========>...................] - ETA: 0s - loss: 0.00244/8 [==============>...............] - ETA: 0s - loss: 0.00265/8 [=================>............] - ETA: 0s - loss: 0.00306/8 [=====================>........] - ETA: 0s - loss: 0.00337/8 [=========================>....] - ETA: 0s - loss: 0.00378/8 [==============================] - 1s 70ms/step - loss: 0.0039
1/8 [==>...........................] - ETA: 0s - loss: 1.6045e-044/8 [==============>...............] - ETA: 0s - loss: 1.7999e-048/8 [==============================] - 0s 13ms/step - loss: 2.1175e-04
1/8 [==>...........................] - ETA: 0s - loss: 3.6323e-045/8 [=================>............] - ETA: 0s - loss: 4.9359e-048/8 [==============================] - 0s 14ms/step - loss: 4.9968e-04
1/8 [==>...........................] - ETA: 0s - loss: 5.9456e-044/8 [==============>...............] - ETA: 0s - loss: 5.2505e-047/8 [=========================>....] - ETA: 0s - loss: 4.1097e-048/8 [==============================] - 0s 19ms/step - loss: 4.0545e-04
1/8 [==>...........................] - ETA: 0s - loss: 3.2242e-044/8 [==============>...............] - ETA: 0s - loss: 6.0305e-047/8 [=========================>....] - ETA: 0s - loss: 8.6714e-048/8 [==============================] - 0s 15ms/step - loss: 9.3462e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00224/8 [==============>...............] - ETA: 0s - loss: 0.00286/8 [=====================>........] - ETA: 0s - loss: 0.00368/8 [==============================] - ETA: 0s - loss: 0.00428/8 [==============================] - 0s 23ms/step - loss: 0.0042
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0012443100422387943:
Train Score: 0.00067 MSE 0.02592 RMSE
Test Score: 0.00950 MSE 0.09747 RMSE
Deviation Min [9.95600824e-06], Max [0.14535716]
Deviation 99.5th pctile [0.13610956]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1648,    8]))
Confusion matrix 
[[1639    9]
 [   8    0]]
precision 0.00000, recall 0.00000, f1 0.00000
Time to train: 366906 ms
Saving model models/A3Benchmark/A3Benchmark-TS72.csv.h5
Total Time to proces all the selected files : 371906 ms
A3Benchmark : Avg precision 0.00000 recall 0.00000 f1 0.00000 time to train 366906.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS72.csv  --epochs 20 --n_iter 3 --patience 3 :: took 378 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS73.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 05:30:55 AM MST
2020-12-01 05:31:01.758191: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 05:31:01.776014: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 05:31:01.776832: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55ba818b7d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 05:31:01.776894: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 05:31:01.777028: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS73.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00685/8 [=================>............] - ETA: 0s - loss: 0.00748/8 [==============================] - ETA: 0s - loss: 0.00768/8 [==============================] - 0s 15ms/step - loss: 0.0076
1/8 [==>...........................] - ETA: 0s - loss: 0.00973/8 [==========>...................] - ETA: 0s - loss: 0.01034/8 [==============>...............] - ETA: 0s - loss: 0.00865/8 [=================>............] - ETA: 0s - loss: 0.00888/8 [==============================] - ETA: 0s - loss: 0.01078/8 [==============================] - 0s 56ms/step - loss: 0.0107
1/8 [==>...........................] - ETA: 0s - loss: 0.00373/8 [==========>...................] - ETA: 0s - loss: 0.00454/8 [==============>...............] - ETA: 0s - loss: 0.00706/8 [=====================>........] - ETA: 0s - loss: 0.00627/8 [=========================>....] - ETA: 0s - loss: 0.00718/8 [==============================] - 0s 40ms/step - loss: 0.0069
1/8 [==>...........................] - ETA: 0s - loss: 0.00543/8 [==========>...................] - ETA: 0s - loss: 0.00975/8 [=================>............] - ETA: 0s - loss: 0.00807/8 [=========================>....] - ETA: 0s - loss: 0.00918/8 [==============================] - ETA: 0s - loss: 0.00898/8 [==============================] - 0s 50ms/step - loss: 0.0089
1/8 [==>...........................] - ETA: 0s - loss: 0.00512/8 [======>.......................] - ETA: 0s - loss: 0.00604/8 [==============>...............] - ETA: 0s - loss: 0.00766/8 [=====================>........] - ETA: 0s - loss: 0.00798/8 [==============================] - 0s 54ms/step - loss: 0.0080
1/8 [==>...........................] - ETA: 0s - loss: 0.00632/8 [======>.......................] - ETA: 0s - loss: 0.00644/8 [==============>...............] - ETA: 0s - loss: 0.00695/8 [=================>............] - ETA: 0s - loss: 0.00697/8 [=========================>....] - ETA: 0s - loss: 0.00758/8 [==============================] - ETA: 0s - loss: 0.00738/8 [==============================] - 1s 65ms/step - loss: 0.0073
1/8 [==>...........................] - ETA: 0s - loss: 0.00372/8 [======>.......................] - ETA: 0s - loss: 0.00493/8 [==========>...................] - ETA: 0s - loss: 0.00425/8 [=================>............] - ETA: 0s - loss: 0.00527/8 [=========================>....] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 49ms/step - loss: 0.0056
1/8 [==>...........................] - ETA: 0s - loss: 0.00405/8 [=================>............] - ETA: 0s - loss: 0.00738/8 [==============================] - 0s 13ms/step - loss: 0.0072
1/8 [==>...........................] - ETA: 0s - loss: 0.00484/8 [==============>...............] - ETA: 0s - loss: 0.00777/8 [=========================>....] - ETA: 0s - loss: 0.00848/8 [==============================] - 0s 16ms/step - loss: 0.0081
1/8 [==>...........................] - ETA: 0s - loss: 0.00415/8 [=================>............] - ETA: 0s - loss: 0.00518/8 [==============================] - 0s 14ms/step - loss: 0.0056
1/8 [==>...........................] - ETA: 0s - loss: 0.00853/8 [==========>...................] - ETA: 0s - loss: 0.00865/8 [=================>............] - ETA: 0s - loss: 0.00807/8 [=========================>....] - ETA: 0s - loss: 0.00888/8 [==============================] - ETA: 0s - loss: 0.00868/8 [==============================] - 0s 46ms/step - loss: 0.0086
1/8 [==>...........................] - ETA: 0s - loss: 0.00323/8 [==========>...................] - ETA: 0s - loss: 0.00395/8 [=================>............] - ETA: 0s - loss: 0.00696/8 [=====================>........] - ETA: 0s - loss: 0.00677/8 [=========================>....] - ETA: 0s - loss: 0.00658/8 [==============================] - ETA: 0s - loss: 0.00658/8 [==============================] - 1s 104ms/step - loss: 0.0065
1/8 [==>...........................] - ETA: 0s - loss: 0.00633/8 [==========>...................] - ETA: 0s - loss: 0.00775/8 [=================>............] - ETA: 0s - loss: 0.00947/8 [=========================>....] - ETA: 0s - loss: 0.00968/8 [==============================] - 0s 27ms/step - loss: 0.0097
1/8 [==>...........................] - ETA: 0s - loss: 0.00483/8 [==========>...................] - ETA: 0s - loss: 0.00795/8 [=================>............] - ETA: 0s - loss: 0.00677/8 [=========================>....] - ETA: 0s - loss: 0.00798/8 [==============================] - 0s 25ms/step - loss: 0.0076
1/8 [==>...........................] - ETA: 0s - loss: 0.00693/8 [==========>...................] - ETA: 0s - loss: 0.00625/8 [=================>............] - ETA: 0s - loss: 0.00647/8 [=========================>....] - ETA: 0s - loss: 0.00678/8 [==============================] - 0s 31ms/step - loss: 0.0069
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.006750221736729145:
Train Score: 0.00611 MSE 0.07814 RMSE
Test Score: 0.00558 MSE 0.07467 RMSE
Deviation Min [1.53321622e-05], Max [0.46703082]
Deviation 99.5th pctile [0.32078469]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1641,   15]))
Confusion matrix 
[[1641    0]
 [   6    9]]
precision 1.00000, recall 0.60000, f1 0.75000
Time to train: 943437 ms
Saving model models/A3Benchmark/A3Benchmark-TS73.csv.h5
Total Time to proces all the selected files : 948868 ms
A3Benchmark : Avg precision 1.00000 recall 0.60000 f1 0.75000 time to train 943437.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS73.csv  --epochs 20 --n_iter 3 --patience 3 :: took 956 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS74.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 05:46:56 AM MST
2020-12-01 05:47:02.166247: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 05:47:02.185117: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 05:47:02.186775: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55e302464310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 05:47:02.186821: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 05:47:02.187058: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS74.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00213/8 [==========>...................] - ETA: 0s - loss: 0.00225/8 [=================>............] - ETA: 0s - loss: 0.00227/8 [=========================>....] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 36ms/step - loss: 0.0022
1/8 [==>...........................] - ETA: 0s - loss: 0.00183/8 [==========>...................] - ETA: 0s - loss: 0.00255/8 [=================>............] - ETA: 0s - loss: 0.00257/8 [=========================>....] - ETA: 0s - loss: 0.00258/8 [==============================] - 0s 31ms/step - loss: 0.0026
1/8 [==>...........................] - ETA: 0s - loss: 0.00173/8 [==========>...................] - ETA: 0s - loss: 0.00235/8 [=================>............] - ETA: 0s - loss: 0.00247/8 [=========================>....] - ETA: 0s - loss: 0.00248/8 [==============================] - 0s 27ms/step - loss: 0.0024
1/8 [==>...........................] - ETA: 0s - loss: 0.00253/8 [==========>...................] - ETA: 0s - loss: 0.00345/8 [=================>............] - ETA: 0s - loss: 0.00367/8 [=========================>....] - ETA: 0s - loss: 0.00378/8 [==============================] - 0s 28ms/step - loss: 0.0039
1/8 [==>...........................] - ETA: 0s - loss: 0.00563/8 [==========>...................] - ETA: 0s - loss: 0.00595/8 [=================>............] - ETA: 0s - loss: 0.00677/8 [=========================>....] - ETA: 0s - loss: 0.00738/8 [==============================] - ETA: 0s - loss: 0.00768/8 [==============================] - 0s 46ms/step - loss: 0.0076
1/8 [==>...........................] - ETA: 0s - loss: 0.00205/8 [=================>............] - ETA: 0s - loss: 0.00208/8 [==============================] - 0s 12ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.00145/8 [=================>............] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 13ms/step - loss: 0.0018
1/8 [==>...........................] - ETA: 0s - loss: 0.00195/8 [=================>............] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 13ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.00232/8 [======>.......................] - ETA: 0s - loss: 0.00314/8 [==============>...............] - ETA: 0s - loss: 0.00305/8 [=================>............] - ETA: 0s - loss: 0.00336/8 [=====================>........] - ETA: 0s - loss: 0.00337/8 [=========================>....] - ETA: 0s - loss: 0.00348/8 [==============================] - 0s 61ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.00415/8 [=================>............] - ETA: 0s - loss: 0.00508/8 [==============================] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 16ms/step - loss: 0.0057
1/8 [==>...........................] - ETA: 0s - loss: 0.00184/8 [==============>...............] - ETA: 0s - loss: 0.00177/8 [=========================>....] - ETA: 0s - loss: 0.00198/8 [==============================] - 0s 18ms/step - loss: 0.0019
1/8 [==>...........................] - ETA: 0s - loss: 0.00214/8 [==============>...............] - ETA: 0s - loss: 0.00267/8 [=========================>....] - ETA: 0s - loss: 0.00268/8 [==============================] - 0s 17ms/step - loss: 0.0026
1/8 [==>...........................] - ETA: 0s - loss: 0.00174/8 [==============>...............] - ETA: 0s - loss: 0.00227/8 [=========================>....] - ETA: 0s - loss: 0.00208/8 [==============================] - 0s 19ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.00133/8 [==========>...................] - ETA: 0s - loss: 0.00184/8 [==============>...............] - ETA: 0s - loss: 0.00177/8 [=========================>....] - ETA: 0s - loss: 0.00208/8 [==============================] - 0s 26ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.00235/8 [=================>............] - ETA: 0s - loss: 0.00308/8 [==============================] - 0s 14ms/step - loss: 0.0037
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0024826290551573037:
Train Score: 0.00235 MSE 0.04850 RMSE
Test Score: 0.00953 MSE 0.09760 RMSE
Deviation Min [2.3793766e-05], Max [0.17078832]
Deviation 99.5th pctile [0.16122939]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1650,    6]))
Confusion matrix 
[[1642    8]
 [   5    1]]
precision 0.11111, recall 0.16667, f1 0.13333
Time to train: 365320 ms
Saving model models/A3Benchmark/A3Benchmark-TS74.csv.h5
Total Time to proces all the selected files : 369841 ms
A3Benchmark : Avg precision 0.11111 recall 0.16667 f1 0.13333 time to train 365320.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS74.csv  --epochs 20 --n_iter 3 --patience 3 :: took 376 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS75.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 05:53:17 AM MST
2020-12-01 05:53:23.100403: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 05:53:23.119022: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 05:53:23.119996: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5568dabd48e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 05:53:23.120021: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 05:53:23.120138: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS75.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.01143/8 [==========>...................] - ETA: 0s - loss: 0.01325/8 [=================>............] - ETA: 0s - loss: 0.01447/8 [=========================>....] - ETA: 0s - loss: 0.01378/8 [==============================] - 0s 32ms/step - loss: 0.0139
1/8 [==>...........................] - ETA: 0s - loss: 0.00973/8 [==========>...................] - ETA: 0s - loss: 0.01325/8 [=================>............] - ETA: 0s - loss: 0.01267/8 [=========================>....] - ETA: 0s - loss: 0.01218/8 [==============================] - 0s 26ms/step - loss: 0.0126
1/8 [==>...........................] - ETA: 0s - loss: 0.00172/8 [======>.......................] - ETA: 0s - loss: 0.00163/8 [==========>...................] - ETA: 0s - loss: 0.00144/8 [==============>...............] - ETA: 0s - loss: 0.00205/8 [=================>............] - ETA: 0s - loss: 0.00216/8 [=====================>........] - ETA: 0s - loss: 0.00247/8 [=========================>....] - ETA: 0s - loss: 0.00248/8 [==============================] - 1s 83ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.00972/8 [======>.......................] - ETA: 0s - loss: 0.01303/8 [==========>...................] - ETA: 0s - loss: 0.01324/8 [==============>...............] - ETA: 0s - loss: 0.01295/8 [=================>............] - ETA: 0s - loss: 0.01316/8 [=====================>........] - ETA: 0s - loss: 0.01367/8 [=========================>....] - ETA: 0s - loss: 0.01328/8 [==============================] - ETA: 0s - loss: 0.01368/8 [==============================] - 1s 94ms/step - loss: 0.0136
1/8 [==>...........................] - ETA: 0s - loss: 0.01432/8 [======>.......................] - ETA: 0s - loss: 0.01444/8 [==============>...............] - ETA: 0s - loss: 0.01286/8 [=====================>........] - ETA: 0s - loss: 0.01388/8 [==============================] - ETA: 0s - loss: 0.01378/8 [==============================] - 0s 30ms/step - loss: 0.0137
1/8 [==>...........................] - ETA: 0s - loss: 0.00964/8 [==============>...............] - ETA: 0s - loss: 0.01237/8 [=========================>....] - ETA: 0s - loss: 0.01218/8 [==============================] - 0s 17ms/step - loss: 0.0121
1/8 [==>...........................] - ETA: 0s - loss: 0.00152/8 [======>.......................] - ETA: 0s - loss: 0.00244/8 [==============>...............] - ETA: 0s - loss: 0.00236/8 [=====================>........] - ETA: 0s - loss: 0.00217/8 [=========================>....] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 44ms/step - loss: 0.0022
1/8 [==>...........................] - ETA: 0s - loss: 0.00414/8 [==============>...............] - ETA: 0s - loss: 0.00407/8 [=========================>....] - ETA: 0s - loss: 0.00438/8 [==============================] - 0s 18ms/step - loss: 0.0043
1/8 [==>...........................] - ETA: 0s - loss: 0.00275/8 [=================>............] - ETA: 0s - loss: 0.00248/8 [==============================] - 0s 12ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 0.00264/8 [==============>...............] - ETA: 0s - loss: 0.00246/8 [=====================>........] - ETA: 0s - loss: 0.00257/8 [=========================>....] - ETA: 0s - loss: 0.00258/8 [==============================] - 0s 39ms/step - loss: 0.0025
1/8 [==>...........................] - ETA: 0s - loss: 0.01162/8 [======>.......................] - ETA: 0s - loss: 0.01393/8 [==========>...................] - ETA: 0s - loss: 0.01334/8 [==============>...............] - ETA: 0s - loss: 0.01395/8 [=================>............] - ETA: 0s - loss: 0.01446/8 [=====================>........] - ETA: 0s - loss: 0.01417/8 [=========================>....] - ETA: 0s - loss: 0.01378/8 [==============================] - ETA: 0s - loss: 0.01398/8 [==============================] - 1s 131ms/step - loss: 0.0139
1/8 [==>...........................] - ETA: 0s - loss: 0.01023/8 [==========>...................] - ETA: 0s - loss: 0.01395/8 [=================>............] - ETA: 0s - loss: 0.01327/8 [=========================>....] - ETA: 0s - loss: 0.01278/8 [==============================] - 0s 39ms/step - loss: 0.0131
1/8 [==>...........................] - ETA: 0s - loss: 0.01072/8 [======>.......................] - ETA: 0s - loss: 0.01223/8 [==========>...................] - ETA: 0s - loss: 0.01294/8 [==============>...............] - ETA: 0s - loss: 0.01265/8 [=================>............] - ETA: 0s - loss: 0.01346/8 [=====================>........] - ETA: 0s - loss: 0.01367/8 [=========================>....] - ETA: 0s - loss: 0.01318/8 [==============================] - ETA: 0s - loss: 0.01358/8 [==============================] - 1s 119ms/step - loss: 0.0135
1/8 [==>...........................] - ETA: 0s - loss: 0.00343/8 [==========>...................] - ETA: 0s - loss: 0.00325/8 [=================>............] - ETA: 0s - loss: 0.00347/8 [=========================>....] - ETA: 0s - loss: 0.00378/8 [==============================] - 0s 26ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.00643/8 [==========>...................] - ETA: 0s - loss: 0.00675/8 [=================>............] - ETA: 0s - loss: 0.00587/8 [=========================>....] - ETA: 0s - loss: 0.00618/8 [==============================] - 0s 27ms/step - loss: 0.0062
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.004779097950085997:
Train Score: 0.00294 MSE 0.05421 RMSE
Test Score: 0.00540 MSE 0.07347 RMSE
Deviation Min [0.00025617], Max [0.34922194]
Deviation 99.5th pctile [0.26718319]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1643,   13]))
Confusion matrix 
[[1643    0]
 [   4    9]]
precision 1.00000, recall 0.69231, f1 0.81818
Time to train: 736067 ms
Saving model models/A3Benchmark/A3Benchmark-TS75.csv.h5
Total Time to proces all the selected files : 739076 ms
A3Benchmark : Avg precision 1.00000 recall 0.69231 f1 0.81818 time to train 736067.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS75.csv  --epochs 20 --n_iter 3 --patience 3 :: took 745 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS76.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 06:05:47 AM MST
2020-12-01 06:05:53.572762: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 06:05:53.591222: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 06:05:53.592633: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x562522182c00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 06:05:53.592685: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 06:05:53.592901: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS76.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.02042/8 [======>.......................] - ETA: 0s - loss: 0.02393/8 [==========>...................] - ETA: 0s - loss: 0.02374/8 [==============>...............] - ETA: 0s - loss: 0.02326/8 [=====================>........] - ETA: 0s - loss: 0.02417/8 [=========================>....] - ETA: 0s - loss: 0.02398/8 [==============================] - ETA: 0s - loss: 0.02478/8 [==============================] - 1s 70ms/step - loss: 0.0247
1/8 [==>...........................] - ETA: 0s - loss: 0.00293/8 [==========>...................] - ETA: 0s - loss: 0.00406/8 [=====================>........] - ETA: 0s - loss: 0.00338/8 [==============================] - ETA: 0s - loss: 0.00378/8 [==============================] - 0s 29ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.00413/8 [==========>...................] - ETA: 0s - loss: 0.00695/8 [=================>............] - ETA: 0s - loss: 0.00607/8 [=========================>....] - ETA: 0s - loss: 0.00558/8 [==============================] - 0s 27ms/step - loss: 0.0055
1/8 [==>...........................] - ETA: 0s - loss: 0.00473/8 [==========>...................] - ETA: 0s - loss: 0.00595/8 [=================>............] - ETA: 0s - loss: 0.00566/8 [=====================>........] - ETA: 0s - loss: 0.00557/8 [=========================>....] - ETA: 0s - loss: 0.00538/8 [==============================] - ETA: 0s - loss: 0.00678/8 [==============================] - 0s 45ms/step - loss: 0.0067
1/8 [==>...........................] - ETA: 0s - loss: 0.00363/8 [==========>...................] - ETA: 0s - loss: 0.00325/8 [=================>............] - ETA: 0s - loss: 0.00387/8 [=========================>....] - ETA: 0s - loss: 0.00378/8 [==============================] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 39ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.00344/8 [==============>...............] - ETA: 0s - loss: 0.00267/8 [=========================>....] - ETA: 0s - loss: 0.00278/8 [==============================] - 0s 16ms/step - loss: 0.0026
1/8 [==>...........................] - ETA: 0s - loss: 0.00124/8 [==============>...............] - ETA: 0s - loss: 0.00258/8 [==============================] - ETA: 0s - loss: 0.00248/8 [==============================] - 0s 15ms/step - loss: 0.0024
1/8 [==>...........................] - ETA: 0s - loss: 0.00262/8 [======>.......................] - ETA: 0s - loss: 0.00335/8 [=================>............] - ETA: 0s - loss: 0.00396/8 [=====================>........] - ETA: 0s - loss: 0.00368/8 [==============================] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 39ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.00284/8 [==============>...............] - ETA: 0s - loss: 0.00197/8 [=========================>....] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 18ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 0.00365/8 [=================>............] - ETA: 0s - loss: 0.00448/8 [==============================] - 0s 12ms/step - loss: 0.0041
1/8 [==>...........................] - ETA: 0s - loss: 0.00503/8 [==========>...................] - ETA: 0s - loss: 0.00335/8 [=================>............] - ETA: 0s - loss: 0.00387/8 [=========================>....] - ETA: 0s - loss: 0.00398/8 [==============================] - 0s 32ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.00433/8 [==========>...................] - ETA: 0s - loss: 0.00406/8 [=====================>........] - ETA: 0s - loss: 0.00337/8 [=========================>....] - ETA: 0s - loss: 0.00378/8 [==============================] - 0s 30ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.00323/8 [==========>...................] - ETA: 0s - loss: 0.00595/8 [=================>............] - ETA: 0s - loss: 0.00427/8 [=========================>....] - ETA: 0s - loss: 0.00408/8 [==============================] - 0s 27ms/step - loss: 0.0040
1/8 [==>...........................] - ETA: 0s - loss: 0.01573/8 [==========>...................] - ETA: 0s - loss: 0.02335/8 [=================>............] - ETA: 0s - loss: 0.02247/8 [=========================>....] - ETA: 0s - loss: 0.02248/8 [==============================] - 0s 31ms/step - loss: 0.0242
1/8 [==>...........................] - ETA: 0s - loss: 0.00453/8 [==========>...................] - ETA: 0s - loss: 0.00585/8 [=================>............] - ETA: 0s - loss: 0.00627/8 [=========================>....] - ETA: 0s - loss: 0.00588/8 [==============================] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 54ms/step - loss: 0.0057
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.003085089009255171:
Train Score: 0.00264 MSE 0.05142 RMSE
Test Score: 0.00288 MSE 0.05365 RMSE
Deviation Min [8.59688785e-06], Max [0.4486697]
Deviation 99.5th pctile [0.15533585]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1651,    5]))
Confusion matrix 
[[1647    4]
 [   0    5]]
precision 0.55556, recall 1.00000, f1 0.71429
Time to train: 1203695 ms
Saving model models/A3Benchmark/A3Benchmark-TS76.csv.h5
Total Time to proces all the selected files : 1206706 ms
A3Benchmark : Avg precision 0.55556 recall 1.00000 f1 0.71429 time to train 1203695.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS76.csv  --epochs 20 --n_iter 3 --patience 3 :: took 1213 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS77.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 06:26:05 AM MST
2020-12-01 06:26:11.567940: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 06:26:11.586053: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 06:26:11.586848: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55e58db7f8e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 06:26:11.586896: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 06:26:11.587025: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS77.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.01162/8 [======>.......................] - ETA: 0s - loss: 0.01373/8 [==========>...................] - ETA: 0s - loss: 0.01344/8 [==============>...............] - ETA: 0s - loss: 0.01305/8 [=================>............] - ETA: 0s - loss: 0.01366/8 [=====================>........] - ETA: 0s - loss: 0.01357/8 [=========================>....] - ETA: 0s - loss: 0.01328/8 [==============================] - 1s 123ms/step - loss: 0.0144
1/8 [==>...........................] - ETA: 0s - loss: 0.01034/8 [==============>...............] - ETA: 0s - loss: 0.01256/8 [=====================>........] - ETA: 0s - loss: 0.01318/8 [==============================] - ETA: 0s - loss: 0.01318/8 [==============================] - 0s 30ms/step - loss: 0.0131
1/8 [==>...........................] - ETA: 0s - loss: 8.8205e-043/8 [==========>...................] - ETA: 0s - loss: 0.0011    5/8 [=================>............] - ETA: 0s - loss: 0.00247/8 [=========================>....] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 34ms/step - loss: 0.0046
1/8 [==>...........................] - ETA: 0s - loss: 4.5108e-043/8 [==========>...................] - ETA: 0s - loss: 0.0013    5/8 [=================>............] - ETA: 0s - loss: 0.00127/8 [=========================>....] - ETA: 0s - loss: 0.00118/8 [==============================] - 0s 34ms/step - loss: 0.0011
1/8 [==>...........................] - ETA: 0s - loss: 0.00563/8 [==========>...................] - ETA: 0s - loss: 0.00495/8 [=================>............] - ETA: 0s - loss: 0.00387/8 [=========================>....] - ETA: 0s - loss: 0.00408/8 [==============================] - 0s 26ms/step - loss: 0.0039
1/8 [==>...........................] - ETA: 0s - loss: 0.00163/8 [==========>...................] - ETA: 0s - loss: 0.00145/8 [=================>............] - ETA: 0s - loss: 9.9582e-047/8 [=========================>....] - ETA: 0s - loss: 0.0012    8/8 [==============================] - 0s 33ms/step - loss: 0.0019
1/8 [==>...........................] - ETA: 0s - loss: 0.01093/8 [==========>...................] - ETA: 0s - loss: 0.01355/8 [=================>............] - ETA: 0s - loss: 0.01357/8 [=========================>....] - ETA: 0s - loss: 0.01328/8 [==============================] - 0s 32ms/step - loss: 0.0136
1/8 [==>...........................] - ETA: 0s - loss: 5.9032e-042/8 [======>.......................] - ETA: 0s - loss: 6.5591e-043/8 [==========>...................] - ETA: 0s - loss: 6.6792e-044/8 [==============>...............] - ETA: 0s - loss: 0.0014    5/8 [=================>............] - ETA: 0s - loss: 0.00256/8 [=====================>........] - ETA: 0s - loss: 0.00517/8 [=========================>....] - ETA: 0s - loss: 0.00468/8 [==============================] - ETA: 0s - loss: 0.00448/8 [==============================] - 1s 124ms/step - loss: 0.0044
1/8 [==>...........................] - ETA: 0s - loss: 7.3119e-043/8 [==========>...................] - ETA: 0s - loss: 8.7482e-045/8 [=================>............] - ETA: 0s - loss: 8.9964e-047/8 [=========================>....] - ETA: 0s - loss: 8.8384e-048/8 [==============================] - 0s 36ms/step - loss: 8.6769e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00562/8 [======>.......................] - ETA: 0s - loss: 0.00353/8 [==========>...................] - ETA: 0s - loss: 0.00434/8 [==============>...............] - ETA: 0s - loss: 0.00355/8 [=================>............] - ETA: 0s - loss: 0.00297/8 [=========================>....] - ETA: 0s - loss: 0.00318/8 [==============================] - 1s 83ms/step - loss: 0.0030
1/8 [==>...........................] - ETA: 0s - loss: 0.00264/8 [==============>...............] - ETA: 0s - loss: 0.00148/8 [==============================] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 13ms/step - loss: 0.0022
1/8 [==>...........................] - ETA: 0s - loss: 0.01465/8 [=================>............] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 13ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.0096WARNING:tensorflow:Method (on_test_batch_end) is slow compared to the batch update (0.254250). Check your callbacks.
WARNING:tensorflow:Method (on_test_batch_end) is slow compared to the batch update (0.127137). Check your callbacks.
3/8 [==========>...................] - ETA: 0s - loss: 0.01226/8 [=====================>........] - ETA: 0s - loss: 0.01457/8 [=========================>....] - ETA: 0s - loss: 0.01388/8 [==============================] - 0s 25ms/step - loss: 0.0141
1/8 [==>...........................] - ETA: 0s - loss: 0.01004/8 [==============>...............] - ETA: 0s - loss: 0.01137/8 [=========================>....] - ETA: 0s - loss: 0.01158/8 [==============================] - 0s 18ms/step - loss: 0.0119
1/8 [==>...........................] - ETA: 0s - loss: 0.00552/8 [======>.......................] - ETA: 0s - loss: 0.00313/8 [==========>...................] - ETA: 0s - loss: 0.00384/8 [==============>...............] - ETA: 0s - loss: 0.00316/8 [=====================>........] - ETA: 0s - loss: 0.00318/8 [==============================] - ETA: 0s - loss: 0.00268/8 [==============================] - 0s 62ms/step - loss: 0.0026
Best parameters {'n_units': 96, 'n_hidden': 2} best score 0.004744564520660788:
Train Score: 0.00216 MSE 0.04645 RMSE
Test Score: 0.00383 MSE 0.06190 RMSE
Deviation Min [2.75367145e-05], Max [0.52790881]
Deviation 99.5th pctile [0.35542138]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1640,   16]))
Confusion matrix 
[[1640    0]
 [   7    9]]
precision 1.00000, recall 0.56250, f1 0.72000
Time to train: 1161524 ms
Saving model models/A3Benchmark/A3Benchmark-TS77.csv.h5
Total Time to proces all the selected files : 1168748 ms
A3Benchmark : Avg precision 1.00000 recall 0.56250 f1 0.72000 time to train 1161524.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS77.csv  --epochs 20 --n_iter 3 --patience 3 :: took 1175 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS78.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 06:45:45 AM MST
2020-12-01 06:45:51.585890: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 06:45:51.604262: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 06:45:51.605821: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55cb80f34310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 06:45:51.605926: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 06:45:51.606078: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS78.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00615/8 [=================>............] - ETA: 0s - loss: 0.00558/8 [==============================] - ETA: 0s - loss: 0.00568/8 [==============================] - 0s 16ms/step - loss: 0.0056
1/8 [==>...........................] - ETA: 0s - loss: 0.00203/8 [==========>...................] - ETA: 0s - loss: 0.00226/8 [=====================>........] - ETA: 0s - loss: 0.00277/8 [=========================>....] - ETA: 0s - loss: 0.00288/8 [==============================] - 0s 33ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 0.00435/8 [=================>............] - ETA: 0s - loss: 0.00338/8 [==============================] - 0s 15ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.00603/8 [==========>...................] - ETA: 0s - loss: 0.00825/8 [=================>............] - ETA: 0s - loss: 0.00857/8 [=========================>....] - ETA: 0s - loss: 0.00828/8 [==============================] - 0s 26ms/step - loss: 0.0085
1/8 [==>...........................] - ETA: 0s - loss: 0.00545/8 [=================>............] - ETA: 0s - loss: 0.00688/8 [==============================] - ETA: 0s - loss: 0.00718/8 [==============================] - 0s 15ms/step - loss: 0.0071
1/8 [==>...........................] - ETA: 0s - loss: 0.00683/8 [==========>...................] - ETA: 0s - loss: 0.00655/8 [=================>............] - ETA: 0s - loss: 0.00637/8 [=========================>....] - ETA: 0s - loss: 0.00628/8 [==============================] - ETA: 0s - loss: 0.00648/8 [==============================] - 0s 33ms/step - loss: 0.0064
1/8 [==>...........................] - ETA: 0s - loss: 0.00503/8 [==========>...................] - ETA: 0s - loss: 0.00625/8 [=================>............] - ETA: 0s - loss: 0.00677/8 [=========================>....] - ETA: 0s - loss: 0.00678/8 [==============================] - 0s 30ms/step - loss: 0.0068
1/8 [==>...........................] - ETA: 0s - loss: 0.00652/8 [======>.......................] - ETA: 0s - loss: 0.00613/8 [==========>...................] - ETA: 0s - loss: 0.00634/8 [==============>...............] - ETA: 0s - loss: 0.00615/8 [=================>............] - ETA: 0s - loss: 0.00637/8 [=========================>....] - ETA: 0s - loss: 0.00628/8 [==============================] - ETA: 0s - loss: 0.00638/8 [==============================] - 1s 104ms/step - loss: 0.0063
1/8 [==>...........................] - ETA: 0s - loss: 0.00493/8 [==========>...................] - ETA: 0s - loss: 0.00694/8 [==============>...............] - ETA: 0s - loss: 0.00665/8 [=================>............] - ETA: 0s - loss: 0.00686/8 [=====================>........] - ETA: 0s - loss: 0.00677/8 [=========================>....] - ETA: 0s - loss: 0.00668/8 [==============================] - ETA: 0s - loss: 0.00688/8 [==============================] - 1s 114ms/step - loss: 0.0068
1/8 [==>...........................] - ETA: 0s - loss: 0.00763/8 [==========>...................] - ETA: 0s - loss: 0.00894/8 [==============>...............] - ETA: 0s - loss: 0.00865/8 [=================>............] - ETA: 0s - loss: 0.00936/8 [=====================>........] - ETA: 0s - loss: 0.00978/8 [==============================] - ETA: 0s - loss: 0.00998/8 [==============================] - 0s 52ms/step - loss: 0.0099
1/8 [==>...........................] - ETA: 0s - loss: 0.00435/8 [=================>............] - ETA: 0s - loss: 0.00347/8 [=========================>....] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 17ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.00194/8 [==============>...............] - ETA: 0s - loss: 0.00257/8 [=========================>....] - ETA: 0s - loss: 0.00258/8 [==============================] - 0s 16ms/step - loss: 0.0025
1/8 [==>...........................] - ETA: 0s - loss: 0.00605/8 [=================>............] - ETA: 0s - loss: 0.00548/8 [==============================] - 0s 14ms/step - loss: 0.0055
1/8 [==>...........................] - ETA: 0s - loss: 0.00555/8 [=================>............] - ETA: 0s - loss: 0.00758/8 [==============================] - ETA: 0s - loss: 0.00758/8 [==============================] - 0s 16ms/step - loss: 0.0075
1/8 [==>...........................] - ETA: 0s - loss: 0.00564/8 [==============>...............] - ETA: 0s - loss: 0.00667/8 [=========================>....] - ETA: 0s - loss: 0.00738/8 [==============================] - 0s 15ms/step - loss: 0.0074
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.005310247605666518:
Train Score: 0.00220 MSE 0.04691 RMSE
Test Score: 0.00538 MSE 0.07338 RMSE
Deviation Min [7.00119692e-05], Max [0.32127169]
Deviation 99.5th pctile [0.19108027]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1641,   15]))
Confusion matrix 
[[1641    0]
 [   6    9]]
precision 1.00000, recall 0.60000, f1 0.75000
Time to train: 498193 ms
Saving model models/A3Benchmark/A3Benchmark-TS78.csv.h5
Total Time to proces all the selected files : 500894 ms
A3Benchmark : Avg precision 1.00000 recall 0.60000 f1 0.75000 time to train 498193.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS78.csv  --epochs 20 --n_iter 3 --patience 3 :: took 507 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS79.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 06:54:17 AM MST
2020-12-01 06:54:24.007940: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 06:54:24.026200: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 06:54:24.027192: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55b8c5f7c310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 06:54:24.027228: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 06:54:24.027382: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS79.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00963/8 [==========>...................] - ETA: 0s - loss: 0.01065/8 [=================>............] - ETA: 0s - loss: 0.01067/8 [=========================>....] - ETA: 0s - loss: 0.01058/8 [==============================] - 0s 38ms/step - loss: 0.0107
1/8 [==>...........................] - ETA: 0s - loss: 0.00793/8 [==========>...................] - ETA: 0s - loss: 0.00965/8 [=================>............] - ETA: 0s - loss: 0.00947/8 [=========================>....] - ETA: 0s - loss: 0.00968/8 [==============================] - 0s 28ms/step - loss: 0.0099
1/8 [==>...........................] - ETA: 0s - loss: 0.00213/8 [==========>...................] - ETA: 0s - loss: 0.00375/8 [=================>............] - ETA: 0s - loss: 0.00297/8 [=========================>....] - ETA: 0s - loss: 0.00278/8 [==============================] - 0s 29ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 0.00963/8 [==========>...................] - ETA: 0s - loss: 0.01155/8 [=================>............] - ETA: 0s - loss: 0.01146/8 [=====================>........] - ETA: 0s - loss: 0.01107/8 [=========================>....] - ETA: 0s - loss: 0.01118/8 [==============================] - ETA: 0s - loss: 0.01148/8 [==============================] - 0s 55ms/step - loss: 0.0114
1/8 [==>...........................] - ETA: 0s - loss: 0.01743/8 [==========>...................] - ETA: 0s - loss: 0.01445/8 [=================>............] - ETA: 0s - loss: 0.01557/8 [=========================>....] - ETA: 0s - loss: 0.01568/8 [==============================] - 0s 27ms/step - loss: 0.0158
1/8 [==>...........................] - ETA: 0s - loss: 0.00882/8 [======>.......................] - ETA: 0s - loss: 0.00974/8 [==============>...............] - ETA: 0s - loss: 0.00975/8 [=================>............] - ETA: 0s - loss: 0.01016/8 [=====================>........] - ETA: 0s - loss: 0.01037/8 [=========================>....] - ETA: 0s - loss: 0.01008/8 [==============================] - ETA: 0s - loss: 0.01028/8 [==============================] - 1s 68ms/step - loss: 0.0102
1/8 [==>...........................] - ETA: 0s - loss: 0.00832/8 [======>.......................] - ETA: 0s - loss: 0.00983/8 [==========>...................] - ETA: 0s - loss: 0.01014/8 [==============>...............] - ETA: 0s - loss: 0.00965/8 [=================>............] - ETA: 0s - loss: 0.00976/8 [=====================>........] - ETA: 0s - loss: 0.01007/8 [=========================>....] - ETA: 0s - loss: 0.01008/8 [==============================] - ETA: 0s - loss: 0.01038/8 [==============================] - 1s 126ms/step - loss: 0.0103
1/8 [==>...........................] - ETA: 0s - loss: 0.00843/8 [==========>...................] - ETA: 0s - loss: 0.01165/8 [=================>............] - ETA: 0s - loss: 0.01117/8 [=========================>....] - ETA: 0s - loss: 0.01088/8 [==============================] - ETA: 0s - loss: 0.01128/8 [==============================] - 1s 79ms/step - loss: 0.0112
1/8 [==>...........................] - ETA: 0s - loss: 0.00973/8 [==========>...................] - ETA: 0s - loss: 0.01136/8 [=====================>........] - ETA: 0s - loss: 0.01097/8 [=========================>....] - ETA: 0s - loss: 0.01098/8 [==============================] - 0s 43ms/step - loss: 0.0112
1/8 [==>...........................] - ETA: 0s - loss: 0.01474/8 [==============>...............] - ETA: 0s - loss: 0.01197/8 [=========================>....] - ETA: 0s - loss: 0.01358/8 [==============================] - 0s 21ms/step - loss: 0.0137
1/8 [==>...........................] - ETA: 0s - loss: 0.00654/8 [==============>...............] - ETA: 0s - loss: 0.00527/8 [=========================>....] - ETA: 0s - loss: 0.00588/8 [==============================] - 0s 18ms/step - loss: 0.0058
1/8 [==>...........................] - ETA: 0s - loss: 0.00395/8 [=================>............] - ETA: 0s - loss: 0.00518/8 [==============================] - ETA: 0s - loss: 0.00518/8 [==============================] - 0s 15ms/step - loss: 0.0051
1/8 [==>...........................] - ETA: 0s - loss: 0.00284/8 [==============>...............] - ETA: 0s - loss: 0.00377/8 [=========================>....] - ETA: 0s - loss: 0.00318/8 [==============================] - 0s 18ms/step - loss: 0.0032
1/8 [==>...........................] - ETA: 0s - loss: 0.00295/8 [=================>............] - ETA: 0s - loss: 0.00308/8 [==============================] - 0s 14ms/step - loss: 0.0033
1/8 [==>...........................] - ETA: 0s - loss: 0.00824/8 [==============>...............] - ETA: 0s - loss: 0.00548/8 [==============================] - ETA: 0s - loss: 0.00748/8 [==============================] - 0s 16ms/step - loss: 0.0074
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.004958569537848234:
Train Score: 0.00254 MSE 0.05042 RMSE
Test Score: 0.00498 MSE 0.07059 RMSE
Deviation Min [1.97564125e-05], Max [0.37247198]
Deviation 99.5th pctile [0.16453385]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1652,    4]))
Confusion matrix 
[[1647    5]
 [   0    4]]
precision 0.44444, recall 1.00000, f1 0.61538
Time to train: 704108 ms
Saving model models/A3Benchmark/A3Benchmark-TS79.csv.h5
Total Time to proces all the selected files : 707896 ms
A3Benchmark : Avg precision 0.44444 recall 1.00000 f1 0.61538 time to train 704108.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS79.csv  --epochs 20 --n_iter 3 --patience 3 :: took 715 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS7.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 07:06:17 AM MST
2020-12-01 07:06:23.191668: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 07:06:23.211014: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 07:06:23.211943: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5630f5676310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 07:06:23.211972: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 07:06:23.212128: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS7.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00963/8 [==========>...................] - ETA: 0s - loss: 0.00655/8 [=================>............] - ETA: 0s - loss: 0.00677/8 [=========================>....] - ETA: 0s - loss: 0.00718/8 [==============================] - 0s 32ms/step - loss: 0.0069
1/8 [==>...........................] - ETA: 0s - loss: 0.00772/8 [======>.......................] - ETA: 0s - loss: 0.00484/8 [==============>...............] - ETA: 0s - loss: 0.00445/8 [=================>............] - ETA: 0s - loss: 0.00456/8 [=====================>........] - ETA: 0s - loss: 0.00397/8 [=========================>....] - ETA: 0s - loss: 0.00378/8 [==============================] - 0s 59ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.00273/8 [==========>...................] - ETA: 0s - loss: 0.00455/8 [=================>............] - ETA: 0s - loss: 0.00356/8 [=====================>........] - ETA: 0s - loss: 0.00328/8 [==============================] - ETA: 0s - loss: 0.00378/8 [==============================] - 0s 31ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.00222/8 [======>.......................] - ETA: 0s - loss: 0.00244/8 [==============>...............] - ETA: 0s - loss: 0.00246/8 [=====================>........] - ETA: 0s - loss: 0.00257/8 [=========================>....] - ETA: 0s - loss: 0.00248/8 [==============================] - 0s 44ms/step - loss: 0.0024
1/8 [==>...........................] - ETA: 0s - loss: 0.00493/8 [==========>...................] - ETA: 0s - loss: 0.00645/8 [=================>............] - ETA: 0s - loss: 0.00557/8 [=========================>....] - ETA: 0s - loss: 0.00518/8 [==============================] - 0s 27ms/step - loss: 0.0051
1/8 [==>...........................] - ETA: 0s - loss: 0.00343/8 [==========>...................] - ETA: 0s - loss: 0.00285/8 [=================>............] - ETA: 0s - loss: 0.00336/8 [=====================>........] - ETA: 0s - loss: 0.00317/8 [=========================>....] - ETA: 0s - loss: 0.00308/8 [==============================] - ETA: 0s - loss: 0.00298/8 [==============================] - 1s 79ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00883/8 [==========>...................] - ETA: 0s - loss: 0.00545/8 [=================>............] - ETA: 0s - loss: 0.00497/8 [=========================>....] - ETA: 0s - loss: 0.00448/8 [==============================] - 0s 29ms/step - loss: 0.0043
1/8 [==>...........................] - ETA: 0s - loss: 0.00343/8 [==========>...................] - ETA: 0s - loss: 0.00365/8 [=================>............] - ETA: 0s - loss: 0.00357/8 [=========================>....] - ETA: 0s - loss: 0.00348/8 [==============================] - 0s 32ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.00232/8 [======>.......................] - ETA: 0s - loss: 0.00303/8 [==========>...................] - ETA: 0s - loss: 0.00334/8 [==============>...............] - ETA: 0s - loss: 0.00345/8 [=================>............] - ETA: 0s - loss: 0.00356/8 [=====================>........] - ETA: 0s - loss: 0.00347/8 [=========================>....] - ETA: 0s - loss: 0.00338/8 [==============================] - ETA: 0s - loss: 0.00348/8 [==============================] - 1s 115ms/step - loss: 0.0034
1/8 [==>...........................] - ETA: 0s - loss: 4.9297e-044/8 [==============>...............] - ETA: 0s - loss: 0.0031    7/8 [=========================>....] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 18ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.00395/8 [=================>............] - ETA: 0s - loss: 0.00268/8 [==============================] - 0s 13ms/step - loss: 0.0027
1/8 [==>...........................] - ETA: 0s - loss: 0.00613/8 [==========>...................] - ETA: 0s - loss: 0.00354/8 [==============>...............] - ETA: 0s - loss: 0.00355/8 [=================>............] - ETA: 0s - loss: 0.00366/8 [=====================>........] - ETA: 0s - loss: 0.00328/8 [==============================] - ETA: 0s - loss: 0.00308/8 [==============================] - 0s 52ms/step - loss: 0.0030
1/8 [==>...........................] - ETA: 0s - loss: 0.00573/8 [==========>...................] - ETA: 0s - loss: 0.00556/8 [=====================>........] - ETA: 0s - loss: 0.00568/8 [==============================] - 0s 19ms/step - loss: 0.0057
1/8 [==>...........................] - ETA: 0s - loss: 0.00194/8 [==============>...............] - ETA: 0s - loss: 0.00147/8 [=========================>....] - ETA: 0s - loss: 0.00168/8 [==============================] - 0s 17ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 0.00174/8 [==============>...............] - ETA: 0s - loss: 0.00307/8 [=========================>....] - ETA: 0s - loss: 0.00248/8 [==============================] - 0s 18ms/step - loss: 0.0024
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.003069322137162089:
Train Score: 0.00930 MSE 0.09642 RMSE
Test Score: 0.00982 MSE 0.09909 RMSE
Deviation Min [0.00016065], Max [0.47552119]
Deviation 99.5th pctile [0.2276402]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1651,    5]))
Confusion matrix 
[[1647    4]
 [   0    5]]
precision 0.55556, recall 1.00000, f1 0.71429
Time to train: 1097564 ms
Saving model models/A3Benchmark/A3Benchmark-TS7.csv.h5
Total Time to proces all the selected files : 1100428 ms
A3Benchmark : Avg precision 0.55556 recall 1.00000 f1 0.71429 time to train 1097564.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS7.csv  --epochs 20 --n_iter 3 --patience 3 :: took 1107 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS80.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 07:24:49 AM MST
2020-12-01 07:24:55.185947: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 07:24:55.204268: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 07:24:55.205123: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5643544328e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 07:24:55.205149: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 07:24:55.205266: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS80.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 9.1202e-043/8 [==========>...................] - ETA: 0s - loss: 0.0011    4/8 [==============>...............] - ETA: 0s - loss: 0.00105/8 [=================>............] - ETA: 0s - loss: 0.00117/8 [=========================>....] - ETA: 0s - loss: 0.00118/8 [==============================] - ETA: 0s - loss: 0.00128/8 [==============================] - 0s 57ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 7.2641e-043/8 [==========>...................] - ETA: 0s - loss: 0.0011    5/8 [=================>............] - ETA: 0s - loss: 0.00127/8 [=========================>....] - ETA: 0s - loss: 0.00118/8 [==============================] - 0s 38ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00125/8 [=================>............] - ETA: 0s - loss: 0.00167/8 [=========================>....] - ETA: 0s - loss: 0.00178/8 [==============================] - 0s 38ms/step - loss: 0.0017
1/8 [==>...........................] - ETA: 0s - loss: 6.5737e-043/8 [==========>...................] - ETA: 0s - loss: 9.9001e-045/8 [=================>............] - ETA: 0s - loss: 9.1592e-047/8 [=========================>....] - ETA: 0s - loss: 9.4425e-048/8 [==============================] - 0s 37ms/step - loss: 9.9055e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00482/8 [======>.......................] - ETA: 0s - loss: 0.00483/8 [==========>...................] - ETA: 0s - loss: 0.00444/8 [==============>...............] - ETA: 0s - loss: 0.00445/8 [=================>............] - ETA: 0s - loss: 0.00506/8 [=====================>........] - ETA: 0s - loss: 0.00547/8 [=========================>....] - ETA: 0s - loss: 0.00578/8 [==============================] - ETA: 0s - loss: 0.00598/8 [==============================] - 1s 118ms/step - loss: 0.0059
1/8 [==>...........................] - ETA: 0s - loss: 8.0238e-044/8 [==============>...............] - ETA: 0s - loss: 9.1162e-047/8 [=========================>....] - ETA: 0s - loss: 9.0147e-048/8 [==============================] - 0s 18ms/step - loss: 9.5963e-04
1/8 [==>...........................] - ETA: 0s - loss: 6.1359e-044/8 [==============>...............] - ETA: 0s - loss: 7.7652e-047/8 [=========================>....] - ETA: 0s - loss: 7.8116e-048/8 [==============================] - 0s 16ms/step - loss: 8.0697e-04
1/8 [==>...........................] - ETA: 0s - loss: 9.5513e-044/8 [==============>...............] - ETA: 0s - loss: 9.7147e-046/8 [=====================>........] - ETA: 0s - loss: 9.6488e-048/8 [==============================] - ETA: 0s - loss: 9.6770e-048/8 [==============================] - 0s 24ms/step - loss: 9.6770e-04
1/8 [==>...........................] - ETA: 0s - loss: 7.2024e-045/8 [=================>............] - ETA: 0s - loss: 0.0014    8/8 [==============================] - 0s 14ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 0.00333/8 [==========>...................] - ETA: 0s - loss: 0.00305/8 [=================>............] - ETA: 0s - loss: 0.00357/8 [=========================>....] - ETA: 0s - loss: 0.00408/8 [==============================] - 0s 27ms/step - loss: 0.0041
1/8 [==>...........................] - ETA: 0s - loss: 6.9578e-045/8 [=================>............] - ETA: 0s - loss: 8.7716e-048/8 [==============================] - 0s 12ms/step - loss: 8.7817e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00104/8 [==============>...............] - ETA: 0s - loss: 0.00148/8 [==============================] - ETA: 0s - loss: 0.00148/8 [==============================] - 0s 15ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 0.00214/8 [==============>...............] - ETA: 0s - loss: 0.00207/8 [=========================>....] - ETA: 0s - loss: 0.00188/8 [==============================] - 0s 17ms/step - loss: 0.0019
1/8 [==>...........................] - ETA: 0s - loss: 7.6683e-044/8 [==============>...............] - ETA: 0s - loss: 0.0013    7/8 [=========================>....] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 17ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 0.00216/8 [=====================>........] - ETA: 0s - loss: 0.00268/8 [==============================] - 0s 11ms/step - loss: 0.0030
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0016938551794737577:
Train Score: 0.00157 MSE 0.03963 RMSE
Test Score: 0.01088 MSE 0.10432 RMSE
Deviation Min [1.95850798e-05], Max [0.18383007]
Deviation 99.5th pctile [0.16085096]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1643,   13]))
Confusion matrix 
[[1634    9]
 [  13    0]]
precision 0.00000, recall 0.00000, f1 0.00000
Time to train: 380850 ms
Saving model models/A3Benchmark/A3Benchmark-TS80.csv.h5
Total Time to proces all the selected files : 385563 ms
A3Benchmark : Avg precision 0.00000 recall 0.00000 f1 0.00000 time to train 380850.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS80.csv  --epochs 20 --n_iter 3 --patience 3 :: took 392 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS81.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 07:31:26 AM MST
2020-12-01 07:31:32.011475: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 07:31:32.029983: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 07:31:32.030731: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d5ac233c00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 07:31:32.030759: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 07:31:32.030908: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS81.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00904/8 [==============>...............] - ETA: 0s - loss: 0.00867/8 [=========================>....] - ETA: 0s - loss: 0.00938/8 [==============================] - 0s 17ms/step - loss: 0.0102
1/8 [==>...........................] - ETA: 0s - loss: 0.00413/8 [==========>...................] - ETA: 0s - loss: 0.00487/8 [=========================>....] - ETA: 0s - loss: 0.00468/8 [==============================] - 0s 20ms/step - loss: 0.0047
1/8 [==>...........................] - ETA: 0s - loss: 8.4033e-045/8 [=================>............] - ETA: 0s - loss: 0.0012    8/8 [==============================] - ETA: 0s - loss: 0.00148/8 [==============================] - 0s 16ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 0.04622/8 [======>.......................] - ETA: 0s - loss: 0.03993/8 [==========>...................] - ETA: 0s - loss: 0.03935/8 [=================>............] - ETA: 0s - loss: 0.03897/8 [=========================>....] - ETA: 0s - loss: 0.04818/8 [==============================] - 0s 43ms/step - loss: 0.0486
1/8 [==>...........................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00125/8 [=================>............] - ETA: 0s - loss: 0.00157/8 [=========================>....] - ETA: 0s - loss: 0.00168/8 [==============================] - 0s 26ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 0.00594/8 [==============>...............] - ETA: 0s - loss: 0.00487/8 [=========================>....] - ETA: 0s - loss: 0.00458/8 [==============================] - 0s 17ms/step - loss: 0.0047
1/8 [==>...........................] - ETA: 0s - loss: 0.00305/8 [=================>............] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 14ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.00293/8 [==========>...................] - ETA: 0s - loss: 0.00364/8 [==============>...............] - ETA: 0s - loss: 0.00355/8 [=================>............] - ETA: 0s - loss: 0.00306/8 [=====================>........] - ETA: 0s - loss: 0.00327/8 [=========================>....] - ETA: 0s - loss: 0.00358/8 [==============================] - ETA: 0s - loss: 0.00368/8 [==============================] - 1s 75ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.00494/8 [==============>...............] - ETA: 0s - loss: 0.00297/8 [=========================>....] - ETA: 0s - loss: 0.00348/8 [==============================] - 0s 17ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.00175/8 [=================>............] - ETA: 0s - loss: 0.00368/8 [==============================] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 15ms/step - loss: 0.0036
1/8 [==>...........................] - ETA: 0s - loss: 0.00983/8 [==========>...................] - ETA: 0s - loss: 0.00885/8 [=================>............] - ETA: 0s - loss: 0.01017/8 [=========================>....] - ETA: 0s - loss: 0.00938/8 [==============================] - 0s 31ms/step - loss: 0.0096
1/8 [==>...........................] - ETA: 0s - loss: 9.7484e-043/8 [==========>...................] - ETA: 0s - loss: 0.0015    5/8 [=================>............] - ETA: 0s - loss: 0.00167/8 [=========================>....] - ETA: 0s - loss: 0.00168/8 [==============================] - 0s 37ms/step - loss: 0.0016
1/8 [==>...........................] - ETA: 0s - loss: 0.00233/8 [==========>...................] - ETA: 0s - loss: 0.00255/8 [=================>............] - ETA: 0s - loss: 0.00197/8 [=========================>....] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 28ms/step - loss: 0.0024
1/8 [==>...........................] - ETA: 0s - loss: 0.00283/8 [==========>...................] - ETA: 0s - loss: 0.00215/8 [=================>............] - ETA: 0s - loss: 0.00216/8 [=====================>........] - ETA: 0s - loss: 0.00258/8 [==============================] - ETA: 0s - loss: 0.00288/8 [==============================] - 0s 37ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 0.01633/8 [==========>...................] - ETA: 0s - loss: 0.02225/8 [=================>............] - ETA: 0s - loss: 0.02317/8 [=========================>....] - ETA: 0s - loss: 0.02348/8 [==============================] - 0s 38ms/step - loss: 0.0237
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0037725190166383983:
Train Score: 0.00320 MSE 0.05661 RMSE
Test Score: 0.00398 MSE 0.06307 RMSE
Deviation Min [1.85539652e-05], Max [0.35413841]
Deviation 99.5th pctile [0.20530012]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1644,   12]))
Confusion matrix 
[[1644    0]
 [   3    9]]
precision 1.00000, recall 0.75000, f1 0.85714
Time to train: 734974 ms
Saving model models/A3Benchmark/A3Benchmark-TS81.csv.h5
Total Time to proces all the selected files : 738770 ms
A3Benchmark : Avg precision 1.00000 recall 0.75000 f1 0.85714 time to train 734974.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS81.csv  --epochs 20 --n_iter 3 --patience 3 :: took 745 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS82.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 07:43:56 AM MST
2020-12-01 07:44:02.041683: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 07:44:02.064050: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 07:44:02.065156: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5608c0c87c00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 07:44:02.065187: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 07:44:02.065366: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS82.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00553/8 [==========>...................] - ETA: 0s - loss: 0.00705/8 [=================>............] - ETA: 0s - loss: 0.00706/8 [=====================>........] - ETA: 0s - loss: 0.00707/8 [=========================>....] - ETA: 0s - loss: 0.00698/8 [==============================] - ETA: 0s - loss: 0.00708/8 [==============================] - 0s 54ms/step - loss: 0.0070
1/8 [==>...........................] - ETA: 0s - loss: 0.00613/8 [==========>...................] - ETA: 0s - loss: 0.00704/8 [==============>...............] - ETA: 0s - loss: 0.00655/8 [=================>............] - ETA: 0s - loss: 0.00696/8 [=====================>........] - ETA: 0s - loss: 0.00697/8 [=========================>....] - ETA: 0s - loss: 0.00678/8 [==============================] - ETA: 0s - loss: 0.00698/8 [==============================] - 0s 51ms/step - loss: 0.0069
1/8 [==>...........................] - ETA: 0s - loss: 0.00533/8 [==========>...................] - ETA: 0s - loss: 0.00745/8 [=================>............] - ETA: 0s - loss: 0.00697/8 [=========================>....] - ETA: 0s - loss: 0.00698/8 [==============================] - 0s 36ms/step - loss: 0.0071
1/8 [==>...........................] - ETA: 0s - loss: 0.00432/8 [======>.......................] - ETA: 0s - loss: 0.00563/8 [==========>...................] - ETA: 0s - loss: 0.00634/8 [==============>...............] - ETA: 0s - loss: 0.00635/8 [=================>............] - ETA: 0s - loss: 0.00656/8 [=====================>........] - ETA: 0s - loss: 0.00677/8 [=========================>....] - ETA: 0s - loss: 0.00668/8 [==============================] - ETA: 0s - loss: 0.00688/8 [==============================] - 1s 124ms/step - loss: 0.0068
1/8 [==>...........................] - ETA: 0s - loss: 0.01083/8 [==========>...................] - ETA: 0s - loss: 0.01125/8 [=================>............] - ETA: 0s - loss: 0.01167/8 [=========================>....] - ETA: 0s - loss: 0.01218/8 [==============================] - 0s 32ms/step - loss: 0.0124
1/8 [==>...........................] - ETA: 0s - loss: 0.00553/8 [==========>...................] - ETA: 0s - loss: 0.00715/8 [=================>............] - ETA: 0s - loss: 0.00706/8 [=====================>........] - ETA: 0s - loss: 0.00707/8 [=========================>....] - ETA: 0s - loss: 0.00698/8 [==============================] - ETA: 0s - loss: 0.00708/8 [==============================] - 0s 56ms/step - loss: 0.0070
1/8 [==>...........................] - ETA: 0s - loss: 0.00602/8 [======>.......................] - ETA: 0s - loss: 0.00673/8 [==========>...................] - ETA: 0s - loss: 0.00694/8 [==============>...............] - ETA: 0s - loss: 0.00656/8 [=====================>........] - ETA: 0s - loss: 0.00687/8 [=========================>....] - ETA: 0s - loss: 0.00678/8 [==============================] - 0s 53ms/step - loss: 0.0069
1/8 [==>...........................] - ETA: 0s - loss: 0.00543/8 [==========>...................] - ETA: 0s - loss: 0.00735/8 [=================>............] - ETA: 0s - loss: 0.00697/8 [=========================>....] - ETA: 0s - loss: 0.00698/8 [==============================] - 0s 30ms/step - loss: 0.0072
1/8 [==>...........................] - ETA: 0s - loss: 0.00463/8 [==========>...................] - ETA: 0s - loss: 0.00675/8 [=================>............] - ETA: 0s - loss: 0.00727/8 [=========================>....] - ETA: 0s - loss: 0.00728/8 [==============================] - 0s 32ms/step - loss: 0.0075
1/8 [==>...........................] - ETA: 0s - loss: 0.01082/8 [======>.......................] - ETA: 0s - loss: 0.01193/8 [==========>...................] - ETA: 0s - loss: 0.01114/8 [==============>...............] - ETA: 0s - loss: 0.01075/8 [=================>............] - ETA: 0s - loss: 0.01166/8 [=====================>........] - ETA: 0s - loss: 0.01207/8 [=========================>....] - ETA: 0s - loss: 0.01228/8 [==============================] - ETA: 0s - loss: 0.01258/8 [==============================] - 1s 93ms/step - loss: 0.0125
1/8 [==>...........................] - ETA: 0s - loss: 0.00304/8 [==============>...............] - ETA: 0s - loss: 0.00347/8 [=========================>....] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 18ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.00454/8 [==============>...............] - ETA: 0s - loss: 0.00517/8 [=========================>....] - ETA: 0s - loss: 0.00528/8 [==============================] - 0s 17ms/step - loss: 0.0054
1/8 [==>...........................] - ETA: 0s - loss: 0.00432/8 [======>.......................] - ETA: 0s - loss: 0.00564/8 [==============>...............] - ETA: 0s - loss: 0.00555/8 [=================>............] - ETA: 0s - loss: 0.00567/8 [=========================>....] - ETA: 0s - loss: 0.00568/8 [==============================] - 0s 39ms/step - loss: 0.0058
1/8 [==>...........................] - ETA: 0s - loss: 0.00333/8 [==========>...................] - ETA: 0s - loss: 0.00475/8 [=================>............] - ETA: 0s - loss: 0.00497/8 [=========================>....] - ETA: 0s - loss: 0.00508/8 [==============================] - ETA: 0s - loss: 0.00528/8 [==============================] - 0s 61ms/step - loss: 0.0052
1/8 [==>...........................] - ETA: 0s - loss: 0.00243/8 [==========>...................] - ETA: 0s - loss: 0.00245/8 [=================>............] - ETA: 0s - loss: 0.00266/8 [=====================>........] - ETA: 0s - loss: 0.00308/8 [==============================] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 39ms/step - loss: 0.0036
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.004720223089680076:
Train Score: 0.00274 MSE 0.05239 RMSE
Test Score: 0.00567 MSE 0.07529 RMSE
Deviation Min [4.31677461e-06], Max [0.22181171]
Deviation 99.5th pctile [0.15538924]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1649,    7]))
Confusion matrix 
[[1643    6]
 [   4    3]]
precision 0.33333, recall 0.42857, f1 0.37500
Time to train: 581272 ms
Saving model models/A3Benchmark/A3Benchmark-TS82.csv.h5
Total Time to proces all the selected files : 586545 ms
A3Benchmark : Avg precision 0.33333 recall 0.42857 f1 0.37500 time to train 581272.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS82.csv  --epochs 20 --n_iter 3 --patience 3 :: took 593 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS83.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 07:53:54 AM MST
2020-12-01 07:53:59.806988: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 07:53:59.827001: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 07:53:59.827886: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55a2fce03d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 07:53:59.827915: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 07:53:59.828058: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS83.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00563/8 [==========>...................] - ETA: 0s - loss: 0.00685/8 [=================>............] - ETA: 0s - loss: 0.00877/8 [=========================>....] - ETA: 0s - loss: 0.00778/8 [==============================] - 0s 23ms/step - loss: 0.0076
1/8 [==>...........................] - ETA: 0s - loss: 0.01373/8 [==========>...................] - ETA: 0s - loss: 0.01715/8 [=================>............] - ETA: 0s - loss: 0.01787/8 [=========================>....] - ETA: 0s - loss: 0.01708/8 [==============================] - ETA: 0s - loss: 0.01748/8 [==============================] - 0s 35ms/step - loss: 0.0174
1/8 [==>...........................] - ETA: 0s - loss: 0.01403/8 [==========>...................] - ETA: 0s - loss: 0.01954/8 [==============>...............] - ETA: 0s - loss: 0.01785/8 [=================>............] - ETA: 0s - loss: 0.01786/8 [=====================>........] - ETA: 0s - loss: 0.01987/8 [=========================>....] - ETA: 0s - loss: 0.01968/8 [==============================] - 0s 58ms/step - loss: 0.0205
1/8 [==>...........................] - ETA: 0s - loss: 0.01163/8 [==========>...................] - ETA: 0s - loss: 0.00665/8 [=================>............] - ETA: 0s - loss: 0.00778/8 [==============================] - ETA: 0s - loss: 0.00618/8 [==============================] - 0s 28ms/step - loss: 0.0061
1/8 [==>...........................] - ETA: 0s - loss: 0.00162/8 [======>.......................] - ETA: 0s - loss: 0.00443/8 [==========>...................] - ETA: 0s - loss: 0.00634/8 [==============>...............] - ETA: 0s - loss: 0.00565/8 [=================>............] - ETA: 0s - loss: 0.00486/8 [=====================>........] - ETA: 0s - loss: 0.00417/8 [=========================>....] - ETA: 0s - loss: 0.00418/8 [==============================] - ETA: 0s - loss: 0.00438/8 [==============================] - 1s 73ms/step - loss: 0.0043
1/8 [==>...........................] - ETA: 0s - loss: 0.00472/8 [======>.......................] - ETA: 0s - loss: 0.00443/8 [==========>...................] - ETA: 0s - loss: 0.00515/8 [=================>............] - ETA: 0s - loss: 0.00567/8 [=========================>....] - ETA: 0s - loss: 0.00528/8 [==============================] - 0s 39ms/step - loss: 0.0051
1/8 [==>...........................] - ETA: 0s - loss: 0.00302/8 [======>.......................] - ETA: 0s - loss: 0.00655/8 [=================>............] - ETA: 0s - loss: 0.00508/8 [==============================] - 0s 24ms/step - loss: 0.0044
1/8 [==>...........................] - ETA: 0s - loss: 0.00213/8 [==========>...................] - ETA: 0s - loss: 0.00386/8 [=====================>........] - ETA: 0s - loss: 0.00458/8 [==============================] - 0s 24ms/step - loss: 0.0041
1/8 [==>...........................] - ETA: 0s - loss: 0.00984/8 [==============>...............] - ETA: 0s - loss: 0.00487/8 [=========================>....] - ETA: 0s - loss: 0.00458/8 [==============================] - 0s 17ms/step - loss: 0.0043
1/8 [==>...........................] - ETA: 0s - loss: 0.00134/8 [==============>...............] - ETA: 0s - loss: 0.00337/8 [=========================>....] - ETA: 0s - loss: 0.00278/8 [==============================] - 0s 16ms/step - loss: 0.0027
1/8 [==>...........................] - ETA: 0s - loss: 0.01313/8 [==========>...................] - ETA: 0s - loss: 0.01655/8 [=================>............] - ETA: 0s - loss: 0.01727/8 [=========================>....] - ETA: 0s - loss: 0.01668/8 [==============================] - 0s 27ms/step - loss: 0.0170
1/8 [==>...........................] - ETA: 0s - loss: 0.01312/8 [======>.......................] - ETA: 0s - loss: 0.01793/8 [==========>...................] - ETA: 0s - loss: 0.01714/8 [==============>...............] - ETA: 0s - loss: 0.01645/8 [=================>............] - ETA: 0s - loss: 0.01736/8 [=====================>........] - ETA: 0s - loss: 0.01737/8 [=========================>....] - ETA: 0s - loss: 0.01648/8 [==============================] - ETA: 0s - loss: 0.01688/8 [==============================] - 1s 72ms/step - loss: 0.0168
1/8 [==>...........................] - ETA: 0s - loss: 0.00423/8 [==========>...................] - ETA: 0s - loss: 0.00705/8 [=================>............] - ETA: 0s - loss: 0.00517/8 [=========================>....] - ETA: 0s - loss: 0.00648/8 [==============================] - 0s 38ms/step - loss: 0.0064
1/8 [==>...........................] - ETA: 0s - loss: 0.02153/8 [==========>...................] - ETA: 0s - loss: 0.01865/8 [=================>............] - ETA: 0s - loss: 0.01927/8 [=========================>....] - ETA: 0s - loss: 0.01998/8 [==============================] - 0s 38ms/step - loss: 0.0199
1/8 [==>...........................] - ETA: 0s - loss: 0.01363/8 [==========>...................] - ETA: 0s - loss: 0.01755/8 [=================>............] - ETA: 0s - loss: 0.01667/8 [=========================>....] - ETA: 0s - loss: 0.01628/8 [==============================] - ETA: 0s - loss: 0.01668/8 [==============================] - 0s 40ms/step - loss: 0.0166
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.004116008151322603:
Train Score: 0.00293 MSE 0.05409 RMSE
Test Score: 0.00233 MSE 0.04829 RMSE
Deviation Min [2.64025669e-05], Max [0.41238648]
Deviation 99.5th pctile [0.29991223]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1644,   12]))
Confusion matrix 
[[1644    0]
 [   3    9]]
precision 1.00000, recall 0.75000, f1 0.85714
Time to train: 808787 ms
Saving model models/A3Benchmark/A3Benchmark-TS83.csv.h5
Total Time to proces all the selected files : 813536 ms
A3Benchmark : Avg precision 1.00000 recall 0.75000 f1 0.85714 time to train 808787.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS83.csv  --epochs 20 --n_iter 3 --patience 3 :: took 819 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS84.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 08:07:38 AM MST
2020-12-01 08:07:44.926642: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 08:07:44.945026: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 08:07:44.945805: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55631761bd30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 08:07:44.945841: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 08:07:44.945987: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS84.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00523/8 [==========>...................] - ETA: 0s - loss: 0.00615/8 [=================>............] - ETA: 0s - loss: 0.00647/8 [=========================>....] - ETA: 0s - loss: 0.00628/8 [==============================] - 0s 30ms/step - loss: 0.0064
1/8 [==>...........................] - ETA: 0s - loss: 0.00422/8 [======>.......................] - ETA: 0s - loss: 0.00563/8 [==========>...................] - ETA: 0s - loss: 0.00605/8 [=================>............] - ETA: 0s - loss: 0.00597/8 [=========================>....] - ETA: 0s - loss: 0.00568/8 [==============================] - 0s 46ms/step - loss: 0.0057
1/8 [==>...........................] - ETA: 0s - loss: 0.00493/8 [==========>...................] - ETA: 0s - loss: 0.00655/8 [=================>............] - ETA: 0s - loss: 0.00727/8 [=========================>....] - ETA: 0s - loss: 0.00688/8 [==============================] - 0s 31ms/step - loss: 0.0069
1/8 [==>...........................] - ETA: 0s - loss: 0.00463/8 [==========>...................] - ETA: 0s - loss: 0.00754/8 [==============>...............] - ETA: 0s - loss: 0.00736/8 [=====================>........] - ETA: 0s - loss: 0.00718/8 [==============================] - ETA: 0s - loss: 0.00778/8 [==============================] - 0s 34ms/step - loss: 0.0077
1/8 [==>...........................] - ETA: 0s - loss: 0.01463/8 [==========>...................] - ETA: 0s - loss: 0.01275/8 [=================>............] - ETA: 0s - loss: 0.01317/8 [=========================>....] - ETA: 0s - loss: 0.01428/8 [==============================] - 0s 38ms/step - loss: 0.0144
1/8 [==>...........................] - ETA: 0s - loss: 0.00552/8 [======>.......................] - ETA: 0s - loss: 0.00643/8 [==========>...................] - ETA: 0s - loss: 0.00624/8 [==============>...............] - ETA: 0s - loss: 0.00635/8 [=================>............] - ETA: 0s - loss: 0.00646/8 [=====================>........] - ETA: 0s - loss: 0.00647/8 [=========================>....] - ETA: 0s - loss: 0.00638/8 [==============================] - ETA: 0s - loss: 0.00648/8 [==============================] - 1s 79ms/step - loss: 0.0064
1/8 [==>...........................] - ETA: 0s - loss: 0.00413/8 [==========>...................] - ETA: 0s - loss: 0.00634/8 [==============>...............] - ETA: 0s - loss: 0.00666/8 [=====================>........] - ETA: 0s - loss: 0.00658/8 [==============================] - ETA: 0s - loss: 0.00628/8 [==============================] - 0s 37ms/step - loss: 0.0062
1/8 [==>...........................] - ETA: 0s - loss: 0.00443/8 [==========>...................] - ETA: 0s - loss: 0.00665/8 [=================>............] - ETA: 0s - loss: 0.00607/8 [=========================>....] - ETA: 0s - loss: 0.00588/8 [==============================] - 0s 25ms/step - loss: 0.0061
1/8 [==>...........................] - ETA: 0s - loss: 0.00383/8 [==========>...................] - ETA: 0s - loss: 0.00545/8 [=================>............] - ETA: 0s - loss: 0.00527/8 [=========================>....] - ETA: 0s - loss: 0.00558/8 [==============================] - 0s 30ms/step - loss: 0.0057
1/8 [==>...........................] - ETA: 0s - loss: 0.01073/8 [==========>...................] - ETA: 0s - loss: 0.00965/8 [=================>............] - ETA: 0s - loss: 0.00977/8 [=========================>....] - ETA: 0s - loss: 0.01088/8 [==============================] - 0s 29ms/step - loss: 0.0110
1/8 [==>...........................] - ETA: 0s - loss: 0.00673/8 [==========>...................] - ETA: 0s - loss: 0.00735/8 [=================>............] - ETA: 0s - loss: 0.00717/8 [=========================>....] - ETA: 0s - loss: 0.00708/8 [==============================] - 0s 24ms/step - loss: 0.0072
1/8 [==>...........................] - ETA: 0s - loss: 0.00423/8 [==========>...................] - ETA: 0s - loss: 0.00605/8 [=================>............] - ETA: 0s - loss: 0.00577/8 [=========================>....] - ETA: 0s - loss: 0.00568/8 [==============================] - 0s 25ms/step - loss: 0.0057
1/8 [==>...........................] - ETA: 0s - loss: 0.00443/8 [==========>...................] - ETA: 0s - loss: 0.00625/8 [=================>............] - ETA: 0s - loss: 0.00637/8 [=========================>....] - ETA: 0s - loss: 0.00618/8 [==============================] - 0s 33ms/step - loss: 0.0063
1/8 [==>...........................] - ETA: 0s - loss: 0.00473/8 [==========>...................] - ETA: 0s - loss: 0.00784/8 [==============>...............] - ETA: 0s - loss: 0.00776/8 [=====================>........] - ETA: 0s - loss: 0.00758/8 [==============================] - ETA: 0s - loss: 0.00818/8 [==============================] - 0s 46ms/step - loss: 0.0081
1/8 [==>...........................] - ETA: 0s - loss: 0.00833/8 [==========>...................] - ETA: 0s - loss: 0.00785/8 [=================>............] - ETA: 0s - loss: 0.00787/8 [=========================>....] - ETA: 0s - loss: 0.00858/8 [==============================] - 0s 33ms/step - loss: 0.0087
Best parameters {'n_units': 48, 'n_hidden': 2} best score 0.00707519194111228:
Train Score: 0.00640 MSE 0.08001 RMSE
Test Score: 0.01189 MSE 0.10905 RMSE
Deviation Min [3.93396094e-05], Max [0.23872532]
Deviation 99.5th pctile [0.21607772]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1651,    5]))
Confusion matrix 
[[1643    8]
 [   4    1]]
precision 0.11111, recall 0.20000, f1 0.14286
Time to train: 580969 ms
Saving model models/A3Benchmark/A3Benchmark-TS84.csv.h5
Total Time to proces all the selected files : 589245 ms
A3Benchmark : Avg precision 0.11111 recall 0.20000 f1 0.14286 time to train 580969.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS84.csv  --epochs 20 --n_iter 3 --patience 3 :: took 596 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS85.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 08:17:39 AM MST
2020-12-01 08:17:45.523206: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 08:17:45.541001: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 08:17:45.541880: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55ba64066d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 08:17:45.541909: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 08:17:45.542033: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS85.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.01152/8 [======>.......................] - ETA: 0s - loss: 0.00704/8 [==============>...............] - ETA: 0s - loss: 0.00455/8 [=================>............] - ETA: 0s - loss: 0.00418/8 [==============================] - ETA: 0s - loss: 0.00358/8 [==============================] - 0s 58ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.00313/8 [==========>...................] - ETA: 0s - loss: 0.00606/8 [=====================>........] - ETA: 0s - loss: 0.00508/8 [==============================] - 0s 19ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00174/8 [==============>...............] - ETA: 0s - loss: 0.00367/8 [=========================>....] - ETA: 0s - loss: 0.00308/8 [==============================] - 0s 18ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00265/8 [=================>............] - ETA: 0s - loss: 0.00588/8 [==============================] - ETA: 0s - loss: 0.00478/8 [==============================] - 0s 13ms/step - loss: 0.0047
1/8 [==>...........................] - ETA: 0s - loss: 0.00225/8 [=================>............] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 13ms/step - loss: 0.0027
1/8 [==>...........................] - ETA: 0s - loss: 0.01183/8 [==========>...................] - ETA: 0s - loss: 0.00615/8 [=================>............] - ETA: 0s - loss: 0.00546/8 [=====================>........] - ETA: 0s - loss: 0.00527/8 [=========================>....] - ETA: 0s - loss: 0.00548/8 [==============================] - ETA: 0s - loss: 0.00518/8 [==============================] - 0s 60ms/step - loss: 0.0051
1/8 [==>...........................] - ETA: 0s - loss: 0.00214/8 [==============>...............] - ETA: 0s - loss: 0.00705/8 [=================>............] - ETA: 0s - loss: 0.00636/8 [=====================>........] - ETA: 0s - loss: 0.00577/8 [=========================>....] - ETA: 0s - loss: 0.00568/8 [==============================] - 1s 71ms/step - loss: 0.0058
1/8 [==>...........................] - ETA: 0s - loss: 0.00372/8 [======>.......................] - ETA: 0s - loss: 0.00603/8 [==========>...................] - ETA: 0s - loss: 0.00694/8 [==============>...............] - ETA: 0s - loss: 0.00705/8 [=================>............] - ETA: 0s - loss: 0.00666/8 [=====================>........] - ETA: 0s - loss: 0.00607/8 [=========================>....] - ETA: 0s - loss: 0.00658/8 [==============================] - ETA: 0s - loss: 0.00668/8 [==============================] - 1s 134ms/step - loss: 0.0066
1/8 [==>...........................] - ETA: 0s - loss: 0.00283/8 [==========>...................] - ETA: 0s - loss: 0.00915/8 [=================>............] - ETA: 0s - loss: 0.00697/8 [=========================>....] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 26ms/step - loss: 0.0055
1/8 [==>...........................] - ETA: 0s - loss: 0.00403/8 [==========>...................] - ETA: 0s - loss: 0.00335/8 [=================>............] - ETA: 0s - loss: 0.00287/8 [=========================>....] - ETA: 0s - loss: 0.00418/8 [==============================] - 0s 39ms/step - loss: 0.0040
1/8 [==>...........................] - ETA: 0s - loss: 0.00985/8 [=================>............] - ETA: 0s - loss: 0.00308/8 [==============================] - 0s 14ms/step - loss: 0.0025
1/8 [==>...........................] - ETA: 0s - loss: 0.00105/8 [=================>............] - ETA: 0s - loss: 0.00358/8 [==============================] - 0s 11ms/step - loss: 0.0030
1/8 [==>...........................] - ETA: 0s - loss: 0.00184/8 [==============>...............] - ETA: 0s - loss: 0.00386/8 [=====================>........] - ETA: 0s - loss: 0.00338/8 [==============================] - 0s 29ms/step - loss: 0.0033
1/8 [==>...........................] - ETA: 0s - loss: 0.00295/8 [=================>............] - ETA: 0s - loss: 0.00618/8 [==============================] - 0s 14ms/step - loss: 0.0049
1/8 [==>...........................] - ETA: 0s - loss: 0.00265/8 [=================>............] - ETA: 0s - loss: 0.00198/8 [==============================] - ETA: 0s - loss: 0.00318/8 [==============================] - 0s 15ms/step - loss: 0.0031
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0033656228333711624:
Train Score: 0.00415 MSE 0.06443 RMSE
Test Score: 0.00377 MSE 0.06139 RMSE
Deviation Min [5.79985866e-06], Max [0.49303699]
Deviation 99.5th pctile [0.20268317]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1648,    8]))
Confusion matrix 
[[1647    1]
 [   0    8]]
precision 0.88889, recall 1.00000, f1 0.94118
Time to train: 1026100 ms
Saving model models/A3Benchmark/A3Benchmark-TS85.csv.h5
Total Time to proces all the selected files : 1031648 ms
A3Benchmark : Avg precision 0.88889 recall 1.00000 f1 0.94118 time to train 1026100.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS85.csv  --epochs 20 --n_iter 3 --patience 3 :: took 1038 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS86.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 08:35:02 AM MST
2020-12-01 08:35:08.399799: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 08:35:08.420070: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 08:35:08.421348: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55a502e68d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 08:35:08.421386: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 08:35:08.421571: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS86.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00353/8 [==========>...................] - ETA: 0s - loss: 0.00294/8 [==============>...............] - ETA: 0s - loss: 0.00307/8 [=========================>....] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 26ms/step - loss: 0.0034
1/8 [==>...........................] - ETA: 0s - loss: 0.00763/8 [==========>...................] - ETA: 0s - loss: 0.00654/8 [==============>...............] - ETA: 0s - loss: 0.00555/8 [=================>............] - ETA: 0s - loss: 0.00488/8 [==============================] - ETA: 0s - loss: 0.00568/8 [==============================] - 0s 55ms/step - loss: 0.0056
1/8 [==>...........................] - ETA: 0s - loss: 0.00172/8 [======>.......................] - ETA: 0s - loss: 0.00153/8 [==========>...................] - ETA: 0s - loss: 0.00164/8 [==============>...............] - ETA: 0s - loss: 0.00156/8 [=====================>........] - ETA: 0s - loss: 0.00237/8 [=========================>....] - ETA: 0s - loss: 0.00248/8 [==============================] - 0s 48ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 0.00273/8 [==========>...................] - ETA: 0s - loss: 0.00185/8 [=================>............] - ETA: 0s - loss: 0.00287/8 [=========================>....] - ETA: 0s - loss: 0.00288/8 [==============================] - 0s 25ms/step - loss: 0.0034
1/8 [==>...........................] - ETA: 0s - loss: 0.00893/8 [==========>...................] - ETA: 0s - loss: 0.00604/8 [==============>...............] - ETA: 0s - loss: 0.00685/8 [=================>............] - ETA: 0s - loss: 0.00586/8 [=====================>........] - ETA: 0s - loss: 0.00547/8 [=========================>....] - ETA: 0s - loss: 0.00508/8 [==============================] - 0s 47ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00153/8 [==========>...................] - ETA: 0s - loss: 0.00135/8 [=================>............] - ETA: 0s - loss: 0.00257/8 [=========================>....] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 28ms/step - loss: 0.0022
1/8 [==>...........................] - ETA: 0s - loss: 0.00602/8 [======>.......................] - ETA: 0s - loss: 0.00563/8 [==========>...................] - ETA: 0s - loss: 0.00474/8 [==============>...............] - ETA: 0s - loss: 0.00396/8 [=====================>........] - ETA: 0s - loss: 0.00378/8 [==============================] - ETA: 0s - loss: 0.00358/8 [==============================] - 1s 63ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.00133/8 [==========>...................] - ETA: 0s - loss: 0.00155/8 [=================>............] - ETA: 0s - loss: 0.00137/8 [=========================>....] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 33ms/step - loss: 0.0026
1/8 [==>...........................] - ETA: 0s - loss: 0.00343/8 [==========>...................] - ETA: 0s - loss: 0.00195/8 [=================>............] - ETA: 0s - loss: 0.00317/8 [=========================>....] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 37ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.00803/8 [==========>...................] - ETA: 0s - loss: 0.00555/8 [=================>............] - ETA: 0s - loss: 0.00567/8 [=========================>....] - ETA: 0s - loss: 0.00468/8 [==============================] - 0s 30ms/step - loss: 0.0044
1/8 [==>...........................] - ETA: 0s - loss: 0.00154/8 [==============>...............] - ETA: 0s - loss: 0.00137/8 [=========================>....] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 19ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.00564/8 [==============>...............] - ETA: 0s - loss: 0.00377/8 [=========================>....] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 17ms/step - loss: 0.0034
1/8 [==>...........................] - ETA: 0s - loss: 0.00204/8 [==============>...............] - ETA: 0s - loss: 0.00167/8 [=========================>....] - ETA: 0s - loss: 0.00258/8 [==============================] - 0s 18ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00184/8 [==============>...............] - ETA: 0s - loss: 0.00297/8 [=========================>....] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 17ms/step - loss: 0.0031
1/8 [==>...........................] - ETA: 0s - loss: 0.00785/8 [=================>............] - ETA: 0s - loss: 0.00518/8 [==============================] - 0s 12ms/step - loss: 0.0041
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0031235067639499904:
Train Score: 0.00300 MSE 0.05482 RMSE
Test Score: 0.00232 MSE 0.04812 RMSE
Deviation Min [4.45501689e-06], Max [0.42124894]
Deviation 99.5th pctile [0.3692327]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1643,   13]))
Confusion matrix 
[[1643    0]
 [   4    9]]
precision 1.00000, recall 0.69231, f1 0.81818
Time to train: 932117 ms
Saving model models/A3Benchmark/A3Benchmark-TS86.csv.h5
Total Time to proces all the selected files : 935304 ms
A3Benchmark : Avg precision 1.00000 recall 0.69231 f1 0.81818 time to train 932117.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS86.csv  --epochs 20 --n_iter 3 --patience 3 :: took 942 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS87.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 08:50:49 AM MST
2020-12-01 08:50:55.392208: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 08:50:55.411253: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 08:50:55.412838: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55a865cd7d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 08:50:55.412909: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 08:50:55.413131: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS87.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.01092/8 [======>.......................] - ETA: 0s - loss: 0.00843/8 [==========>...................] - ETA: 0s - loss: 0.00825/8 [=================>............] - ETA: 0s - loss: 0.00597/8 [=========================>....] - ETA: 0s - loss: 0.00608/8 [==============================] - 0s 39ms/step - loss: 0.0057
1/8 [==>...........................] - ETA: 0s - loss: 0.00193/8 [==========>...................] - ETA: 0s - loss: 0.00484/8 [==============>...............] - ETA: 0s - loss: 0.00436/8 [=====================>........] - ETA: 0s - loss: 0.00357/8 [=========================>....] - ETA: 0s - loss: 0.00368/8 [==============================] - ETA: 0s - loss: 0.00378/8 [==============================] - 1s 64ms/step - loss: 0.0037
1/8 [==>...........................] - ETA: 0s - loss: 0.00282/8 [======>.......................] - ETA: 0s - loss: 0.00414/8 [==============>...............] - ETA: 0s - loss: 0.00336/8 [=====================>........] - ETA: 0s - loss: 0.00397/8 [=========================>....] - ETA: 0s - loss: 0.00408/8 [==============================] - 0s 45ms/step - loss: 0.0040
1/8 [==>...........................] - ETA: 0s - loss: 0.00273/8 [==========>...................] - ETA: 0s - loss: 0.00245/8 [=================>............] - ETA: 0s - loss: 0.00327/8 [=========================>....] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 24ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00932/8 [======>.......................] - ETA: 0s - loss: 0.00703/8 [==========>...................] - ETA: 0s - loss: 0.00605/8 [=================>............] - ETA: 0s - loss: 0.00617/8 [=========================>....] - ETA: 0s - loss: 0.00688/8 [==============================] - 0s 52ms/step - loss: 0.0067
1/8 [==>...........................] - ETA: 0s - loss: 0.00613/8 [==========>...................] - ETA: 0s - loss: 0.00475/8 [=================>............] - ETA: 0s - loss: 0.00387/8 [=========================>....] - ETA: 0s - loss: 0.00348/8 [==============================] - 0s 28ms/step - loss: 0.0032
1/8 [==>...........................] - ETA: 0s - loss: 0.00202/8 [======>.......................] - ETA: 0s - loss: 0.00453/8 [==========>...................] - ETA: 0s - loss: 0.00384/8 [==============>...............] - ETA: 0s - loss: 0.00475/8 [=================>............] - ETA: 0s - loss: 0.00506/8 [=====================>........] - ETA: 0s - loss: 0.00467/8 [=========================>....] - ETA: 0s - loss: 0.00448/8 [==============================] - ETA: 0s - loss: 0.00428/8 [==============================] - 1s 82ms/step - loss: 0.0042
1/8 [==>...........................] - ETA: 0s - loss: 0.00383/8 [==========>...................] - ETA: 0s - loss: 0.00616/8 [=====================>........] - ETA: 0s - loss: 0.00558/8 [==============================] - 0s 30ms/step - loss: 0.0060
1/8 [==>...........................] - ETA: 0s - loss: 0.00183/8 [==========>...................] - ETA: 0s - loss: 0.00245/8 [=================>............] - ETA: 0s - loss: 0.00317/8 [=========================>....] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 33ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 0.00413/8 [==========>...................] - ETA: 0s - loss: 0.00595/8 [=================>............] - ETA: 0s - loss: 0.00547/8 [=========================>....] - ETA: 0s - loss: 0.00518/8 [==============================] - 0s 34ms/step - loss: 0.0051
1/8 [==>...........................] - ETA: 0s - loss: 0.00545/8 [=================>............] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 13ms/step - loss: 0.0045
1/8 [==>...........................] - ETA: 0s - loss: 0.00304/8 [==============>...............] - ETA: 0s - loss: 0.00576/8 [=====================>........] - ETA: 0s - loss: 0.00548/8 [==============================] - 0s 21ms/step - loss: 0.0055
1/8 [==>...........................] - ETA: 0s - loss: 0.00262/8 [======>.......................] - ETA: 0s - loss: 0.00406/8 [=====================>........] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 20ms/step - loss: 0.0040
1/8 [==>...........................] - ETA: 0s - loss: 0.00212/8 [======>.......................] - ETA: 0s - loss: 0.00234/8 [==============>...............] - ETA: 0s - loss: 0.00277/8 [=========================>....] - ETA: 0s - loss: 0.00288/8 [==============================] - 0s 29ms/step - loss: 0.0028
1/8 [==>...........................] - ETA: 0s - loss: 0.00315/8 [=================>............] - ETA: 0s - loss: 0.00318/8 [==============================] - 0s 13ms/step - loss: 0.0031
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.003983657201752066:
Train Score: 0.00579 MSE 0.07608 RMSE
Test Score: 0.00675 MSE 0.08216 RMSE
Deviation Min [2.91226707e-05], Max [0.43374121]
Deviation 99.5th pctile [0.26744218]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1649,    7]))
Confusion matrix 
[[1646    3]
 [   1    6]]
precision 0.66667, recall 0.85714, f1 0.75000
Time to train: 1205973 ms
Saving model models/A3Benchmark/A3Benchmark-TS87.csv.h5
Total Time to proces all the selected files : 1210548 ms
A3Benchmark : Avg precision 0.66667 recall 0.85714 f1 0.75000 time to train 1205973.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS87.csv  --epochs 20 --n_iter 3 --patience 3 :: took 1217 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS88.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 09:11:11 AM MST
2020-12-01 09:11:17.348785: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 09:11:17.367011: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 09:11:17.367842: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x563d3c8ccc00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 09:11:17.367879: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 09:11:17.368016: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS88.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00733/8 [==========>...................] - ETA: 0s - loss: 0.00545/8 [=================>............] - ETA: 0s - loss: 0.00607/8 [=========================>....] - ETA: 0s - loss: 0.00568/8 [==============================] - 0s 39ms/step - loss: 0.0055
1/8 [==>...........................] - ETA: 0s - loss: 0.02343/8 [==========>...................] - ETA: 0s - loss: 0.03315/8 [=================>............] - ETA: 0s - loss: 0.03076/8 [=====================>........] - ETA: 0s - loss: 0.03047/8 [=========================>....] - ETA: 0s - loss: 0.03008/8 [==============================] - 0s 61ms/step - loss: 0.0311
1/8 [==>...........................] - ETA: 0s - loss: 0.00302/8 [======>.......................] - ETA: 0s - loss: 0.00624/8 [==============>...............] - ETA: 0s - loss: 0.00476/8 [=====================>........] - ETA: 0s - loss: 0.00478/8 [==============================] - ETA: 0s - loss: 0.00478/8 [==============================] - 0s 31ms/step - loss: 0.0047
1/8 [==>...........................] - ETA: 0s - loss: 0.00763/8 [==========>...................] - ETA: 0s - loss: 0.00414/8 [==============>...............] - ETA: 0s - loss: 0.00376/8 [=====================>........] - ETA: 0s - loss: 0.00458/8 [==============================] - ETA: 0s - loss: 0.00528/8 [==============================] - 0s 38ms/step - loss: 0.0052
1/8 [==>...........................] - ETA: 0s - loss: 0.00223/8 [==========>...................] - ETA: 0s - loss: 0.00565/8 [=================>............] - ETA: 0s - loss: 0.00597/8 [=========================>....] - ETA: 0s - loss: 0.00548/8 [==============================] - 0s 30ms/step - loss: 0.0056
1/8 [==>...........................] - ETA: 0s - loss: 0.00904/8 [==============>...............] - ETA: 0s - loss: 0.00527/8 [=========================>....] - ETA: 0s - loss: 0.00518/8 [==============================] - 0s 15ms/step - loss: 0.0050
1/8 [==>...........................] - ETA: 0s - loss: 0.01386/8 [=====================>........] - ETA: 0s - loss: 0.01598/8 [==============================] - 0s 10ms/step - loss: 0.0161
1/8 [==>...........................] - ETA: 0s - loss: 0.00395/8 [=================>............] - ETA: 0s - loss: 0.00548/8 [==============================] - ETA: 0s - loss: 0.00558/8 [==============================] - 0s 15ms/step - loss: 0.0055
1/8 [==>...........................] - ETA: 0s - loss: 0.00606/8 [=====================>........] - ETA: 0s - loss: 0.00398/8 [==============================] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 22ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00263/8 [==========>...................] - ETA: 0s - loss: 0.00375/8 [=================>............] - ETA: 0s - loss: 0.00487/8 [=========================>....] - ETA: 0s - loss: 0.00478/8 [==============================] - 0s 39ms/step - loss: 0.0046
1/8 [==>...........................] - ETA: 0s - loss: 0.00805/8 [=================>............] - ETA: 0s - loss: 0.00448/8 [==============================] - 0s 13ms/step - loss: 0.0040
1/8 [==>...........................] - ETA: 0s - loss: 0.00565/8 [=================>............] - ETA: 0s - loss: 0.00678/8 [==============================] - ETA: 0s - loss: 0.00618/8 [==============================] - 0s 16ms/step - loss: 0.0061
1/8 [==>...........................] - ETA: 0s - loss: 0.00284/8 [==============>...............] - ETA: 0s - loss: 0.00437/8 [=========================>....] - ETA: 0s - loss: 0.00448/8 [==============================] - 0s 17ms/step - loss: 0.0044
1/8 [==>...........................] - ETA: 0s - loss: 0.00765/8 [=================>............] - ETA: 0s - loss: 0.00478/8 [==============================] - 0s 13ms/step - loss: 0.0054
1/8 [==>...........................] - ETA: 0s - loss: 0.00185/8 [=================>............] - ETA: 0s - loss: 0.00418/8 [==============================] - 0s 12ms/step - loss: 0.0040
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.004788582026958465:
Train Score: 0.00375 MSE 0.06124 RMSE
Test Score: 0.00404 MSE 0.06354 RMSE
Deviation Min [2.32753747e-05], Max [0.37682137]
Deviation 99.5th pctile [0.29758299]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1644,   12]))
Confusion matrix 
[[1644    0]
 [   3    9]]
precision 1.00000, recall 0.75000, f1 0.85714
Time to train: 889043 ms
Saving model models/A3Benchmark/A3Benchmark-TS88.csv.h5
Total Time to proces all the selected files : 892646 ms
A3Benchmark : Avg precision 1.00000 recall 0.75000 f1 0.85714 time to train 889043.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS88.csv  --epochs 20 --n_iter 3 --patience 3 :: took 899 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS89.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 09:26:15 AM MST
2020-12-01 09:26:21.380073: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 09:26:21.398323: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 09:26:21.399793: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5599415ad310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 09:26:21.399838: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 09:26:21.400056: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS89.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00172/8 [======>.......................] - ETA: 0s - loss: 0.00303/8 [==========>...................] - ETA: 0s - loss: 0.00254/8 [==============>...............] - ETA: 0s - loss: 0.00236/8 [=====================>........] - ETA: 0s - loss: 0.00227/8 [=========================>....] - ETA: 0s - loss: 0.00228/8 [==============================] - 0s 55ms/step - loss: 0.0022
1/8 [==>...........................] - ETA: 0s - loss: 0.00443/8 [==========>...................] - ETA: 0s - loss: 0.00556/8 [=====================>........] - ETA: 0s - loss: 0.00568/8 [==============================] - ETA: 0s - loss: 0.00568/8 [==============================] - 0s 30ms/step - loss: 0.0056
1/8 [==>...........................] - ETA: 0s - loss: 0.00935/8 [=================>............] - ETA: 0s - loss: 0.00698/8 [==============================] - 0s 12ms/step - loss: 0.0068
1/8 [==>...........................] - ETA: 0s - loss: 0.00185/8 [=================>............] - ETA: 0s - loss: 0.00248/8 [==============================] - ETA: 0s - loss: 0.00248/8 [==============================] - 0s 15ms/step - loss: 0.0024
1/8 [==>...........................] - ETA: 0s - loss: 0.00175/8 [=================>............] - ETA: 0s - loss: 0.00208/8 [==============================] - ETA: 0s - loss: 0.00278/8 [==============================] - 0s 15ms/step - loss: 0.0027
1/8 [==>...........................] - ETA: 0s - loss: 6.5403e-044/8 [==============>...............] - ETA: 0s - loss: 0.0020    7/8 [=========================>....] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 17ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 0.00174/8 [==============>...............] - ETA: 0s - loss: 0.00257/8 [=========================>....] - ETA: 0s - loss: 0.00258/8 [==============================] - 0s 18ms/step - loss: 0.0026
1/8 [==>...........................] - ETA: 0s - loss: 0.00904/8 [==============>...............] - ETA: 0s - loss: 0.00637/8 [=========================>....] - ETA: 0s - loss: 0.00598/8 [==============================] - 0s 16ms/step - loss: 0.0061
1/8 [==>...........................] - ETA: 0s - loss: 0.00494/8 [==============>...............] - ETA: 0s - loss: 0.00665/8 [=================>............] - ETA: 0s - loss: 0.00666/8 [=====================>........] - ETA: 0s - loss: 0.00648/8 [==============================] - ETA: 0s - loss: 0.00658/8 [==============================] - 0s 42ms/step - loss: 0.0065
1/8 [==>...........................] - ETA: 0s - loss: 0.00335/8 [=================>............] - ETA: 0s - loss: 0.00408/8 [==============================] - 0s 13ms/step - loss: 0.0045
1/8 [==>...........................] - ETA: 0s - loss: 0.00535/8 [=================>............] - ETA: 0s - loss: 0.00688/8 [==============================] - ETA: 0s - loss: 0.00658/8 [==============================] - 0s 14ms/step - loss: 0.0065
1/8 [==>...........................] - ETA: 0s - loss: 0.00486/8 [=====================>........] - ETA: 0s - loss: 0.00618/8 [==============================] - 0s 11ms/step - loss: 0.0061
1/8 [==>...........................] - ETA: 0s - loss: 0.00894/8 [==============>...............] - ETA: 0s - loss: 0.00617/8 [=========================>....] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 19ms/step - loss: 0.0058
1/8 [==>...........................] - ETA: 0s - loss: 0.00365/8 [=================>............] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 12ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00233/8 [==========>...................] - ETA: 0s - loss: 0.00275/8 [=================>............] - ETA: 0s - loss: 0.00277/8 [=========================>....] - ETA: 0s - loss: 0.00328/8 [==============================] - 0s 46ms/step - loss: 0.0034
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.003929627174511552:
Train Score: 0.00289 MSE 0.05377 RMSE
Test Score: 0.00484 MSE 0.06958 RMSE
Deviation Min [1.39904743e-05], Max [0.324085]
Deviation 99.5th pctile [0.1929381]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1644,   12]))
Confusion matrix 
[[1644    0]
 [   3    9]]
precision 1.00000, recall 0.75000, f1 0.85714
Time to train: 536111 ms
Saving model models/A3Benchmark/A3Benchmark-TS89.csv.h5
Total Time to proces all the selected files : 538565 ms
A3Benchmark : Avg precision 1.00000 recall 0.75000 f1 0.85714 time to train 536111.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS89.csv  --epochs 20 --n_iter 3 --patience 3 :: took 545 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS8.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 09:35:25 AM MST
2020-12-01 09:35:31.515293: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 09:35:31.534206: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 09:35:31.535547: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55c8065188e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 09:35:31.535594: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 09:35:31.535777: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS8.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00273/8 [==========>...................] - ETA: 0s - loss: 0.00335/8 [=================>............] - ETA: 0s - loss: 0.00337/8 [=========================>....] - ETA: 0s - loss: 0.00318/8 [==============================] - 0s 31ms/step - loss: 0.0032
1/8 [==>...........................] - ETA: 0s - loss: 0.00253/8 [==========>...................] - ETA: 0s - loss: 0.00325/8 [=================>............] - ETA: 0s - loss: 0.00337/8 [=========================>....] - ETA: 0s - loss: 0.00328/8 [==============================] - 0s 32ms/step - loss: 0.0033
1/8 [==>...........................] - ETA: 0s - loss: 0.00243/8 [==========>...................] - ETA: 0s - loss: 0.00325/8 [=================>............] - ETA: 0s - loss: 0.00317/8 [=========================>....] - ETA: 0s - loss: 0.00308/8 [==============================] - ETA: 0s - loss: 0.00318/8 [==============================] - 0s 35ms/step - loss: 0.0031
1/8 [==>...........................] - ETA: 0s - loss: 0.00273/8 [==========>...................] - ETA: 0s - loss: 0.00385/8 [=================>............] - ETA: 0s - loss: 0.00407/8 [=========================>....] - ETA: 0s - loss: 0.00438/8 [==============================] - 0s 31ms/step - loss: 0.0044
1/8 [==>...........................] - ETA: 0s - loss: 0.00572/8 [======>.......................] - ETA: 0s - loss: 0.00593/8 [==========>...................] - ETA: 0s - loss: 0.00564/8 [==============>...............] - ETA: 0s - loss: 0.00555/8 [=================>............] - ETA: 0s - loss: 0.00617/8 [=========================>....] - ETA: 0s - loss: 0.00688/8 [==============================] - ETA: 0s - loss: 0.00698/8 [==============================] - 1s 98ms/step - loss: 0.0069
1/8 [==>...........................] - ETA: 0s - loss: 0.00296/8 [=====================>........] - ETA: 0s - loss: 0.00308/8 [==============================] - 0s 11ms/step - loss: 0.0031
1/8 [==>...........................] - ETA: 0s - loss: 0.00234/8 [==============>...............] - ETA: 0s - loss: 0.00297/8 [=========================>....] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 19ms/step - loss: 0.0030
1/8 [==>...........................] - ETA: 0s - loss: 0.00223/8 [==========>...................] - ETA: 0s - loss: 0.00295/8 [=================>............] - ETA: 0s - loss: 0.00278/8 [==============================] - ETA: 0s - loss: 0.00278/8 [==============================] - 0s 25ms/step - loss: 0.0027
1/8 [==>...........................] - ETA: 0s - loss: 0.00205/8 [=================>............] - ETA: 0s - loss: 0.00268/8 [==============================] - 0s 13ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00485/8 [=================>............] - ETA: 0s - loss: 0.00508/8 [==============================] - 0s 14ms/step - loss: 0.0057
1/8 [==>...........................] - ETA: 0s - loss: 0.00253/8 [==========>...................] - ETA: 0s - loss: 0.00286/8 [=====================>........] - ETA: 0s - loss: 0.00288/8 [==============================] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 29ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00325/8 [=================>............] - ETA: 0s - loss: 0.00468/8 [==============================] - 0s 15ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 0.00232/8 [======>.......................] - ETA: 0s - loss: 0.00294/8 [==============>...............] - ETA: 0s - loss: 0.00275/8 [=================>............] - ETA: 0s - loss: 0.00277/8 [=========================>....] - ETA: 0s - loss: 0.00268/8 [==============================] - 0s 40ms/step - loss: 0.0027
1/8 [==>...........................] - ETA: 0s - loss: 0.00205/8 [=================>............] - ETA: 0s - loss: 0.00267/8 [=========================>....] - ETA: 0s - loss: 0.00288/8 [==============================] - 0s 19ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00365/8 [=================>............] - ETA: 0s - loss: 0.00408/8 [==============================] - 0s 13ms/step - loss: 0.0047
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0034625444561243056:
Train Score: 0.00389 MSE 0.06239 RMSE
Test Score: 0.01514 MSE 0.12303 RMSE
Deviation Min [2.99207701e-05], Max [0.30452091]
Deviation 99.5th pctile [0.21031512]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1652,    4]))
Confusion matrix 
[[1645    7]
 [   2    2]]
precision 0.22222, recall 0.50000, f1 0.30769
Time to train: 389392 ms
Saving model models/A3Benchmark/A3Benchmark-TS8.csv.h5
Total Time to proces all the selected files : 394513 ms
A3Benchmark : Avg precision 0.22222 recall 0.50000 f1 0.30769 time to train 389392.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS8.csv  --epochs 20 --n_iter 3 --patience 3 :: took 401 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS90.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 09:42:11 AM MST
2020-12-01 09:42:17.347998: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 09:42:17.366012: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 09:42:17.366801: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55c901140c00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 09:42:17.366830: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 09:42:17.366995: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS90.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00583/8 [==========>...................] - ETA: 0s - loss: 0.00575/8 [=================>............] - ETA: 0s - loss: 0.00617/8 [=========================>....] - ETA: 0s - loss: 0.00578/8 [==============================] - 0s 28ms/step - loss: 0.0058
1/8 [==>...........................] - ETA: 0s - loss: 0.00393/8 [==========>...................] - ETA: 0s - loss: 0.00535/8 [=================>............] - ETA: 0s - loss: 0.00587/8 [=========================>....] - ETA: 0s - loss: 0.00558/8 [==============================] - 0s 31ms/step - loss: 0.0057
1/8 [==>...........................] - ETA: 0s - loss: 0.00783/8 [==========>...................] - ETA: 0s - loss: 0.00675/8 [=================>............] - ETA: 0s - loss: 0.00597/8 [=========================>....] - ETA: 0s - loss: 0.00588/8 [==============================] - 0s 35ms/step - loss: 0.0061
1/8 [==>...........................] - ETA: 0s - loss: 2.8969e-042/8 [======>.......................] - ETA: 0s - loss: 0.0010    3/8 [==========>...................] - ETA: 0s - loss: 0.00105/8 [=================>............] - ETA: 0s - loss: 8.2338e-046/8 [=====================>........] - ETA: 0s - loss: 8.9671e-048/8 [==============================] - ETA: 0s - loss: 8.8144e-048/8 [==============================] - 1s 100ms/step - loss: 8.8144e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00483/8 [==========>...................] - ETA: 0s - loss: 0.00655/8 [=================>............] - ETA: 0s - loss: 0.00637/8 [=========================>....] - ETA: 0s - loss: 0.00628/8 [==============================] - 0s 26ms/step - loss: 0.0062
1/8 [==>...........................] - ETA: 0s - loss: 0.00713/8 [==========>...................] - ETA: 0s - loss: 0.00645/8 [=================>............] - ETA: 0s - loss: 0.00717/8 [=========================>....] - ETA: 0s - loss: 0.00648/8 [==============================] - 0s 27ms/step - loss: 0.0064
1/8 [==>...........................] - ETA: 0s - loss: 0.00183/8 [==========>...................] - ETA: 0s - loss: 0.00155/8 [=================>............] - ETA: 0s - loss: 0.00137/8 [=========================>....] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 33ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 0.00342/8 [======>.......................] - ETA: 0s - loss: 0.00263/8 [==========>...................] - ETA: 0s - loss: 0.00214/8 [==============>...............] - ETA: 0s - loss: 0.00175/8 [=================>............] - ETA: 0s - loss: 0.00146/8 [=====================>........] - ETA: 0s - loss: 0.00137/8 [=========================>....] - ETA: 0s - loss: 0.00138/8 [==============================] - ETA: 0s - loss: 0.00148/8 [==============================] - 1s 74ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 0.00403/8 [==========>...................] - ETA: 0s - loss: 0.00625/8 [=================>............] - ETA: 0s - loss: 0.00577/8 [=========================>....] - ETA: 0s - loss: 0.00568/8 [==============================] - 0s 38ms/step - loss: 0.0058
1/8 [==>...........................] - ETA: 0s - loss: 5.6293e-043/8 [==========>...................] - ETA: 0s - loss: 0.0014    5/8 [=================>............] - ETA: 0s - loss: 0.00147/8 [=========================>....] - ETA: 0s - loss: 0.00128/8 [==============================] - 0s 30ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 0.00674/8 [==============>...............] - ETA: 0s - loss: 0.00637/8 [=========================>....] - ETA: 0s - loss: 0.00598/8 [==============================] - 0s 15ms/step - loss: 0.0058
1/8 [==>...........................] - ETA: 0s - loss: 6.1523e-044/8 [==============>...............] - ETA: 0s - loss: 6.6691e-047/8 [=========================>....] - ETA: 0s - loss: 8.3561e-048/8 [==============================] - 0s 17ms/step - loss: 8.3636e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00605/8 [=================>............] - ETA: 0s - loss: 0.00398/8 [==============================] - ETA: 0s - loss: 0.00408/8 [==============================] - 0s 15ms/step - loss: 0.0040
1/8 [==>...........................] - ETA: 0s - loss: 3.2987e-042/8 [======>.......................] - ETA: 0s - loss: 0.0011    3/8 [==========>...................] - ETA: 0s - loss: 9.5881e-044/8 [==============>...............] - ETA: 0s - loss: 8.1972e-047/8 [=========================>....] - ETA: 0s - loss: 8.4805e-048/8 [==============================] - 0s 38ms/step - loss: 8.2344e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00124/8 [==============>...............] - ETA: 0s - loss: 8.2713e-047/8 [=========================>....] - ETA: 0s - loss: 0.0015    8/8 [==============================] - 0s 19ms/step - loss: 0.0015
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0025936730322428047:
Train Score: 0.00078 MSE 0.02786 RMSE
Test Score: 0.00174 MSE 0.04170 RMSE
Deviation Min [3.11055254e-05], Max [0.24570872]
Deviation 99.5th pctile [0.14750584]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1646,   10]))
Confusion matrix 
[[1646    0]
 [   1    9]]
precision 1.00000, recall 0.90000, f1 0.94737
Time to train: 860979 ms
Saving model models/A3Benchmark/A3Benchmark-TS90.csv.h5
Total Time to proces all the selected files : 865915 ms
A3Benchmark : Avg precision 1.00000 recall 0.90000 f1 0.94737 time to train 860979.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS90.csv  --epochs 20 --n_iter 3 --patience 3 :: took 872 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS91.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 09:56:48 AM MST
2020-12-01 09:56:54.711737: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 09:56:54.729988: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 09:56:54.730754: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x555a94a3d310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 09:56:54.730781: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 09:56:54.730938: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS91.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00302/8 [======>.......................] - ETA: 0s - loss: 0.00243/8 [==========>...................] - ETA: 0s - loss: 0.00365/8 [=================>............] - ETA: 0s - loss: 0.00457/8 [=========================>....] - ETA: 0s - loss: 0.00468/8 [==============================] - 1s 73ms/step - loss: 0.0043
1/8 [==>...........................] - ETA: 0s - loss: 9.0962e-046/8 [=====================>........] - ETA: 0s - loss: 0.0013    8/8 [==============================] - 0s 11ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 0.00265/8 [=================>............] - ETA: 0s - loss: 0.00268/8 [==============================] - 0s 14ms/step - loss: 0.0026
1/8 [==>...........................] - ETA: 0s - loss: 0.00245/8 [=================>............] - ETA: 0s - loss: 0.00278/8 [==============================] - 0s 10ms/step - loss: 0.0026
1/8 [==>...........................] - ETA: 0s - loss: 0.00293/8 [==========>...................] - ETA: 0s - loss: 0.00285/8 [=================>............] - ETA: 0s - loss: 0.00247/8 [=========================>....] - ETA: 0s - loss: 0.00248/8 [==============================] - ETA: 0s - loss: 0.00248/8 [==============================] - 0s 32ms/step - loss: 0.0024
1/8 [==>...........................] - ETA: 0s - loss: 0.00383/8 [==========>...................] - ETA: 0s - loss: 0.00414/8 [==============>...............] - ETA: 0s - loss: 0.00555/8 [=================>............] - ETA: 0s - loss: 0.00507/8 [=========================>....] - ETA: 0s - loss: 0.00528/8 [==============================] - 0s 43ms/step - loss: 0.0050
1/8 [==>...........................] - ETA: 0s - loss: 0.00322/8 [======>.......................] - ETA: 0s - loss: 0.00455/8 [=================>............] - ETA: 0s - loss: 0.00438/8 [==============================] - ETA: 0s - loss: 0.00428/8 [==============================] - 0s 28ms/step - loss: 0.0042
1/8 [==>...........................] - ETA: 0s - loss: 0.00305/8 [=================>............] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 13ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00346/8 [=====================>........] - ETA: 0s - loss: 0.00308/8 [==============================] - 0s 9ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00256/8 [=====================>........] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 10ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.00443/8 [==========>...................] - ETA: 0s - loss: 0.00495/8 [=================>............] - ETA: 0s - loss: 0.00617/8 [=========================>....] - ETA: 0s - loss: 0.00598/8 [==============================] - 0s 33ms/step - loss: 0.0058
1/8 [==>...........................] - ETA: 0s - loss: 0.00163/8 [==========>...................] - ETA: 0s - loss: 0.00355/8 [=================>............] - ETA: 0s - loss: 0.00307/8 [=========================>....] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 31ms/step - loss: 0.0031
1/8 [==>...........................] - ETA: 0s - loss: 0.00213/8 [==========>...................] - ETA: 0s - loss: 0.00365/8 [=================>............] - ETA: 0s - loss: 0.00317/8 [=========================>....] - ETA: 0s - loss: 0.00318/8 [==============================] - 0s 28ms/step - loss: 0.0032
1/8 [==>...........................] - ETA: 0s - loss: 0.00263/8 [==========>...................] - ETA: 0s - loss: 0.00195/8 [=================>............] - ETA: 0s - loss: 0.00297/8 [=========================>....] - ETA: 0s - loss: 0.00308/8 [==============================] - 0s 32ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00322/8 [======>.......................] - ETA: 0s - loss: 0.00304/8 [==============>...............] - ETA: 0s - loss: 0.00366/8 [=====================>........] - ETA: 0s - loss: 0.00328/8 [==============================] - ETA: 0s - loss: 0.00328/8 [==============================] - 0s 31ms/step - loss: 0.0032
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0026569884736090898:
Train Score: 0.00240 MSE 0.04903 RMSE
Test Score: 0.00299 MSE 0.05468 RMSE
Deviation Min [3.01706877e-05], Max [0.39170659]
Deviation 99.5th pctile [0.12957731]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1651,    5]))
Confusion matrix 
[[1647    4]
 [   0    5]]
precision 0.55556, recall 1.00000, f1 0.71429
Time to train: 1015629 ms
Saving model models/A3Benchmark/A3Benchmark-TS91.csv.h5
Total Time to proces all the selected files : 1018294 ms
A3Benchmark : Avg precision 0.55556 recall 1.00000 f1 0.71429 time to train 1015629.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS91.csv  --epochs 20 --n_iter 3 --patience 3 :: took 1025 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS92.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 10:13:58 AM MST
2020-12-01 10:14:04.210395: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 10:14:04.229011: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 10:14:04.229784: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5648ead208e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 10:14:04.229813: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 10:14:04.229970: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS92.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00543/8 [==========>...................] - ETA: 0s - loss: 0.00435/8 [=================>............] - ETA: 0s - loss: 0.00397/8 [=========================>....] - ETA: 0s - loss: 0.00398/8 [==============================] - 0s 25ms/step - loss: 0.0038
1/8 [==>...........................] - ETA: 0s - loss: 0.00473/8 [==========>...................] - ETA: 0s - loss: 0.00335/8 [=================>............] - ETA: 0s - loss: 0.00287/8 [=========================>....] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 35ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00223/8 [==========>...................] - ETA: 0s - loss: 0.00365/8 [=================>............] - ETA: 0s - loss: 0.00297/8 [=========================>....] - ETA: 0s - loss: 0.00298/8 [==============================] - 0s 33ms/step - loss: 0.0030
1/8 [==>...........................] - ETA: 0s - loss: 0.00293/8 [==========>...................] - ETA: 0s - loss: 0.00265/8 [=================>............] - ETA: 0s - loss: 0.00237/8 [=========================>....] - ETA: 0s - loss: 0.00308/8 [==============================] - 0s 39ms/step - loss: 0.0029
1/8 [==>...........................] - ETA: 0s - loss: 0.00343/8 [==========>...................] - ETA: 0s - loss: 0.00395/8 [=================>............] - ETA: 0s - loss: 0.00427/8 [=========================>....] - ETA: 0s - loss: 0.00448/8 [==============================] - 0s 29ms/step - loss: 0.0044
1/8 [==>...........................] - ETA: 0s - loss: 0.01453/8 [==========>...................] - ETA: 0s - loss: 0.01446/8 [=====================>........] - ETA: 0s - loss: 0.01348/8 [==============================] - 0s 21ms/step - loss: 0.0135
1/8 [==>...........................] - ETA: 0s - loss: 0.00612/8 [======>.......................] - ETA: 0s - loss: 0.00473/8 [==========>...................] - ETA: 0s - loss: 0.00355/8 [=================>............] - ETA: 0s - loss: 0.00306/8 [=====================>........] - ETA: 0s - loss: 0.00318/8 [==============================] - ETA: 0s - loss: 0.00318/8 [==============================] - 0s 52ms/step - loss: 0.0031
1/8 [==>...........................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00205/8 [=================>............] - ETA: 0s - loss: 0.00186/8 [=====================>........] - ETA: 0s - loss: 0.00178/8 [==============================] - 0s 37ms/step - loss: 0.0019
1/8 [==>...........................] - ETA: 0s - loss: 0.00173/8 [==========>...................] - ETA: 0s - loss: 0.00204/8 [==============>...............] - ETA: 0s - loss: 0.00186/8 [=====================>........] - ETA: 0s - loss: 0.00178/8 [==============================] - ETA: 0s - loss: 0.00248/8 [==============================] - 0s 53ms/step - loss: 0.0024
1/8 [==>...........................] - ETA: 0s - loss: 0.00277/8 [=========================>....] - ETA: 0s - loss: 0.00448/8 [==============================] - 0s 8ms/step - loss: 0.0045
1/8 [==>...........................] - ETA: 0s - loss: 0.00433/8 [==========>...................] - ETA: 0s - loss: 0.00325/8 [=================>............] - ETA: 0s - loss: 0.00247/8 [=========================>....] - ETA: 0s - loss: 0.00258/8 [==============================] - 0s 27ms/step - loss: 0.0024
1/8 [==>...........................] - ETA: 0s - loss: 0.00473/8 [==========>...................] - ETA: 0s - loss: 0.00395/8 [=================>............] - ETA: 0s - loss: 0.00337/8 [=========================>....] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 28ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.00313/8 [==========>...................] - ETA: 0s - loss: 0.00445/8 [=================>............] - ETA: 0s - loss: 0.00407/8 [=========================>....] - ETA: 0s - loss: 0.00418/8 [==============================] - 0s 37ms/step - loss: 0.0042
1/8 [==>...........................] - ETA: 0s - loss: 0.00143/8 [==========>...................] - ETA: 0s - loss: 0.00165/8 [=================>............] - ETA: 0s - loss: 0.00157/8 [=========================>....] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 28ms/step - loss: 0.0020
1/8 [==>...........................] - ETA: 0s - loss: 0.00183/8 [==========>...................] - ETA: 0s - loss: 0.00244/8 [==============>...............] - ETA: 0s - loss: 0.00325/8 [=================>............] - ETA: 0s - loss: 0.00286/8 [=====================>........] - ETA: 0s - loss: 0.00287/8 [=========================>....] - ETA: 0s - loss: 0.00278/8 [==============================] - ETA: 0s - loss: 0.00278/8 [==============================] - 1s 77ms/step - loss: 0.0027
Best parameters {'n_units': 72, 'n_hidden': 2} best score 0.002959612710401416:
Train Score: 0.00277 MSE 0.05259 RMSE
Test Score: 0.00241 MSE 0.04905 RMSE
Deviation Min [1.47706492e-05], Max [0.37317713]
Deviation 99.5th pctile [0.22956496]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1648,    8]))
Confusion matrix 
[[1647    1]
 [   0    8]]
precision 0.88889, recall 1.00000, f1 0.94118
Time to train: 1189191 ms
Saving model models/A3Benchmark/A3Benchmark-TS92.csv.h5
Total Time to proces all the selected files : 1197676 ms
A3Benchmark : Avg precision 0.88889 recall 1.00000 f1 0.94118 time to train 1189191.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS92.csv  --epochs 20 --n_iter 3 --patience 3 :: took 1204 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS93.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 10:34:07 AM MST
2020-12-01 10:34:13.488670: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 10:34:13.509072: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 10:34:13.510297: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55e512482310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 10:34:13.510339: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 10:34:13.510516: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS93.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00445/8 [=================>............] - ETA: 0s - loss: 0.00768/8 [==============================] - ETA: 0s - loss: 0.00828/8 [==============================] - 0s 16ms/step - loss: 0.0082
1/8 [==>...........................] - ETA: 0s - loss: 0.00845/8 [=================>............] - ETA: 0s - loss: 0.00978/8 [==============================] - 0s 13ms/step - loss: 0.0098
1/8 [==>...........................] - ETA: 0s - loss: 0.00396/8 [=====================>........] - ETA: 0s - loss: 0.00438/8 [==============================] - 0s 11ms/step - loss: 0.0050
1/8 [==>...........................] - ETA: 0s - loss: 0.00344/8 [==============>...............] - ETA: 0s - loss: 0.00677/8 [=========================>....] - ETA: 0s - loss: 0.00648/8 [==============================] - 0s 16ms/step - loss: 0.0064
1/8 [==>...........................] - ETA: 0s - loss: 0.00465/8 [=================>............] - ETA: 0s - loss: 0.00668/8 [==============================] - ETA: 0s - loss: 0.00718/8 [==============================] - 0s 15ms/step - loss: 0.0071
1/8 [==>...........................] - ETA: 0s - loss: 0.00434/8 [==============>...............] - ETA: 0s - loss: 0.00627/8 [=========================>....] - ETA: 0s - loss: 0.00708/8 [==============================] - 0s 18ms/step - loss: 0.0073
1/8 [==>...........................] - ETA: 0s - loss: 0.00344/8 [==============>...............] - ETA: 0s - loss: 0.00427/8 [=========================>....] - ETA: 0s - loss: 0.00388/8 [==============================] - 0s 20ms/step - loss: 0.0039
1/8 [==>...........................] - ETA: 0s - loss: 0.00334/8 [==============>...............] - ETA: 0s - loss: 0.00416/8 [=====================>........] - ETA: 0s - loss: 0.00418/8 [==============================] - ETA: 0s - loss: 0.00498/8 [==============================] - 0s 22ms/step - loss: 0.0049
1/8 [==>...........................] - ETA: 0s - loss: 0.00425/8 [=================>............] - ETA: 0s - loss: 0.00718/8 [==============================] - ETA: 0s - loss: 0.00738/8 [==============================] - 0s 15ms/step - loss: 0.0073
1/8 [==>...........................] - ETA: 0s - loss: 0.00324/8 [==============>...............] - ETA: 0s - loss: 0.00377/8 [=========================>....] - ETA: 0s - loss: 0.00468/8 [==============================] - 0s 17ms/step - loss: 0.0052
1/8 [==>...........................] - ETA: 0s - loss: 0.00375/8 [=================>............] - ETA: 0s - loss: 0.00708/8 [==============================] - 0s 13ms/step - loss: 0.0073
1/8 [==>...........................] - ETA: 0s - loss: 0.00342/8 [======>.......................] - ETA: 0s - loss: 0.00353/8 [==========>...................] - ETA: 0s - loss: 0.00334/8 [==============>...............] - ETA: 0s - loss: 0.00395/8 [=================>............] - ETA: 0s - loss: 0.00386/8 [=====================>........] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 58ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 0.00265/8 [=================>............] - ETA: 0s - loss: 0.00398/8 [==============================] - 0s 13ms/step - loss: 0.0045
1/8 [==>...........................] - ETA: 0s - loss: 0.00404/8 [==============>...............] - ETA: 0s - loss: 0.00687/8 [=========================>....] - ETA: 0s - loss: 0.00658/8 [==============================] - 0s 17ms/step - loss: 0.0065
1/8 [==>...........................] - ETA: 0s - loss: 0.00434/8 [==============>...............] - ETA: 0s - loss: 0.00448/8 [==============================] - 0s 12ms/step - loss: 0.0059
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.005556107871234417:
Train Score: 0.00487 MSE 0.06977 RMSE
Test Score: 0.00403 MSE 0.06349 RMSE
Deviation Min [5.29451996e-05], Max [0.45846983]
Deviation 99.5th pctile [0.39666219]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1641,   15]))
Confusion matrix 
[[1641    0]
 [   6    9]]
precision 1.00000, recall 0.60000, f1 0.75000
Time to train: 671133 ms
Saving model models/A3Benchmark/A3Benchmark-TS93.csv.h5
Total Time to proces all the selected files : 673587 ms
A3Benchmark : Avg precision 1.00000 recall 0.60000 f1 0.75000 time to train 671133.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS93.csv  --epochs 20 --n_iter 3 --patience 3 :: took 680 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS94.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 10:45:32 AM MST
2020-12-01 10:45:38.844397: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 10:45:38.863229: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 10:45:38.864814: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56080aa8cc00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 10:45:38.864884: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 10:45:38.865113: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS94.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.01442/8 [======>.......................] - ETA: 0s - loss: 0.01593/8 [==========>...................] - ETA: 0s - loss: 0.01544/8 [==============>...............] - ETA: 0s - loss: 0.01585/8 [=================>............] - ETA: 0s - loss: 0.01696/8 [=====================>........] - ETA: 0s - loss: 0.01657/8 [=========================>....] - ETA: 0s - loss: 0.01598/8 [==============================] - 1s 112ms/step - loss: 0.0162
1/8 [==>...........................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00114/8 [==============>...............] - ETA: 0s - loss: 0.00145/8 [=================>............] - ETA: 0s - loss: 0.00147/8 [=========================>....] - ETA: 0s - loss: 0.00208/8 [==============================] - 0s 55ms/step - loss: 0.0019
1/8 [==>...........................] - ETA: 0s - loss: 0.01253/8 [==========>...................] - ETA: 0s - loss: 0.01725/8 [=================>............] - ETA: 0s - loss: 0.01607/8 [=========================>....] - ETA: 0s - loss: 0.01638/8 [==============================] - 0s 28ms/step - loss: 0.0172
1/8 [==>...........................] - ETA: 0s - loss: 0.02223/8 [==========>...................] - ETA: 0s - loss: 0.02154/8 [==============>...............] - ETA: 0s - loss: 0.02075/8 [=================>............] - ETA: 0s - loss: 0.02127/8 [=========================>....] - ETA: 0s - loss: 0.02438/8 [==============================] - 0s 45ms/step - loss: 0.0246
1/8 [==>...........................] - ETA: 0s - loss: 0.01702/8 [======>.......................] - ETA: 0s - loss: 0.01923/8 [==========>...................] - ETA: 0s - loss: 0.02884/8 [==============>...............] - ETA: 0s - loss: 0.02965/8 [=================>............] - ETA: 0s - loss: 0.02846/8 [=====================>........] - ETA: 0s - loss: 0.02887/8 [=========================>....] - ETA: 0s - loss: 0.02828/8 [==============================] - ETA: 0s - loss: 0.02858/8 [==============================] - 1s 117ms/step - loss: 0.0285
1/8 [==>...........................] - ETA: 0s - loss: 0.00684/8 [==============>...............] - ETA: 0s - loss: 0.00696/8 [=====================>........] - ETA: 0s - loss: 0.00718/8 [==============================] - ETA: 0s - loss: 0.00698/8 [==============================] - 0s 22ms/step - loss: 0.0069
1/8 [==>...........................] - ETA: 0s - loss: 0.02344/8 [==============>...............] - ETA: 0s - loss: 0.02348/8 [==============================] - ETA: 0s - loss: 0.02988/8 [==============================] - 0s 16ms/step - loss: 0.0298
1/8 [==>...........................] - ETA: 0s - loss: 0.00174/8 [==============>...............] - ETA: 0s - loss: 0.00147/8 [=========================>....] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 17ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 0.00645/8 [=================>............] - ETA: 0s - loss: 0.00498/8 [==============================] - ETA: 0s - loss: 0.00488/8 [==============================] - 0s 17ms/step - loss: 0.0048
1/8 [==>...........................] - ETA: 0s - loss: 5.0084e-045/8 [=================>............] - ETA: 0s - loss: 0.0017    8/8 [==============================] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 15ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 0.01134/8 [==============>...............] - ETA: 0s - loss: 0.01297/8 [=========================>....] - ETA: 0s - loss: 0.01338/8 [==============================] - 0s 18ms/step - loss: 0.0139
1/8 [==>...........................] - ETA: 0s - loss: 0.01095/8 [=================>............] - ETA: 0s - loss: 0.01428/8 [==============================] - 0s 13ms/step - loss: 0.0146
1/8 [==>...........................] - ETA: 0s - loss: 0.01344/8 [==============>...............] - ETA: 0s - loss: 0.01987/8 [=========================>....] - ETA: 0s - loss: 0.01978/8 [==============================] - 0s 19ms/step - loss: 0.0209
1/8 [==>...........................] - ETA: 0s - loss: 8.2927e-044/8 [==============>...............] - ETA: 0s - loss: 6.8420e-047/8 [=========================>....] - ETA: 0s - loss: 8.9672e-048/8 [==============================] - 0s 23ms/step - loss: 8.8162e-04
1/8 [==>...........................] - ETA: 0s - loss: 4.9871e-044/8 [==============>...............] - ETA: 0s - loss: 0.0019    7/8 [=========================>....] - ETA: 0s - loss: 0.00148/8 [==============================] - 0s 17ms/step - loss: 0.0014
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.008887971634976566:
Train Score: 0.00088 MSE 0.02970 RMSE
Test Score: 0.00120 MSE 0.03459 RMSE
Deviation Min [1.97886213e-06], Max [0.34161268]
Deviation 99.5th pctile [0.07883705]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1653,    3]))
Confusion matrix 
[[1647    6]
 [   0    3]]
precision 0.33333, recall 1.00000, f1 0.50000
Time to train: 641164 ms
Saving model models/A3Benchmark/A3Benchmark-TS94.csv.h5
Total Time to proces all the selected files : 643655 ms
A3Benchmark : Avg precision 0.33333 recall 1.00000 f1 0.50000 time to train 641164.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS94.csv  --epochs 20 --n_iter 3 --patience 3 :: took 650 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS95.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 10:56:27 AM MST
2020-12-01 10:56:33.849718: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 10:56:33.868177: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 10:56:33.868935: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55941ac46d30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 10:56:33.868961: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 10:56:33.869083: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS95.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 2.7833e-044/8 [==============>...............] - ETA: 0s - loss: 3.2372e-047/8 [=========================>....] - ETA: 0s - loss: 3.5502e-048/8 [==============================] - 0s 18ms/step - loss: 3.6398e-04
1/8 [==>...........................] - ETA: 0s - loss: 6.3298e-045/8 [=================>............] - ETA: 0s - loss: 8.3962e-048/8 [==============================] - 0s 14ms/step - loss: 8.1303e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00114/8 [==============>...............] - ETA: 0s - loss: 9.9423e-047/8 [=========================>....] - ETA: 0s - loss: 7.9935e-048/8 [==============================] - 0s 18ms/step - loss: 7.8694e-04
1/8 [==>...........................] - ETA: 0s - loss: 2.8170e-044/8 [==============>...............] - ETA: 0s - loss: 3.0621e-047/8 [=========================>....] - ETA: 0s - loss: 3.7175e-048/8 [==============================] - 0s 17ms/step - loss: 3.9120e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00233/8 [==========>...................] - ETA: 0s - loss: 0.00234/8 [==============>...............] - ETA: 0s - loss: 0.00255/8 [=================>............] - ETA: 0s - loss: 0.00286/8 [=====================>........] - ETA: 0s - loss: 0.00318/8 [==============================] - ETA: 0s - loss: 0.00358/8 [==============================] - 1s 67ms/step - loss: 0.0035
1/8 [==>...........................] - ETA: 0s - loss: 6.6791e-042/8 [======>.......................] - ETA: 0s - loss: 8.2987e-043/8 [==========>...................] - ETA: 0s - loss: 7.3913e-044/8 [==============>...............] - ETA: 0s - loss: 6.5481e-045/8 [=================>............] - ETA: 0s - loss: 6.3028e-046/8 [=====================>........] - ETA: 0s - loss: 5.9209e-047/8 [=========================>....] - ETA: 0s - loss: 5.7784e-048/8 [==============================] - ETA: 0s - loss: 5.8031e-048/8 [==============================] - 1s 99ms/step - loss: 5.8031e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00113/8 [==========>...................] - ETA: 0s - loss: 0.00125/8 [=================>............] - ETA: 0s - loss: 0.00127/8 [=========================>....] - ETA: 0s - loss: 0.00118/8 [==============================] - 0s 30ms/step - loss: 0.0011
1/8 [==>...........................] - ETA: 0s - loss: 3.9926e-043/8 [==========>...................] - ETA: 0s - loss: 4.5047e-045/8 [=================>............] - ETA: 0s - loss: 4.2796e-048/8 [==============================] - ETA: 0s - loss: 4.2512e-048/8 [==============================] - 0s 22ms/step - loss: 4.2512e-04
1/8 [==>...........................] - ETA: 0s - loss: 5.5181e-043/8 [==========>...................] - ETA: 0s - loss: 8.2956e-045/8 [=================>............] - ETA: 0s - loss: 0.0011    7/8 [=========================>....] - ETA: 0s - loss: 0.00128/8 [==============================] - 0s 26ms/step - loss: 0.0013
1/8 [==>...........................] - ETA: 0s - loss: 0.00222/8 [======>.......................] - ETA: 0s - loss: 0.00243/8 [==========>...................] - ETA: 0s - loss: 0.00234/8 [==============>...............] - ETA: 0s - loss: 0.00255/8 [=================>............] - ETA: 0s - loss: 0.00306/8 [=====================>........] - ETA: 0s - loss: 0.00347/8 [=========================>....] - ETA: 0s - loss: 0.00388/8 [==============================] - 1s 108ms/step - loss: 0.0040
1/8 [==>...........................] - ETA: 0s - loss: 3.0882e-042/8 [======>.......................] - ETA: 0s - loss: 4.3884e-044/8 [==============>...............] - ETA: 0s - loss: 3.6017e-045/8 [=================>............] - ETA: 0s - loss: 4.0196e-046/8 [=====================>........] - ETA: 0s - loss: 4.3653e-048/8 [==============================] - ETA: 0s - loss: 4.8889e-048/8 [==============================] - 1s 68ms/step - loss: 4.8889e-04
1/8 [==>...........................] - ETA: 0s - loss: 4.1487e-045/8 [=================>............] - ETA: 0s - loss: 5.8792e-048/8 [==============================] - 0s 13ms/step - loss: 5.6260e-04
1/8 [==>...........................] - ETA: 0s - loss: 6.3223e-044/8 [==============>...............] - ETA: 0s - loss: 6.0612e-047/8 [=========================>....] - ETA: 0s - loss: 5.2359e-048/8 [==============================] - 0s 16ms/step - loss: 5.2084e-04
1/8 [==>...........................] - ETA: 0s - loss: 2.3722e-043/8 [==========>...................] - ETA: 0s - loss: 3.1567e-046/8 [=====================>........] - ETA: 0s - loss: 4.2596e-047/8 [=========================>....] - ETA: 0s - loss: 4.7620e-048/8 [==============================] - 0s 61ms/step - loss: 5.2134e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00245/8 [=================>............] - ETA: 0s - loss: 0.00297/8 [=========================>....] - ETA: 0s - loss: 0.00358/8 [==============================] - ETA: 0s - loss: 0.00368/8 [==============================] - 0s 52ms/step - loss: 0.0036
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.0011395422508940101:
Train Score: 0.00114 MSE 0.03373 RMSE
Test Score: 0.01207 MSE 0.10985 RMSE
Deviation Min [6.35717596e-05], Max [0.17515561]
Deviation 99.5th pctile [0.1596158]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1640,   16]))
Confusion matrix 
[[1631    9]
 [  16    0]]
precision 0.00000, recall 0.00000, f1 0.00000
Time to train: 363340 ms
Saving model models/A3Benchmark/A3Benchmark-TS95.csv.h5
Total Time to proces all the selected files : 365746 ms
A3Benchmark : Avg precision 0.00000 recall 0.00000 f1 0.00000 time to train 363340.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS95.csv  --epochs 20 --n_iter 3 --patience 3 :: took 373 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS96.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 11:02:45 AM MST
2020-12-01 11:02:51.037668: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 11:02:51.056268: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 11:02:51.057763: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55fc1b77b0b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 11:02:51.057819: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 11:02:51.058049: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS96.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00733/8 [==========>...................] - ETA: 0s - loss: 0.00845/8 [=================>............] - ETA: 0s - loss: 0.00817/8 [=========================>....] - ETA: 0s - loss: 0.00798/8 [==============================] - 0s 35ms/step - loss: 0.0081
1/8 [==>...........................] - ETA: 0s - loss: 8.7682e-043/8 [==========>...................] - ETA: 0s - loss: 9.4038e-045/8 [=================>............] - ETA: 0s - loss: 0.0012    7/8 [=========================>....] - ETA: 0s - loss: 0.00118/8 [==============================] - 0s 38ms/step - loss: 0.0013
1/8 [==>...........................] - ETA: 0s - loss: 0.00663/8 [==========>...................] - ETA: 0s - loss: 0.00795/8 [=================>............] - ETA: 0s - loss: 0.00767/8 [=========================>....] - ETA: 0s - loss: 0.00748/8 [==============================] - 0s 27ms/step - loss: 0.0077
1/8 [==>...........................] - ETA: 0s - loss: 0.00553/8 [==========>...................] - ETA: 0s - loss: 0.00755/8 [=================>............] - ETA: 0s - loss: 0.00837/8 [=========================>....] - ETA: 0s - loss: 0.00828/8 [==============================] - 0s 26ms/step - loss: 0.0085
1/8 [==>...........................] - ETA: 0s - loss: 0.00973/8 [==========>...................] - ETA: 0s - loss: 0.00965/8 [=================>............] - ETA: 0s - loss: 0.00997/8 [=========================>....] - ETA: 0s - loss: 0.01048/8 [==============================] - 0s 32ms/step - loss: 0.0108
1/8 [==>...........................] - ETA: 0s - loss: 0.00655/8 [=================>............] - ETA: 0s - loss: 0.00708/8 [==============================] - 0s 13ms/step - loss: 0.0070
1/8 [==>...........................] - ETA: 0s - loss: 0.00535/8 [=================>............] - ETA: 0s - loss: 0.00668/8 [==============================] - ETA: 0s - loss: 0.00678/8 [==============================] - 0s 14ms/step - loss: 0.0067
1/8 [==>...........................] - ETA: 0s - loss: 0.00434/8 [==============>...............] - ETA: 0s - loss: 0.00447/8 [=========================>....] - ETA: 0s - loss: 0.00448/8 [==============================] - 0s 16ms/step - loss: 0.0046
1/8 [==>...........................] - ETA: 0s - loss: 0.00546/8 [=====================>........] - ETA: 0s - loss: 0.00828/8 [==============================] - 0s 11ms/step - loss: 0.0085
1/8 [==>...........................] - ETA: 0s - loss: 0.00446/8 [=====================>........] - ETA: 0s - loss: 0.00498/8 [==============================] - 0s 11ms/step - loss: 0.0058
1/8 [==>...........................] - ETA: 0s - loss: 0.00713/8 [==========>...................] - ETA: 0s - loss: 0.00836/8 [=====================>........] - ETA: 0s - loss: 0.00828/8 [==============================] - ETA: 0s - loss: 0.00828/8 [==============================] - 0s 24ms/step - loss: 0.0082
1/8 [==>...........................] - ETA: 0s - loss: 0.00612/8 [======>.......................] - ETA: 0s - loss: 0.00733/8 [==========>...................] - ETA: 0s - loss: 0.00774/8 [==============>...............] - ETA: 0s - loss: 0.00745/8 [=================>............] - ETA: 0s - loss: 0.00786/8 [=====================>........] - ETA: 0s - loss: 0.00787/8 [=========================>....] - ETA: 0s - loss: 0.00748/8 [==============================] - ETA: 0s - loss: 0.00788/8 [==============================] - 1s 91ms/step - loss: 0.0078
1/8 [==>...........................] - ETA: 0s - loss: 0.00713/8 [==========>...................] - ETA: 0s - loss: 0.00805/8 [=================>............] - ETA: 0s - loss: 0.00937/8 [=========================>....] - ETA: 0s - loss: 0.00898/8 [==============================] - 0s 35ms/step - loss: 0.0091
1/8 [==>...........................] - ETA: 0s - loss: 0.00615/8 [=================>............] - ETA: 0s - loss: 0.00968/8 [==============================] - ETA: 0s - loss: 0.00988/8 [==============================] - 0s 15ms/step - loss: 0.0098
1/8 [==>...........................] - ETA: 0s - loss: 0.01232/8 [======>.......................] - ETA: 0s - loss: 0.01234/8 [==============>...............] - ETA: 0s - loss: 0.01106/8 [=====================>........] - ETA: 0s - loss: 0.01268/8 [==============================] - ETA: 0s - loss: 0.01328/8 [==============================] - 0s 41ms/step - loss: 0.0132
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.006531728897243738:
Train Score: 0.00389 MSE 0.06237 RMSE
Test Score: 0.00601 MSE 0.07751 RMSE
Deviation Min [6.65694268e-05], Max [0.28856257]
Deviation 99.5th pctile [0.16548788]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1651,    5]))
Confusion matrix 
[[1646    5]
 [   1    4]]
precision 0.44444, recall 0.80000, f1 0.57143
Time to train: 595412 ms
Saving model models/A3Benchmark/A3Benchmark-TS96.csv.h5
Total Time to proces all the selected files : 599742 ms
A3Benchmark : Avg precision 0.44444 recall 0.80000 f1 0.57143 time to train 595412.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS96.csv  --epochs 20 --n_iter 3 --patience 3 :: took 606 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS97.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 11:12:56 AM MST
2020-12-01 11:13:02.907397: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 11:13:02.914142: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 11:13:02.914831: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55558b935c00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 11:13:02.914861: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 11:13:02.914973: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS97.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00573/8 [==========>...................] - ETA: 0s - loss: 0.00804/8 [==============>...............] - ETA: 0s - loss: 0.00797/8 [=========================>....] - ETA: 0s - loss: 0.00758/8 [==============================] - 0s 25ms/step - loss: 0.0076
1/8 [==>...........................] - ETA: 0s - loss: 0.00513/8 [==========>...................] - ETA: 0s - loss: 0.00705/8 [=================>............] - ETA: 0s - loss: 0.00747/8 [=========================>....] - ETA: 0s - loss: 0.00728/8 [==============================] - 0s 29ms/step - loss: 0.0073
1/8 [==>...........................] - ETA: 0s - loss: 0.00523/8 [==========>...................] - ETA: 0s - loss: 0.00705/8 [=================>............] - ETA: 0s - loss: 0.00667/8 [=========================>....] - ETA: 0s - loss: 0.00658/8 [==============================] - 0s 30ms/step - loss: 0.0067
1/8 [==>...........................] - ETA: 0s - loss: 0.00513/8 [==========>...................] - ETA: 0s - loss: 0.00655/8 [=================>............] - ETA: 0s - loss: 0.00657/8 [=========================>....] - ETA: 0s - loss: 0.00658/8 [==============================] - 0s 34ms/step - loss: 0.0067
1/8 [==>...........................] - ETA: 0s - loss: 0.00993/8 [==========>...................] - ETA: 0s - loss: 0.01004/8 [==============>...............] - ETA: 0s - loss: 0.00985/8 [=================>............] - ETA: 0s - loss: 0.01096/8 [=====================>........] - ETA: 0s - loss: 0.01117/8 [=========================>....] - ETA: 0s - loss: 0.01138/8 [==============================] - 1s 107ms/step - loss: 0.0115
1/8 [==>...........................] - ETA: 0s - loss: 0.00542/8 [======>.......................] - ETA: 0s - loss: 0.00833/8 [==========>...................] - ETA: 0s - loss: 0.00764/8 [==============>...............] - ETA: 0s - loss: 0.00775/8 [=================>............] - ETA: 0s - loss: 0.00777/8 [=========================>....] - ETA: 0s - loss: 0.00728/8 [==============================] - ETA: 0s - loss: 0.00728/8 [==============================] - 1s 84ms/step - loss: 0.0072
1/8 [==>...........................] - ETA: 0s - loss: 0.00503/8 [==========>...................] - ETA: 0s - loss: 0.00685/8 [=================>............] - ETA: 0s - loss: 0.00727/8 [=========================>....] - ETA: 0s - loss: 0.00698/8 [==============================] - 0s 26ms/step - loss: 0.0071
1/8 [==>...........................] - ETA: 0s - loss: 0.00513/8 [==========>...................] - ETA: 0s - loss: 0.00695/8 [=================>............] - ETA: 0s - loss: 0.00667/8 [=========================>....] - ETA: 0s - loss: 0.00648/8 [==============================] - 0s 28ms/step - loss: 0.0066
1/8 [==>...........................] - ETA: 0s - loss: 0.00553/8 [==========>...................] - ETA: 0s - loss: 0.00735/8 [=================>............] - ETA: 0s - loss: 0.00757/8 [=========================>....] - ETA: 0s - loss: 0.00748/8 [==============================] - 0s 28ms/step - loss: 0.0077
1/8 [==>...........................] - ETA: 0s - loss: 0.01003/8 [==========>...................] - ETA: 0s - loss: 0.01015/8 [=================>............] - ETA: 0s - loss: 0.01106/8 [=====================>........] - ETA: 0s - loss: 0.01127/8 [=========================>....] - ETA: 0s - loss: 0.01148/8 [==============================] - ETA: 0s - loss: 0.01168/8 [==============================] - 0s 47ms/step - loss: 0.0116
1/8 [==>...........................] - ETA: 0s - loss: 0.00345/8 [=================>............] - ETA: 0s - loss: 0.00508/8 [==============================] - ETA: 0s - loss: 0.00478/8 [==============================] - 0s 15ms/step - loss: 0.0047
1/8 [==>...........................] - ETA: 0s - loss: 0.00124/8 [==============>...............] - ETA: 0s - loss: 0.00268/8 [==============================] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 15ms/step - loss: 0.0023
1/8 [==>...........................] - ETA: 0s - loss: 0.00364/8 [==============>...............] - ETA: 0s - loss: 0.00387/8 [=========================>....] - ETA: 0s - loss: 0.00348/8 [==============================] - 0s 17ms/step - loss: 0.0034
1/8 [==>...........................] - ETA: 0s - loss: 0.00484/8 [==============>...............] - ETA: 0s - loss: 0.00597/8 [=========================>....] - ETA: 0s - loss: 0.00608/8 [==============================] - 0s 16ms/step - loss: 0.0062
1/8 [==>...........................] - ETA: 0s - loss: 0.00783/8 [==========>...................] - ETA: 0s - loss: 0.00794/8 [==============>...............] - ETA: 0s - loss: 0.00785/8 [=================>............] - ETA: 0s - loss: 0.00877/8 [=========================>....] - ETA: 0s - loss: 0.00918/8 [==============================] - 0s 33ms/step - loss: 0.0092
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0051776890642941:
Train Score: 0.00371 MSE 0.06095 RMSE
Test Score: 0.00720 MSE 0.08485 RMSE
Deviation Min [4.23560478e-05], Max [0.29765146]
Deviation 99.5th pctile [0.18285314]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Confusion matrix 
[[1645    2]
 [   2    7]]
precision 0.77778, recall 0.77778, f1 0.77778
Time to train: 527515 ms
Saving model models/A3Benchmark/A3Benchmark-TS97.csv.h5
Total Time to proces all the selected files : 532846 ms
A3Benchmark : Avg precision 0.77778 recall 0.77778 f1 0.77778 time to train 527515.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS97.csv  --epochs 20 --n_iter 3 --patience 3 :: took 540 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS98.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 11:22:01 AM MST
2020-12-01 11:22:06.967240: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 11:22:06.986023: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 11:22:06.986805: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x555c4b1b4310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 11:22:06.986833: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 11:22:06.986988: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS98.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00594/8 [==============>...............] - ETA: 0s - loss: 0.00566/8 [=====================>........] - ETA: 0s - loss: 0.00658/8 [==============================] - 0s 20ms/step - loss: 0.0064
1/8 [==>...........................] - ETA: 0s - loss: 0.00253/8 [==========>...................] - ETA: 0s - loss: 0.00284/8 [==============>...............] - ETA: 0s - loss: 0.00385/8 [=================>............] - ETA: 0s - loss: 0.00478/8 [==============================] - ETA: 0s - loss: 0.00418/8 [==============================] - 0s 62ms/step - loss: 0.0041
1/8 [==>...........................] - ETA: 0s - loss: 0.00485/8 [=================>............] - ETA: 0s - loss: 0.00698/8 [==============================] - 0s 14ms/step - loss: 0.0068
1/8 [==>...........................] - ETA: 0s - loss: 0.00172/8 [======>.......................] - ETA: 0s - loss: 0.00185/8 [=================>............] - ETA: 0s - loss: 0.00237/8 [=========================>....] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 41ms/step - loss: 0.0021
1/8 [==>...........................] - ETA: 0s - loss: 0.00454/8 [==============>...............] - ETA: 0s - loss: 0.00438/8 [==============================] - ETA: 0s - loss: 0.00538/8 [==============================] - 0s 16ms/step - loss: 0.0053
1/8 [==>...........................] - ETA: 0s - loss: 0.00704/8 [==============>...............] - ETA: 0s - loss: 0.00817/8 [=========================>....] - ETA: 0s - loss: 0.00858/8 [==============================] - 0s 17ms/step - loss: 0.0086
1/8 [==>...........................] - ETA: 0s - loss: 0.00412/8 [======>.......................] - ETA: 0s - loss: 0.00483/8 [==========>...................] - ETA: 0s - loss: 0.00494/8 [==============>...............] - ETA: 0s - loss: 0.00535/8 [=================>............] - ETA: 0s - loss: 0.00647/8 [=========================>....] - ETA: 0s - loss: 0.00598/8 [==============================] - 1s 71ms/step - loss: 0.0061
1/8 [==>...........................] - ETA: 0s - loss: 0.00714/8 [==============>...............] - ETA: 0s - loss: 0.00857/8 [=========================>....] - ETA: 0s - loss: 0.00908/8 [==============================] - 0s 16ms/step - loss: 0.0093
1/8 [==>...........................] - ETA: 0s - loss: 0.00293/8 [==========>...................] - ETA: 0s - loss: 0.00286/8 [=====================>........] - ETA: 0s - loss: 0.00348/8 [==============================] - ETA: 0s - loss: 0.00338/8 [==============================] - 0s 34ms/step - loss: 0.0033
1/8 [==>...........................] - ETA: 0s - loss: 0.00835/8 [=================>............] - ETA: 0s - loss: 0.00948/8 [==============================] - 0s 14ms/step - loss: 0.0096
1/8 [==>...........................] - ETA: 0s - loss: 0.00893/8 [==========>...................] - ETA: 0s - loss: 0.01035/8 [=================>............] - ETA: 0s - loss: 0.01107/8 [=========================>....] - ETA: 0s - loss: 0.01068/8 [==============================] - 0s 33ms/step - loss: 0.0107
1/8 [==>...........................] - ETA: 0s - loss: 0.00173/8 [==========>...................] - ETA: 0s - loss: 0.00174/8 [==============>...............] - ETA: 0s - loss: 0.00186/8 [=====================>........] - ETA: 0s - loss: 0.00268/8 [==============================] - ETA: 0s - loss: 0.00268/8 [==============================] - 0s 58ms/step - loss: 0.0026
1/8 [==>...........................] - ETA: 0s - loss: 0.01073/8 [==========>...................] - ETA: 0s - loss: 0.01325/8 [=================>............] - ETA: 0s - loss: 0.01557/8 [=========================>....] - ETA: 0s - loss: 0.01468/8 [==============================] - 0s 33ms/step - loss: 0.0149
1/8 [==>...........................] - ETA: 0s - loss: 0.00613/8 [==========>...................] - ETA: 0s - loss: 0.00725/8 [=================>............] - ETA: 0s - loss: 0.00787/8 [=========================>....] - ETA: 0s - loss: 0.00808/8 [==============================] - 0s 33ms/step - loss: 0.0082
1/8 [==>...........................] - ETA: 0s - loss: 0.01622/8 [======>.......................] - ETA: 0s - loss: 0.01923/8 [==========>...................] - ETA: 0s - loss: 0.01835/8 [=================>............] - ETA: 0s - loss: 0.01776/8 [=====================>........] - ETA: 0s - loss: 0.01778/8 [==============================] - ETA: 0s - loss: 0.01808/8 [==============================] - 0s 56ms/step - loss: 0.0180
Best parameters {'n_units': 96, 'n_hidden': 1} best score 0.0049368107691407205:
Train Score: 0.00336 MSE 0.05799 RMSE
Test Score: 0.00564 MSE 0.07513 RMSE
Deviation Min [3.10298344e-05], Max [0.31951293]
Deviation 99.5th pctile [0.19893717]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1644,   12]))
Confusion matrix 
[[1643    1]
 [   4    8]]
precision 0.88889, recall 0.66667, f1 0.76190
Time to train: 687310 ms
Saving model models/A3Benchmark/A3Benchmark-TS98.csv.h5
Total Time to proces all the selected files : 692569 ms
A3Benchmark : Avg precision 0.88889 recall 0.66667 f1 0.76190 time to train 687310.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS98.csv  --epochs 20 --n_iter 3 --patience 3 :: took 698 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS99.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 11:33:44 AM MST
2020-12-01 11:33:50.774621: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 11:33:50.793022: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 11:33:50.794115: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d3eea078e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 11:33:50.794146: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 11:33:50.794311: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS99.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00143/8 [==========>...................] - ETA: 0s - loss: 0.00155/8 [=================>............] - ETA: 0s - loss: 0.00137/8 [=========================>....] - ETA: 0s - loss: 0.00128/8 [==============================] - 0s 41ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 0.00134/8 [==============>...............] - ETA: 0s - loss: 0.00155/8 [=================>............] - ETA: 0s - loss: 0.00156/8 [=====================>........] - ETA: 0s - loss: 0.00158/8 [==============================] - ETA: 0s - loss: 0.00158/8 [==============================] - 0s 45ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 7.7016e-043/8 [==========>...................] - ETA: 0s - loss: 8.8370e-046/8 [=====================>........] - ETA: 0s - loss: 7.9413e-048/8 [==============================] - 0s 21ms/step - loss: 7.8155e-04
1/8 [==>...........................] - ETA: 0s - loss: 7.0916e-045/8 [=================>............] - ETA: 0s - loss: 0.0013    8/8 [==============================] - 0s 12ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 0.00336/8 [=====================>........] - ETA: 0s - loss: 0.00438/8 [==============================] - 0s 10ms/step - loss: 0.0049
1/8 [==>...........................] - ETA: 0s - loss: 6.1603e-044/8 [==============>...............] - ETA: 0s - loss: 6.9063e-048/8 [==============================] - ETA: 0s - loss: 8.2868e-048/8 [==============================] - 0s 14ms/step - loss: 8.2868e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00144/8 [==============>...............] - ETA: 0s - loss: 0.00137/8 [=========================>....] - ETA: 0s - loss: 0.00128/8 [==============================] - 0s 18ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 5.8878e-044/8 [==============>...............] - ETA: 0s - loss: 6.9617e-047/8 [=========================>....] - ETA: 0s - loss: 7.5881e-048/8 [==============================] - 0s 20ms/step - loss: 7.7529e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00144/8 [==============>...............] - ETA: 0s - loss: 0.00227/8 [=========================>....] - ETA: 0s - loss: 0.00258/8 [==============================] - 0s 19ms/step - loss: 0.0026
1/8 [==>...........................] - ETA: 0s - loss: 0.00313/8 [==========>...................] - ETA: 0s - loss: 0.00305/8 [=================>............] - ETA: 0s - loss: 0.00367/8 [=========================>....] - ETA: 0s - loss: 0.00448/8 [==============================] - ETA: 0s - loss: 0.00458/8 [==============================] - 0s 40ms/step - loss: 0.0045
1/8 [==>...........................] - ETA: 0s - loss: 7.7931e-042/8 [======>.......................] - ETA: 0s - loss: 9.4354e-043/8 [==========>...................] - ETA: 0s - loss: 9.5107e-044/8 [==============>...............] - ETA: 0s - loss: 9.0523e-046/8 [=====================>........] - ETA: 0s - loss: 9.5205e-047/8 [=========================>....] - ETA: 0s - loss: 9.4153e-048/8 [==============================] - 1s 89ms/step - loss: 9.4909e-04
1/8 [==>...........................] - ETA: 0s - loss: 0.00133/8 [==========>...................] - ETA: 0s - loss: 0.00134/8 [==============>...............] - ETA: 0s - loss: 0.00135/8 [=================>............] - ETA: 0s - loss: 0.00137/8 [=========================>....] - ETA: 0s - loss: 0.00138/8 [==============================] - 0s 46ms/step - loss: 0.0013
1/8 [==>...........................] - ETA: 0s - loss: 0.00123/8 [==========>...................] - ETA: 0s - loss: 0.00135/8 [=================>............] - ETA: 0s - loss: 0.00117/8 [=========================>....] - ETA: 0s - loss: 0.00128/8 [==============================] - 0s 25ms/step - loss: 0.0012
1/8 [==>...........................] - ETA: 0s - loss: 6.7857e-043/8 [==========>...................] - ETA: 0s - loss: 9.7123e-045/8 [=================>............] - ETA: 0s - loss: 0.0010    7/8 [=========================>....] - ETA: 0s - loss: 0.00108/8 [==============================] - ETA: 0s - loss: 0.00118/8 [==============================] - 0s 40ms/step - loss: 0.0011
1/8 [==>...........................] - ETA: 0s - loss: 0.00382/8 [======>.......................] - ETA: 0s - loss: 0.00404/8 [==============>...............] - ETA: 0s - loss: 0.00395/8 [=================>............] - ETA: 0s - loss: 0.00446/8 [=====================>........] - ETA: 0s - loss: 0.00487/8 [=========================>....] - ETA: 0s - loss: 0.00538/8 [==============================] - 1s 88ms/step - loss: 0.0054
Best parameters {'n_units': 48, 'n_hidden': 1} best score 0.0019501385278999806:
Train Score: 0.00164 MSE 0.04049 RMSE
Test Score: 0.01216 MSE 0.11027 RMSE
Deviation Min [2.30253885e-06], Max [0.23420046]
Deviation 99.5th pctile [0.17377491]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1645,   11]))
Confusion matrix 
[[1639    6]
 [   8    3]]
precision 0.33333, recall 0.27273, f1 0.30000
Time to train: 389099 ms
Saving model models/A3Benchmark/A3Benchmark-TS99.csv.h5
Total Time to proces all the selected files : 393585 ms
A3Benchmark : Avg precision 0.33333 recall 0.27273 f1 0.30000 time to train 389099.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS99.csv  --epochs 20 --n_iter 3 --patience 3 :: took 400 seconds
Staring command  : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS9.csv  --epochs 20 --n_iter 3 --patience 3  at time :: Tue 01 Dec 2020 11:40:29 AM MST
2020-12-01 11:40:35.515674: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2020-12-01 11:40:35.534017: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2593590000 Hz
2020-12-01 11:40:35.534804: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55db7d19a310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-01 11:40:35.534832: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-01 11:40:35.535012: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
python version sys.version_info(major=3, minor=8, micro=5, releaselevel='final', serial=0)
tf version 2.2.0 keras version 2.3.0-tf
Processing 1 files in folder A3Benchmark
File Name :  ../Stochastic-Methods/data/yahoo/dataset/ydata-labeled-time-series-anomalies-v1_0/A3Benchmark/A3Benchmark-TS9.csv
Shapes: time variant data with labels (1680, 2), full data (1680, 9)
Look back data shapes: lookbackX (1656, 24, 1) lookbackY (1656, 2)
Shapes: Xtrain_full (1324, 24, 1), Ytrain_full (1324, 1), Xtest (332, 24, 1), Ytest (332, 1)
Shapes: Xtrain (1192, 24, 1), Ytrain (1192, 1), Xvalid (132, 24, 1), Yvalid (132, 1)
1/8 [==>...........................] - ETA: 0s - loss: 0.00433/8 [==========>...................] - ETA: 0s - loss: 0.00225/8 [=================>............] - ETA: 0s - loss: 0.00287/8 [=========================>....] - ETA: 0s - loss: 0.00288/8 [==============================] - 0s 32ms/step - loss: 0.0026
1/8 [==>...........................] - ETA: 0s - loss: 5.5381e-042/8 [======>.......................] - ETA: 0s - loss: 6.2897e-043/8 [==========>...................] - ETA: 0s - loss: 9.2809e-044/8 [==============>...............] - ETA: 0s - loss: 0.0017    5/8 [=================>............] - ETA: 0s - loss: 0.00186/8 [=====================>........] - ETA: 0s - loss: 0.00177/8 [=========================>....] - ETA: 0s - loss: 0.00158/8 [==============================] - 1s 112ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 9.1410e-042/8 [======>.......................] - ETA: 0s - loss: 0.0015    3/8 [==========>...................] - ETA: 0s - loss: 0.00144/8 [==============>...............] - ETA: 0s - loss: 0.00115/8 [=================>............] - ETA: 0s - loss: 0.00116/8 [=====================>........] - ETA: 0s - loss: 9.9322e-047/8 [=========================>....] - ETA: 0s - loss: 0.0011    8/8 [==============================] - ETA: 0s - loss: 0.00118/8 [==============================] - 1s 134ms/step - loss: 0.0011
1/8 [==>...........................] - ETA: 0s - loss: 0.00172/8 [======>.......................] - ETA: 0s - loss: 0.00264/8 [==============>...............] - ETA: 0s - loss: 0.00255/8 [=================>............] - ETA: 0s - loss: 0.00256/8 [=====================>........] - ETA: 0s - loss: 0.00257/8 [=========================>....] - ETA: 0s - loss: 0.00248/8 [==============================] - 1s 73ms/step - loss: 0.0026
1/8 [==>...........................] - ETA: 0s - loss: 0.01282/8 [======>.......................] - ETA: 0s - loss: 0.01773/8 [==========>...................] - ETA: 0s - loss: 0.01634/8 [==============>...............] - ETA: 0s - loss: 0.01475/8 [=================>............] - ETA: 0s - loss: 0.01517/8 [=========================>....] - ETA: 0s - loss: 0.01478/8 [==============================] - ETA: 0s - loss: 0.01548/8 [==============================] - 1s 150ms/step - loss: 0.0154
1/8 [==>...........................] - ETA: 0s - loss: 0.00524/8 [==============>...............] - ETA: 0s - loss: 0.00237/8 [=========================>....] - ETA: 0s - loss: 0.00348/8 [==============================] - 0s 17ms/step - loss: 0.0032
1/8 [==>...........................] - ETA: 0s - loss: 7.7508e-045/8 [=================>............] - ETA: 0s - loss: 0.0015    8/8 [==============================] - 0s 14ms/step - loss: 0.0015
1/8 [==>...........................] - ETA: 0s - loss: 0.00134/8 [==============>...............] - ETA: 0s - loss: 0.00137/8 [=========================>....] - ETA: 0s - loss: 0.00148/8 [==============================] - 0s 14ms/step - loss: 0.0014
1/8 [==>...........................] - ETA: 0s - loss: 0.00414/8 [==============>...............] - ETA: 0s - loss: 0.00525/8 [=================>............] - ETA: 0s - loss: 0.00537/8 [=========================>....] - ETA: 0s - loss: 0.00538/8 [==============================] - 0s 26ms/step - loss: 0.0055
1/8 [==>...........................] - ETA: 0s - loss: 0.00263/8 [==========>...................] - ETA: 0s - loss: 0.00434/8 [==============>...............] - ETA: 0s - loss: 0.00375/8 [=================>............] - ETA: 0s - loss: 0.00356/8 [=====================>........] - ETA: 0s - loss: 0.00348/8 [==============================] - ETA: 0s - loss: 0.00388/8 [==============================] - 1s 84ms/step - loss: 0.0038
1/8 [==>...........................] - ETA: 0s - loss: 0.00473/8 [==========>...................] - ETA: 0s - loss: 0.00295/8 [=================>............] - ETA: 0s - loss: 0.00347/8 [=========================>....] - ETA: 0s - loss: 0.00348/8 [==============================] - 0s 29ms/step - loss: 0.0032
1/8 [==>...........................] - ETA: 0s - loss: 0.00213/8 [==========>...................] - ETA: 0s - loss: 0.00255/8 [=================>............] - ETA: 0s - loss: 0.00237/8 [=========================>....] - ETA: 0s - loss: 0.00238/8 [==============================] - 0s 30ms/step - loss: 0.0025
1/8 [==>...........................] - ETA: 0s - loss: 0.00993/8 [==========>...................] - ETA: 0s - loss: 0.01225/8 [=================>............] - ETA: 0s - loss: 0.01227/8 [=========================>....] - ETA: 0s - loss: 0.01198/8 [==============================] - 0s 30ms/step - loss: 0.0124
1/8 [==>...........................] - ETA: 0s - loss: 0.00213/8 [==========>...................] - ETA: 0s - loss: 0.00186/8 [=====================>........] - ETA: 0s - loss: 0.00218/8 [==============================] - 0s 22ms/step - loss: 0.0020
1/8 [==>...........................] - ETA: 0s - loss: 0.00433/8 [==========>...................] - ETA: 0s - loss: 0.00625/8 [=================>............] - ETA: 0s - loss: 0.00527/8 [=========================>....] - ETA: 0s - loss: 0.00518/8 [==============================] - 0s 29ms/step - loss: 0.0055
Best parameters {'n_units': 72, 'n_hidden': 1} best score 0.0030878048157319425:
Train Score: 0.00194 MSE 0.04401 RMSE
Test Score: 0.00322 MSE 0.05677 RMSE
Deviation Min [6.13924369e-06], Max [0.39005753]
Deviation 99.5th pctile [0.26088412]
Deviation > 99.5th pctile is_anomaly labels in data (array([0, 1]), array([1647,    9]))
Actual is_anomaly labels in data (array([0, 1]), array([1646,   10]))
Confusion matrix 
[[1646    0]
 [   1    9]]
precision 1.00000, recall 0.90000, f1 0.94737
Time to train: 1004304 ms
Saving model models/A3Benchmark/A3Benchmark-TS9.csv.h5
Total Time to proces all the selected files : 1007926 ms
A3Benchmark : Avg precision 1.00000 recall 0.90000 f1 0.94737 time to train 1004304.00 ms
Finished command : python Yahoo-LSTM-per-file.py -f A3Benchmark --save 1 --file_name A3Benchmark-TS9.csv  --epochs 20 --n_iter 3 --patience 3 :: took 1014 seconds
